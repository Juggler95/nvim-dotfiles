"use strict";(()=>{var GF=Object.create;var gp=Object.defineProperty;var jS=Object.getOwnPropertyDescriptor;var zF=Object.getOwnPropertyNames;var KF=Object.getPrototypeOf,JF=Object.prototype.hasOwnProperty;var g=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var lu=(r,e)=>()=>(r&&(e=r(r=0)),e);var _=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),YF=(r,e)=>{for(var t in e)gp(r,t,{get:e[t],enumerable:!0})},XF=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of zF(e))!JF.call(r,i)&&i!==t&&gp(r,i,{get:()=>e[i],enumerable:!(n=jS(e,i))||n.enumerable});return r};var S=(r,e,t)=>(t=r!=null?GF(KF(r)):{},XF(e||!r||!r.__esModule?gp(t,"default",{value:r,enumerable:!0}):t,r));var P=(r,e,t,n)=>{for(var i=n>1?void 0:n?jS(e,t):e,o=r.length-1,s;o>=0;o--)(s=r[o])&&(i=(n?s(e,t,i):s(i))||i);return n&&i&&gp(e,t,i),i},y=(r,e)=>(t,n)=>e(t,n,r);var He=_((OJ,$S)=>{"use strict";var jg=Object.defineProperty,QF=Object.getOwnPropertyDescriptor,ZF=Object.getOwnPropertyNames,eB=Object.prototype.hasOwnProperty,tB=(r,e)=>{for(var t in e)jg(r,t,{get:e[t],enumerable:!0})},rB=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of ZF(e))!eB.call(r,i)&&i!==t&&jg(r,i,{get:()=>e[i],enumerable:!(n=QF(e,i))||n.enumerable});return r},nB=r=>rB(jg({},"__esModule",{value:!0}),r),WS={};tB(WS,{config:()=>cB,t:()=>VS});$S.exports=nB(WS);var iB=g("fs"),oB=g("fs/promises");async function sB(r){if(r.protocol==="file:")return await(0,oB.readFile)(r,"utf8");if(r.protocol==="http:"||r.protocol==="https:"){let e=await fetch(r.toString(),{headers:{"Accept-Encoding":"gzip, deflate",Accept:"application/json"},redirect:"follow"});if(!e.ok){let n=`Unexpected ${e.status} response while trying to read ${r}`;try{n+=`: ${await e.text()}`}catch{}throw new Error(n)}return await e.text()}throw new Error("Unsupported protocol")}function aB(r){return(0,iB.readFileSync)(r,"utf8")}var pu;function cB(r){if("contents"in r){typeof r.contents=="string"?pu=JSON.parse(r.contents):pu=r.contents;return}if("fsPath"in r){let e=aB(r.fsPath),t=JSON.parse(e);pu=qS(t)?t.contents.bundle:t;return}if(r.uri){let e=r.uri;return typeof r.uri=="string"&&(e=new URL(r.uri)),new Promise((t,n)=>{sB(e).then(i=>{try{let o=JSON.parse(i);pu=qS(o)?o.contents.bundle:o,t()}catch(o){n(o)}}).catch(i=>{n(i)})})}}function VS(...r){let e=r[0],t,n,i;if(typeof e=="string")t=e,n=e,r.splice(0,1),i=!r||typeof r[0]!="object"?r:r[0];else if(e instanceof Array){let s=r.slice(1);if(e.length!==s.length+1)throw new Error("expected a string as the first argument to l10n.t");let a=e[0];for(let c=1;c<e.length;c++)a+=`{${c-1}}`+e[c];return VS(a,...s)}else n=e.message,t=n,e.comment&&e.comment.length>0&&(t+=`/${Array.isArray(e.comment)?e.comment.join(""):e.comment}`),i=e.args??{};let o=pu?.[t];return o?typeof o=="string"?yp(o,i):o.comment?yp(o.message,i):yp(n,i):yp(n,i)}var uB=/{([^}]+)}/g;function yp(r,e){return Object.keys(e).length===0?r:r.replace(uB,(t,n)=>e[n]??t)}function qS(r){return typeof r?.contents?.bundle=="object"&&typeof r?.version=="string"}});var qg=_(()=>{var HS;(function(r){(function(e){var t=typeof globalThis=="object"?globalThis:typeof global=="object"?global:typeof self=="object"?self:typeof this=="object"?this:a(),n=i(r);typeof t.Reflect<"u"&&(n=i(t.Reflect,n)),e(n,t),typeof t.Reflect>"u"&&(t.Reflect=r);function i(c,u){return function(l,p){Object.defineProperty(c,l,{configurable:!0,writable:!0,value:p}),u&&u(l,p)}}function o(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function a(){return o()||s()}})(function(e,t){var n=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",o=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",a=typeof Object.create=="function",c={__proto__:[]}instanceof Array,u=!a&&!c,l={create:a?function(){return Ug(Object.create(null))}:c?function(){return Ug({__proto__:null})}:function(){return Ug({})},has:u?function(w,x){return n.call(w,x)}:function(w,x){return x in w},get:u?function(w,x){return n.call(w,x)?w[x]:void 0}:function(w,x){return w[x]}},p=Object.getPrototypeOf(Function),d=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:qF(),f=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:WF(),h=typeof WeakMap=="function"?WeakMap:VF(),m=i?Symbol.for("@reflect-metadata:registry"):void 0,b=BF(),I=UF(b);function D(w,x,R,M){if(ee(R)){if(!L(w))throw new TypeError;if(!Ee(x))throw new TypeError;return Te(w,x)}else{if(!L(w))throw new TypeError;if(!we(x))throw new TypeError;if(!we(M)&&!ee(M)&&!Li(M))throw new TypeError;return Li(M)&&(M=void 0),R=ae(R),Ie(w,x,R,M)}}e("decorate",D);function B(w,x){function R(M,Q){if(!we(M))throw new TypeError;if(!ee(Q)&&!_t(Q))throw new TypeError;pe(w,x,M,Q)}return R}e("metadata",B);function Z(w,x,R,M){if(!we(R))throw new TypeError;return ee(M)||(M=ae(M)),pe(w,x,R,M)}e("defineMetadata",Z);function F(w,x,R){if(!we(x))throw new TypeError;return ee(R)||(R=ae(R)),Kr(w,x,R)}e("hasMetadata",F);function X(w,x,R){if(!we(x))throw new TypeError;return ee(R)||(R=ae(R)),T(w,x,R)}e("hasOwnMetadata",X);function H(w,x,R){if(!we(x))throw new TypeError;return ee(R)||(R=ae(R)),E(w,x,R)}e("getMetadata",H);function j(w,x,R){if(!we(x))throw new TypeError;return ee(R)||(R=ae(R)),pt(w,x,R)}e("getOwnMetadata",j);function te(w,x){if(!we(w))throw new TypeError;return ee(x)||(x=ae(x)),sr(w,x)}e("getMetadataKeys",te);function Se(w,x){if(!we(w))throw new TypeError;return ee(x)||(x=ae(x)),ar(w,x)}e("getOwnMetadataKeys",Se);function A(w,x,R){if(!we(x))throw new TypeError;if(ee(R)||(R=ae(R)),!we(x))throw new TypeError;ee(R)||(R=ae(R));var M=uu(x,R,!1);return ee(M)?!1:M.OrdinaryDeleteMetadata(w,x,R)}e("deleteMetadata",A);function Te(w,x){for(var R=w.length-1;R>=0;--R){var M=w[R],Q=M(x);if(!ee(Q)&&!Li(Q)){if(!Ee(Q))throw new TypeError;x=Q}}return x}function Ie(w,x,R,M){for(var Q=w.length-1;Q>=0;--Q){var Ke=w[Q],at=Ke(x,R,M);if(!ee(at)&&!Li(at)){if(!we(at))throw new TypeError;M=at}}return M}function Kr(w,x,R){var M=T(w,x,R);if(M)return!0;var Q=Bg(x);return Li(Q)?!1:Kr(w,Q,R)}function T(w,x,R){var M=uu(x,R,!1);return ee(M)?!1:mp(M.OrdinaryHasOwnMetadata(w,x,R))}function E(w,x,R){var M=T(w,x,R);if(M)return pt(w,x,R);var Q=Bg(x);if(!Li(Q))return E(w,Q,R)}function pt(w,x,R){var M=uu(x,R,!1);if(!ee(M))return M.OrdinaryGetOwnMetadata(w,x,R)}function pe(w,x,R,M){var Q=uu(R,M,!0);Q.OrdinaryDefineOwnMetadata(w,x,R,M)}function sr(w,x){var R=ar(w,x),M=Bg(w);if(M===null)return R;var Q=sr(M,x);if(Q.length<=0)return R;if(R.length<=0)return Q;for(var Ke=new f,at=[],se=0,U=R;se<U.length;se++){var K=U[se],z=Ke.has(K);z||(Ke.add(K),at.push(K))}for(var Y=0,ce=Q;Y<ce.length;Y++){var K=ce[Y],z=Ke.has(K);z||(Ke.add(K),at.push(K))}return at}function ar(w,x){var R=uu(w,x,!1);return R?R.OrdinaryOwnMetadataKeys(w,x):[]}function Ct(w){if(w===null)return 1;switch(typeof w){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return w===null?1:6;default:return 6}}function ee(w){return w===void 0}function Li(w){return w===null}function Ks(w){return typeof w=="symbol"}function we(w){return typeof w=="object"?w!==null:typeof w=="function"}function oe(w,x){switch(Ct(w)){case 0:return w;case 1:return w;case 2:return w;case 3:return w;case 4:return w;case 5:return w}var R=x===3?"string":x===5?"number":"default",M=Ys(w,o);if(M!==void 0){var Q=M.call(w,R);if(we(Q))throw new TypeError;return Q}return Js(w,R==="default"?"number":R)}function Js(w,x){if(x==="string"){var R=w.toString;if(re(R)){var M=R.call(w);if(!we(M))return M}var Q=w.valueOf;if(re(Q)){var M=Q.call(w);if(!we(M))return M}}else{var Q=w.valueOf;if(re(Q)){var M=Q.call(w);if(!we(M))return M}var Ke=w.toString;if(re(Ke)){var M=Ke.call(w);if(!we(M))return M}}throw new TypeError}function mp(w){return!!w}function q(w){return""+w}function ae(w){var x=oe(w,3);return Ks(x)?x:q(x)}function L(w){return Array.isArray?Array.isArray(w):w instanceof Object?w instanceof Array:Object.prototype.toString.call(w)==="[object Array]"}function re(w){return typeof w=="function"}function Ee(w){return typeof w=="function"}function _t(w){switch(Ct(w)){case 3:return!0;case 4:return!0;default:return!1}}function qe(w,x){return w===x||w!==w&&x!==x}function Ys(w,x){var R=w[x];if(R!=null){if(!re(R))throw new TypeError;return R}}function Lo(w){var x=Ys(w,s);if(!re(x))throw new TypeError;var R=x.call(w);if(!we(R))throw new TypeError;return R}function LS(w){return w.value}function FS(w){var x=w.next();return x.done?!1:x}function BS(w){var x=w.return;x&&x.call(w)}function Bg(w){var x=Object.getPrototypeOf(w);if(typeof w!="function"||w===p||x!==p)return x;var R=w.prototype,M=R&&Object.getPrototypeOf(R);if(M==null||M===Object.prototype)return x;var Q=M.constructor;return typeof Q!="function"||Q===w?x:Q}function FF(){var w;!ee(m)&&typeof t.Reflect<"u"&&!(m in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(w=jF(t.Reflect));var x,R,M,Q=new h,Ke={registerProvider:at,getProvider:U,setProvider:z};return Ke;function at(Y){if(!Object.isExtensible(Ke))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case w===Y:break;case ee(x):x=Y;break;case x===Y:break;case ee(R):R=Y;break;case R===Y:break;default:M===void 0&&(M=new f),M.add(Y);break}}function se(Y,ce){if(!ee(x)){if(x.isProviderFor(Y,ce))return x;if(!ee(R)){if(R.isProviderFor(Y,ce))return x;if(!ee(M))for(var ke=Lo(M);;){var Je=FS(ke);if(!Je)return;var Jr=LS(Je);if(Jr.isProviderFor(Y,ce))return BS(ke),Jr}}}if(!ee(w)&&w.isProviderFor(Y,ce))return w}function U(Y,ce){var ke=Q.get(Y),Je;return ee(ke)||(Je=ke.get(ce)),ee(Je)&&(Je=se(Y,ce),ee(Je)||(ee(ke)&&(ke=new d,Q.set(Y,ke)),ke.set(ce,Je))),Je}function K(Y){if(ee(Y))throw new TypeError;return x===Y||R===Y||!ee(M)&&M.has(Y)}function z(Y,ce,ke){if(!K(ke))throw new Error("Metadata provider not registered.");var Je=U(Y,ce);if(Je!==ke){if(!ee(Je))return!1;var Jr=Q.get(Y);ee(Jr)&&(Jr=new d,Q.set(Y,Jr)),Jr.set(ce,ke)}return!0}}function BF(){var w;return!ee(m)&&we(t.Reflect)&&Object.isExtensible(t.Reflect)&&(w=t.Reflect[m]),ee(w)&&(w=FF()),!ee(m)&&we(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,m,{enumerable:!1,configurable:!1,writable:!1,value:w}),w}function UF(w){var x=new h,R={isProviderFor:function(K,z){var Y=x.get(K);return ee(Y)?!1:Y.has(z)},OrdinaryDefineOwnMetadata:at,OrdinaryHasOwnMetadata:Q,OrdinaryGetOwnMetadata:Ke,OrdinaryOwnMetadataKeys:se,OrdinaryDeleteMetadata:U};return b.registerProvider(R),R;function M(K,z,Y){var ce=x.get(K),ke=!1;if(ee(ce)){if(!Y)return;ce=new d,x.set(K,ce),ke=!0}var Je=ce.get(z);if(ee(Je)){if(!Y)return;if(Je=new d,ce.set(z,Je),!w.setProvider(K,z,R))throw ce.delete(z),ke&&x.delete(K),new Error("Wrong provider for target.")}return Je}function Q(K,z,Y){var ce=M(z,Y,!1);return ee(ce)?!1:mp(ce.has(K))}function Ke(K,z,Y){var ce=M(z,Y,!1);if(!ee(ce))return ce.get(K)}function at(K,z,Y,ce){var ke=M(Y,ce,!0);ke.set(K,z)}function se(K,z){var Y=[],ce=M(K,z,!1);if(ee(ce))return Y;for(var ke=ce.keys(),Je=Lo(ke),Jr=0;;){var US=FS(Je);if(!US)return Y.length=Jr,Y;var $F=LS(US);try{Y[Jr]=$F}catch(HF){try{BS(Je)}finally{throw HF}}Jr++}}function U(K,z,Y){var ce=M(z,Y,!1);if(ee(ce)||!ce.delete(K))return!1;if(ce.size===0){var ke=x.get(z);ee(ke)||(ke.delete(Y),ke.size===0&&x.delete(ke))}return!0}}function jF(w){var x=w.defineMetadata,R=w.hasOwnMetadata,M=w.getOwnMetadata,Q=w.getOwnMetadataKeys,Ke=w.deleteMetadata,at=new h,se={isProviderFor:function(U,K){var z=at.get(U);return ee(z)?Q(U,K).length?(ee(z)&&(z=new f,at.set(U,z)),z.add(K),!0):!1:z.has(K)},OrdinaryDefineOwnMetadata:x,OrdinaryHasOwnMetadata:R,OrdinaryGetOwnMetadata:M,OrdinaryOwnMetadataKeys:Q,OrdinaryDeleteMetadata:Ke};return se}function uu(w,x,R){var M=b.getProvider(w,x);if(!ee(M))return M;if(R){if(b.setProvider(w,x,I))return I;throw new Error("Illegal state.")}}function qF(){var w={},x=[],R=function(){function se(U,K,z){this._index=0,this._keys=U,this._values=K,this._selector=z}return se.prototype["@@iterator"]=function(){return this},se.prototype[s]=function(){return this},se.prototype.next=function(){var U=this._index;if(U>=0&&U<this._keys.length){var K=this._selector(this._keys[U],this._values[U]);return U+1>=this._keys.length?(this._index=-1,this._keys=x,this._values=x):this._index++,{value:K,done:!1}}return{value:void 0,done:!0}},se.prototype.throw=function(U){throw this._index>=0&&(this._index=-1,this._keys=x,this._values=x),U},se.prototype.return=function(U){return this._index>=0&&(this._index=-1,this._keys=x,this._values=x),{value:U,done:!0}},se}(),M=function(){function se(){this._keys=[],this._values=[],this._cacheKey=w,this._cacheIndex=-2}return Object.defineProperty(se.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),se.prototype.has=function(U){return this._find(U,!1)>=0},se.prototype.get=function(U){var K=this._find(U,!1);return K>=0?this._values[K]:void 0},se.prototype.set=function(U,K){var z=this._find(U,!0);return this._values[z]=K,this},se.prototype.delete=function(U){var K=this._find(U,!1);if(K>=0){for(var z=this._keys.length,Y=K+1;Y<z;Y++)this._keys[Y-1]=this._keys[Y],this._values[Y-1]=this._values[Y];return this._keys.length--,this._values.length--,qe(U,this._cacheKey)&&(this._cacheKey=w,this._cacheIndex=-2),!0}return!1},se.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=w,this._cacheIndex=-2},se.prototype.keys=function(){return new R(this._keys,this._values,Q)},se.prototype.values=function(){return new R(this._keys,this._values,Ke)},se.prototype.entries=function(){return new R(this._keys,this._values,at)},se.prototype["@@iterator"]=function(){return this.entries()},se.prototype[s]=function(){return this.entries()},se.prototype._find=function(U,K){if(!qe(this._cacheKey,U)){this._cacheIndex=-1;for(var z=0;z<this._keys.length;z++)if(qe(this._keys[z],U)){this._cacheIndex=z;break}}return this._cacheIndex<0&&K&&(this._cacheIndex=this._keys.length,this._keys.push(U),this._values.push(void 0)),this._cacheIndex},se}();return M;function Q(se,U){return se}function Ke(se,U){return U}function at(se,U){return[se,U]}}function WF(){var w=function(){function x(){this._map=new d}return Object.defineProperty(x.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),x.prototype.has=function(R){return this._map.has(R)},x.prototype.add=function(R){return this._map.set(R,R),this},x.prototype.delete=function(R){return this._map.delete(R)},x.prototype.clear=function(){this._map.clear()},x.prototype.keys=function(){return this._map.keys()},x.prototype.values=function(){return this._map.keys()},x.prototype.entries=function(){return this._map.entries()},x.prototype["@@iterator"]=function(){return this.keys()},x.prototype[s]=function(){return this.keys()},x}();return w}function VF(){var w=16,x=l.create(),R=M();return function(){function U(){this._key=M()}return U.prototype.has=function(K){var z=Q(K,!1);return z!==void 0?l.has(z,this._key):!1},U.prototype.get=function(K){var z=Q(K,!1);return z!==void 0?l.get(z,this._key):void 0},U.prototype.set=function(K,z){var Y=Q(K,!0);return Y[this._key]=z,this},U.prototype.delete=function(K){var z=Q(K,!1);return z!==void 0?delete z[this._key]:!1},U.prototype.clear=function(){this._key=M()},U}();function M(){var U;do U="@@WeakMap@@"+se();while(l.has(x,U));return x[U]=!0,U}function Q(U,K){if(!n.call(U,R)){if(!K)return;Object.defineProperty(U,R,{value:l.create()})}return U[R]}function Ke(U,K){for(var z=0;z<K;++z)U[z]=Math.random()*255|0;return U}function at(U){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(U)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(U)):Ke(new Uint8Array(U),U):Ke(new Array(U),U)}function se(){var U=at(w);U[6]=U[6]&79|64,U[8]=U[8]&191|128;for(var K="",z=0;z<w;++z){var Y=U[z];(z===4||z===6||z===8)&&(K+="-"),Y<16&&(K+="0"),K+=Y.toString(16).toLowerCase()}return K}}function Ug(w){return w.__=void 0,delete w.__,w}})})(HS||(HS={}))});var tt=_(de=>{"use strict";Object.defineProperty(de,"__esModule",{value:!0});de.NON_CUSTOM_TAG_KEYS=de.PRE_DESTROY=de.POST_CONSTRUCT=de.DESIGN_PARAM_TYPES=de.PARAM_TYPES=de.TAGGED_PROP=de.TAGGED=de.MULTI_INJECT_TAG=de.INJECT_TAG=de.OPTIONAL_TAG=de.UNMANAGED_TAG=de.NAME_TAG=de.NAMED_TAG=void 0;de.NAMED_TAG="named";de.NAME_TAG="name";de.UNMANAGED_TAG="unmanaged";de.OPTIONAL_TAG="optional";de.INJECT_TAG="inject";de.MULTI_INJECT_TAG="multi_inject";de.TAGGED="inversify:tagged";de.TAGGED_PROP="inversify:tagged_props";de.PARAM_TYPES="inversify:paramtypes";de.DESIGN_PARAM_TYPES="design:paramtypes";de.POST_CONSTRUCT="post_construct";de.PRE_DESTROY="pre_destroy";function hB(){return[de.INJECT_TAG,de.MULTI_INJECT_TAG,de.NAME_TAG,de.UNMANAGED_TAG,de.NAMED_TAG,de.OPTIONAL_TAG]}de.NON_CUSTOM_TAG_KEYS=hB()});var Ir=_(Fi=>{"use strict";Object.defineProperty(Fi,"__esModule",{value:!0});Fi.TargetTypeEnum=Fi.BindingTypeEnum=Fi.BindingScopeEnum=void 0;var mB={Request:"Request",Singleton:"Singleton",Transient:"Transient"};Fi.BindingScopeEnum=mB;var gB={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};Fi.BindingTypeEnum=gB;var yB={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};Fi.TargetTypeEnum=yB});var Bi=_(xp=>{"use strict";Object.defineProperty(xp,"__esModule",{value:!0});xp.id=void 0;var bB=0;function vB(){return bB++}xp.id=vB});var cx=_(Ip=>{"use strict";Object.defineProperty(Ip,"__esModule",{value:!0});Ip.Binding=void 0;var ax=Ir(),_B=Bi(),wB=function(){function r(e,t){this.id=(0,_B.id)(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=ax.BindingTypeEnum.Invalid,this.constraint=function(n){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return r.prototype.clone=function(){var e=new r(this.serviceIdentifier,this.scope);return e.activated=e.scope===ax.BindingScopeEnum.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},r}();Ip.Binding=wB});var Tt=_($=>{"use strict";Object.defineProperty($,"__esModule",{value:!0});$.STACK_OVERFLOW=$.CIRCULAR_DEPENDENCY_IN_FACTORY=$.ON_DEACTIVATION_ERROR=$.PRE_DESTROY_ERROR=$.POST_CONSTRUCT_ERROR=$.ASYNC_UNBIND_REQUIRED=$.MULTIPLE_POST_CONSTRUCT_METHODS=$.MULTIPLE_PRE_DESTROY_METHODS=$.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=$.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=$.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=$.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=$.ARGUMENTS_LENGTH_MISMATCH=$.INVALID_DECORATOR_OPERATION=$.INVALID_TO_SELF_VALUE=$.LAZY_IN_SYNC=$.INVALID_FUNCTION_BINDING=$.INVALID_MIDDLEWARE_RETURN=$.NO_MORE_SNAPSHOTS_AVAILABLE=$.INVALID_BINDING_TYPE=$.NOT_IMPLEMENTED=$.CIRCULAR_DEPENDENCY=$.UNDEFINED_INJECT_ANNOTATION=$.MISSING_INJECT_ANNOTATION=$.MISSING_INJECTABLE_ANNOTATION=$.NOT_REGISTERED=$.CANNOT_UNBIND=$.AMBIGUOUS_MATCH=$.KEY_NOT_FOUND=$.NULL_ARGUMENT=$.DUPLICATED_METADATA=$.DUPLICATED_INJECTABLE_DECORATOR=void 0;$.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.";$.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:";$.NULL_ARGUMENT="NULL argument";$.KEY_NOT_FOUND="Key Not Found";$.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:";$.CANNOT_UNBIND="Could not unbind serviceIdentifier:";$.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";$.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:";$.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var SB=function(r){return"@inject called with undefined this could mean that the class "+r+" has a circular dependency problem. You can use a LazyServiceIdentifier to  overcome this limitation."};$.UNDEFINED_INJECT_ANNOTATION=SB;$.CIRCULAR_DEPENDENCY="Circular dependency found:";$.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.";$.INVALID_BINDING_TYPE="Invalid binding type:";$.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.";$.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!";$.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";var xB=function(r){return"You are attempting to construct '"+r+`' in a synchronous way
 but it has asynchronous dependencies.`};$.LAZY_IN_SYNC=xB;$.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier";$.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var IB=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return"The number of constructor arguments in the derived class "+(r[0]+" must be >= than the number of constructor arguments of its base class.")};$.ARGUMENTS_LENGTH_MISMATCH=IB;$.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.";$.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE='Invalid Container option. Default scope must be a string ("singleton" or "transient").';$.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean";$.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean";$.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class";$.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";$.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";var CB=function(r,e){return"@postConstruct error in class "+r+": "+e};$.POST_CONSTRUCT_ERROR=CB;var PB=function(r,e){return"@preDestroy error in class "+r+": "+e};$.PRE_DESTROY_ERROR=PB;var TB=function(r,e){return"onDeactivation() error in class "+r+": "+e};$.ON_DEACTIVATION_ERROR=TB;var EB=function(r,e){return"It looks like there is a circular dependency in one of the '"+r+"' bindings. Please investigate bindings with "+("service identifier '"+e+"'.")};$.CIRCULAR_DEPENDENCY_IN_FACTORY=EB;$.STACK_OVERFLOW="Maximum call stack size exceeded"});var $g=_(dn=>{"use strict";var RB=dn&&dn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),AB=dn&&dn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),kB=dn&&dn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&RB(e,r,t);return AB(e,r),e};Object.defineProperty(dn,"__esModule",{value:!0});dn.MetadataReader=void 0;var Vg=kB(tt()),DB=function(){function r(){}return r.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(Vg.PARAM_TYPES,e),n=Reflect.getMetadata(Vg.TAGGED,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:n||{}}},r.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(Vg.TAGGED_PROP,e)||[];return t},r}();dn.MetadataReader=DB});var ux=_(Cp=>{"use strict";Object.defineProperty(Cp,"__esModule",{value:!0});Cp.BindingCount=void 0;Cp.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}});var Hg=_(Cr=>{"use strict";var OB=Cr&&Cr.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),MB=Cr&&Cr.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),NB=Cr&&Cr.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&OB(e,r,t);return MB(e,r),e};Object.defineProperty(Cr,"__esModule",{value:!0});Cr.tryAndThrowErrorIfStackOverflow=Cr.isStackOverflowExeption=void 0;var LB=NB(Tt());function lx(r){return r instanceof RangeError||r.message===LB.STACK_OVERFLOW}Cr.isStackOverflowExeption=lx;var FB=function(r,e){try{return r()}catch(t){throw lx(t)&&(t=e()),t}};Cr.tryAndThrowErrorIfStackOverflow=FB});var jo=_(rt=>{"use strict";var BB=rt&&rt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),UB=rt&&rt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),jB=rt&&rt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&BB(e,r,t);return UB(e,r),e};Object.defineProperty(rt,"__esModule",{value:!0});rt.getSymbolDescription=rt.circularDependencyToException=rt.listMetadataForTarget=rt.listRegisteredBindingsForServiceIdentifier=rt.getServiceIdentifierAsString=rt.getFunctionName=void 0;var qB=jB(Tt());function px(r){if(typeof r=="function"){var e=r;return e.name}else{if(typeof r=="symbol")return r.toString();var e=r;return e}}rt.getServiceIdentifierAsString=px;function WB(r,e,t){var n="",i=t(r,e);return i.length!==0&&(n=`
Registered bindings:`,i.forEach(function(o){var s="Object";o.implementationType!==null&&(s=hx(o.implementationType)),n=n+`
 `+s,o.constraint.metaData&&(n=n+" - "+o.constraint.metaData)})),n}rt.listRegisteredBindingsForServiceIdentifier=WB;function dx(r,e){return r.parentRequest===null?!1:r.parentRequest.serviceIdentifier===e?!0:dx(r.parentRequest,e)}function VB(r){function e(n,i){i===void 0&&(i=[]);var o=px(n.serviceIdentifier);return i.push(o),n.parentRequest!==null?e(n.parentRequest,i):i}var t=e(r);return t.reverse().join(" --> ")}function fx(r){r.childRequests.forEach(function(e){if(dx(e,e.serviceIdentifier)){var t=VB(e);throw new Error(qB.CIRCULAR_DEPENDENCY+" "+t)}else fx(e)})}rt.circularDependencyToException=fx;function $B(r,e){if(e.isTagged()||e.isNamed()){var t="",n=e.getNamedTag(),i=e.getCustomTags();return n!==null&&(t+=n.toString()+`
`),i!==null&&i.forEach(function(o){t+=o.toString()+`
`})," "+r+`
 `+r+" - "+t}else return" "+r}rt.listMetadataForTarget=$B;function hx(r){if(r.name)return r.name;var e=r.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: "+e}rt.getFunctionName=hx;function HB(r){return r.toString().slice(7,-1)}rt.getSymbolDescription=HB});var mx=_(Pp=>{"use strict";Object.defineProperty(Pp,"__esModule",{value:!0});Pp.Context=void 0;var GB=Bi(),zB=function(){function r(e){this.id=(0,GB.id)(),this.container=e}return r.prototype.addPlan=function(e){this.plan=e},r.prototype.setCurrentRequest=function(e){this.currentRequest=e},r}();Pp.Context=zB});var Yr=_(fn=>{"use strict";var KB=fn&&fn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),JB=fn&&fn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),YB=fn&&fn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&KB(e,r,t);return JB(e,r),e};Object.defineProperty(fn,"__esModule",{value:!0});fn.Metadata=void 0;var XB=YB(tt()),QB=function(){function r(e,t){this.key=e,this.value=t}return r.prototype.toString=function(){return this.key===XB.NAMED_TAG?"named: "+String(this.value).toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+String(this.value)+" }"},r}();fn.Metadata=QB});var gx=_(Tp=>{"use strict";Object.defineProperty(Tp,"__esModule",{value:!0});Tp.Plan=void 0;var ZB=function(){function r(e,t){this.parentContext=e,this.rootRequest=t}return r}();Tp.Plan=ZB});var Rp=_(Ep=>{"use strict";Object.defineProperty(Ep,"__esModule",{value:!0});Ep.LazyServiceIdentifier=void 0;var eU=function(){function r(e){this._cb=e}return r.prototype.unwrap=function(){return this._cb()},r}();Ep.LazyServiceIdentifier=eU});var yx=_(Ap=>{"use strict";Object.defineProperty(Ap,"__esModule",{value:!0});Ap.QueryableString=void 0;var tU=function(){function r(e){this.str=e}return r.prototype.startsWith=function(e){return this.str.indexOf(e)===0},r.prototype.endsWith=function(e){var t="",n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},r.prototype.contains=function(e){return this.str.indexOf(e)!==-1},r.prototype.equals=function(e){return this.str===e},r.prototype.value=function(){return this.str},r}();Ap.QueryableString=tU});var Gg=_(hn=>{"use strict";var rU=hn&&hn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),nU=hn&&hn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),iU=hn&&hn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&rU(e,r,t);return nU(e,r),e};Object.defineProperty(hn,"__esModule",{value:!0});hn.Target=void 0;var ci=iU(tt()),oU=Bi(),sU=jo(),bx=Yr(),aU=yx(),cU=function(){function r(e,t,n,i){this.id=(0,oU.id)(),this.type=e,this.serviceIdentifier=n;var o=typeof t=="symbol"?(0,sU.getSymbolDescription)(t):t;this.name=new aU.QueryableString(o||""),this.identifier=t,this.metadata=new Array;var s=null;typeof i=="string"?s=new bx.Metadata(ci.NAMED_TAG,i):i instanceof bx.Metadata&&(s=i),s!==null&&this.metadata.push(s)}return r.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){var i=n[t];if(i.key===e)return!0}return!1},r.prototype.isArray=function(){return this.hasTag(ci.MULTI_INJECT_TAG)},r.prototype.matchesArray=function(e){return this.matchesTag(ci.MULTI_INJECT_TAG)(e)},r.prototype.isNamed=function(){return this.hasTag(ci.NAMED_TAG)},r.prototype.isTagged=function(){return this.metadata.some(function(e){return ci.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})})},r.prototype.isOptional=function(){return this.matchesTag(ci.OPTIONAL_TAG)(!0)},r.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===ci.NAMED_TAG})[0]:null},r.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return ci.NON_CUSTOM_TAG_KEYS.every(function(t){return e.key!==t})}):null},r.prototype.matchesNamedTag=function(e){return this.matchesTag(ci.NAMED_TAG)(e)},r.prototype.matchesTag=function(e){var t=this;return function(n){for(var i=0,o=t.metadata;i<o.length;i++){var s=o[i];if(s.key===e&&s.value===n)return!0}return!1}},r}();hn.Target=cU});var Px=_(Et=>{"use strict";var uU=Et&&Et.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),lU=Et&&Et.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),vx=Et&&Et.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&uU(e,r,t);return lU(e,r),e},kp=Et&&Et.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(Et,"__esModule",{value:!0});Et.getFunctionName=Et.getBaseClassDependencyCount=Et.getDependencies=void 0;var pU=Rp(),zg=vx(Tt()),_x=Ir(),du=vx(tt()),Kg=jo();Object.defineProperty(Et,"getFunctionName",{enumerable:!0,get:function(){return Kg.getFunctionName}});var wx=Gg();function dU(r,e){var t=(0,Kg.getFunctionName)(e);return Sx(r,t,e,!1)}Et.getDependencies=dU;function Sx(r,e,t,n){var i=r.getConstructorMetadata(t),o=i.compilerGeneratedMetadata;if(o===void 0){var s=zg.MISSING_INJECTABLE_ANNOTATION+" "+e+".";throw new Error(s)}var a=i.userGeneratedMetadata,c=Object.keys(a),u=t.length===0&&c.length>0,l=c.length>t.length,p=u||l?c.length:t.length,d=hU(n,e,o,a,p),f=xx(r,t,e),h=kp(kp([],d,!0),f,!0);return h}function fU(r,e,t,n,i){var o=i[r.toString()]||[],s=Cx(o),a=s.unmanaged!==!0,c=n[r],u=s.inject||s.multiInject;if(c=u||c,c instanceof pU.LazyServiceIdentifier&&(c=c.unwrap()),a){var l=c===Object,p=c===Function,d=c===void 0,f=l||p||d;if(!e&&f){var h=zg.MISSING_INJECT_ANNOTATION+" argument "+r+" in class "+t+".";throw new Error(h)}var m=new wx.Target(_x.TargetTypeEnum.ConstructorArgument,s.targetName,c);return m.metadata=o,m}return null}function hU(r,e,t,n,i){for(var o=[],s=0;s<i;s++){var a=s,c=fU(a,r,e,t,n);c!==null&&o.push(c)}return o}function mU(r,e,t,n){var i=r||e;if(i===void 0){var o=zg.MISSING_INJECTABLE_ANNOTATION+" for property "+String(t)+" in class "+n+".";throw new Error(o)}return i}function xx(r,e,t){for(var n=r.getPropertiesMetadata(e),i=[],o=Object.getOwnPropertySymbols(n),s=Object.keys(n),a=s.concat(o),c=0,u=a;c<u.length;c++){var l=u[c],p=n[l],d=Cx(p),f=d.targetName||l,h=mU(d.inject,d.multiInject,l,t),m=new wx.Target(_x.TargetTypeEnum.ClassProperty,f,h);m.metadata=p,i.push(m)}var b=Object.getPrototypeOf(e.prototype).constructor;if(b!==Object){var I=xx(r,b,t);i=kp(kp([],i,!0),I,!0)}return i}function Ix(r,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var n=(0,Kg.getFunctionName)(t),i=Sx(r,n,t,!0),o=i.map(function(c){return c.metadata.filter(function(u){return u.key===du.UNMANAGED_TAG})}),s=[].concat.apply([],o).length,a=i.length-s;return a>0?a:Ix(r,t)}else return 0}Et.getBaseClassDependencyCount=Ix;function Cx(r){var e={};return r.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[du.INJECT_TAG],multiInject:e[du.MULTI_INJECT_TAG],targetName:e[du.NAME_TAG],unmanaged:e[du.UNMANAGED_TAG]}}});var Tx=_(Dp=>{"use strict";Object.defineProperty(Dp,"__esModule",{value:!0});Dp.Request=void 0;var gU=Bi(),yU=function(){function r(e,t,n,i,o){this.id=(0,gU.id)(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=o,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=n===null?new Map:null}return r.prototype.addChildRequest=function(e,t,n){var i=new r(e,this.parentContext,this,t,n);return this.childRequests.push(i),i},r}();Dp.Request=yU});var Zg=_(Yt=>{"use strict";var bU=Yt&&Yt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),vU=Yt&&Yt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Ax=Yt&&Yt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&bU(e,r,t);return vU(e,r),e};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.getBindingDictionary=Yt.createMockRequest=Yt.plan=void 0;var Op=ux(),Yg=Ax(Tt()),kx=Ir(),Ex=Ax(tt()),_U=Hg(),ea=jo(),Dx=mx(),Xg=Yr(),wU=gx(),Jg=Px(),Qg=Tx(),Ox=Gg();function Mx(r){return r._bindingDictionary}Yt.getBindingDictionary=Mx;function SU(r,e,t,n,i,o){var s=r?Ex.MULTI_INJECT_TAG:Ex.INJECT_TAG,a=new Xg.Metadata(s,t),c=new Ox.Target(e,n,t,a);if(i!==void 0){var u=new Xg.Metadata(i,o);c.metadata.push(u)}return c}function Rx(r,e,t,n,i){var o=fu(t.container,i.serviceIdentifier),s=[];return o.length===Op.BindingCount.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof i.serviceIdentifier=="function"&&r.getConstructorMetadata(i.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(i.serviceIdentifier).toSelf(),o=fu(t.container,i.serviceIdentifier)),e?s=o:s=o.filter(function(a){var c=new Qg.Request(a.serviceIdentifier,t,n,a,i);return a.constraint(c)}),xU(i.serviceIdentifier,s,i,t.container),s}function xU(r,e,t,n){switch(e.length){case Op.BindingCount.NoBindingsAvailable:if(t.isOptional())return e;var i=(0,ea.getServiceIdentifierAsString)(r),o=Yg.NOT_REGISTERED;throw o+=(0,ea.listMetadataForTarget)(i,t),o+=(0,ea.listRegisteredBindingsForServiceIdentifier)(n,i,fu),new Error(o);case Op.BindingCount.OnlyOneBindingAvailable:return e;case Op.BindingCount.MultipleBindingsAvailable:default:if(t.isArray())return e;var i=(0,ea.getServiceIdentifierAsString)(r),o=Yg.AMBIGUOUS_MATCH+" "+i;throw o+=(0,ea.listRegisteredBindingsForServiceIdentifier)(n,i,fu),new Error(o)}}function Nx(r,e,t,n,i,o){var s,a;if(i===null){s=Rx(r,e,n,null,o),a=new Qg.Request(t,n,null,s,o);var c=new wU.Plan(n,a);n.addPlan(c)}else s=Rx(r,e,n,i,o),a=i.addChildRequest(o.serviceIdentifier,s,o);s.forEach(function(u){var l=null;if(o.isArray())l=a.addChildRequest(u.serviceIdentifier,u,o);else{if(u.cache)return;l=a}if(u.type===kx.BindingTypeEnum.Instance&&u.implementationType!==null){var p=(0,Jg.getDependencies)(r,u.implementationType);if(!n.container.options.skipBaseClassChecks){var d=(0,Jg.getBaseClassDependencyCount)(r,u.implementationType);if(p.length<d){var f=Yg.ARGUMENTS_LENGTH_MISMATCH((0,Jg.getFunctionName)(u.implementationType));throw new Error(f)}}p.forEach(function(h){Nx(r,!1,h.serviceIdentifier,n,l,h)})}})}function fu(r,e){var t=[],n=Mx(r);return n.hasKey(e)?t=n.get(e):r.parent!==null&&(t=fu(r.parent,e)),t}function IU(r,e,t,n,i,o,s,a){a===void 0&&(a=!1);var c=new Dx.Context(e),u=SU(t,n,i,"",o,s);try{return Nx(r,a,i,c,null,u),c}catch(l){throw(0,_U.isStackOverflowExeption)(l)&&(0,ea.circularDependencyToException)(c.plan.rootRequest),l}}Yt.plan=IU;function CU(r,e,t,n){var i=new Ox.Target(kx.TargetTypeEnum.Variable,"",e,new Xg.Metadata(t,n)),o=new Dx.Context(r),s=new Qg.Request(e,o,null,[],i);return s}Yt.createMockRequest=CU});var hu=_(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.isPromiseOrContainsPromise=ta.isPromise=void 0;function ey(r){var e=typeof r=="object"&&r!==null||typeof r=="function";return e&&typeof r.then=="function"}ta.isPromise=ey;function PU(r){return ey(r)?!0:Array.isArray(r)&&r.some(ey)}ta.isPromiseOrContainsPromise=PU});var Lx=_(mn=>{"use strict";var TU=mn&&mn.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(l){try{u(n.next(l))}catch(p){s(p)}}function c(l){try{u(n.throw(l))}catch(p){s(p)}}function u(l){l.done?o(l.value):i(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})},EU=mn&&mn.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(l){u=[6,l],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(mn,"__esModule",{value:!0});mn.saveToScope=mn.tryGetFromScope=void 0;var Mp=Ir(),RU=hu(),AU=function(r,e){return e.scope===Mp.BindingScopeEnum.Singleton&&e.activated?e.cache:e.scope===Mp.BindingScopeEnum.Request&&r.has(e.id)?r.get(e.id):null};mn.tryGetFromScope=AU;var kU=function(r,e,t){e.scope===Mp.BindingScopeEnum.Singleton&&OU(e,t),e.scope===Mp.BindingScopeEnum.Request&&DU(r,e,t)};mn.saveToScope=kU;var DU=function(r,e,t){r.has(e.id)||r.set(e.id,t)},OU=function(r,e){r.cache=e,r.activated=!0,(0,RU.isPromise)(e)&&MU(r,e)},MU=function(r,e){return TU(void 0,void 0,void 0,function(){var t,n;return EU(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return t=i.sent(),r.cache=t,[3,3];case 2:throw n=i.sent(),r.cache=null,r.activated=!1,n;case 3:return[2]}})})}});var Fx=_(mu=>{"use strict";Object.defineProperty(mu,"__esModule",{value:!0});mu.FactoryType=void 0;var NU;(function(r){r.DynamicValue="toDynamicValue",r.Factory="toFactory",r.Provider="toProvider"})(NU=mu.FactoryType||(mu.FactoryType={}))});var ry=_(Xt=>{"use strict";var LU=Xt&&Xt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),FU=Xt&&Xt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),BU=Xt&&Xt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&LU(e,r,t);return FU(e,r),e};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.getFactoryDetails=Xt.ensureFullyBound=Xt.multiBindToService=void 0;var UU=jo(),jU=BU(Tt()),gn=Ir(),ty=Fx(),qU=function(r){return function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.forEach(function(i){return r.bind(i).toService(e)})}}};Xt.multiBindToService=qU;var WU=function(r){var e=null;switch(r.type){case gn.BindingTypeEnum.ConstantValue:case gn.BindingTypeEnum.Function:e=r.cache;break;case gn.BindingTypeEnum.Constructor:case gn.BindingTypeEnum.Instance:e=r.implementationType;break;case gn.BindingTypeEnum.DynamicValue:e=r.dynamicValue;break;case gn.BindingTypeEnum.Provider:e=r.provider;break;case gn.BindingTypeEnum.Factory:e=r.factory;break}if(e===null){var t=(0,UU.getServiceIdentifierAsString)(r.serviceIdentifier);throw new Error(jU.INVALID_BINDING_TYPE+" "+t)}};Xt.ensureFullyBound=WU;var VU=function(r){switch(r.type){case gn.BindingTypeEnum.Factory:return{factory:r.factory,factoryType:ty.FactoryType.Factory};case gn.BindingTypeEnum.Provider:return{factory:r.provider,factoryType:ty.FactoryType.Provider};case gn.BindingTypeEnum.DynamicValue:return{factory:r.dynamicValue,factoryType:ty.FactoryType.DynamicValue};default:throw new Error("Unexpected factory type "+r.type)}};Xt.getFactoryDetails=VU});var Vx=_(dt=>{"use strict";var ra=dt&&dt.__assign||function(){return ra=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},ra.apply(this,arguments)},$U=dt&&dt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),HU=dt&&dt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),GU=dt&&dt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&$U(e,r,t);return HU(e,r),e},jx=dt&&dt.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(l){try{u(n.next(l))}catch(p){s(p)}}function c(l){try{u(n.throw(l))}catch(p){s(p)}}function u(l){l.done?o(l.value):i(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})},qx=dt&&dt.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(l){u=[6,l],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},zU=dt&&dt.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(dt,"__esModule",{value:!0});dt.resolveInstance=void 0;var ny=Tt(),oy=Ir(),iy=GU(tt()),sy=hu();function KU(r,e){return r.reduce(function(t,n){var i=e(n),o=n.target.type;return o===oy.TargetTypeEnum.ConstructorArgument?t.constructorInjections.push(i):(t.propertyRequests.push(n),t.propertyInjections.push(i)),t.isAsync||(t.isAsync=(0,sy.isPromiseOrContainsPromise)(i)),t},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function JU(r,e,t){var n;if(e.length>0){var i=KU(e,t),o=ra(ra({},i),{constr:r});i.isAsync?n=YU(o):n=Wx(o)}else n=new r;return n}function Wx(r){var e,t=new((e=r.constr).bind.apply(e,zU([void 0],r.constructorInjections,!1)));return r.propertyRequests.forEach(function(n,i){var o=n.target.identifier,s=r.propertyInjections[i];(!n.target.isOptional()||s!==void 0)&&(t[o]=s)}),t}function YU(r){return jx(this,void 0,void 0,function(){var e,t;return qx(this,function(n){switch(n.label){case 0:return[4,Bx(r.constructorInjections)];case 1:return e=n.sent(),[4,Bx(r.propertyInjections)];case 2:return t=n.sent(),[2,Wx(ra(ra({},r),{constructorInjections:e,propertyInjections:t}))]}})})}function Bx(r){return jx(this,void 0,void 0,function(){var e,t,n,i;return qx(this,function(o){for(e=[],t=0,n=r;t<n.length;t++)i=n[t],Array.isArray(i)?e.push(Promise.all(i)):e.push(i);return[2,Promise.all(e)]})})}function Ux(r,e){var t=XU(r,e);return(0,sy.isPromise)(t)?t.then(function(){return e}):e}function XU(r,e){var t,n;if(Reflect.hasMetadata(iy.POST_CONSTRUCT,r)){var i=Reflect.getMetadata(iy.POST_CONSTRUCT,r);try{return(n=(t=e)[i.value])===null||n===void 0?void 0:n.call(t)}catch(o){if(o instanceof Error)throw new Error((0,ny.POST_CONSTRUCT_ERROR)(r.name,o.message))}}}function QU(r,e){r.scope!==oy.BindingScopeEnum.Singleton&&ZU(r,e)}function ZU(r,e){var t="Class cannot be instantiated in "+(r.scope===oy.BindingScopeEnum.Request?"request":"transient")+" scope.";if(typeof r.onDeactivation=="function")throw new Error((0,ny.ON_DEACTIVATION_ERROR)(e.name,t));if(Reflect.hasMetadata(iy.PRE_DESTROY,e))throw new Error((0,ny.PRE_DESTROY_ERROR)(e.name,t))}function ej(r,e,t,n){QU(r,e);var i=JU(e,t,n);return(0,sy.isPromise)(i)?i.then(function(o){return Ux(e,o)}):Ux(e,i)}dt.resolveInstance=ej});var Kx=_(Qt=>{"use strict";var tj=Qt&&Qt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),rj=Qt&&Qt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),nj=Qt&&Qt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&tj(e,r,t);return rj(e,r),e},ij=Qt&&Qt.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(l){try{u(n.next(l))}catch(p){s(p)}}function c(l){try{u(n.throw(l))}catch(p){s(p)}}function u(l){l.done?o(l.value):i(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})},oj=Qt&&Qt.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(l){u=[6,l],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.resolve=void 0;var sj=nj(Tt()),Np=Ir(),aj=Zg(),$x=Lx(),ay=hu(),Gx=ry(),cj=Hg(),uj=Vx(),cy=function(r){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,n=e.childRequests,i=e.target&&e.target.isArray(),o=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(i&&o)return n.map(function(a){var c=cy(r);return c(a)});if(e.target.isOptional()&&t.length===0)return;var s=t[0];return fj(r,e,s)}},lj=function(r,e){var t=(0,Gx.getFactoryDetails)(r);return(0,cj.tryAndThrowErrorIfStackOverflow)(function(){return t.factory.bind(r)(e)},function(){return new Error(sj.CIRCULAR_DEPENDENCY_IN_FACTORY(t.factoryType,e.currentRequest.serviceIdentifier.toString()))})},pj=function(r,e,t){var n,i=e.childRequests;switch((0,Gx.ensureFullyBound)(t),t.type){case Np.BindingTypeEnum.ConstantValue:case Np.BindingTypeEnum.Function:n=t.cache;break;case Np.BindingTypeEnum.Constructor:n=t.implementationType;break;case Np.BindingTypeEnum.Instance:n=(0,uj.resolveInstance)(t,t.implementationType,i,cy(r));break;default:n=lj(t,e.parentContext)}return n},dj=function(r,e,t){var n=(0,$x.tryGetFromScope)(r,e);return n!==null||(n=t(),(0,$x.saveToScope)(r,e,n)),n},fj=function(r,e,t){return dj(r,t,function(){var n=pj(r,e,t);return(0,ay.isPromise)(n)?n=n.then(function(i){return Hx(e,t,i)}):n=Hx(e,t,n),n})};function Hx(r,e,t){var n=hj(r.parentContext,e,t),i=yj(r.parentContext.container),o,s=i.next();do{o=s.value;var a=r.parentContext,c=r.serviceIdentifier,u=gj(o,c);(0,ay.isPromise)(n)?n=zx(u,a,n):n=mj(u,a,n),s=i.next()}while(s.done!==!0&&!(0,aj.getBindingDictionary)(o).hasKey(r.serviceIdentifier));return n}var hj=function(r,e,t){var n;return typeof e.onActivation=="function"?n=e.onActivation(r,t):n=t,n},mj=function(r,e,t){for(var n=r.next();!n.done;){if(t=n.value(e,t),(0,ay.isPromise)(t))return zx(r,e,t);n=r.next()}return t},zx=function(r,e,t){return ij(void 0,void 0,void 0,function(){var n,i;return oj(this,function(o){switch(o.label){case 0:return[4,t];case 1:n=o.sent(),i=r.next(),o.label=2;case 2:return i.done?[3,4]:[4,i.value(e,n)];case 3:return n=o.sent(),i=r.next(),[3,2];case 4:return[2,n]}})})},gj=function(r,e){var t=r._activations;return t.hasKey(e)?t.get(e).values():[].values()},yj=function(r){for(var e=[r],t=r.parent;t!==null;)e.push(t),t=t.parent;var n=function(){var o=e.pop();return o!==void 0?{done:!1,value:o}:{done:!0,value:void 0}},i={next:n};return i};function bj(r){var e=cy(r.plan.rootRequest.requestScope);return e(r.plan.rootRequest)}Qt.resolve=bj});var uy=_(Rt=>{"use strict";var vj=Rt&&Rt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),_j=Rt&&Rt.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),wj=Rt&&Rt.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&vj(e,r,t);return _j(e,r),e};Object.defineProperty(Rt,"__esModule",{value:!0});Rt.typeConstraint=Rt.namedConstraint=Rt.taggedConstraint=Rt.traverseAncerstors=void 0;var Sj=wj(tt()),xj=Yr(),Jx=function(r,e){var t=r.parentRequest;return t!==null?e(t)?!0:Jx(t,e):!1};Rt.traverseAncerstors=Jx;var Yx=function(r){return function(e){var t=function(n){return n!==null&&n.target!==null&&n.target.matchesTag(r)(e)};return t.metaData=new xj.Metadata(r,e),t}};Rt.taggedConstraint=Yx;var Ij=Yx(Sj.NAMED_TAG);Rt.namedConstraint=Ij;var Cj=function(r){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof r=="string"){var n=t.serviceIdentifier;return n===r}else{var i=e.bindings[0].implementationType;return r===i}return!1}};Rt.typeConstraint=Cj});var Fp=_(Lp=>{"use strict";Object.defineProperty(Lp,"__esModule",{value:!0});Lp.BindingWhenSyntax=void 0;var Ut=Bp(),ct=uy(),Pj=function(){function r(e){this._binding=e}return r.prototype.when=function(e){return this._binding.constraint=e,new Ut.BindingOnSyntax(this._binding)},r.prototype.whenTargetNamed=function(e){return this._binding.constraint=(0,ct.namedConstraint)(e),new Ut.BindingOnSyntax(this._binding)},r.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){if(e===null)return!1;var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=(0,ct.taggedConstraint)(e)(t),new Ut.BindingOnSyntax(this._binding)},r.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ct.typeConstraint)(e)(t.parentRequest)},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ct.namedConstraint)(e)(t.parentRequest)},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,ct.taggedConstraint)(e)(t)(n.parentRequest)},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ct.traverseAncerstors)(t,(0,ct.typeConstraint)(e))},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,ct.traverseAncerstors)(t,(0,ct.typeConstraint)(e))},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ct.traverseAncerstors)(t,(0,ct.namedConstraint)(e))},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,ct.traverseAncerstors)(t,(0,ct.namedConstraint)(e))},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&(0,ct.traverseAncerstors)(n,(0,ct.taggedConstraint)(e)(t))},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return n!==null&&!(0,ct.traverseAncerstors)(n,(0,ct.taggedConstraint)(e)(t))},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&(0,ct.traverseAncerstors)(t,e)},new Ut.BindingOnSyntax(this._binding)},r.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&!(0,ct.traverseAncerstors)(t,e)},new Ut.BindingOnSyntax(this._binding)},r}();Lp.BindingWhenSyntax=Pj});var Bp=_(Up=>{"use strict";Object.defineProperty(Up,"__esModule",{value:!0});Up.BindingOnSyntax=void 0;var Xx=Fp(),Tj=function(){function r(e){this._binding=e}return r.prototype.onActivation=function(e){return this._binding.onActivation=e,new Xx.BindingWhenSyntax(this._binding)},r.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new Xx.BindingWhenSyntax(this._binding)},r}();Up.BindingOnSyntax=Tj});var ly=_(jp=>{"use strict";Object.defineProperty(jp,"__esModule",{value:!0});jp.BindingWhenOnSyntax=void 0;var Ej=Bp(),Rj=Fp(),Aj=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Rj.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Ej.BindingOnSyntax(this._binding)}return r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();jp.BindingWhenOnSyntax=Aj});var Qx=_(qp=>{"use strict";Object.defineProperty(qp,"__esModule",{value:!0});qp.BindingInSyntax=void 0;var py=Ir(),dy=ly(),kj=function(){function r(e){this._binding=e}return r.prototype.inRequestScope=function(){return this._binding.scope=py.BindingScopeEnum.Request,new dy.BindingWhenOnSyntax(this._binding)},r.prototype.inSingletonScope=function(){return this._binding.scope=py.BindingScopeEnum.Singleton,new dy.BindingWhenOnSyntax(this._binding)},r.prototype.inTransientScope=function(){return this._binding.scope=py.BindingScopeEnum.Transient,new dy.BindingWhenOnSyntax(this._binding)},r}();qp.BindingInSyntax=kj});var Zx=_(Wp=>{"use strict";Object.defineProperty(Wp,"__esModule",{value:!0});Wp.BindingInWhenOnSyntax=void 0;var Dj=Qx(),Oj=Bp(),Mj=Fp(),Nj=function(){function r(e){this._binding=e,this._bindingWhenSyntax=new Mj.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new Oj.BindingOnSyntax(this._binding),this._bindingInSyntax=new Dj.BindingInSyntax(e)}return r.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},r.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},r.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},r.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},r.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},r.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},r.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},r.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},r.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},r.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},r.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},r.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},r.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},r.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},r.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},r.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},r.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},r.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},r.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},r.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},r}();Wp.BindingInWhenOnSyntax=Nj});var rI=_(yn=>{"use strict";var Lj=yn&&yn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Fj=yn&&yn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),Bj=yn&&yn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Lj(e,r,t);return Fj(e,r),e};Object.defineProperty(yn,"__esModule",{value:!0});yn.BindingToSyntax=void 0;var eI=Bj(Tt()),jt=Ir(),tI=Zx(),na=ly(),Uj=function(){function r(e){this._binding=e}return r.prototype.to=function(e){return this._binding.type=jt.BindingTypeEnum.Instance,this._binding.implementationType=e,new tI.BindingInWhenOnSyntax(this._binding)},r.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error(""+eI.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},r.prototype.toConstantValue=function(e){return this._binding.type=jt.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=jt.BindingScopeEnum.Singleton,new na.BindingWhenOnSyntax(this._binding)},r.prototype.toDynamicValue=function(e){return this._binding.type=jt.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new tI.BindingInWhenOnSyntax(this._binding)},r.prototype.toConstructor=function(e){return this._binding.type=jt.BindingTypeEnum.Constructor,this._binding.implementationType=e,this._binding.scope=jt.BindingScopeEnum.Singleton,new na.BindingWhenOnSyntax(this._binding)},r.prototype.toFactory=function(e){return this._binding.type=jt.BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=jt.BindingScopeEnum.Singleton,new na.BindingWhenOnSyntax(this._binding)},r.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(eI.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=jt.BindingTypeEnum.Function,this._binding.scope=jt.BindingScopeEnum.Singleton,t},r.prototype.toAutoFactory=function(e){return this._binding.type=jt.BindingTypeEnum.Factory,this._binding.factory=function(t){var n=function(){return t.container.get(e)};return n},this._binding.scope=jt.BindingScopeEnum.Singleton,new na.BindingWhenOnSyntax(this._binding)},r.prototype.toAutoNamedFactory=function(e){return this._binding.type=jt.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(n){return t.container.getNamed(e,n)}},new na.BindingWhenOnSyntax(this._binding)},r.prototype.toProvider=function(e){return this._binding.type=jt.BindingTypeEnum.Provider,this._binding.provider=e,this._binding.scope=jt.BindingScopeEnum.Singleton,new na.BindingWhenOnSyntax(this._binding)},r.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},r}();yn.BindingToSyntax=Uj});var nI=_(Vp=>{"use strict";Object.defineProperty(Vp,"__esModule",{value:!0});Vp.ContainerSnapshot=void 0;var jj=function(){function r(){}return r.of=function(e,t,n,i,o){var s=new r;return s.bindings=e,s.middleware=t,s.deactivations=i,s.activations=n,s.moduleActivationStore=o,s},r}();Vp.ContainerSnapshot=jj});var iI=_($p=>{"use strict";Object.defineProperty($p,"__esModule",{value:!0});$p.isClonable=void 0;function qj(r){return typeof r=="object"&&r!==null&&"clone"in r&&typeof r.clone=="function"}$p.isClonable=qj});var fy=_(bn=>{"use strict";var Wj=bn&&bn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Vj=bn&&bn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$j=bn&&bn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Wj(e,r,t);return Vj(e,r),e};Object.defineProperty(bn,"__esModule",{value:!0});bn.Lookup=void 0;var qo=$j(Tt()),Hj=iI(),Gj=function(){function r(){this._map=new Map}return r.prototype.getMap=function(){return this._map},r.prototype.add=function(e,t){if(e==null)throw new Error(qo.NULL_ARGUMENT);if(t==null)throw new Error(qo.NULL_ARGUMENT);var n=this._map.get(e);n!==void 0?n.push(t):this._map.set(e,[t])},r.prototype.get=function(e){if(e==null)throw new Error(qo.NULL_ARGUMENT);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(qo.KEY_NOT_FOUND)},r.prototype.remove=function(e){if(e==null)throw new Error(qo.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(qo.KEY_NOT_FOUND)},r.prototype.removeIntersection=function(e){var t=this;this.traverse(function(n,i){var o=e.hasKey(n)?e.get(n):void 0;if(o!==void 0){var s=i.filter(function(a){return!o.some(function(c){return a===c})});t._setValue(n,s)}})},r.prototype.removeByCondition=function(e){var t=this,n=[];return this._map.forEach(function(i,o){for(var s=[],a=0,c=i;a<c.length;a++){var u=c[a],l=e(u);l?n.push(u):s.push(u)}t._setValue(o,s)}),n},r.prototype.hasKey=function(e){if(e==null)throw new Error(qo.NULL_ARGUMENT);return this._map.has(e)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){t.forEach(function(i){return e.add(n,(0,Hj.isClonable)(i)?i.clone():i)})}),e},r.prototype.traverse=function(e){this._map.forEach(function(t,n){e(n,t)})},r.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},r}();bn.Lookup=Gj});var sI=_(Hp=>{"use strict";Object.defineProperty(Hp,"__esModule",{value:!0});Hp.ModuleActivationStore=void 0;var oI=fy(),zj=function(){function r(){this._map=new Map}return r.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},r.prototype.addDeactivation=function(e,t,n){this._getModuleActivationHandlers(e).onDeactivations.add(t,n)},r.prototype.addActivation=function(e,t,n){this._getModuleActivationHandlers(e).onActivations.add(t,n)},r.prototype.clone=function(){var e=new r;return this._map.forEach(function(t,n){e._map.set(n,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),e},r.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},r.prototype._getEmptyHandlersStore=function(){var e={onActivations:new oI.Lookup,onDeactivations:new oI.Lookup};return e},r}();Hp.ModuleActivationStore=zj});var cI=_(ft=>{"use strict";var zp=ft&&ft.__assign||function(){return zp=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},zp.apply(this,arguments)},Kj=ft&&ft.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Jj=ft&&ft.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),aI=ft&&ft.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Kj(e,r,t);return Jj(e,r),e},Pr=ft&&ft.__awaiter||function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(l){try{u(n.next(l))}catch(p){s(p)}}function c(l){try{u(n.throw(l))}catch(p){s(p)}}function u(l){l.done?o(l.value):i(l.value).then(a,c)}u((n=n.apply(r,e||[])).next())})},Tr=ft&&ft.__generator||function(r,e){var t={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,s;return s={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(o=u[0]&2?i.return:u[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,u[1])).done)return o;switch(i=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,i=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(o=t.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){t.label=u[1];break}if(u[0]===6&&t.label<o[1]){t.label=o[1],o=u;break}if(o&&t.label<o[2]){t.label=o[2],t.ops.push(u);break}o[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(l){u=[6,l],i=0}finally{n=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Yj=ft&&ft.__spreadArray||function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(ft,"__esModule",{value:!0});ft.Container=void 0;var Xj=cx(),Xr=aI(Tt()),ia=Ir(),Wo=aI(tt()),Qj=$g(),Gp=Zg(),Zj=Kx(),e2=rI(),Vo=hu(),t2=Bi(),r2=jo(),n2=nI(),gu=fy(),i2=sI(),o2=function(){function r(e){var t=e||{};if(typeof t!="object")throw new Error(""+Xr.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(t.defaultScope===void 0)t.defaultScope=ia.BindingScopeEnum.Transient;else if(t.defaultScope!==ia.BindingScopeEnum.Singleton&&t.defaultScope!==ia.BindingScopeEnum.Transient&&t.defaultScope!==ia.BindingScopeEnum.Request)throw new Error(""+Xr.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error(""+Xr.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error(""+Xr.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=(0,t2.id)(),this._bindingDictionary=new gu.Lookup,this._snapshots=[],this._middleware=null,this._activations=new gu.Lookup,this._deactivations=new gu.Lookup,this.parent=null,this._metadataReader=new Qj.MetadataReader,this._moduleActivationStore=new i2.ModuleActivationStore}return r.merge=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var o=new r,s=Yj([e,t],n,!0).map(function(u){return(0,Gp.getBindingDictionary)(u)}),a=(0,Gp.getBindingDictionary)(o);function c(u,l){u.traverse(function(p,d){d.forEach(function(f){l.add(f.serviceIdentifier,f.clone())})})}return s.forEach(function(u){c(u,a)}),o},r.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),i=0,o=e;i<o.length;i++){var s=o[i],a=n(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},r.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Pr(this,void 0,void 0,function(){var n,i,o,s,a;return Tr(this,function(c){switch(c.label){case 0:n=this._getContainerModuleHelpersFactory(),i=0,o=e,c.label=1;case 1:return i<o.length?(s=o[i],a=n(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:c.sent(),c.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},r.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.forEach(function(i){var o=e._removeModuleBindings(i.id);e._deactivateSingletons(o),e._removeModuleHandlers(i.id)})},r.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Pr(this,void 0,void 0,function(){var n,i,o,s;return Tr(this,function(a){switch(a.label){case 0:n=0,i=e,a.label=1;case 1:return n<i.length?(o=i[n],s=this._removeModuleBindings(o.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(o.id),a.label=3;case 3:return n++,[3,1];case 4:return[2]}})})},r.prototype.bind=function(e){var t=this.options.defaultScope||ia.BindingScopeEnum.Transient,n=new Xj.Binding(e,t);return this._bindingDictionary.add(e,n),new e2.BindingToSyntax(n)},r.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},r.prototype.rebindAsync=function(e){return Pr(this,void 0,void 0,function(){return Tr(this,function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}})})},r.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},r.prototype.unbindAsync=function(e){return Pr(this,void 0,void 0,function(){var t;return Tr(this,function(n){switch(n.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:n.sent(),n.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}})})},r.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse(function(t,n){e._deactivateSingletons(n)}),this._bindingDictionary=new gu.Lookup},r.prototype.unbindAllAsync=function(){return Pr(this,void 0,void 0,function(){var e,t=this;return Tr(this,function(n){switch(n.label){case 0:return e=[],this._bindingDictionary.traverse(function(i,o){e.push(t._deactivateSingletonsAsync(o))}),[4,Promise.all(e)];case 1:return n.sent(),this._bindingDictionary=new gu.Lookup,[2]}})})},r.prototype.onActivation=function(e,t){this._activations.add(e,t)},r.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},r.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},r.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},r.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,Wo.NAMED_TAG,t)},r.prototype.isBoundTagged=function(e,t,n){var i=!1;if(this._bindingDictionary.hasKey(e)){var o=this._bindingDictionary.get(e),s=(0,Gp.createMockRequest)(this,e,t,n);i=o.some(function(a){return a.constraint(s)})}return!i&&this.parent&&(i=this.parent.isBoundTagged(e,t,n)),i},r.prototype.snapshot=function(){this._snapshots.push(n2.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},r.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(Xr.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},r.prototype.createChild=function(e){var t=new r(e||this.options);return t.parent=this,t},r.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(i,o){return o(i)},n)},r.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},r.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},r.prototype.getAsync=function(e){return Pr(this,void 0,void 0,function(){var t;return Tr(this,function(n){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]})})},r.prototype.getTagged=function(e,t,n){var i=this._getNotAllArgs(e,!1,t,n);return this._getButThrowIfAsync(i)},r.prototype.getTaggedAsync=function(e,t,n){return Pr(this,void 0,void 0,function(){var i;return Tr(this,function(o){return i=this._getNotAllArgs(e,!1,t,n),[2,this._get(i)]})})},r.prototype.getNamed=function(e,t){return this.getTagged(e,Wo.NAMED_TAG,t)},r.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,Wo.NAMED_TAG,t)},r.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},r.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},r.prototype.getAllTagged=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getButThrowIfAsync(i)},r.prototype.getAllTaggedAsync=function(e,t,n){var i=this._getNotAllArgs(e,!0,t,n);return this._getAll(i)},r.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,Wo.NAMED_TAG,t)},r.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,Wo.NAMED_TAG,t)},r.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var n=this.get(e);return t||this.unbind(e),n},r.prototype._preDestroy=function(e,t){var n,i;if(Reflect.hasMetadata(Wo.PRE_DESTROY,e)){var o=Reflect.getMetadata(Wo.PRE_DESTROY,e);return(i=(n=t)[o.value])===null||i===void 0?void 0:i.call(n)}},r.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},r.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition(function(t){return t.moduleId===e})},r.prototype._deactivate=function(e,t){var n=this,i=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var o=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if((0,Vo.isPromise)(o))return this._handleDeactivationError(o.then(function(){return n._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,i)}),i)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,i);if((0,Vo.isPromise)(s))return this._handleDeactivationError(s,i)}catch(a){if(a instanceof Error)throw new Error(Xr.ON_DEACTIVATION_ERROR(i.name,a.message))}},r.prototype._handleDeactivationError=function(e,t){return Pr(this,void 0,void 0,function(){var n;return Tr(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,e];case 1:return i.sent(),[3,3];case 2:if(n=i.sent(),n instanceof Error)throw new Error(Xr.ON_DEACTIVATION_ERROR(t.name,n.message));return[3,3];case 3:return[2]}})})},r.prototype._deactivateContainer=function(e,t){for(var n=this,i=t.next();i.value;){var o=i.value(e);if((0,Vo.isPromise)(o))return o.then(function(){return n._deactivateContainerAsync(e,t)});i=t.next()}},r.prototype._deactivateContainerAsync=function(e,t){return Pr(this,void 0,void 0,function(){var n;return Tr(this,function(i){switch(i.label){case 0:n=t.next(),i.label=1;case 1:return n.value?[4,n.value(e)]:[3,3];case 2:return i.sent(),n=t.next(),[3,1];case 3:return[2]}})})},r.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(l,p){l._binding.moduleId=p},n=function(l){return function(p){var d=e.bind(p);return t(d,l),d}},i=function(){return function(l){return e.unbind(l)}},o=function(){return function(l){return e.unbindAsync(l)}},s=function(){return function(l){return e.isBound(l)}},a=function(l){return function(p){var d=e.rebind(p);return t(d,l),d}},c=function(l){return function(p,d){e._moduleActivationStore.addActivation(l,p,d),e.onActivation(p,d)}},u=function(l){return function(p,d){e._moduleActivationStore.addDeactivation(l,p,d),e.onDeactivation(p,d)}};return function(l){return{bindFunction:n(l),isboundFunction:s(),onActivationFunction:c(l),onDeactivationFunction:u(l),rebindFunction:a(l),unbindFunction:i(),unbindAsyncFunction:o()}}},r.prototype._getAll=function(e){return Promise.all(this._get(e))},r.prototype._get=function(e){var t=zp(zp({},e),{contextInterceptor:function(i){return i},targetType:ia.TargetTypeEnum.Variable});if(this._middleware){var n=this._middleware(t);if(n==null)throw new Error(Xr.INVALID_MIDDLEWARE_RETURN);return n}return this._planAndResolve()(t)},r.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if((0,Vo.isPromiseOrContainsPromise)(t))throw new Error(Xr.LAZY_IN_SYNC(e.serviceIdentifier));return t},r.prototype._getAllArgs=function(e){var t={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e};return t},r.prototype._getNotAllArgs=function(e,t,n,i){var o={avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:n,value:i};return o},r.prototype._planAndResolve=function(){var e=this;return function(t){var n=(0,Gp.plan)(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);n=t.contextInterceptor(n);var i=(0,Zj.resolve)(n);return i}},r.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return(0,Vo.isPromise)(e.cache)?e.cache.then(function(n){return t._deactivate(e,n)}):this._deactivate(e,e.cache)},r.prototype._deactivateSingletons=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],o=this._deactivateIfSingleton(i);if((0,Vo.isPromise)(o))throw new Error(Xr.ASYNC_UNBIND_REQUIRED)}},r.prototype._deactivateSingletonsAsync=function(e){return Pr(this,void 0,void 0,function(){var t=this;return Tr(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(i){return t._deactivateIfSingleton(i)}))];case 1:return n.sent(),[2]}})})},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,n){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,n)},r.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,n){return Pr(this,void 0,void 0,function(){return Tr(this,function(i){switch(i.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,n)];case 3:i.sent(),i.label=4;case 4:return[2]}})})},r.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch{throw new Error(Xr.CANNOT_UNBIND+" "+(0,r2.getServiceIdentifierAsString)(e))}},r.prototype._bindingDeactivationAndPreDestroy=function(e,t,n){var i=this;if(typeof e.onDeactivation=="function"){var o=e.onDeactivation(t);if((0,Vo.isPromise)(o))return o.then(function(){return i._preDestroy(n,t)})}return this._preDestroy(n,t)},r.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,n){return Pr(this,void 0,void 0,function(){return Tr(this,function(i){switch(i.label){case 0:return typeof e.onDeactivation!="function"?[3,2]:[4,e.onDeactivation(t)];case 1:i.sent(),i.label=2;case 2:return[4,this._preDestroy(n,t)];case 3:return i.sent(),[2]}})})},r}();ft.Container=o2});var lI=_(oa=>{"use strict";Object.defineProperty(oa,"__esModule",{value:!0});oa.AsyncContainerModule=oa.ContainerModule=void 0;var uI=Bi(),s2=function(){function r(e){this.id=(0,uI.id)(),this.registry=e}return r}();oa.ContainerModule=s2;var a2=function(){function r(e){this.id=(0,uI.id)(),this.registry=e}return r}();oa.AsyncContainerModule=a2});var pI=_(Kp=>{"use strict";Object.defineProperty(Kp,"__esModule",{value:!0});Kp.getFirstArrayDuplicate=void 0;function c2(r){for(var e=new Set,t=0,n=r;t<n.length;t++){var i=n[t];if(e.has(i))return i;e.add(i)}}Kp.getFirstArrayDuplicate=c2});var ui=_(At=>{"use strict";var u2=At&&At.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),l2=At&&At.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),fI=At&&At.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&u2(e,r,t);return l2(e,r),e};Object.defineProperty(At,"__esModule",{value:!0});At.createTaggedDecorator=At.tagProperty=At.tagParameter=At.decorate=void 0;var Jp=fI(Tt()),hI=fI(tt()),p2=pI();function d2(r){return r.prototype!==void 0}function f2(r){if(r!==void 0)throw new Error(Jp.INVALID_DECORATOR_OPERATION)}function mI(r,e,t,n){f2(e),yI(hI.TAGGED,r,t.toString(),n)}At.tagParameter=mI;function gI(r,e,t){if(d2(r))throw new Error(Jp.INVALID_DECORATOR_OPERATION);yI(hI.TAGGED_PROP,r.constructor,e,t)}At.tagProperty=gI;function h2(r){var e=[];if(Array.isArray(r)){e=r;var t=(0,p2.getFirstArrayDuplicate)(e.map(function(n){return n.key}));if(t!==void 0)throw new Error(Jp.DUPLICATED_METADATA+" "+t.toString())}else e=[r];return e}function yI(r,e,t,n){var i=h2(n),o={};Reflect.hasOwnMetadata(r,e)&&(o=Reflect.getMetadata(r,e));var s=o[t];if(s===void 0)s=[];else for(var a=function(p){if(i.some(function(d){return d.key===p.key}))throw new Error(Jp.DUPLICATED_METADATA+" "+p.key.toString())},c=0,u=s;c<u.length;c++){var l=u[c];a(l)}s.push.apply(s,i),o[t]=s,Reflect.defineMetadata(r,o,e)}function m2(r){return function(e,t,n){typeof n=="number"?mI(e,t,n,r):gI(e,t,r)}}At.createTaggedDecorator=m2;function dI(r,e){Reflect.decorate(r,e)}function g2(r,e){return function(t,n){e(t,n,r)}}function y2(r,e,t){typeof t=="number"?dI([g2(t,r)],e):typeof t=="string"?Reflect.decorate([r],e,t):dI([r],e)}At.decorate=y2});var vI=_(vn=>{"use strict";var b2=vn&&vn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),v2=vn&&vn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),bI=vn&&vn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&b2(e,r,t);return v2(e,r),e};Object.defineProperty(vn,"__esModule",{value:!0});vn.injectable=void 0;var _2=bI(Tt()),hy=bI(tt());function w2(){return function(r){if(Reflect.hasOwnMetadata(hy.PARAM_TYPES,r))throw new Error(_2.DUPLICATED_INJECTABLE_DECORATOR);var e=Reflect.getMetadata(hy.DESIGN_PARAM_TYPES,r)||[];return Reflect.defineMetadata(hy.PARAM_TYPES,e,r),r}}vn.injectable=w2});var _I=_(Yp=>{"use strict";Object.defineProperty(Yp,"__esModule",{value:!0});Yp.tagged=void 0;var S2=Yr(),x2=ui();function I2(r,e){return(0,x2.createTaggedDecorator)(new S2.Metadata(r,e))}Yp.tagged=I2});var wI=_(_n=>{"use strict";var C2=_n&&_n.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),P2=_n&&_n.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),T2=_n&&_n.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&C2(e,r,t);return P2(e,r),e};Object.defineProperty(_n,"__esModule",{value:!0});_n.named=void 0;var E2=T2(tt()),R2=Yr(),A2=ui();function k2(r){return(0,A2.createTaggedDecorator)(new R2.Metadata(E2.NAMED_TAG,r))}_n.named=k2});var my=_(Xp=>{"use strict";Object.defineProperty(Xp,"__esModule",{value:!0});Xp.injectBase=void 0;var D2=Tt(),O2=Yr(),M2=ui();function N2(r){return function(e){return function(t,n,i){if(e===void 0){var o=typeof t=="function"?t.name:t.constructor.name;throw new Error((0,D2.UNDEFINED_INJECT_ANNOTATION)(o))}return(0,M2.createTaggedDecorator)(new O2.Metadata(r,e))(t,n,i)}}}Xp.injectBase=N2});var SI=_(wn=>{"use strict";var L2=wn&&wn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),F2=wn&&wn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),B2=wn&&wn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&L2(e,r,t);return F2(e,r),e};Object.defineProperty(wn,"__esModule",{value:!0});wn.inject=void 0;var U2=B2(tt()),j2=my(),q2=(0,j2.injectBase)(U2.INJECT_TAG);wn.inject=q2});var xI=_(Sn=>{"use strict";var W2=Sn&&Sn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),V2=Sn&&Sn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),$2=Sn&&Sn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&W2(e,r,t);return V2(e,r),e};Object.defineProperty(Sn,"__esModule",{value:!0});Sn.optional=void 0;var H2=$2(tt()),G2=Yr(),z2=ui();function K2(){return(0,z2.createTaggedDecorator)(new G2.Metadata(H2.OPTIONAL_TAG,!0))}Sn.optional=K2});var II=_(xn=>{"use strict";var J2=xn&&xn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Y2=xn&&xn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),X2=xn&&xn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&J2(e,r,t);return Y2(e,r),e};Object.defineProperty(xn,"__esModule",{value:!0});xn.unmanaged=void 0;var Q2=X2(tt()),Z2=Yr(),eq=ui();function tq(){return function(r,e,t){var n=new Z2.Metadata(Q2.UNMANAGED_TAG,!0);(0,eq.tagParameter)(r,e,t,n)}}xn.unmanaged=tq});var CI=_(In=>{"use strict";var rq=In&&In.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),nq=In&&In.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),iq=In&&In.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&rq(e,r,t);return nq(e,r),e};Object.defineProperty(In,"__esModule",{value:!0});In.multiInject=void 0;var oq=iq(tt()),sq=my(),aq=(0,sq.injectBase)(oq.MULTI_INJECT_TAG);In.multiInject=aq});var PI=_(Cn=>{"use strict";var cq=Cn&&Cn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),uq=Cn&&Cn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),lq=Cn&&Cn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&cq(e,r,t);return uq(e,r),e};Object.defineProperty(Cn,"__esModule",{value:!0});Cn.targetName=void 0;var pq=lq(tt()),dq=Yr(),fq=ui();function hq(r){return function(e,t,n){var i=new dq.Metadata(pq.NAME_TAG,r);(0,fq.tagParameter)(e,t,n,i)}}Cn.targetName=hq});var gy=_(Qp=>{"use strict";Object.defineProperty(Qp,"__esModule",{value:!0});Qp.propertyEventDecorator=void 0;var mq=Yr();function gq(r,e){return function(){return function(t,n){var i=new mq.Metadata(r,n);if(Reflect.hasOwnMetadata(r,t.constructor))throw new Error(e);Reflect.defineMetadata(r,i,t.constructor)}}}Qp.propertyEventDecorator=gq});var EI=_(Pn=>{"use strict";var yq=Pn&&Pn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),bq=Pn&&Pn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),TI=Pn&&Pn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&yq(e,r,t);return bq(e,r),e};Object.defineProperty(Pn,"__esModule",{value:!0});Pn.postConstruct=void 0;var vq=TI(Tt()),_q=TI(tt()),wq=gy(),Sq=(0,wq.propertyEventDecorator)(_q.POST_CONSTRUCT,vq.MULTIPLE_POST_CONSTRUCT_METHODS);Pn.postConstruct=Sq});var AI=_(Tn=>{"use strict";var xq=Tn&&Tn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Iq=Tn&&Tn.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),RI=Tn&&Tn.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&xq(e,r,t);return Iq(e,r),e};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.preDestroy=void 0;var Cq=RI(Tt()),Pq=RI(tt()),Tq=gy(),Eq=(0,Tq.propertyEventDecorator)(Pq.PRE_DESTROY,Cq.MULTIPLE_PRE_DESTROY_METHODS);Tn.preDestroy=Eq});var kI=_(Zp=>{"use strict";Object.defineProperty(Zp,"__esModule",{value:!0});Zp.interfaces=void 0;var yy;yy||(yy={});Zp.interfaces=yy});var G=_(V=>{"use strict";var Rq=V&&V.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Aq=V&&V.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),kq=V&&V.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&Rq(e,r,t);return Aq(e,r),e};Object.defineProperty(V,"__esModule",{value:!0});V.multiBindToService=V.getServiceIdentifierAsString=V.typeConstraint=V.namedConstraint=V.taggedConstraint=V.traverseAncerstors=V.decorate=V.interfaces=V.id=V.MetadataReader=V.preDestroy=V.postConstruct=V.targetName=V.multiInject=V.unmanaged=V.optional=V.LazyServiceIdentifer=V.LazyServiceIdentifier=V.inject=V.named=V.tagged=V.injectable=V.createTaggedDecorator=V.ContainerModule=V.AsyncContainerModule=V.TargetTypeEnum=V.BindingTypeEnum=V.BindingScopeEnum=V.Container=V.METADATA_KEY=void 0;var Dq=kq(tt());V.METADATA_KEY=Dq;var Oq=cI();Object.defineProperty(V,"Container",{enumerable:!0,get:function(){return Oq.Container}});var by=Ir();Object.defineProperty(V,"BindingScopeEnum",{enumerable:!0,get:function(){return by.BindingScopeEnum}});Object.defineProperty(V,"BindingTypeEnum",{enumerable:!0,get:function(){return by.BindingTypeEnum}});Object.defineProperty(V,"TargetTypeEnum",{enumerable:!0,get:function(){return by.TargetTypeEnum}});var DI=lI();Object.defineProperty(V,"AsyncContainerModule",{enumerable:!0,get:function(){return DI.AsyncContainerModule}});Object.defineProperty(V,"ContainerModule",{enumerable:!0,get:function(){return DI.ContainerModule}});var Mq=ui();Object.defineProperty(V,"createTaggedDecorator",{enumerable:!0,get:function(){return Mq.createTaggedDecorator}});var Nq=vI();Object.defineProperty(V,"injectable",{enumerable:!0,get:function(){return Nq.injectable}});var Lq=_I();Object.defineProperty(V,"tagged",{enumerable:!0,get:function(){return Lq.tagged}});var Fq=wI();Object.defineProperty(V,"named",{enumerable:!0,get:function(){return Fq.named}});var Bq=SI();Object.defineProperty(V,"inject",{enumerable:!0,get:function(){return Bq.inject}});var Uq=Rp();Object.defineProperty(V,"LazyServiceIdentifier",{enumerable:!0,get:function(){return Uq.LazyServiceIdentifier}});var jq=Rp();Object.defineProperty(V,"LazyServiceIdentifer",{enumerable:!0,get:function(){return jq.LazyServiceIdentifier}});var qq=xI();Object.defineProperty(V,"optional",{enumerable:!0,get:function(){return qq.optional}});var Wq=II();Object.defineProperty(V,"unmanaged",{enumerable:!0,get:function(){return Wq.unmanaged}});var Vq=CI();Object.defineProperty(V,"multiInject",{enumerable:!0,get:function(){return Vq.multiInject}});var $q=PI();Object.defineProperty(V,"targetName",{enumerable:!0,get:function(){return $q.targetName}});var Hq=EI();Object.defineProperty(V,"postConstruct",{enumerable:!0,get:function(){return Hq.postConstruct}});var Gq=AI();Object.defineProperty(V,"preDestroy",{enumerable:!0,get:function(){return Gq.preDestroy}});var zq=$g();Object.defineProperty(V,"MetadataReader",{enumerable:!0,get:function(){return zq.MetadataReader}});var Kq=Bi();Object.defineProperty(V,"id",{enumerable:!0,get:function(){return Kq.id}});var Jq=kI();Object.defineProperty(V,"interfaces",{enumerable:!0,get:function(){return Jq.interfaces}});var Yq=ui();Object.defineProperty(V,"decorate",{enumerable:!0,get:function(){return Yq.decorate}});var ed=uy();Object.defineProperty(V,"traverseAncerstors",{enumerable:!0,get:function(){return ed.traverseAncerstors}});Object.defineProperty(V,"taggedConstraint",{enumerable:!0,get:function(){return ed.taggedConstraint}});Object.defineProperty(V,"namedConstraint",{enumerable:!0,get:function(){return ed.namedConstraint}});Object.defineProperty(V,"typeConstraint",{enumerable:!0,get:function(){return ed.typeConstraint}});var Xq=jo();Object.defineProperty(V,"getServiceIdentifierAsString",{enumerable:!0,get:function(){return Xq.getServiceIdentifierAsString}});var Qq=ry();Object.defineProperty(V,"multiBindToService",{enumerable:!0,get:function(){return Qq.multiBindToService}})});var UI=_((GY,BI)=>{BI.exports=FI;FI.sync=eW;var NI=g("fs");function Zq(r,e){var t=e.pathExt!==void 0?e.pathExt:process.env.PATHEXT;if(!t||(t=t.split(";"),t.indexOf("")!==-1))return!0;for(var n=0;n<t.length;n++){var i=t[n].toLowerCase();if(i&&r.substr(-i.length).toLowerCase()===i)return!0}return!1}function LI(r,e,t){return!r.isSymbolicLink()&&!r.isFile()?!1:Zq(e,t)}function FI(r,e,t){NI.stat(r,function(n,i){t(n,n?!1:LI(i,r,e))})}function eW(r,e){return LI(NI.statSync(r),r,e)}});var $I=_((zY,VI)=>{VI.exports=qI;qI.sync=tW;var jI=g("fs");function qI(r,e,t){jI.stat(r,function(n,i){t(n,n?!1:WI(i,e))})}function tW(r,e){return WI(jI.statSync(r),e)}function WI(r,e){return r.isFile()&&rW(r,e)}function rW(r,e){var t=r.mode,n=r.uid,i=r.gid,o=e.uid!==void 0?e.uid:process.getuid&&process.getuid(),s=e.gid!==void 0?e.gid:process.getgid&&process.getgid(),a=parseInt("100",8),c=parseInt("010",8),u=parseInt("001",8),l=a|c,p=t&u||t&c&&i===s||t&a&&n===o||t&l&&o===0;return p}});var GI=_((JY,HI)=>{var KY=g("fs"),rd;process.platform==="win32"||global.TESTING_WINDOWS?rd=UI():rd=$I();HI.exports=_y;_y.sync=nW;function _y(r,e,t){if(typeof e=="function"&&(t=e,e={}),!t){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(n,i){_y(r,e||{},function(o,s){o?i(o):n(s)})})}rd(r,e||{},function(n,i){n&&(n.code==="EACCES"||e&&e.ignoreErrors)&&(n=null,i=!1),t(n,i)})}function nW(r,e){try{return rd.sync(r,e||{})}catch(t){if(e&&e.ignoreErrors||t.code==="EACCES")return!1;throw t}}});var ZI=_((YY,QI)=>{var aa=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",zI=g("path"),iW=aa?";":":",KI=GI(),JI=r=>Object.assign(new Error(`not found: ${r}`),{code:"ENOENT"}),YI=(r,e)=>{let t=e.colon||iW,n=r.match(/\//)||aa&&r.match(/\\/)?[""]:[...aa?[process.cwd()]:[],...(e.path||process.env.PATH||"").split(t)],i=aa?e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",o=aa?i.split(t):[""];return aa&&r.indexOf(".")!==-1&&o[0]!==""&&o.unshift(""),{pathEnv:n,pathExt:o,pathExtExe:i}},XI=(r,e,t)=>{typeof e=="function"&&(t=e,e={}),e||(e={});let{pathEnv:n,pathExt:i,pathExtExe:o}=YI(r,e),s=[],a=u=>new Promise((l,p)=>{if(u===n.length)return e.all&&s.length?l(s):p(JI(r));let d=n[u],f=/^".*"$/.test(d)?d.slice(1,-1):d,h=zI.join(f,r),m=!f&&/^\.[\\\/]/.test(r)?r.slice(0,2)+h:h;l(c(m,u,0))}),c=(u,l,p)=>new Promise((d,f)=>{if(p===i.length)return d(a(l+1));let h=i[p];KI(u+h,{pathExt:o},(m,b)=>{if(!m&&b)if(e.all)s.push(u+h);else return d(u+h);return d(c(u,l,p+1))})});return t?a(0).then(u=>t(null,u),t):a(0)},oW=(r,e)=>{e=e||{};let{pathEnv:t,pathExt:n,pathExtExe:i}=YI(r,e),o=[];for(let s=0;s<t.length;s++){let a=t[s],c=/^".*"$/.test(a)?a.slice(1,-1):a,u=zI.join(c,r),l=!c&&/^\.[\\\/]/.test(r)?r.slice(0,2)+u:u;for(let p=0;p<n.length;p++){let d=l+n[p];try{if(KI.sync(d,{pathExt:i}))if(e.all)o.push(d);else return d}catch{}}}if(e.all&&o.length)return o;if(e.nothrow)return null;throw JI(r)};QI.exports=XI;XI.sync=oW});var Sy=_((XY,wy)=>{"use strict";var eC=(r={})=>{let e=r.env||process.env;return(r.platform||process.platform)!=="win32"?"PATH":Object.keys(e).reverse().find(n=>n.toUpperCase()==="PATH")||"Path"};wy.exports=eC;wy.exports.default=eC});var iC=_((QY,nC)=>{"use strict";var tC=g("path"),sW=ZI(),aW=Sy();function rC(r,e){let t=r.options.env||process.env,n=process.cwd(),i=r.options.cwd!=null,o=i&&process.chdir!==void 0&&!process.chdir.disabled;if(o)try{process.chdir(r.options.cwd)}catch{}let s;try{s=sW.sync(r.command,{path:t[aW({env:t})],pathExt:e?tC.delimiter:void 0})}catch{}finally{o&&process.chdir(n)}return s&&(s=tC.resolve(i?r.options.cwd:"",s)),s}function cW(r){return rC(r)||rC(r,!0)}nC.exports=cW});var oC=_((ZY,Iy)=>{"use strict";var xy=/([()\][%!^"`<>&|;, *?])/g;function uW(r){return r=r.replace(xy,"^$1"),r}function lW(r,e){return r=`${r}`,r=r.replace(/(?=(\\+?)?)\1"/g,'$1$1\\"'),r=r.replace(/(?=(\\+?)?)\1$/,"$1$1"),r=`"${r}"`,r=r.replace(xy,"^$1"),e&&(r=r.replace(xy,"^$1")),r}Iy.exports.command=uW;Iy.exports.argument=lW});var aC=_((eX,sC)=>{"use strict";sC.exports=/^#!(.*)/});var uC=_((tX,cC)=>{"use strict";var pW=aC();cC.exports=(r="")=>{let e=r.match(pW);if(!e)return null;let[t,n]=e[0].replace(/#! ?/,"").split(" "),i=t.split("/").pop();return i==="env"?n:n?`${i} ${n}`:i}});var pC=_((rX,lC)=>{"use strict";var Cy=g("fs"),dW=uC();function fW(r){let t=Buffer.alloc(150),n;try{n=Cy.openSync(r,"r"),Cy.readSync(n,t,0,150,0),Cy.closeSync(n)}catch{}return dW(t.toString())}lC.exports=fW});var mC=_((nX,hC)=>{"use strict";var hW=g("path"),dC=iC(),fC=oC(),mW=pC(),gW=process.platform==="win32",yW=/\.(?:com|exe)$/i,bW=/node_modules[\\/].bin[\\/][^\\/]+\.cmd$/i;function vW(r){r.file=dC(r);let e=r.file&&mW(r.file);return e?(r.args.unshift(r.file),r.command=e,dC(r)):r.file}function _W(r){if(!gW)return r;let e=vW(r),t=!yW.test(e);if(r.options.forceShell||t){let n=bW.test(e);r.command=hW.normalize(r.command),r.command=fC.command(r.command),r.args=r.args.map(o=>fC.argument(o,n));let i=[r.command].concat(r.args).join(" ");r.args=["/d","/s","/c",`"${i}"`],r.command=process.env.comspec||"cmd.exe",r.options.windowsVerbatimArguments=!0}return r}function wW(r,e,t){e&&!Array.isArray(e)&&(t=e,e=null),e=e?e.slice(0):[],t=Object.assign({},t);let n={command:r,args:e,options:t,file:void 0,original:{command:r,args:e}};return t.shell?n:_W(n)}hC.exports=wW});var bC=_((iX,yC)=>{"use strict";var Py=process.platform==="win32";function Ty(r,e){return Object.assign(new Error(`${e} ${r.command} ENOENT`),{code:"ENOENT",errno:"ENOENT",syscall:`${e} ${r.command}`,path:r.command,spawnargs:r.args})}function SW(r,e){if(!Py)return;let t=r.emit;r.emit=function(n,i){if(n==="exit"){let o=gC(i,e);if(o)return t.call(r,"error",o)}return t.apply(r,arguments)}}function gC(r,e){return Py&&r===1&&!e.file?Ty(e.original,"spawn"):null}function xW(r,e){return Py&&r===1&&!e.file?Ty(e.original,"spawnSync"):null}yC.exports={hookChildProcess:SW,verifyENOENT:gC,verifyENOENTSync:xW,notFoundError:Ty}});var wC=_((oX,ca)=>{"use strict";var vC=g("child_process"),Ey=mC(),Ry=bC();function _C(r,e,t){let n=Ey(r,e,t),i=vC.spawn(n.command,n.args,n.options);return Ry.hookChildProcess(i,n),i}function IW(r,e,t){let n=Ey(r,e,t),i=vC.spawnSync(n.command,n.args,n.options);return i.error=i.error||Ry.verifyENOENTSync(i.status,n),i}ca.exports=_C;ca.exports.spawn=_C;ca.exports.sync=IW;ca.exports._parse=Ey;ca.exports._enoent=Ry});var xC=_((sX,SC)=>{"use strict";SC.exports=r=>{let e=typeof r=="string"?`
`:10,t=typeof r=="string"?"\r":13;return r[r.length-1]===e&&(r=r.slice(0,r.length-1)),r[r.length-1]===t&&(r=r.slice(0,r.length-1)),r}});var PC=_((aX,bu)=>{"use strict";var yu=g("path"),IC=Sy(),CC=r=>{r={cwd:process.cwd(),path:process.env[IC()],execPath:process.execPath,...r};let e,t=yu.resolve(r.cwd),n=[];for(;e!==t;)n.push(yu.join(t,"node_modules/.bin")),e=t,t=yu.resolve(t,"..");let i=yu.resolve(r.cwd,r.execPath,"..");return n.push(i),n.concat(r.path).join(yu.delimiter)};bu.exports=CC;bu.exports.default=CC;bu.exports.env=r=>{r={env:process.env,...r};let e={...r.env},t=IC({env:e});return r.path=e[t],e[t]=bu.exports(r),e}});var EC=_((cX,Ay)=>{"use strict";var TC=(r,e)=>{for(let t of Reflect.ownKeys(e))Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t));return r};Ay.exports=TC;Ay.exports.default=TC});var AC=_((uX,id)=>{"use strict";var CW=EC(),nd=new WeakMap,RC=(r,e={})=>{if(typeof r!="function")throw new TypeError("Expected a function");let t,n=0,i=r.displayName||r.name||"<anonymous>",o=function(...s){if(nd.set(o,++n),n===1)t=r.apply(this,s),r=null;else if(e.throw===!0)throw new Error(`Function \`${i}\` can only be called once`);return t};return CW(o,r),nd.set(o,n),o};id.exports=RC;id.exports.default=RC;id.exports.callCount=r=>{if(!nd.has(r))throw new Error(`The given function \`${r.name}\` is not wrapped by the \`onetime\` package`);return nd.get(r)}});var kC=_(od=>{"use strict";Object.defineProperty(od,"__esModule",{value:!0});od.SIGNALS=void 0;var PW=[{name:"SIGHUP",number:1,action:"terminate",description:"Terminal closed",standard:"posix"},{name:"SIGINT",number:2,action:"terminate",description:"User interruption with CTRL-C",standard:"ansi"},{name:"SIGQUIT",number:3,action:"core",description:"User interruption with CTRL-\\",standard:"posix"},{name:"SIGILL",number:4,action:"core",description:"Invalid machine instruction",standard:"ansi"},{name:"SIGTRAP",number:5,action:"core",description:"Debugger breakpoint",standard:"posix"},{name:"SIGABRT",number:6,action:"core",description:"Aborted",standard:"ansi"},{name:"SIGIOT",number:6,action:"core",description:"Aborted",standard:"bsd"},{name:"SIGBUS",number:7,action:"core",description:"Bus error due to misaligned, non-existing address or paging error",standard:"bsd"},{name:"SIGEMT",number:7,action:"terminate",description:"Command should be emulated but is not implemented",standard:"other"},{name:"SIGFPE",number:8,action:"core",description:"Floating point arithmetic error",standard:"ansi"},{name:"SIGKILL",number:9,action:"terminate",description:"Forced termination",standard:"posix",forced:!0},{name:"SIGUSR1",number:10,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGSEGV",number:11,action:"core",description:"Segmentation fault",standard:"ansi"},{name:"SIGUSR2",number:12,action:"terminate",description:"Application-specific signal",standard:"posix"},{name:"SIGPIPE",number:13,action:"terminate",description:"Broken pipe or socket",standard:"posix"},{name:"SIGALRM",number:14,action:"terminate",description:"Timeout or timer",standard:"posix"},{name:"SIGTERM",number:15,action:"terminate",description:"Termination",standard:"ansi"},{name:"SIGSTKFLT",number:16,action:"terminate",description:"Stack is empty or overflowed",standard:"other"},{name:"SIGCHLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"posix"},{name:"SIGCLD",number:17,action:"ignore",description:"Child process terminated, paused or unpaused",standard:"other"},{name:"SIGCONT",number:18,action:"unpause",description:"Unpaused",standard:"posix",forced:!0},{name:"SIGSTOP",number:19,action:"pause",description:"Paused",standard:"posix",forced:!0},{name:"SIGTSTP",number:20,action:"pause",description:'Paused using CTRL-Z or "suspend"',standard:"posix"},{name:"SIGTTIN",number:21,action:"pause",description:"Background process cannot read terminal input",standard:"posix"},{name:"SIGBREAK",number:21,action:"terminate",description:"User interruption with CTRL-BREAK",standard:"other"},{name:"SIGTTOU",number:22,action:"pause",description:"Background process cannot write to terminal output",standard:"posix"},{name:"SIGURG",number:23,action:"ignore",description:"Socket received out-of-band data",standard:"bsd"},{name:"SIGXCPU",number:24,action:"core",description:"Process timed out",standard:"bsd"},{name:"SIGXFSZ",number:25,action:"core",description:"File too big",standard:"bsd"},{name:"SIGVTALRM",number:26,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGPROF",number:27,action:"terminate",description:"Timeout or timer",standard:"bsd"},{name:"SIGWINCH",number:28,action:"ignore",description:"Terminal window size changed",standard:"bsd"},{name:"SIGIO",number:29,action:"terminate",description:"I/O is available",standard:"other"},{name:"SIGPOLL",number:29,action:"terminate",description:"Watched event",standard:"other"},{name:"SIGINFO",number:29,action:"ignore",description:"Request for process information",standard:"other"},{name:"SIGPWR",number:30,action:"terminate",description:"Device running out of power",standard:"systemv"},{name:"SIGSYS",number:31,action:"core",description:"Invalid system call",standard:"other"},{name:"SIGUNUSED",number:31,action:"terminate",description:"Invalid system call",standard:"other"}];od.SIGNALS=PW});var ky=_(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.SIGRTMAX=ua.getRealtimeSignals=void 0;var TW=function(){let r=OC-DC+1;return Array.from({length:r},EW)};ua.getRealtimeSignals=TW;var EW=function(r,e){return{name:`SIGRT${e+1}`,number:DC+e,action:"terminate",description:"Application-specific signal (realtime)",standard:"posix"}},DC=34,OC=64;ua.SIGRTMAX=OC});var MC=_(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});sd.getSignals=void 0;var RW=g("os"),AW=kC(),kW=ky(),DW=function(){let r=(0,kW.getRealtimeSignals)();return[...AW.SIGNALS,...r].map(OW)};sd.getSignals=DW;var OW=function({name:r,number:e,description:t,action:n,forced:i=!1,standard:o}){let{signals:{[r]:s}}=RW.constants,a=s!==void 0;return{name:r,number:a?s:e,description:t,supported:a,action:n,forced:i,standard:o}}});var LC=_(la=>{"use strict";Object.defineProperty(la,"__esModule",{value:!0});la.signalsByNumber=la.signalsByName=void 0;var MW=g("os"),NC=MC(),NW=ky(),LW=function(){return(0,NC.getSignals)().reduce(FW,{})},FW=function(r,{name:e,number:t,description:n,supported:i,action:o,forced:s,standard:a}){return{...r,[e]:{name:e,number:t,description:n,supported:i,action:o,forced:s,standard:a}}},BW=LW();la.signalsByName=BW;var UW=function(){let r=(0,NC.getSignals)(),e=NW.SIGRTMAX+1,t=Array.from({length:e},(n,i)=>jW(i,r));return Object.assign({},...t)},jW=function(r,e){let t=qW(r,e);if(t===void 0)return{};let{name:n,description:i,supported:o,action:s,forced:a,standard:c}=t;return{[r]:{name:n,number:r,description:i,supported:o,action:s,forced:a,standard:c}}},qW=function(r,e){let t=e.find(({name:n})=>MW.constants.signals[n]===r);return t!==void 0?t:e.find(n=>n.number===r)},WW=UW();la.signalsByNumber=WW});var BC=_((hX,FC)=>{"use strict";var{signalsByName:VW}=LC(),$W=({timedOut:r,timeout:e,errorCode:t,signal:n,signalDescription:i,exitCode:o,isCanceled:s})=>r?`timed out after ${e} milliseconds`:s?"was canceled":t!==void 0?`failed with ${t}`:n!==void 0?`was killed with ${n} (${i})`:o!==void 0?`failed with exit code ${o}`:"failed",HW=({stdout:r,stderr:e,all:t,error:n,signal:i,exitCode:o,command:s,escapedCommand:a,timedOut:c,isCanceled:u,killed:l,parsed:{options:{timeout:p}}})=>{o=o===null?void 0:o,i=i===null?void 0:i;let d=i===void 0?void 0:VW[i].description,f=n&&n.code,m=`Command ${$W({timedOut:c,timeout:p,errorCode:f,signal:i,signalDescription:d,exitCode:o,isCanceled:u})}: ${s}`,b=Object.prototype.toString.call(n)==="[object Error]",I=b?`${m}
${n.message}`:m,D=[I,e,r].filter(Boolean).join(`
`);return b?(n.originalMessage=n.message,n.message=D):n=new Error(D),n.shortMessage=I,n.command=s,n.escapedCommand=a,n.exitCode=o,n.signal=i,n.signalDescription=d,n.stdout=r,n.stderr=e,t!==void 0&&(n.all=t),"bufferedData"in n&&delete n.bufferedData,n.failed=!0,n.timedOut=!!c,n.isCanceled=u,n.killed=l&&!c,n};FC.exports=HW});var jC=_((mX,Dy)=>{"use strict";var ad=["stdin","stdout","stderr"],GW=r=>ad.some(e=>r[e]!==void 0),UC=r=>{if(!r)return;let{stdio:e}=r;if(e===void 0)return ad.map(n=>r[n]);if(GW(r))throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${ad.map(n=>`\`${n}\``).join(", ")}`);if(typeof e=="string")return e;if(!Array.isArray(e))throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof e}\``);let t=Math.max(e.length,ad.length);return Array.from({length:t},(n,i)=>e[i])};Dy.exports=UC;Dy.exports.node=r=>{let e=UC(r);return e==="ipc"?"ipc":e===void 0||typeof e=="string"?[e,e,e,"ipc"]:e.includes("ipc")?e:[...e,"ipc"]}});var qC=_((gX,cd)=>{cd.exports=["SIGABRT","SIGALRM","SIGHUP","SIGINT","SIGTERM"];process.platform!=="win32"&&cd.exports.push("SIGVTALRM","SIGXCPU","SIGXFSZ","SIGUSR2","SIGTRAP","SIGSYS","SIGQUIT","SIGIOT");process.platform==="linux"&&cd.exports.push("SIGIO","SIGPOLL","SIGPWR","SIGSTKFLT","SIGUNUSED")});var $C=_((yX,wu)=>{var zW=g("assert"),vu=qC(),KW=/^win/i.test(process.platform),ud=g("events");typeof ud!="function"&&(ud=ud.EventEmitter);var St;process.__signal_exit_emitter__?St=process.__signal_exit_emitter__:(St=process.__signal_exit_emitter__=new ud,St.count=0,St.emitted={});St.infinite||(St.setMaxListeners(1/0),St.infinite=!0);wu.exports=function(r,e){zW.equal(typeof r,"function","a callback must be provided for exit handler"),_u===!1&&WC();var t="exit";e&&e.alwaysLast&&(t="afterexit");var n=function(){St.removeListener(t,r),St.listeners("exit").length===0&&St.listeners("afterexit").length===0&&My()};return St.on(t,r),n};wu.exports.unload=My;function My(){_u&&(_u=!1,vu.forEach(function(r){try{process.removeListener(r,Ny[r])}catch{}}),process.emit=Oy,process.reallyExit=VC,St.count-=1)}function pa(r,e,t){St.emitted[r]||(St.emitted[r]=!0,St.emit(r,e,t))}var Ny={};vu.forEach(function(r){Ny[r]=function(){var t=process.listeners(r);t.length===St.count&&(My(),pa("exit",null,r),pa("afterexit",null,r),KW&&r==="SIGHUP"&&(r="SIGINT"),process.kill(process.pid,r))}});wu.exports.signals=function(){return vu};wu.exports.load=WC;var _u=!1;function WC(){_u||(_u=!0,St.count+=1,vu=vu.filter(function(r){try{return process.on(r,Ny[r]),!0}catch{return!1}}),process.emit=YW,process.reallyExit=JW)}var VC=process.reallyExit;function JW(r){process.exitCode=r||0,pa("exit",process.exitCode,null),pa("afterexit",process.exitCode,null),VC.call(process,process.exitCode)}var Oy=process.emit;function YW(r,e){if(r==="exit"){e!==void 0&&(process.exitCode=e);var t=Oy.apply(this,arguments);return pa("exit",process.exitCode,null),pa("afterexit",process.exitCode,null),t}else return Oy.apply(this,arguments)}});var GC=_((bX,HC)=>{"use strict";var XW=g("os"),QW=$C(),ZW=1e3*5,eV=(r,e="SIGTERM",t={})=>{let n=r(e);return tV(r,e,t,n),n},tV=(r,e,t,n)=>{if(!rV(e,t,n))return;let i=iV(t),o=setTimeout(()=>{r("SIGKILL")},i);o.unref&&o.unref()},rV=(r,{forceKillAfterTimeout:e},t)=>nV(r)&&e!==!1&&t,nV=r=>r===XW.constants.signals.SIGTERM||typeof r=="string"&&r.toUpperCase()==="SIGTERM",iV=({forceKillAfterTimeout:r=!0})=>{if(r===!0)return ZW;if(!Number.isFinite(r)||r<0)throw new TypeError(`Expected the \`forceKillAfterTimeout\` option to be a non-negative integer, got \`${r}\` (${typeof r})`);return r},oV=(r,e)=>{r.kill()&&(e.isCanceled=!0)},sV=(r,e,t)=>{r.kill(e),t(Object.assign(new Error("Timed out"),{timedOut:!0,signal:e}))},aV=(r,{timeout:e,killSignal:t="SIGTERM"},n)=>{if(e===0||e===void 0)return n;let i,o=new Promise((a,c)=>{i=setTimeout(()=>{sV(r,t,c)},e)}),s=n.finally(()=>{clearTimeout(i)});return Promise.race([o,s])},cV=({timeout:r})=>{if(r!==void 0&&(!Number.isFinite(r)||r<0))throw new TypeError(`Expected the \`timeout\` option to be a non-negative integer, got \`${r}\` (${typeof r})`)},uV=async(r,{cleanup:e,detached:t},n)=>{if(!e||t)return n;let i=QW(()=>{r.kill()});return n.finally(()=>{i()})};HC.exports={spawnedKill:eV,spawnedCancel:oV,setupTimeout:aV,validateTimeout:cV,setExitHandler:uV}});var KC=_((vX,zC)=>{"use strict";var En=r=>r!==null&&typeof r=="object"&&typeof r.pipe=="function";En.writable=r=>En(r)&&r.writable!==!1&&typeof r._write=="function"&&typeof r._writableState=="object";En.readable=r=>En(r)&&r.readable!==!1&&typeof r._read=="function"&&typeof r._readableState=="object";En.duplex=r=>En.writable(r)&&En.readable(r);En.transform=r=>En.duplex(r)&&typeof r._transform=="function"&&typeof r._transformState=="object";zC.exports=En});var YC=_((_X,JC)=>{"use strict";var{PassThrough:lV}=g("stream");JC.exports=r=>{r={...r};let{array:e}=r,{encoding:t}=r,n=t==="buffer",i=!1;e?i=!(t||n):t=t||"utf8",n&&(t=null);let o=new lV({objectMode:i});t&&o.setEncoding(t);let s=0,a=[];return o.on("data",c=>{a.push(c),i?s=a.length:s+=c.length}),o.getBufferedValue=()=>e?a:n?Buffer.concat(a,s):a.join(""),o.getBufferedLength=()=>s,o}});var XC=_((wX,Su)=>{"use strict";var{constants:pV}=g("buffer"),dV=g("stream"),{promisify:fV}=g("util"),hV=YC(),mV=fV(dV.pipeline),ld=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function Ly(r,e){if(!r)throw new Error("Expected a stream");e={maxBuffer:1/0,...e};let{maxBuffer:t}=e,n=hV(e);return await new Promise((i,o)=>{let s=a=>{a&&n.getBufferedLength()<=pV.MAX_LENGTH&&(a.bufferedData=n.getBufferedValue()),o(a)};(async()=>{try{await mV(r,n),i()}catch(a){s(a)}})(),n.on("data",()=>{n.getBufferedLength()>t&&s(new ld)})}),n.getBufferedValue()}Su.exports=Ly;Su.exports.buffer=(r,e)=>Ly(r,{...e,encoding:"buffer"});Su.exports.array=(r,e)=>Ly(r,{...e,array:!0});Su.exports.MaxBufferError=ld});var ZC=_((SX,QC)=>{"use strict";var{PassThrough:gV}=g("stream");QC.exports=function(){var r=[],e=new gV({objectMode:!0});return e.setMaxListeners(0),e.add=t,e.isEmpty=n,e.on("unpipe",i),Array.prototype.slice.call(arguments).forEach(t),e;function t(o){return Array.isArray(o)?(o.forEach(t),this):(r.push(o),o.once("end",i.bind(null,o)),o.once("error",e.emit.bind(e,"error")),o.pipe(e,{end:!1}),this)}function n(){return r.length==0}function i(o){r=r.filter(function(s){return s!==o}),!r.length&&e.readable&&e.end()}}});var nP=_((xX,rP)=>{"use strict";var tP=KC(),eP=XC(),yV=ZC(),bV=(r,e)=>{e===void 0||r.stdin===void 0||(tP(e)?e.pipe(r.stdin):r.stdin.end(e))},vV=(r,{all:e})=>{if(!e||!r.stdout&&!r.stderr)return;let t=yV();return r.stdout&&t.add(r.stdout),r.stderr&&t.add(r.stderr),t},Fy=async(r,e)=>{if(r){r.destroy();try{return await e}catch(t){return t.bufferedData}}},By=(r,{encoding:e,buffer:t,maxBuffer:n})=>{if(!(!r||!t))return e?eP(r,{encoding:e,maxBuffer:n}):eP.buffer(r,{maxBuffer:n})},_V=async({stdout:r,stderr:e,all:t},{encoding:n,buffer:i,maxBuffer:o},s)=>{let a=By(r,{encoding:n,buffer:i,maxBuffer:o}),c=By(e,{encoding:n,buffer:i,maxBuffer:o}),u=By(t,{encoding:n,buffer:i,maxBuffer:o*2});try{return await Promise.all([s,a,c,u])}catch(l){return Promise.all([{error:l,signal:l.signal,timedOut:l.timedOut},Fy(r,a),Fy(e,c),Fy(t,u)])}},wV=({input:r})=>{if(tP(r))throw new TypeError("The `input` option cannot be a stream in sync mode")};rP.exports={handleInput:bV,makeAllStream:vV,getSpawnedResult:_V,validateInputSync:wV}});var oP=_((IX,iP)=>{"use strict";var SV=(async()=>{})().constructor.prototype,xV=["then","catch","finally"].map(r=>[r,Reflect.getOwnPropertyDescriptor(SV,r)]),IV=(r,e)=>{for(let[t,n]of xV){let i=typeof e=="function"?(...o)=>Reflect.apply(n.value,e(),o):n.value.bind(e);Reflect.defineProperty(r,t,{...n,value:i})}return r},CV=r=>new Promise((e,t)=>{r.on("exit",(n,i)=>{e({exitCode:n,signal:i})}),r.on("error",n=>{t(n)}),r.stdin&&r.stdin.on("error",n=>{t(n)})});iP.exports={mergePromise:IV,getSpawnedPromise:CV}});var cP=_((CX,aP)=>{"use strict";var sP=(r,e=[])=>Array.isArray(e)?[r,...e]:[r],PV=/^[\w.-]+$/,TV=/"/g,EV=r=>typeof r!="string"||PV.test(r)?r:`"${r.replace(TV,'\\"')}"`,RV=(r,e)=>sP(r,e).join(" "),AV=(r,e)=>sP(r,e).map(t=>EV(t)).join(" "),kV=/ +/g,DV=r=>{let e=[];for(let t of r.trim().split(kV)){let n=e[e.length-1];n&&n.endsWith("\\")?e[e.length-1]=`${n.slice(0,-1)} ${t}`:e.push(t)}return e};aP.exports={joinCommand:RV,getEscapedCommand:AV,parseCommand:DV}});var jy=_((PX,da)=>{"use strict";var OV=g("path"),Uy=g("child_process"),MV=wC(),NV=xC(),LV=PC(),FV=AC(),pd=BC(),lP=jC(),{spawnedKill:BV,spawnedCancel:UV,setupTimeout:jV,validateTimeout:qV,setExitHandler:WV}=GC(),{handleInput:VV,getSpawnedResult:$V,makeAllStream:HV,validateInputSync:GV}=nP(),{mergePromise:uP,getSpawnedPromise:zV}=oP(),{joinCommand:pP,parseCommand:dP,getEscapedCommand:fP}=cP(),KV=1e3*1e3*100,JV=({env:r,extendEnv:e,preferLocal:t,localDir:n,execPath:i})=>{let o=e?{...process.env,...r}:r;return t?LV.env({env:o,cwd:n,execPath:i}):o},hP=(r,e,t={})=>{let n=MV._parse(r,e,t);return r=n.command,e=n.args,t=n.options,t={maxBuffer:KV,buffer:!0,stripFinalNewline:!0,extendEnv:!0,preferLocal:!1,localDir:t.cwd||process.cwd(),execPath:process.execPath,encoding:"utf8",reject:!0,cleanup:!0,all:!1,windowsHide:!0,...t},t.env=JV(t),t.stdio=lP(t),process.platform==="win32"&&OV.basename(r,".exe")==="cmd"&&e.unshift("/q"),{file:r,args:e,options:t,parsed:n}},xu=(r,e,t)=>typeof e!="string"&&!Buffer.isBuffer(e)?t===void 0?void 0:"":r.stripFinalNewline?NV(e):e,dd=(r,e,t)=>{let n=hP(r,e,t),i=pP(r,e),o=fP(r,e);qV(n.options);let s;try{s=Uy.spawn(n.file,n.args,n.options)}catch(f){let h=new Uy.ChildProcess,m=Promise.reject(pd({error:f,stdout:"",stderr:"",all:"",command:i,escapedCommand:o,parsed:n,timedOut:!1,isCanceled:!1,killed:!1}));return uP(h,m)}let a=zV(s),c=jV(s,n.options,a),u=WV(s,n.options,c),l={isCanceled:!1};s.kill=BV.bind(null,s.kill.bind(s)),s.cancel=UV.bind(null,s,l);let d=FV(async()=>{let[{error:f,exitCode:h,signal:m,timedOut:b},I,D,B]=await $V(s,n.options,u),Z=xu(n.options,I),F=xu(n.options,D),X=xu(n.options,B);if(f||h!==0||m!==null){let H=pd({error:f,exitCode:h,signal:m,stdout:Z,stderr:F,all:X,command:i,escapedCommand:o,parsed:n,timedOut:b,isCanceled:l.isCanceled,killed:s.killed});if(!n.options.reject)return H;throw H}return{command:i,escapedCommand:o,exitCode:0,stdout:Z,stderr:F,all:X,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}});return VV(s,n.options.input),s.all=HV(s,n.options),uP(s,d)};da.exports=dd;da.exports.sync=(r,e,t)=>{let n=hP(r,e,t),i=pP(r,e),o=fP(r,e);GV(n.options);let s;try{s=Uy.spawnSync(n.file,n.args,n.options)}catch(u){throw pd({error:u,stdout:"",stderr:"",all:"",command:i,escapedCommand:o,parsed:n,timedOut:!1,isCanceled:!1,killed:!1})}let a=xu(n.options,s.stdout,s.error),c=xu(n.options,s.stderr,s.error);if(s.error||s.status!==0||s.signal!==null){let u=pd({stdout:a,stderr:c,error:s.error,signal:s.signal,exitCode:s.status,command:i,escapedCommand:o,parsed:n,timedOut:s.error&&s.error.code==="ETIMEDOUT",isCanceled:!1,killed:s.signal!==null});if(!n.options.reject)return u;throw u}return{command:i,escapedCommand:o,exitCode:0,stdout:a,stderr:c,failed:!1,timedOut:!1,isCanceled:!1,killed:!1}};da.exports.command=(r,e)=>{let[t,...n]=dP(r);return dd(t,n,e)};da.exports.commandSync=(r,e)=>{let[t,...n]=dP(r);return dd.sync(t,n,e)};da.exports.node=(r,e,t={})=>{e&&!Array.isArray(e)&&typeof e=="object"&&(t=e,e=[]);let n=lP.node(t),i=process.execArgv.filter(a=>!a.startsWith("--inspect")),{nodePath:o=process.execPath,nodeOptions:s=i}=t;return dd(o,[...s,r,...Array.isArray(e)?e:[]],{...t,stdin:void 0,stdout:void 0,stderr:void 0,stdio:n,shell:!1})}});var PP=_((RX,$o)=>{var IP={};IP.__wbindgen_placeholder__=$o.exports;var Rn,{TextDecoder:t$}=g("util"),gd=null;function zy(){return(gd===null||gd.byteLength===0)&&(gd=new Uint8Array(Rn.memory.buffer)),gd}function r$(r,e){return r=r>>>0,zy().subarray(r/1,r/1+e)}var pi=new Array(128).fill(void 0);pi.push(void 0,null,!0,!1);function yd(r){return pi[r]}var Pu=pi.length;function n$(r){r<132||(pi[r]=Pu,Pu=r)}function i$(r){let e=yd(r);return n$(r),e}var CP=new t$("utf-8",{ignoreBOM:!0,fatal:!0});CP.decode();function o$(r,e){return r=r>>>0,CP.decode(zy().subarray(r,r+e))}var Hy=0;function SP(r,e){let t=e(r.length*1,1)>>>0;return zy().set(r,t/1),Hy=r.length,t}function s$(r){Pu===pi.length&&pi.push(pi.length+1);let e=Pu;return Pu=pi[e],pi[e]=r,e}var xP=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(r=>Rn.__wbg_hasher_free(r>>>0,1)),Gy=class{__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,xP.unregister(this),e}free(){let e=this.__destroy_into_raw();Rn.__wbg_hasher_free(e,0)}constructor(){let e=Rn.hasher_new();return this.__wbg_ptr=e>>>0,xP.register(this,this.__wbg_ptr,this),this}update(e){let t=SP(e,Rn.__wbindgen_malloc),n=Hy;Rn.hasher_update(this.__wbg_ptr,t,n)}digest(e){var t=SP(e,Rn.__wbindgen_malloc),n=Hy;Rn.hasher_digest(this.__wbg_ptr,t,n,s$(e))}};$o.exports.Hasher=Gy;$o.exports.__wbindgen_copy_to_typed_array=function(r,e,t){new Uint8Array(yd(t).buffer,yd(t).byteOffset,yd(t).byteLength).set(r$(r,e))};$o.exports.__wbindgen_object_drop_ref=function(r){i$(r)};$o.exports.__wbindgen_throw=function(r,e){throw new Error(o$(r,e))};var a$=g("path").join(__dirname,"chromehash_bg.wasm"),c$=g("fs").readFileSync(a$),u$=new WebAssembly.Module(c$),l$=new WebAssembly.Instance(u$,IP);Rn=l$.exports;$o.exports.__wasm=Rn});var DP=_(ur=>{"use strict";Object.defineProperty(ur,"__esModule",{value:!0});ur.normalizeShaBuffer=ur.shaHashFile=ur.hashFile=ur.shaHash=ur.hash=void 0;var RP=PP(),AP=g("fs"),TP=g("string_decoder"),kP=g("crypto"),vd=Buffer.alloc(4*5),p$=r=>{let e=new RP.Hasher;return e.update(m$(r)),e.digest(vd),e.free(),vd.toString("hex")};ur.hash=p$;var d$=r=>{let e=(0,kP.createHash)("sha256");return e.update((0,ur.normalizeShaBuffer)(r)),e.digest("hex")};ur.shaHash=d$;var f$=async(r,e=4096)=>{e%2===1&&e++;let t=Buffer.alloc(e),n=new RP.Hasher,i;try{i=await AP.promises.open(r,"r");let o=await i.read(t,0,t.length,null),s=t.slice(0,o.bytesRead);if(wd(s))for(n.update(s.slice(2));o.bytesRead===t.length;)o=await i.read(t,0,t.length,null),n.update(t.slice(0,o.bytesRead));else if(Sd(s))for(n.update(s.slice(2).swap16());o.bytesRead===t.length;)o=await i.read(t,0,t.length,null),n.update(t.slice(0,o.bytesRead).swap16());else if(_d(s)){let a=new TP.StringDecoder("utf8");for(n.update(Buffer.from(a.write(s.slice(3)),"utf16le"));o.bytesRead===t.length;)o=await i.read(t,0,t.length,null),n.update(Buffer.from(a.write(t.slice(0,o.bytesRead)),"utf16le"))}else{let a=new TP.StringDecoder("utf8");for(n.update(Buffer.from(a.write(s),"utf16le"));o.bytesRead===t.length;)o=await i.read(t,0,t.length,null),n.update(Buffer.from(a.write(t.slice(0,o.bytesRead)),"utf16le"))}return n.digest(vd),vd.toString("hex")}finally{n.free(),i!==void 0&&await i.close()}};ur.hashFile=f$;var bd={stream:!0},h$=async(r,e=4096)=>{e%2===1&&e++;let t=Buffer.alloc(e),n=(0,kP.createHash)("sha256"),i;try{i=await AP.promises.open(r,"r");let o=await i.read(t,0,t.length,null),s=t.slice(0,o.bytesRead);if(wd(s)){let a=new TextDecoder("utf-16le");for(n.update(a.decode(s.slice(2),bd));o.bytesRead>0;)o=await i.read(t,0,t.length,null),n.update(a.decode(t.slice(0,o.bytesRead),bd))}else if(Sd(s)){let a=new TextDecoder("utf-16be");for(n.update(a.decode(s.slice(2),bd));o.bytesRead>0;)o=await i.read(t,0,t.length,null),n.update(a.decode(t.slice(0,o.bytesRead),bd))}else if(_d(s))for(n.update(s.slice(3));o.bytesRead>0;)o=await i.read(t,0,t.length,null),n.update(t.slice(0,o.bytesRead));else for(n.update(s);o.bytesRead>0;)o=await i.read(t,0,t.length,null),n.update(t.slice(0,o.bytesRead));return n.digest("hex")}finally{await i?.close()}};ur.shaHashFile=h$;var _d=r=>r.length>=3&&r[0]===239&&r[1]===187&&r[2]===191,wd=r=>r.length>=2&&r[0]===255&&r[1]===254,Sd=r=>r.length>=2&&r[0]===254&&r[1]===255,m$=r=>_d(r)?EP(r.slice(3)):wd(r)?r.slice(2):Sd(r)?r.slice(2).swap16():EP(r),g$=r=>_d(r)?r.slice(3):wd(r)?new TextEncoder().encode(new TextDecoder("utf-16le").decode(r.slice(2))):Sd(r)?new TextEncoder().encode(new TextDecoder("utf-16be").decode(r.slice(2))):r;ur.normalizeShaBuffer=g$;var EP=r=>Buffer.from(r.toString("utf8"),"utf16le")});var wf=_(Or=>{"use strict";Or.isInteger=r=>typeof r=="number"?Number.isInteger(r):typeof r=="string"&&r.trim()!==""?Number.isInteger(Number(r)):!1;Or.find=(r,e)=>r.nodes.find(t=>t.type===e);Or.exceedsLimit=(r,e,t=1,n)=>n===!1||!Or.isInteger(r)||!Or.isInteger(e)?!1:(Number(e)-Number(r))/Number(t)>=n;Or.escapeNode=(r,e=0,t)=>{let n=r.nodes[e];n&&(t&&n.type===t||n.type==="open"||n.type==="close")&&n.escaped!==!0&&(n.value="\\"+n.value,n.escaped=!0)};Or.encloseBrace=r=>r.type!=="brace"?!1:r.commas>>0+r.ranges>>0===0?(r.invalid=!0,!0):!1;Or.isInvalidBrace=r=>r.type!=="brace"?!1:r.invalid===!0||r.dollar?!0:r.commas>>0+r.ranges>>0===0||r.open!==!0||r.close!==!0?(r.invalid=!0,!0):!1;Or.isOpenOrClose=r=>r.type==="open"||r.type==="close"?!0:r.open===!0||r.close===!0;Or.reduce=r=>r.reduce((e,t)=>(t.type==="text"&&e.push(t.value),t.type==="range"&&(t.type="text"),e),[]);Or.flatten=(...r)=>{let e=[],t=n=>{for(let i=0;i<n.length;i++){let o=n[i];if(Array.isArray(o)){t(o);continue}o!==void 0&&e.push(o)}return e};return t(r),e}});var Sf=_((Xte,$0)=>{"use strict";var V0=wf();$0.exports=(r,e={})=>{let t=(n,i={})=>{let o=e.escapeInvalid&&V0.isInvalidBrace(i),s=n.invalid===!0&&e.escapeInvalid===!0,a="";if(n.value)return(o||s)&&V0.isOpenOrClose(n)?"\\"+n.value:n.value;if(n.value)return n.value;if(n.nodes)for(let c of n.nodes)a+=t(c);return a};return t(r)}});var G0=_((Qte,H0)=>{"use strict";H0.exports=function(r){return typeof r=="number"?r-r===0:typeof r=="string"&&r.trim()!==""?Number.isFinite?Number.isFinite(+r):isFinite(+r):!1}});var tE=_((Zte,eE)=>{"use strict";var z0=G0(),cs=(r,e,t)=>{if(z0(r)===!1)throw new TypeError("toRegexRange: expected the first argument to be a number");if(e===void 0||r===e)return String(r);if(z0(e)===!1)throw new TypeError("toRegexRange: expected the second argument to be a number.");let n={relaxZeros:!0,...t};typeof n.strictZeros=="boolean"&&(n.relaxZeros=n.strictZeros===!1);let i=String(n.relaxZeros),o=String(n.shorthand),s=String(n.capture),a=String(n.wrap),c=r+":"+e+"="+i+o+s+a;if(cs.cache.hasOwnProperty(c))return cs.cache[c].result;let u=Math.min(r,e),l=Math.max(r,e);if(Math.abs(u-l)===1){let m=r+"|"+e;return n.capture?`(${m})`:n.wrap===!1?m:`(?:${m})`}let p=Z0(r)||Z0(e),d={min:r,max:e,a:u,b:l},f=[],h=[];if(p&&(d.isPadded=p,d.maxLen=String(d.max).length),u<0){let m=l<0?Math.abs(l):1;h=K0(m,Math.abs(u),d,n),u=d.a=0}return l>=0&&(f=K0(u,l,d,n)),d.negatives=h,d.positives=f,d.result=f5(h,f,n),n.capture===!0?d.result=`(${d.result})`:n.wrap!==!1&&f.length+h.length>1&&(d.result=`(?:${d.result})`),cs.cache[c]=d,d.result};function f5(r,e,t){let n=Bb(r,e,"-",!1,t)||[],i=Bb(e,r,"",!1,t)||[],o=Bb(r,e,"-?",!0,t)||[];return n.concat(o).concat(i).join("|")}function h5(r,e){let t=1,n=1,i=Y0(r,t),o=new Set([e]);for(;r<=i&&i<=e;)o.add(i),t+=1,i=Y0(r,t);for(i=X0(e+1,n)-1;r<i&&i<=e;)o.add(i),n+=1,i=X0(e+1,n)-1;return o=[...o],o.sort(y5),o}function m5(r,e,t){if(r===e)return{pattern:r,count:[],digits:0};let n=g5(r,e),i=n.length,o="",s=0;for(let a=0;a<i;a++){let[c,u]=n[a];c===u?o+=c:c!=="0"||u!=="9"?o+=b5(c,u,t):s++}return s&&(o+=t.shorthand===!0?"\\d":"[0-9]"),{pattern:o,count:[s],digits:i}}function K0(r,e,t,n){let i=h5(r,e),o=[],s=r,a;for(let c=0;c<i.length;c++){let u=i[c],l=m5(String(s),String(u),n),p="";if(!t.isPadded&&a&&a.pattern===l.pattern){a.count.length>1&&a.count.pop(),a.count.push(l.count[0]),a.string=a.pattern+Q0(a.count),s=u+1;continue}t.isPadded&&(p=v5(u,t,n)),l.string=p+l.pattern+Q0(l.count),o.push(l),s=u+1,a=l}return o}function Bb(r,e,t,n,i){let o=[];for(let s of r){let{string:a}=s;!n&&!J0(e,"string",a)&&o.push(t+a),n&&J0(e,"string",a)&&o.push(t+a)}return o}function g5(r,e){let t=[];for(let n=0;n<r.length;n++)t.push([r[n],e[n]]);return t}function y5(r,e){return r>e?1:e>r?-1:0}function J0(r,e,t){return r.some(n=>n[e]===t)}function Y0(r,e){return Number(String(r).slice(0,-e)+"9".repeat(e))}function X0(r,e){return r-r%Math.pow(10,e)}function Q0(r){let[e=0,t=""]=r;return t||e>1?`{${e+(t?","+t:"")}}`:""}function b5(r,e,t){return`[${r}${e-r===1?"":"-"}${e}]`}function Z0(r){return/^-?(0+)\d/.test(r)}function v5(r,e,t){if(!e.isPadded)return r;let n=Math.abs(e.maxLen-String(r).length),i=t.relaxZeros!==!1;switch(n){case 0:return"";case 1:return i?"0?":"0";case 2:return i?"0{0,2}":"00";default:return i?`0{0,${n}}`:`0{${n}}`}}cs.cache={};cs.clearCache=()=>cs.cache={};eE.exports=cs});var qb=_((ere,cE)=>{"use strict";var _5=g("util"),nE=tE(),rE=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),w5=r=>e=>r===!0?Number(e):String(e),Ub=r=>typeof r=="number"||typeof r=="string"&&r!=="",Xu=r=>Number.isInteger(+r),jb=r=>{let e=`${r}`,t=-1;if(e[0]==="-"&&(e=e.slice(1)),e==="0")return!1;for(;e[++t]==="0";);return t>0},S5=(r,e,t)=>typeof r=="string"||typeof e=="string"?!0:t.stringify===!0,x5=(r,e,t)=>{if(e>0){let n=r[0]==="-"?"-":"";n&&(r=r.slice(1)),r=n+r.padStart(n?e-1:e,"0")}return t===!1?String(r):r},If=(r,e)=>{let t=r[0]==="-"?"-":"";for(t&&(r=r.slice(1),e--);r.length<e;)r="0"+r;return t?"-"+r:r},I5=(r,e,t)=>{r.negatives.sort((a,c)=>a<c?-1:a>c?1:0),r.positives.sort((a,c)=>a<c?-1:a>c?1:0);let n=e.capture?"":"?:",i="",o="",s;return r.positives.length&&(i=r.positives.map(a=>If(String(a),t)).join("|")),r.negatives.length&&(o=`-(${n}${r.negatives.map(a=>If(String(a),t)).join("|")})`),i&&o?s=`${i}|${o}`:s=i||o,e.wrap?`(${n}${s})`:s},iE=(r,e,t,n)=>{if(t)return nE(r,e,{wrap:!1,...n});let i=String.fromCharCode(r);if(r===e)return i;let o=String.fromCharCode(e);return`[${i}-${o}]`},oE=(r,e,t)=>{if(Array.isArray(r)){let n=t.wrap===!0,i=t.capture?"":"?:";return n?`(${i}${r.join("|")})`:r.join("|")}return nE(r,e,t)},sE=(...r)=>new RangeError("Invalid range arguments: "+_5.inspect(...r)),aE=(r,e,t)=>{if(t.strictRanges===!0)throw sE([r,e]);return[]},C5=(r,e)=>{if(e.strictRanges===!0)throw new TypeError(`Expected step "${r}" to be a number`);return[]},P5=(r,e,t=1,n={})=>{let i=Number(r),o=Number(e);if(!Number.isInteger(i)||!Number.isInteger(o)){if(n.strictRanges===!0)throw sE([r,e]);return[]}i===0&&(i=0),o===0&&(o=0);let s=i>o,a=String(r),c=String(e),u=String(t);t=Math.max(Math.abs(t),1);let l=jb(a)||jb(c)||jb(u),p=l?Math.max(a.length,c.length,u.length):0,d=l===!1&&S5(r,e,n)===!1,f=n.transform||w5(d);if(n.toRegex&&t===1)return iE(If(r,p),If(e,p),!0,n);let h={negatives:[],positives:[]},m=D=>h[D<0?"negatives":"positives"].push(Math.abs(D)),b=[],I=0;for(;s?i>=o:i<=o;)n.toRegex===!0&&t>1?m(i):b.push(x5(f(i,I),p,d)),i=s?i-t:i+t,I++;return n.toRegex===!0?t>1?I5(h,n,p):oE(b,null,{wrap:!1,...n}):b},T5=(r,e,t=1,n={})=>{if(!Xu(r)&&r.length>1||!Xu(e)&&e.length>1)return aE(r,e,n);let i=n.transform||(d=>String.fromCharCode(d)),o=`${r}`.charCodeAt(0),s=`${e}`.charCodeAt(0),a=o>s,c=Math.min(o,s),u=Math.max(o,s);if(n.toRegex&&t===1)return iE(c,u,!1,n);let l=[],p=0;for(;a?o>=s:o<=s;)l.push(i(o,p)),o=a?o-t:o+t,p++;return n.toRegex===!0?oE(l,null,{wrap:!1,options:n}):l},xf=(r,e,t,n={})=>{if(e==null&&Ub(r))return[r];if(!Ub(r)||!Ub(e))return aE(r,e,n);if(typeof t=="function")return xf(r,e,1,{transform:t});if(rE(t))return xf(r,e,0,t);let i={...n};return i.capture===!0&&(i.wrap=!0),t=t||i.step||1,Xu(t)?Xu(r)&&Xu(e)?P5(r,e,t,i):T5(r,e,Math.max(Math.abs(t),1),i):t!=null&&!rE(t)?C5(t,i):xf(r,e,1,t)};cE.exports=xf});var pE=_((tre,lE)=>{"use strict";var E5=qb(),uE=wf(),R5=(r,e={})=>{let t=(n,i={})=>{let o=uE.isInvalidBrace(i),s=n.invalid===!0&&e.escapeInvalid===!0,a=o===!0||s===!0,c=e.escapeInvalid===!0?"\\":"",u="";if(n.isOpen===!0)return c+n.value;if(n.isClose===!0)return console.log("node.isClose",c,n.value),c+n.value;if(n.type==="open")return a?c+n.value:"(";if(n.type==="close")return a?c+n.value:")";if(n.type==="comma")return n.prev.type==="comma"?"":a?n.value:"|";if(n.value)return n.value;if(n.nodes&&n.ranges>0){let l=uE.reduce(n.nodes),p=E5(...l,{...e,wrap:!1,toRegex:!0,strictZeros:!0});if(p.length!==0)return l.length>1&&p.length>1?`(${p})`:p}if(n.nodes)for(let l of n.nodes)u+=t(l,n);return u};return t(r)};lE.exports=R5});var hE=_((rre,fE)=>{"use strict";var A5=qb(),dE=Sf(),Wa=wf(),us=(r="",e="",t=!1)=>{let n=[];if(r=[].concat(r),e=[].concat(e),!e.length)return r;if(!r.length)return t?Wa.flatten(e).map(i=>`{${i}}`):e;for(let i of r)if(Array.isArray(i))for(let o of i)n.push(us(o,e,t));else for(let o of e)t===!0&&typeof o=="string"&&(o=`{${o}}`),n.push(Array.isArray(o)?us(i,o,t):i+o);return Wa.flatten(n)},k5=(r,e={})=>{let t=e.rangeLimit===void 0?1e3:e.rangeLimit,n=(i,o={})=>{i.queue=[];let s=o,a=o.queue;for(;s.type!=="brace"&&s.type!=="root"&&s.parent;)s=s.parent,a=s.queue;if(i.invalid||i.dollar){a.push(us(a.pop(),dE(i,e)));return}if(i.type==="brace"&&i.invalid!==!0&&i.nodes.length===2){a.push(us(a.pop(),["{}"]));return}if(i.nodes&&i.ranges>0){let p=Wa.reduce(i.nodes);if(Wa.exceedsLimit(...p,e.step,t))throw new RangeError("expanded array length exceeds range limit. Use options.rangeLimit to increase or disable the limit.");let d=A5(...p,e);d.length===0&&(d=dE(i,e)),a.push(us(a.pop(),d)),i.nodes=[];return}let c=Wa.encloseBrace(i),u=i.queue,l=i;for(;l.type!=="brace"&&l.type!=="root"&&l.parent;)l=l.parent,u=l.queue;for(let p=0;p<i.nodes.length;p++){let d=i.nodes[p];if(d.type==="comma"&&i.type==="brace"){p===1&&u.push(""),u.push("");continue}if(d.type==="close"){a.push(us(a.pop(),u,c));continue}if(d.value&&d.type!=="open"){u.push(us(u.pop(),d.value));continue}d.nodes&&n(d,i)}return u};return Wa.flatten(n(r))};fE.exports=k5});var gE=_((nre,mE)=>{"use strict";mE.exports={MAX_LENGTH:1e4,CHAR_0:"0",CHAR_9:"9",CHAR_UPPERCASE_A:"A",CHAR_LOWERCASE_A:"a",CHAR_UPPERCASE_Z:"Z",CHAR_LOWERCASE_Z:"z",CHAR_LEFT_PARENTHESES:"(",CHAR_RIGHT_PARENTHESES:")",CHAR_ASTERISK:"*",CHAR_AMPERSAND:"&",CHAR_AT:"@",CHAR_BACKSLASH:"\\",CHAR_BACKTICK:"`",CHAR_CARRIAGE_RETURN:"\r",CHAR_CIRCUMFLEX_ACCENT:"^",CHAR_COLON:":",CHAR_COMMA:",",CHAR_DOLLAR:"$",CHAR_DOT:".",CHAR_DOUBLE_QUOTE:'"',CHAR_EQUAL:"=",CHAR_EXCLAMATION_MARK:"!",CHAR_FORM_FEED:"\f",CHAR_FORWARD_SLASH:"/",CHAR_HASH:"#",CHAR_HYPHEN_MINUS:"-",CHAR_LEFT_ANGLE_BRACKET:"<",CHAR_LEFT_CURLY_BRACE:"{",CHAR_LEFT_SQUARE_BRACKET:"[",CHAR_LINE_FEED:`
`,CHAR_NO_BREAK_SPACE:"\xA0",CHAR_PERCENT:"%",CHAR_PLUS:"+",CHAR_QUESTION_MARK:"?",CHAR_RIGHT_ANGLE_BRACKET:">",CHAR_RIGHT_CURLY_BRACE:"}",CHAR_RIGHT_SQUARE_BRACKET:"]",CHAR_SEMICOLON:";",CHAR_SINGLE_QUOTE:"'",CHAR_SPACE:" ",CHAR_TAB:"	",CHAR_UNDERSCORE:"_",CHAR_VERTICAL_LINE:"|",CHAR_ZERO_WIDTH_NOBREAK_SPACE:"\uFEFF"}});var wE=_((ire,_E)=>{"use strict";var D5=Sf(),{MAX_LENGTH:yE,CHAR_BACKSLASH:Wb,CHAR_BACKTICK:O5,CHAR_COMMA:M5,CHAR_DOT:N5,CHAR_LEFT_PARENTHESES:L5,CHAR_RIGHT_PARENTHESES:F5,CHAR_LEFT_CURLY_BRACE:B5,CHAR_RIGHT_CURLY_BRACE:U5,CHAR_LEFT_SQUARE_BRACKET:bE,CHAR_RIGHT_SQUARE_BRACKET:vE,CHAR_DOUBLE_QUOTE:j5,CHAR_SINGLE_QUOTE:q5,CHAR_NO_BREAK_SPACE:W5,CHAR_ZERO_WIDTH_NOBREAK_SPACE:V5}=gE(),$5=(r,e={})=>{if(typeof r!="string")throw new TypeError("Expected a string");let t=e||{},n=typeof t.maxLength=="number"?Math.min(yE,t.maxLength):yE;if(r.length>n)throw new SyntaxError(`Input length (${r.length}), exceeds max characters (${n})`);let i={type:"root",input:r,nodes:[]},o=[i],s=i,a=i,c=0,u=r.length,l=0,p=0,d,f=()=>r[l++],h=m=>{if(m.type==="text"&&a.type==="dot"&&(a.type="text"),a&&a.type==="text"&&m.type==="text"){a.value+=m.value;return}return s.nodes.push(m),m.parent=s,m.prev=a,a=m,m};for(h({type:"bos"});l<u;)if(s=o[o.length-1],d=f(),!(d===V5||d===W5)){if(d===Wb){h({type:"text",value:(e.keepEscaping?d:"")+f()});continue}if(d===vE){h({type:"text",value:"\\"+d});continue}if(d===bE){c++;let m;for(;l<u&&(m=f());){if(d+=m,m===bE){c++;continue}if(m===Wb){d+=f();continue}if(m===vE&&(c--,c===0))break}h({type:"text",value:d});continue}if(d===L5){s=h({type:"paren",nodes:[]}),o.push(s),h({type:"text",value:d});continue}if(d===F5){if(s.type!=="paren"){h({type:"text",value:d});continue}s=o.pop(),h({type:"text",value:d}),s=o[o.length-1];continue}if(d===j5||d===q5||d===O5){let m=d,b;for(e.keepQuotes!==!0&&(d="");l<u&&(b=f());){if(b===Wb){d+=b+f();continue}if(b===m){e.keepQuotes===!0&&(d+=b);break}d+=b}h({type:"text",value:d});continue}if(d===B5){p++;let b={type:"brace",open:!0,close:!1,dollar:a.value&&a.value.slice(-1)==="$"||s.dollar===!0,depth:p,commas:0,ranges:0,nodes:[]};s=h(b),o.push(s),h({type:"open",value:d});continue}if(d===U5){if(s.type!=="brace"){h({type:"text",value:d});continue}let m="close";s=o.pop(),s.close=!0,h({type:m,value:d}),p--,s=o[o.length-1];continue}if(d===M5&&p>0){if(s.ranges>0){s.ranges=0;let m=s.nodes.shift();s.nodes=[m,{type:"text",value:D5(s)}]}h({type:"comma",value:d}),s.commas++;continue}if(d===N5&&p>0&&s.commas===0){let m=s.nodes;if(p===0||m.length===0){h({type:"text",value:d});continue}if(a.type==="dot"){if(s.range=[],a.value+=d,a.type="range",s.nodes.length!==3&&s.nodes.length!==5){s.invalid=!0,s.ranges=0,a.type="text";continue}s.ranges++,s.args=[];continue}if(a.type==="range"){m.pop();let b=m[m.length-1];b.value+=a.value+d,a=b,s.ranges--;continue}h({type:"dot",value:d});continue}h({type:"text",value:d})}do if(s=o.pop(),s.type!=="root"){s.nodes.forEach(I=>{I.nodes||(I.type==="open"&&(I.isOpen=!0),I.type==="close"&&(I.isClose=!0),I.nodes||(I.type="text"),I.invalid=!0)});let m=o[o.length-1],b=m.nodes.indexOf(s);m.nodes.splice(b,1,...s.nodes)}while(o.length>0);return h({type:"eos"}),i};_E.exports=$5});var IE=_((ore,xE)=>{"use strict";var SE=Sf(),H5=pE(),G5=hE(),z5=wE(),dr=(r,e={})=>{let t=[];if(Array.isArray(r))for(let n of r){let i=dr.create(n,e);Array.isArray(i)?t.push(...i):t.push(i)}else t=[].concat(dr.create(r,e));return e&&e.expand===!0&&e.nodupes===!0&&(t=[...new Set(t)]),t};dr.parse=(r,e={})=>z5(r,e);dr.stringify=(r,e={})=>SE(typeof r=="string"?dr.parse(r,e):r,e);dr.compile=(r,e={})=>(typeof r=="string"&&(r=dr.parse(r,e)),H5(r,e));dr.expand=(r,e={})=>{typeof r=="string"&&(r=dr.parse(r,e));let t=G5(r,e);return e.noempty===!0&&(t=t.filter(Boolean)),e.nodupes===!0&&(t=[...new Set(t)]),t};dr.create=(r,e={})=>r===""||r.length<3?[r]:e.expand!==!0?dr.compile(r,e):dr.expand(r,e);xE.exports=dr});var Qu=_((sre,RE)=>{"use strict";var K5=g("path"),Wn="\\\\/",CE=`[^${Wn}]`,_i="\\.",J5="\\+",Y5="\\?",Cf="\\/",X5="(?=.)",PE="[^/]",Vb=`(?:${Cf}|$)`,TE=`(?:^|${Cf})`,$b=`${_i}{1,2}${Vb}`,Q5=`(?!${_i})`,Z5=`(?!${TE}${$b})`,eG=`(?!${_i}{0,1}${Vb})`,tG=`(?!${$b})`,rG=`[^.${Cf}]`,nG=`${PE}*?`,EE={DOT_LITERAL:_i,PLUS_LITERAL:J5,QMARK_LITERAL:Y5,SLASH_LITERAL:Cf,ONE_CHAR:X5,QMARK:PE,END_ANCHOR:Vb,DOTS_SLASH:$b,NO_DOT:Q5,NO_DOTS:Z5,NO_DOT_SLASH:eG,NO_DOTS_SLASH:tG,QMARK_NO_DOT:rG,STAR:nG,START_ANCHOR:TE},iG={...EE,SLASH_LITERAL:`[${Wn}]`,QMARK:CE,STAR:`${CE}*?`,DOTS_SLASH:`${_i}{1,2}(?:[${Wn}]|$)`,NO_DOT:`(?!${_i})`,NO_DOTS:`(?!(?:^|[${Wn}])${_i}{1,2}(?:[${Wn}]|$))`,NO_DOT_SLASH:`(?!${_i}{0,1}(?:[${Wn}]|$))`,NO_DOTS_SLASH:`(?!${_i}{1,2}(?:[${Wn}]|$))`,QMARK_NO_DOT:`[^.${Wn}]`,START_ANCHOR:`(?:^|[${Wn}])`,END_ANCHOR:`(?:[${Wn}]|$)`},oG={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};RE.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:oG,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,SEP:K5.sep,extglobChars(r){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${r.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(r){return r===!0?iG:EE}}});var Zu=_(tr=>{"use strict";var sG=g("path"),aG=process.platform==="win32",{REGEX_BACKSLASH:cG,REGEX_REMOVE_BACKSLASH:uG,REGEX_SPECIAL_CHARS:lG,REGEX_SPECIAL_CHARS_GLOBAL:pG}=Qu();tr.isObject=r=>r!==null&&typeof r=="object"&&!Array.isArray(r);tr.hasRegexChars=r=>lG.test(r);tr.isRegexChar=r=>r.length===1&&tr.hasRegexChars(r);tr.escapeRegex=r=>r.replace(pG,"\\$1");tr.toPosixSlashes=r=>r.replace(cG,"/");tr.removeBackslashes=r=>r.replace(uG,e=>e==="\\"?"":e);tr.supportsLookbehinds=()=>{let r=process.version.slice(1).split(".").map(Number);return r.length===3&&r[0]>=9||r[0]===8&&r[1]>=10};tr.isWindows=r=>r&&typeof r.windows=="boolean"?r.windows:aG===!0||sG.sep==="\\";tr.escapeLast=(r,e,t)=>{let n=r.lastIndexOf(e,t);return n===-1?r:r[n-1]==="\\"?tr.escapeLast(r,e,n-1):`${r.slice(0,n)}\\${r.slice(n)}`};tr.removePrefix=(r,e={})=>{let t=r;return t.startsWith("./")&&(t=t.slice(2),e.prefix="./"),t};tr.wrapOutput=(r,e={},t={})=>{let n=t.contains?"":"^",i=t.contains?"":"$",o=`${n}(?:${r})${i}`;return e.negated===!0&&(o=`(?:^(?!${o}).*$)`),o}});var FE=_((cre,LE)=>{"use strict";var AE=Zu(),{CHAR_ASTERISK:Hb,CHAR_AT:dG,CHAR_BACKWARD_SLASH:el,CHAR_COMMA:fG,CHAR_DOT:Gb,CHAR_EXCLAMATION_MARK:zb,CHAR_FORWARD_SLASH:NE,CHAR_LEFT_CURLY_BRACE:Kb,CHAR_LEFT_PARENTHESES:Jb,CHAR_LEFT_SQUARE_BRACKET:hG,CHAR_PLUS:mG,CHAR_QUESTION_MARK:kE,CHAR_RIGHT_CURLY_BRACE:gG,CHAR_RIGHT_PARENTHESES:DE,CHAR_RIGHT_SQUARE_BRACKET:yG}=Qu(),OE=r=>r===NE||r===el,ME=r=>{r.isPrefix!==!0&&(r.depth=r.isGlobstar?1/0:1)},bG=(r,e)=>{let t=e||{},n=r.length-1,i=t.parts===!0||t.scanToEnd===!0,o=[],s=[],a=[],c=r,u=-1,l=0,p=0,d=!1,f=!1,h=!1,m=!1,b=!1,I=!1,D=!1,B=!1,Z=!1,F=!1,X=0,H,j,te={value:"",depth:0,isGlob:!1},Se=()=>u>=n,A=()=>c.charCodeAt(u+1),Te=()=>(H=j,c.charCodeAt(++u));for(;u<n;){j=Te();let pt;if(j===el){D=te.backslashes=!0,j=Te(),j===Kb&&(I=!0);continue}if(I===!0||j===Kb){for(X++;Se()!==!0&&(j=Te());){if(j===el){D=te.backslashes=!0,Te();continue}if(j===Kb){X++;continue}if(I!==!0&&j===Gb&&(j=Te())===Gb){if(d=te.isBrace=!0,h=te.isGlob=!0,F=!0,i===!0)continue;break}if(I!==!0&&j===fG){if(d=te.isBrace=!0,h=te.isGlob=!0,F=!0,i===!0)continue;break}if(j===gG&&(X--,X===0)){I=!1,d=te.isBrace=!0,F=!0;break}}if(i===!0)continue;break}if(j===NE){if(o.push(u),s.push(te),te={value:"",depth:0,isGlob:!1},F===!0)continue;if(H===Gb&&u===l+1){l+=2;continue}p=u+1;continue}if(t.noext!==!0&&(j===mG||j===dG||j===Hb||j===kE||j===zb)===!0&&A()===Jb){if(h=te.isGlob=!0,m=te.isExtglob=!0,F=!0,j===zb&&u===l&&(Z=!0),i===!0){for(;Se()!==!0&&(j=Te());){if(j===el){D=te.backslashes=!0,j=Te();continue}if(j===DE){h=te.isGlob=!0,F=!0;break}}continue}break}if(j===Hb){if(H===Hb&&(b=te.isGlobstar=!0),h=te.isGlob=!0,F=!0,i===!0)continue;break}if(j===kE){if(h=te.isGlob=!0,F=!0,i===!0)continue;break}if(j===hG){for(;Se()!==!0&&(pt=Te());){if(pt===el){D=te.backslashes=!0,Te();continue}if(pt===yG){f=te.isBracket=!0,h=te.isGlob=!0,F=!0;break}}if(i===!0)continue;break}if(t.nonegate!==!0&&j===zb&&u===l){B=te.negated=!0,l++;continue}if(t.noparen!==!0&&j===Jb){if(h=te.isGlob=!0,i===!0){for(;Se()!==!0&&(j=Te());){if(j===Jb){D=te.backslashes=!0,j=Te();continue}if(j===DE){F=!0;break}}continue}break}if(h===!0){if(F=!0,i===!0)continue;break}}t.noext===!0&&(m=!1,h=!1);let Ie=c,Kr="",T="";l>0&&(Kr=c.slice(0,l),c=c.slice(l),p-=l),Ie&&h===!0&&p>0?(Ie=c.slice(0,p),T=c.slice(p)):h===!0?(Ie="",T=c):Ie=c,Ie&&Ie!==""&&Ie!=="/"&&Ie!==c&&OE(Ie.charCodeAt(Ie.length-1))&&(Ie=Ie.slice(0,-1)),t.unescape===!0&&(T&&(T=AE.removeBackslashes(T)),Ie&&D===!0&&(Ie=AE.removeBackslashes(Ie)));let E={prefix:Kr,input:r,start:l,base:Ie,glob:T,isBrace:d,isBracket:f,isGlob:h,isExtglob:m,isGlobstar:b,negated:B,negatedExtglob:Z};if(t.tokens===!0&&(E.maxDepth=0,OE(j)||s.push(te),E.tokens=s),t.parts===!0||t.tokens===!0){let pt;for(let pe=0;pe<o.length;pe++){let sr=pt?pt+1:l,ar=o[pe],Ct=r.slice(sr,ar);t.tokens&&(pe===0&&l!==0?(s[pe].isPrefix=!0,s[pe].value=Kr):s[pe].value=Ct,ME(s[pe]),E.maxDepth+=s[pe].depth),(pe!==0||Ct!=="")&&a.push(Ct),pt=ar}if(pt&&pt+1<r.length){let pe=r.slice(pt+1);a.push(pe),t.tokens&&(s[s.length-1].value=pe,ME(s[s.length-1]),E.maxDepth+=s[s.length-1].depth)}E.slashes=o,E.parts=a}return E};LE.exports=bG});var jE=_((ure,UE)=>{"use strict";var Pf=Qu(),fr=Zu(),{MAX_LENGTH:Tf,POSIX_REGEX_SOURCE:vG,REGEX_NON_SPECIAL_CHARS:_G,REGEX_SPECIAL_CHARS_BACKREF:wG,REPLACEMENTS:BE}=Pf,SG=(r,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...r,e);r.sort();let t=`[${r.join("-")}]`;try{new RegExp(t)}catch{return r.map(i=>fr.escapeRegex(i)).join("..")}return t},Va=(r,e)=>`Missing ${r}: "${e}" - use "\\\\${e}" to match literal characters`,Yb=(r,e)=>{if(typeof r!="string")throw new TypeError("Expected a string");r=BE[r]||r;let t={...e},n=typeof t.maxLength=="number"?Math.min(Tf,t.maxLength):Tf,i=r.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);let o={type:"bos",value:"",output:t.prepend||""},s=[o],a=t.capture?"":"?:",c=fr.isWindows(e),u=Pf.globChars(c),l=Pf.extglobChars(u),{DOT_LITERAL:p,PLUS_LITERAL:d,SLASH_LITERAL:f,ONE_CHAR:h,DOTS_SLASH:m,NO_DOT:b,NO_DOT_SLASH:I,NO_DOTS_SLASH:D,QMARK:B,QMARK_NO_DOT:Z,STAR:F,START_ANCHOR:X}=u,H=q=>`(${a}(?:(?!${X}${q.dot?m:p}).)*?)`,j=t.dot?"":b,te=t.dot?B:Z,Se=t.bash===!0?H(t):F;t.capture&&(Se=`(${Se})`),typeof t.noext=="boolean"&&(t.noextglob=t.noext);let A={input:r,index:-1,start:0,dot:t.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:s};r=fr.removePrefix(r,A),i=r.length;let Te=[],Ie=[],Kr=[],T=o,E,pt=()=>A.index===i-1,pe=A.peek=(q=1)=>r[A.index+q],sr=A.advance=()=>r[++A.index]||"",ar=()=>r.slice(A.index+1),Ct=(q="",ae=0)=>{A.consumed+=q,A.index+=ae},ee=q=>{A.output+=q.output!=null?q.output:q.value,Ct(q.value)},Li=()=>{let q=1;for(;pe()==="!"&&(pe(2)!=="("||pe(3)==="?");)sr(),A.start++,q++;return q%2===0?!1:(A.negated=!0,A.start++,!0)},Ks=q=>{A[q]++,Kr.push(q)},we=q=>{A[q]--,Kr.pop()},oe=q=>{if(T.type==="globstar"){let ae=A.braces>0&&(q.type==="comma"||q.type==="brace"),L=q.extglob===!0||Te.length&&(q.type==="pipe"||q.type==="paren");q.type!=="slash"&&q.type!=="paren"&&!ae&&!L&&(A.output=A.output.slice(0,-T.output.length),T.type="star",T.value="*",T.output=Se,A.output+=T.output)}if(Te.length&&q.type!=="paren"&&(Te[Te.length-1].inner+=q.value),(q.value||q.output)&&ee(q),T&&T.type==="text"&&q.type==="text"){T.output=(T.output||T.value)+q.value,T.value+=q.value;return}q.prev=T,s.push(q),T=q},Js=(q,ae)=>{let L={...l[ae],conditions:1,inner:""};L.prev=T,L.parens=A.parens,L.output=A.output;let re=(t.capture?"(":"")+L.open;Ks("parens"),oe({type:q,value:ae,output:A.output?"":h}),oe({type:"paren",extglob:!0,value:sr(),output:re}),Te.push(L)},mp=q=>{let ae=q.close+(t.capture?")":""),L;if(q.type==="negate"){let re=Se;if(q.inner&&q.inner.length>1&&q.inner.includes("/")&&(re=H(t)),(re!==Se||pt()||/^\)+$/.test(ar()))&&(ae=q.close=`)$))${re}`),q.inner.includes("*")&&(L=ar())&&/^\.[^\\/.]+$/.test(L)){let Ee=Yb(L,{...e,fastpaths:!1}).output;ae=q.close=`)${Ee})${re})`}q.prev.type==="bos"&&(A.negatedExtglob=!0)}oe({type:"paren",extglob:!0,value:E,output:ae}),we("parens")};if(t.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(r)){let q=!1,ae=r.replace(wG,(L,re,Ee,_t,qe,Ys)=>_t==="\\"?(q=!0,L):_t==="?"?re?re+_t+(qe?B.repeat(qe.length):""):Ys===0?te+(qe?B.repeat(qe.length):""):B.repeat(Ee.length):_t==="."?p.repeat(Ee.length):_t==="*"?re?re+_t+(qe?Se:""):Se:re?L:`\\${L}`);return q===!0&&(t.unescape===!0?ae=ae.replace(/\\/g,""):ae=ae.replace(/\\+/g,L=>L.length%2===0?"\\\\":L?"\\":"")),ae===r&&t.contains===!0?(A.output=r,A):(A.output=fr.wrapOutput(ae,A,e),A)}for(;!pt();){if(E=sr(),E==="\0")continue;if(E==="\\"){let L=pe();if(L==="/"&&t.bash!==!0||L==="."||L===";")continue;if(!L){E+="\\",oe({type:"text",value:E});continue}let re=/^\\+/.exec(ar()),Ee=0;if(re&&re[0].length>2&&(Ee=re[0].length,A.index+=Ee,Ee%2!==0&&(E+="\\")),t.unescape===!0?E=sr():E+=sr(),A.brackets===0){oe({type:"text",value:E});continue}}if(A.brackets>0&&(E!=="]"||T.value==="["||T.value==="[^")){if(t.posix!==!1&&E===":"){let L=T.value.slice(1);if(L.includes("[")&&(T.posix=!0,L.includes(":"))){let re=T.value.lastIndexOf("["),Ee=T.value.slice(0,re),_t=T.value.slice(re+2),qe=vG[_t];if(qe){T.value=Ee+qe,A.backtrack=!0,sr(),!o.output&&s.indexOf(T)===1&&(o.output=h);continue}}}(E==="["&&pe()!==":"||E==="-"&&pe()==="]")&&(E=`\\${E}`),E==="]"&&(T.value==="["||T.value==="[^")&&(E=`\\${E}`),t.posix===!0&&E==="!"&&T.value==="["&&(E="^"),T.value+=E,ee({value:E});continue}if(A.quotes===1&&E!=='"'){E=fr.escapeRegex(E),T.value+=E,ee({value:E});continue}if(E==='"'){A.quotes=A.quotes===1?0:1,t.keepQuotes===!0&&oe({type:"text",value:E});continue}if(E==="("){Ks("parens"),oe({type:"paren",value:E});continue}if(E===")"){if(A.parens===0&&t.strictBrackets===!0)throw new SyntaxError(Va("opening","("));let L=Te[Te.length-1];if(L&&A.parens===L.parens+1){mp(Te.pop());continue}oe({type:"paren",value:E,output:A.parens?")":"\\)"}),we("parens");continue}if(E==="["){if(t.nobracket===!0||!ar().includes("]")){if(t.nobracket!==!0&&t.strictBrackets===!0)throw new SyntaxError(Va("closing","]"));E=`\\${E}`}else Ks("brackets");oe({type:"bracket",value:E});continue}if(E==="]"){if(t.nobracket===!0||T&&T.type==="bracket"&&T.value.length===1){oe({type:"text",value:E,output:`\\${E}`});continue}if(A.brackets===0){if(t.strictBrackets===!0)throw new SyntaxError(Va("opening","["));oe({type:"text",value:E,output:`\\${E}`});continue}we("brackets");let L=T.value.slice(1);if(T.posix!==!0&&L[0]==="^"&&!L.includes("/")&&(E=`/${E}`),T.value+=E,ee({value:E}),t.literalBrackets===!1||fr.hasRegexChars(L))continue;let re=fr.escapeRegex(T.value);if(A.output=A.output.slice(0,-T.value.length),t.literalBrackets===!0){A.output+=re,T.value=re;continue}T.value=`(${a}${re}|${T.value})`,A.output+=T.value;continue}if(E==="{"&&t.nobrace!==!0){Ks("braces");let L={type:"brace",value:E,output:"(",outputIndex:A.output.length,tokensIndex:A.tokens.length};Ie.push(L),oe(L);continue}if(E==="}"){let L=Ie[Ie.length-1];if(t.nobrace===!0||!L){oe({type:"text",value:E,output:E});continue}let re=")";if(L.dots===!0){let Ee=s.slice(),_t=[];for(let qe=Ee.length-1;qe>=0&&(s.pop(),Ee[qe].type!=="brace");qe--)Ee[qe].type!=="dots"&&_t.unshift(Ee[qe].value);re=SG(_t,t),A.backtrack=!0}if(L.comma!==!0&&L.dots!==!0){let Ee=A.output.slice(0,L.outputIndex),_t=A.tokens.slice(L.tokensIndex);L.value=L.output="\\{",E=re="\\}",A.output=Ee;for(let qe of _t)A.output+=qe.output||qe.value}oe({type:"brace",value:E,output:re}),we("braces"),Ie.pop();continue}if(E==="|"){Te.length>0&&Te[Te.length-1].conditions++,oe({type:"text",value:E});continue}if(E===","){let L=E,re=Ie[Ie.length-1];re&&Kr[Kr.length-1]==="braces"&&(re.comma=!0,L="|"),oe({type:"comma",value:E,output:L});continue}if(E==="/"){if(T.type==="dot"&&A.index===A.start+1){A.start=A.index+1,A.consumed="",A.output="",s.pop(),T=o;continue}oe({type:"slash",value:E,output:f});continue}if(E==="."){if(A.braces>0&&T.type==="dot"){T.value==="."&&(T.output=p);let L=Ie[Ie.length-1];T.type="dots",T.output+=E,T.value+=E,L.dots=!0;continue}if(A.braces+A.parens===0&&T.type!=="bos"&&T.type!=="slash"){oe({type:"text",value:E,output:p});continue}oe({type:"dot",value:E,output:p});continue}if(E==="?"){if(!(T&&T.value==="(")&&t.noextglob!==!0&&pe()==="("&&pe(2)!=="?"){Js("qmark",E);continue}if(T&&T.type==="paren"){let re=pe(),Ee=E;if(re==="<"&&!fr.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(T.value==="("&&!/[!=<:]/.test(re)||re==="<"&&!/<([!=]|\w+>)/.test(ar()))&&(Ee=`\\${E}`),oe({type:"text",value:E,output:Ee});continue}if(t.dot!==!0&&(T.type==="slash"||T.type==="bos")){oe({type:"qmark",value:E,output:Z});continue}oe({type:"qmark",value:E,output:B});continue}if(E==="!"){if(t.noextglob!==!0&&pe()==="("&&(pe(2)!=="?"||!/[!=<:]/.test(pe(3)))){Js("negate",E);continue}if(t.nonegate!==!0&&A.index===0){Li();continue}}if(E==="+"){if(t.noextglob!==!0&&pe()==="("&&pe(2)!=="?"){Js("plus",E);continue}if(T&&T.value==="("||t.regex===!1){oe({type:"plus",value:E,output:d});continue}if(T&&(T.type==="bracket"||T.type==="paren"||T.type==="brace")||A.parens>0){oe({type:"plus",value:E});continue}oe({type:"plus",value:d});continue}if(E==="@"){if(t.noextglob!==!0&&pe()==="("&&pe(2)!=="?"){oe({type:"at",extglob:!0,value:E,output:""});continue}oe({type:"text",value:E});continue}if(E!=="*"){(E==="$"||E==="^")&&(E=`\\${E}`);let L=_G.exec(ar());L&&(E+=L[0],A.index+=L[0].length),oe({type:"text",value:E});continue}if(T&&(T.type==="globstar"||T.star===!0)){T.type="star",T.star=!0,T.value+=E,T.output=Se,A.backtrack=!0,A.globstar=!0,Ct(E);continue}let q=ar();if(t.noextglob!==!0&&/^\([^?]/.test(q)){Js("star",E);continue}if(T.type==="star"){if(t.noglobstar===!0){Ct(E);continue}let L=T.prev,re=L.prev,Ee=L.type==="slash"||L.type==="bos",_t=re&&(re.type==="star"||re.type==="globstar");if(t.bash===!0&&(!Ee||q[0]&&q[0]!=="/")){oe({type:"star",value:E,output:""});continue}let qe=A.braces>0&&(L.type==="comma"||L.type==="brace"),Ys=Te.length&&(L.type==="pipe"||L.type==="paren");if(!Ee&&L.type!=="paren"&&!qe&&!Ys){oe({type:"star",value:E,output:""});continue}for(;q.slice(0,3)==="/**";){let Lo=r[A.index+4];if(Lo&&Lo!=="/")break;q=q.slice(3),Ct("/**",3)}if(L.type==="bos"&&pt()){T.type="globstar",T.value+=E,T.output=H(t),A.output=T.output,A.globstar=!0,Ct(E);continue}if(L.type==="slash"&&L.prev.type!=="bos"&&!_t&&pt()){A.output=A.output.slice(0,-(L.output+T.output).length),L.output=`(?:${L.output}`,T.type="globstar",T.output=H(t)+(t.strictSlashes?")":"|$)"),T.value+=E,A.globstar=!0,A.output+=L.output+T.output,Ct(E);continue}if(L.type==="slash"&&L.prev.type!=="bos"&&q[0]==="/"){let Lo=q[1]!==void 0?"|$":"";A.output=A.output.slice(0,-(L.output+T.output).length),L.output=`(?:${L.output}`,T.type="globstar",T.output=`${H(t)}${f}|${f}${Lo})`,T.value+=E,A.output+=L.output+T.output,A.globstar=!0,Ct(E+sr()),oe({type:"slash",value:"/",output:""});continue}if(L.type==="bos"&&q[0]==="/"){T.type="globstar",T.value+=E,T.output=`(?:^|${f}|${H(t)}${f})`,A.output=T.output,A.globstar=!0,Ct(E+sr()),oe({type:"slash",value:"/",output:""});continue}A.output=A.output.slice(0,-T.output.length),T.type="globstar",T.output=H(t),T.value+=E,A.output+=T.output,A.globstar=!0,Ct(E);continue}let ae={type:"star",value:E,output:Se};if(t.bash===!0){ae.output=".*?",(T.type==="bos"||T.type==="slash")&&(ae.output=j+ae.output),oe(ae);continue}if(T&&(T.type==="bracket"||T.type==="paren")&&t.regex===!0){ae.output=E,oe(ae);continue}(A.index===A.start||T.type==="slash"||T.type==="dot")&&(T.type==="dot"?(A.output+=I,T.output+=I):t.dot===!0?(A.output+=D,T.output+=D):(A.output+=j,T.output+=j),pe()!=="*"&&(A.output+=h,T.output+=h)),oe(ae)}for(;A.brackets>0;){if(t.strictBrackets===!0)throw new SyntaxError(Va("closing","]"));A.output=fr.escapeLast(A.output,"["),we("brackets")}for(;A.parens>0;){if(t.strictBrackets===!0)throw new SyntaxError(Va("closing",")"));A.output=fr.escapeLast(A.output,"("),we("parens")}for(;A.braces>0;){if(t.strictBrackets===!0)throw new SyntaxError(Va("closing","}"));A.output=fr.escapeLast(A.output,"{"),we("braces")}if(t.strictSlashes!==!0&&(T.type==="star"||T.type==="bracket")&&oe({type:"maybe_slash",value:"",output:`${f}?`}),A.backtrack===!0){A.output="";for(let q of A.tokens)A.output+=q.output!=null?q.output:q.value,q.suffix&&(A.output+=q.suffix)}return A};Yb.fastpaths=(r,e)=>{let t={...e},n=typeof t.maxLength=="number"?Math.min(Tf,t.maxLength):Tf,i=r.length;if(i>n)throw new SyntaxError(`Input length: ${i}, exceeds maximum allowed length: ${n}`);r=BE[r]||r;let o=fr.isWindows(e),{DOT_LITERAL:s,SLASH_LITERAL:a,ONE_CHAR:c,DOTS_SLASH:u,NO_DOT:l,NO_DOTS:p,NO_DOTS_SLASH:d,STAR:f,START_ANCHOR:h}=Pf.globChars(o),m=t.dot?p:l,b=t.dot?d:l,I=t.capture?"":"?:",D={negated:!1,prefix:""},B=t.bash===!0?".*?":f;t.capture&&(B=`(${B})`);let Z=j=>j.noglobstar===!0?B:`(${I}(?:(?!${h}${j.dot?u:s}).)*?)`,F=j=>{switch(j){case"*":return`${m}${c}${B}`;case".*":return`${s}${c}${B}`;case"*.*":return`${m}${B}${s}${c}${B}`;case"*/*":return`${m}${B}${a}${c}${b}${B}`;case"**":return m+Z(t);case"**/*":return`(?:${m}${Z(t)}${a})?${b}${c}${B}`;case"**/*.*":return`(?:${m}${Z(t)}${a})?${b}${B}${s}${c}${B}`;case"**/.*":return`(?:${m}${Z(t)}${a})?${s}${c}${B}`;default:{let te=/^(.*?)\.(\w+)$/.exec(j);if(!te)return;let Se=F(te[1]);return Se?Se+s+te[2]:void 0}}},X=fr.removePrefix(r,D),H=F(X);return H&&t.strictSlashes!==!0&&(H+=`${a}?`),H};UE.exports=Yb});var WE=_((lre,qE)=>{"use strict";var xG=g("path"),IG=FE(),Xb=jE(),Qb=Zu(),CG=Qu(),PG=r=>r&&typeof r=="object"&&!Array.isArray(r),Qe=(r,e,t=!1)=>{if(Array.isArray(r)){let l=r.map(d=>Qe(d,e,t));return d=>{for(let f of l){let h=f(d);if(h)return h}return!1}}let n=PG(r)&&r.tokens&&r.input;if(r===""||typeof r!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let i=e||{},o=Qb.isWindows(e),s=n?Qe.compileRe(r,e):Qe.makeRe(r,e,!1,!0),a=s.state;delete s.state;let c=()=>!1;if(i.ignore){let l={...e,ignore:null,onMatch:null,onResult:null};c=Qe(i.ignore,l,t)}let u=(l,p=!1)=>{let{isMatch:d,match:f,output:h}=Qe.test(l,s,e,{glob:r,posix:o}),m={glob:r,state:a,regex:s,posix:o,input:l,output:h,match:f,isMatch:d};return typeof i.onResult=="function"&&i.onResult(m),d===!1?(m.isMatch=!1,p?m:!1):c(l)?(typeof i.onIgnore=="function"&&i.onIgnore(m),m.isMatch=!1,p?m:!1):(typeof i.onMatch=="function"&&i.onMatch(m),p?m:!0)};return t&&(u.state=a),u};Qe.test=(r,e,t,{glob:n,posix:i}={})=>{if(typeof r!="string")throw new TypeError("Expected input to be a string");if(r==="")return{isMatch:!1,output:""};let o=t||{},s=o.format||(i?Qb.toPosixSlashes:null),a=r===n,c=a&&s?s(r):r;return a===!1&&(c=s?s(r):r,a=c===n),(a===!1||o.capture===!0)&&(o.matchBase===!0||o.basename===!0?a=Qe.matchBase(r,e,t,i):a=e.exec(c)),{isMatch:!!a,match:a,output:c}};Qe.matchBase=(r,e,t,n=Qb.isWindows(t))=>(e instanceof RegExp?e:Qe.makeRe(e,t)).test(xG.basename(r));Qe.isMatch=(r,e,t)=>Qe(e,t)(r);Qe.parse=(r,e)=>Array.isArray(r)?r.map(t=>Qe.parse(t,e)):Xb(r,{...e,fastpaths:!1});Qe.scan=(r,e)=>IG(r,e);Qe.compileRe=(r,e,t=!1,n=!1)=>{if(t===!0)return r.output;let i=e||{},o=i.contains?"":"^",s=i.contains?"":"$",a=`${o}(?:${r.output})${s}`;r&&r.negated===!0&&(a=`^(?!${a}).*$`);let c=Qe.toRegex(a,e);return n===!0&&(c.state=r),c};Qe.makeRe=(r,e={},t=!1,n=!1)=>{if(!r||typeof r!="string")throw new TypeError("Expected a non-empty string");let i={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(r[0]==="."||r[0]==="*")&&(i.output=Xb.fastpaths(r,e)),i.output||(i=Xb(r,e)),Qe.compileRe(i,e,t,n)};Qe.toRegex=(r,e)=>{try{let t=e||{};return new RegExp(r,t.flags||(t.nocase?"i":""))}catch(t){if(e&&e.debug===!0)throw t;return/$^/}};Qe.constants=CG;qE.exports=Qe});var Zb=_((pre,VE)=>{"use strict";VE.exports=WE()});var tl=_((dre,KE)=>{"use strict";var HE=g("util"),GE=IE(),Vn=Zb(),ev=Zu(),$E=r=>r===""||r==="./",zE=r=>{let e=r.indexOf("{");return e>-1&&r.indexOf("}",e)>-1},Me=(r,e,t)=>{e=[].concat(e),r=[].concat(r);let n=new Set,i=new Set,o=new Set,s=0,a=l=>{o.add(l.output),t&&t.onResult&&t.onResult(l)};for(let l=0;l<e.length;l++){let p=Vn(String(e[l]),{...t,onResult:a},!0),d=p.state.negated||p.state.negatedExtglob;d&&s++;for(let f of r){let h=p(f,!0);(d?!h.isMatch:h.isMatch)&&(d?n.add(h.output):(n.delete(h.output),i.add(h.output)))}}let u=(s===e.length?[...o]:[...i]).filter(l=>!n.has(l));if(t&&u.length===0){if(t.failglob===!0)throw new Error(`No matches found for "${e.join(", ")}"`);if(t.nonull===!0||t.nullglob===!0)return t.unescape?e.map(l=>l.replace(/\\/g,"")):e}return u};Me.match=Me;Me.matcher=(r,e)=>Vn(r,e);Me.isMatch=(r,e,t)=>Vn(e,t)(r);Me.any=Me.isMatch;Me.not=(r,e,t={})=>{e=[].concat(e).map(String);let n=new Set,i=[],o=a=>{t.onResult&&t.onResult(a),i.push(a.output)},s=new Set(Me(r,e,{...t,onResult:o}));for(let a of i)s.has(a)||n.add(a);return[...n]};Me.contains=(r,e,t)=>{if(typeof r!="string")throw new TypeError(`Expected a string: "${HE.inspect(r)}"`);if(Array.isArray(e))return e.some(n=>Me.contains(r,n,t));if(typeof e=="string"){if($E(r)||$E(e))return!1;if(r.includes(e)||r.startsWith("./")&&r.slice(2).includes(e))return!0}return Me.isMatch(r,e,{...t,contains:!0})};Me.matchKeys=(r,e,t)=>{if(!ev.isObject(r))throw new TypeError("Expected the first argument to be an object");let n=Me(Object.keys(r),e,t),i={};for(let o of n)i[o]=r[o];return i};Me.some=(r,e,t)=>{let n=[].concat(r);for(let i of[].concat(e)){let o=Vn(String(i),t);if(n.some(s=>o(s)))return!0}return!1};Me.every=(r,e,t)=>{let n=[].concat(r);for(let i of[].concat(e)){let o=Vn(String(i),t);if(!n.every(s=>o(s)))return!1}return!0};Me.all=(r,e,t)=>{if(typeof r!="string")throw new TypeError(`Expected a string: "${HE.inspect(r)}"`);return[].concat(e).every(n=>Vn(n,t)(r))};Me.capture=(r,e,t)=>{let n=ev.isWindows(t),o=Vn.makeRe(String(r),{...t,capture:!0}).exec(n?ev.toPosixSlashes(e):e);if(o)return o.slice(1).map(s=>s===void 0?"":s)};Me.makeRe=(...r)=>Vn.makeRe(...r);Me.scan=(...r)=>Vn.scan(...r);Me.parse=(r,e)=>{let t=[];for(let n of[].concat(r||[]))for(let i of GE(String(n),e))t.push(Vn.parse(i,e));return t};Me.braces=(r,e)=>{if(typeof r!="string")throw new TypeError("Expected a string");return e&&e.nobrace===!0||!zE(r)?[r]:GE(r,e)};Me.braceExpand=(r,e)=>{if(typeof r!="string")throw new TypeError("Expected a string");return Me.braces(r,{...e,expand:!0})};Me.hasBraces=zE;KE.exports=Me});var bR=_((lie,yR)=>{"use strict";var{Duplex:FG}=g("stream");function mR(r){r.emit("close")}function BG(){!this.destroyed&&this._writableState.finished&&this.destroy()}function gR(r){this.removeListener("error",gR),this.destroy(),this.listenerCount("error")===0&&this.emit("error",r)}function UG(r,e){let t=!0,n=new FG({...e,autoDestroy:!1,emitClose:!1,objectMode:!1,writableObjectMode:!1});return r.on("message",function(o,s){let a=!s&&n._readableState.objectMode?o.toString():o;n.push(a)||r.pause()}),r.once("error",function(o){n.destroyed||(t=!1,n.destroy(o))}),r.once("close",function(){n.destroyed||n.push(null)}),n._destroy=function(i,o){if(r.readyState===r.CLOSED){o(i),process.nextTick(mR,n);return}let s=!1;r.once("error",function(c){s=!0,o(c)}),r.once("close",function(){s||o(i),process.nextTick(mR,n)}),t&&r.terminate()},n._final=function(i){if(r.readyState===r.CONNECTING){r.once("open",function(){n._final(i)});return}r._socket!==null&&(r._socket._writableState.finished?(i(),n._readableState.endEmitted&&n.destroy()):(r._socket.once("finish",function(){i()}),r.close()))},n._read=function(){r.isPaused&&r.resume()},n._write=function(i,o,s){if(r.readyState===r.CONNECTING){r.once("open",function(){n._write(i,o,s)});return}r.send(i,s)},n.on("end",BG),n.on("error",gR),n}yR.exports=UG});var to=_((pie,vR)=>{"use strict";vR.exports={BINARY_TYPES:["nodebuffer","arraybuffer","fragments"],EMPTY_BUFFER:Buffer.alloc(0),GUID:"258EAFA5-E914-47DA-95CA-C5AB0DC85B11",kForOnEventAttribute:Symbol("kIsForOnEventAttribute"),kListener:Symbol("kListener"),kStatusCode:Symbol("status-code"),kWebSocket:Symbol("websocket"),NOOP:()=>{}}});var sl=_((die,Lf)=>{"use strict";var{EMPTY_BUFFER:jG}=to(),sv=Buffer[Symbol.species];function qG(r,e){if(r.length===0)return jG;if(r.length===1)return r[0];let t=Buffer.allocUnsafe(e),n=0;for(let i=0;i<r.length;i++){let o=r[i];t.set(o,n),n+=o.length}return n<e?new sv(t.buffer,t.byteOffset,n):t}function _R(r,e,t,n,i){for(let o=0;o<i;o++)t[n+o]=r[o]^e[o&3]}function wR(r,e){for(let t=0;t<r.length;t++)r[t]^=e[t&3]}function WG(r){return r.length===r.buffer.byteLength?r.buffer:r.buffer.slice(r.byteOffset,r.byteOffset+r.length)}function av(r){if(av.readOnly=!0,Buffer.isBuffer(r))return r;let e;return r instanceof ArrayBuffer?e=new sv(r):ArrayBuffer.isView(r)?e=new sv(r.buffer,r.byteOffset,r.byteLength):(e=Buffer.from(r),av.readOnly=!1),e}Lf.exports={concat:qG,mask:_R,toArrayBuffer:WG,toBuffer:av,unmask:wR};if(!process.env.WS_NO_BUFFER_UTIL)try{let r=g("bufferutil");Lf.exports.mask=function(e,t,n,i,o){o<48?_R(e,t,n,i,o):r.mask(e,t,n,i,o)},Lf.exports.unmask=function(e,t){e.length<32?wR(e,t):r.unmask(e,t)}}catch{}});var IR=_((fie,xR)=>{"use strict";var SR=Symbol("kDone"),cv=Symbol("kRun"),uv=class{constructor(e){this[SR]=()=>{this.pending--,this[cv]()},this.concurrency=e||1/0,this.jobs=[],this.pending=0}add(e){this.jobs.push(e),this[cv]()}[cv](){if(this.pending!==this.concurrency&&this.jobs.length){let e=this.jobs.shift();this.pending++,e(this[SR])}}};xR.exports=uv});var ul=_((hie,ER)=>{"use strict";var al=g("zlib"),CR=sl(),VG=IR(),{kStatusCode:PR}=to(),$G=Buffer[Symbol.species],HG=Buffer.from([0,0,255,255]),Uf=Symbol("permessage-deflate"),wi=Symbol("total-length"),cl=Symbol("callback"),ro=Symbol("buffers"),Bf=Symbol("error"),Ff,lv=class{constructor(e,t,n){if(this._maxPayload=n|0,this._options=e||{},this._threshold=this._options.threshold!==void 0?this._options.threshold:1024,this._isServer=!!t,this._deflate=null,this._inflate=null,this.params=null,!Ff){let i=this._options.concurrencyLimit!==void 0?this._options.concurrencyLimit:10;Ff=new VG(i)}}static get extensionName(){return"permessage-deflate"}offer(){let e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:this._options.clientMaxWindowBits==null&&(e.client_max_window_bits=!0),e}accept(e){return e=this.normalizeParams(e),this.params=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params}cleanup(){if(this._inflate&&(this._inflate.close(),this._inflate=null),this._deflate){let e=this._deflate[cl];this._deflate.close(),this._deflate=null,e&&e(new Error("The deflate stream was closed while data was being processed"))}}acceptAsServer(e){let t=this._options,n=e.find(i=>!(t.serverNoContextTakeover===!1&&i.server_no_context_takeover||i.server_max_window_bits&&(t.serverMaxWindowBits===!1||typeof t.serverMaxWindowBits=="number"&&t.serverMaxWindowBits>i.server_max_window_bits)||typeof t.clientMaxWindowBits=="number"&&!i.client_max_window_bits));if(!n)throw new Error("None of the extension offers can be accepted");return t.serverNoContextTakeover&&(n.server_no_context_takeover=!0),t.clientNoContextTakeover&&(n.client_no_context_takeover=!0),typeof t.serverMaxWindowBits=="number"&&(n.server_max_window_bits=t.serverMaxWindowBits),typeof t.clientMaxWindowBits=="number"?n.client_max_window_bits=t.clientMaxWindowBits:(n.client_max_window_bits===!0||t.clientMaxWindowBits===!1)&&delete n.client_max_window_bits,n}acceptAsClient(e){let t=e[0];if(this._options.clientNoContextTakeover===!1&&t.client_no_context_takeover)throw new Error('Unexpected parameter "client_no_context_takeover"');if(!t.client_max_window_bits)typeof this._options.clientMaxWindowBits=="number"&&(t.client_max_window_bits=this._options.clientMaxWindowBits);else if(this._options.clientMaxWindowBits===!1||typeof this._options.clientMaxWindowBits=="number"&&t.client_max_window_bits>this._options.clientMaxWindowBits)throw new Error('Unexpected or invalid parameter "client_max_window_bits"');return t}normalizeParams(e){return e.forEach(t=>{Object.keys(t).forEach(n=>{let i=t[n];if(i.length>1)throw new Error(`Parameter "${n}" must have only a single value`);if(i=i[0],n==="client_max_window_bits"){if(i!==!0){let o=+i;if(!Number.isInteger(o)||o<8||o>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=o}else if(!this._isServer)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else if(n==="server_max_window_bits"){let o=+i;if(!Number.isInteger(o)||o<8||o>15)throw new TypeError(`Invalid value for parameter "${n}": ${i}`);i=o}else if(n==="client_no_context_takeover"||n==="server_no_context_takeover"){if(i!==!0)throw new TypeError(`Invalid value for parameter "${n}": ${i}`)}else throw new Error(`Unknown parameter "${n}"`);t[n]=i})}),e}decompress(e,t,n){Ff.add(i=>{this._decompress(e,t,(o,s)=>{i(),n(o,s)})})}compress(e,t,n){Ff.add(i=>{this._compress(e,t,(o,s)=>{i(),n(o,s)})})}_decompress(e,t,n){let i=this._isServer?"client":"server";if(!this._inflate){let o=`${i}_max_window_bits`,s=typeof this.params[o]!="number"?al.Z_DEFAULT_WINDOWBITS:this.params[o];this._inflate=al.createInflateRaw({...this._options.zlibInflateOptions,windowBits:s}),this._inflate[Uf]=this,this._inflate[wi]=0,this._inflate[ro]=[],this._inflate.on("error",zG),this._inflate.on("data",TR)}this._inflate[cl]=n,this._inflate.write(e),t&&this._inflate.write(HG),this._inflate.flush(()=>{let o=this._inflate[Bf];if(o){this._inflate.close(),this._inflate=null,n(o);return}let s=CR.concat(this._inflate[ro],this._inflate[wi]);this._inflate._readableState.endEmitted?(this._inflate.close(),this._inflate=null):(this._inflate[wi]=0,this._inflate[ro]=[],t&&this.params[`${i}_no_context_takeover`]&&this._inflate.reset()),n(null,s)})}_compress(e,t,n){let i=this._isServer?"server":"client";if(!this._deflate){let o=`${i}_max_window_bits`,s=typeof this.params[o]!="number"?al.Z_DEFAULT_WINDOWBITS:this.params[o];this._deflate=al.createDeflateRaw({...this._options.zlibDeflateOptions,windowBits:s}),this._deflate[wi]=0,this._deflate[ro]=[],this._deflate.on("data",GG)}this._deflate[cl]=n,this._deflate.write(e),this._deflate.flush(al.Z_SYNC_FLUSH,()=>{if(!this._deflate)return;let o=CR.concat(this._deflate[ro],this._deflate[wi]);t&&(o=new $G(o.buffer,o.byteOffset,o.length-4)),this._deflate[cl]=null,this._deflate[wi]=0,this._deflate[ro]=[],t&&this.params[`${i}_no_context_takeover`]&&this._deflate.reset(),n(null,o)})}};ER.exports=lv;function GG(r){this[ro].push(r),this[wi]+=r.length}function TR(r){if(this[wi]+=r.length,this[Uf]._maxPayload<1||this[wi]<=this[Uf]._maxPayload){this[ro].push(r);return}this[Bf]=new RangeError("Max payload size exceeded"),this[Bf].code="WS_ERR_UNSUPPORTED_MESSAGE_LENGTH",this[Bf][PR]=1009,this.removeListener("data",TR),this.reset()}function zG(r){this[Uf]._inflate=null,r[PR]=1007,this[cl](r)}});var ll=_((mie,jf)=>{"use strict";var{isUtf8:RR}=g("buffer"),KG=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0];function JG(r){return r>=1e3&&r<=1014&&r!==1004&&r!==1005&&r!==1006||r>=3e3&&r<=4999}function pv(r){let e=r.length,t=0;for(;t<e;)if((r[t]&128)===0)t++;else if((r[t]&224)===192){if(t+1===e||(r[t+1]&192)!==128||(r[t]&254)===192)return!1;t+=2}else if((r[t]&240)===224){if(t+2>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||r[t]===224&&(r[t+1]&224)===128||r[t]===237&&(r[t+1]&224)===160)return!1;t+=3}else if((r[t]&248)===240){if(t+3>=e||(r[t+1]&192)!==128||(r[t+2]&192)!==128||(r[t+3]&192)!==128||r[t]===240&&(r[t+1]&240)===128||r[t]===244&&r[t+1]>143||r[t]>244)return!1;t+=4}else return!1;return!0}jf.exports={isValidStatusCode:JG,isValidUTF8:pv,tokenChars:KG};if(RR)jf.exports.isValidUTF8=function(r){return r.length<24?pv(r):RR(r)};else if(!process.env.WS_NO_UTF_8_VALIDATE)try{let r=g("utf-8-validate");jf.exports.isValidUTF8=function(e){return e.length<32?pv(e):r(e)}}catch{}});var gv=_((gie,LR)=>{"use strict";var{Writable:YG}=g("stream"),AR=ul(),{BINARY_TYPES:XG,EMPTY_BUFFER:kR,kStatusCode:QG,kWebSocket:ZG}=to(),{concat:dv,toArrayBuffer:e3,unmask:t3}=sl(),{isValidStatusCode:r3,isValidUTF8:DR}=ll(),qf=Buffer[Symbol.species],Lr=0,OR=1,MR=2,NR=3,fv=4,hv=5,Wf=6,mv=class extends YG{constructor(e={}){super(),this._allowSynchronousEvents=e.allowSynchronousEvents!==void 0?e.allowSynchronousEvents:!0,this._binaryType=e.binaryType||XG[0],this._extensions=e.extensions||{},this._isServer=!!e.isServer,this._maxPayload=e.maxPayload|0,this._skipUTF8Validation=!!e.skipUTF8Validation,this[ZG]=void 0,this._bufferedBytes=0,this._buffers=[],this._compressed=!1,this._payloadLength=0,this._mask=void 0,this._fragmented=0,this._masked=!1,this._fin=!1,this._opcode=0,this._totalPayloadLength=0,this._messageLength=0,this._fragments=[],this._errored=!1,this._loop=!1,this._state=Lr}_write(e,t,n){if(this._opcode===8&&this._state==Lr)return n();this._bufferedBytes+=e.length,this._buffers.push(e),this.startLoop(n)}consume(e){if(this._bufferedBytes-=e,e===this._buffers[0].length)return this._buffers.shift();if(e<this._buffers[0].length){let n=this._buffers[0];return this._buffers[0]=new qf(n.buffer,n.byteOffset+e,n.length-e),new qf(n.buffer,n.byteOffset,e)}let t=Buffer.allocUnsafe(e);do{let n=this._buffers[0],i=t.length-e;e>=n.length?t.set(this._buffers.shift(),i):(t.set(new Uint8Array(n.buffer,n.byteOffset,e),i),this._buffers[0]=new qf(n.buffer,n.byteOffset+e,n.length-e)),e-=n.length}while(e>0);return t}startLoop(e){this._loop=!0;do switch(this._state){case Lr:this.getInfo(e);break;case OR:this.getPayloadLength16(e);break;case MR:this.getPayloadLength64(e);break;case NR:this.getMask();break;case fv:this.getData(e);break;case hv:case Wf:this._loop=!1;return}while(this._loop);this._errored||e()}getInfo(e){if(this._bufferedBytes<2){this._loop=!1;return}let t=this.consume(2);if((t[0]&48)!==0){let i=this.createError(RangeError,"RSV2 and RSV3 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_2_3");e(i);return}let n=(t[0]&64)===64;if(n&&!this._extensions[AR.extensionName]){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(this._fin=(t[0]&128)===128,this._opcode=t[0]&15,this._payloadLength=t[1]&127,this._opcode===0){if(n){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(!this._fragmented){let i=this.createError(RangeError,"invalid opcode 0",!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}this._opcode=this._fragmented}else if(this._opcode===1||this._opcode===2){if(this._fragmented){let i=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}this._compressed=n}else if(this._opcode>7&&this._opcode<11){if(!this._fin){let i=this.createError(RangeError,"FIN must be set",!0,1002,"WS_ERR_EXPECTED_FIN");e(i);return}if(n){let i=this.createError(RangeError,"RSV1 must be clear",!0,1002,"WS_ERR_UNEXPECTED_RSV_1");e(i);return}if(this._payloadLength>125||this._opcode===8&&this._payloadLength===1){let i=this.createError(RangeError,`invalid payload length ${this._payloadLength}`,!0,1002,"WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH");e(i);return}}else{let i=this.createError(RangeError,`invalid opcode ${this._opcode}`,!0,1002,"WS_ERR_INVALID_OPCODE");e(i);return}if(!this._fin&&!this._fragmented&&(this._fragmented=this._opcode),this._masked=(t[1]&128)===128,this._isServer){if(!this._masked){let i=this.createError(RangeError,"MASK must be set",!0,1002,"WS_ERR_EXPECTED_MASK");e(i);return}}else if(this._masked){let i=this.createError(RangeError,"MASK must be clear",!0,1002,"WS_ERR_UNEXPECTED_MASK");e(i);return}this._payloadLength===126?this._state=OR:this._payloadLength===127?this._state=MR:this.haveLength(e)}getPayloadLength16(e){if(this._bufferedBytes<2){this._loop=!1;return}this._payloadLength=this.consume(2).readUInt16BE(0),this.haveLength(e)}getPayloadLength64(e){if(this._bufferedBytes<8){this._loop=!1;return}let t=this.consume(8),n=t.readUInt32BE(0);if(n>Math.pow(2,21)-1){let i=this.createError(RangeError,"Unsupported WebSocket frame: payload length > 2^53 - 1",!1,1009,"WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH");e(i);return}this._payloadLength=n*Math.pow(2,32)+t.readUInt32BE(4),this.haveLength(e)}haveLength(e){if(this._payloadLength&&this._opcode<8&&(this._totalPayloadLength+=this._payloadLength,this._totalPayloadLength>this._maxPayload&&this._maxPayload>0)){let t=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");e(t);return}this._masked?this._state=NR:this._state=fv}getMask(){if(this._bufferedBytes<4){this._loop=!1;return}this._mask=this.consume(4),this._state=fv}getData(e){let t=kR;if(this._payloadLength){if(this._bufferedBytes<this._payloadLength){this._loop=!1;return}t=this.consume(this._payloadLength),this._masked&&(this._mask[0]|this._mask[1]|this._mask[2]|this._mask[3])!==0&&t3(t,this._mask)}if(this._opcode>7){this.controlMessage(t,e);return}if(this._compressed){this._state=hv,this.decompress(t,e);return}t.length&&(this._messageLength=this._totalPayloadLength,this._fragments.push(t)),this.dataMessage(e)}decompress(e,t){this._extensions[AR.extensionName].decompress(e,this._fin,(i,o)=>{if(i)return t(i);if(o.length){if(this._messageLength+=o.length,this._messageLength>this._maxPayload&&this._maxPayload>0){let s=this.createError(RangeError,"Max payload size exceeded",!1,1009,"WS_ERR_UNSUPPORTED_MESSAGE_LENGTH");t(s);return}this._fragments.push(o)}this.dataMessage(t),this._state===Lr&&this.startLoop(t)})}dataMessage(e){if(!this._fin){this._state=Lr;return}let t=this._messageLength,n=this._fragments;if(this._totalPayloadLength=0,this._messageLength=0,this._fragmented=0,this._fragments=[],this._opcode===2){let i;this._binaryType==="nodebuffer"?i=dv(n,t):this._binaryType==="arraybuffer"?i=e3(dv(n,t)):i=n,this._allowSynchronousEvents?(this.emit("message",i,!0),this._state=Lr):(this._state=Wf,setImmediate(()=>{this.emit("message",i,!0),this._state=Lr,this.startLoop(e)}))}else{let i=dv(n,t);if(!this._skipUTF8Validation&&!DR(i)){let o=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");e(o);return}this._state===hv||this._allowSynchronousEvents?(this.emit("message",i,!1),this._state=Lr):(this._state=Wf,setImmediate(()=>{this.emit("message",i,!1),this._state=Lr,this.startLoop(e)}))}}controlMessage(e,t){if(this._opcode===8){if(e.length===0)this._loop=!1,this.emit("conclude",1005,kR),this.end();else{let n=e.readUInt16BE(0);if(!r3(n)){let o=this.createError(RangeError,`invalid status code ${n}`,!0,1002,"WS_ERR_INVALID_CLOSE_CODE");t(o);return}let i=new qf(e.buffer,e.byteOffset+2,e.length-2);if(!this._skipUTF8Validation&&!DR(i)){let o=this.createError(Error,"invalid UTF-8 sequence",!0,1007,"WS_ERR_INVALID_UTF8");t(o);return}this._loop=!1,this.emit("conclude",n,i),this.end()}this._state=Lr;return}this._allowSynchronousEvents?(this.emit(this._opcode===9?"ping":"pong",e),this._state=Lr):(this._state=Wf,setImmediate(()=>{this.emit(this._opcode===9?"ping":"pong",e),this._state=Lr,this.startLoop(t)}))}createError(e,t,n,i,o){this._loop=!1,this._errored=!0;let s=new e(n?`Invalid WebSocket frame: ${t}`:t);return Error.captureStackTrace(s,this.createError),s.code=o,s[QG]=i,s}};LR.exports=mv});var bv=_((bie,UR)=>{"use strict";var{Duplex:yie}=g("stream"),{randomFillSync:n3}=g("crypto"),FR=ul(),{EMPTY_BUFFER:i3}=to(),{isValidStatusCode:o3}=ll(),{mask:BR,toBuffer:Ya}=sl(),nn=Symbol("kByteLength"),s3=Buffer.alloc(4),Vf=8*1024,ls,Xa=Vf,yv=class r{constructor(e,t,n){this._extensions=t||{},n&&(this._generateMask=n,this._maskBuffer=Buffer.alloc(4)),this._socket=e,this._firstFragment=!0,this._compress=!1,this._bufferedBytes=0,this._deflating=!1,this._queue=[]}static frame(e,t){let n,i=!1,o=2,s=!1;t.mask&&(n=t.maskBuffer||s3,t.generateMask?t.generateMask(n):(Xa===Vf&&(ls===void 0&&(ls=Buffer.alloc(Vf)),n3(ls,0,Vf),Xa=0),n[0]=ls[Xa++],n[1]=ls[Xa++],n[2]=ls[Xa++],n[3]=ls[Xa++]),s=(n[0]|n[1]|n[2]|n[3])===0,o=6);let a;typeof e=="string"?(!t.mask||s)&&t[nn]!==void 0?a=t[nn]:(e=Buffer.from(e),a=e.length):(a=e.length,i=t.mask&&t.readOnly&&!s);let c=a;a>=65536?(o+=8,c=127):a>125&&(o+=2,c=126);let u=Buffer.allocUnsafe(i?a+o:o);return u[0]=t.fin?t.opcode|128:t.opcode,t.rsv1&&(u[0]|=64),u[1]=c,c===126?u.writeUInt16BE(a,2):c===127&&(u[2]=u[3]=0,u.writeUIntBE(a,4,6)),t.mask?(u[1]|=128,u[o-4]=n[0],u[o-3]=n[1],u[o-2]=n[2],u[o-1]=n[3],s?[u,e]:i?(BR(e,n,u,o,a),[u]):(BR(e,n,e,0,a),[u,e])):[u,e]}close(e,t,n,i){let o;if(e===void 0)o=i3;else{if(typeof e!="number"||!o3(e))throw new TypeError("First argument must be a valid error code number");if(t===void 0||!t.length)o=Buffer.allocUnsafe(2),o.writeUInt16BE(e,0);else{let a=Buffer.byteLength(t);if(a>123)throw new RangeError("The message must not be greater than 123 bytes");o=Buffer.allocUnsafe(2+a),o.writeUInt16BE(e,0),typeof t=="string"?o.write(t,2):o.set(t,2)}}let s={[nn]:o.length,fin:!0,generateMask:this._generateMask,mask:n,maskBuffer:this._maskBuffer,opcode:8,readOnly:!1,rsv1:!1};this._deflating?this.enqueue([this.dispatch,o,!1,s,i]):this.sendFrame(r.frame(o,s),i)}ping(e,t,n){let i,o;if(typeof e=="string"?(i=Buffer.byteLength(e),o=!1):(e=Ya(e),i=e.length,o=Ya.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let s={[nn]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:9,readOnly:o,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,n]):this.sendFrame(r.frame(e,s),n)}pong(e,t,n){let i,o;if(typeof e=="string"?(i=Buffer.byteLength(e),o=!1):(e=Ya(e),i=e.length,o=Ya.readOnly),i>125)throw new RangeError("The data size must not be greater than 125 bytes");let s={[nn]:i,fin:!0,generateMask:this._generateMask,mask:t,maskBuffer:this._maskBuffer,opcode:10,readOnly:o,rsv1:!1};this._deflating?this.enqueue([this.dispatch,e,!1,s,n]):this.sendFrame(r.frame(e,s),n)}send(e,t,n){let i=this._extensions[FR.extensionName],o=t.binary?2:1,s=t.compress,a,c;if(typeof e=="string"?(a=Buffer.byteLength(e),c=!1):(e=Ya(e),a=e.length,c=Ya.readOnly),this._firstFragment?(this._firstFragment=!1,s&&i&&i.params[i._isServer?"server_no_context_takeover":"client_no_context_takeover"]&&(s=a>=i._threshold),this._compress=s):(s=!1,o=0),t.fin&&(this._firstFragment=!0),i){let u={[nn]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:o,readOnly:c,rsv1:s};this._deflating?this.enqueue([this.dispatch,e,this._compress,u,n]):this.dispatch(e,this._compress,u,n)}else this.sendFrame(r.frame(e,{[nn]:a,fin:t.fin,generateMask:this._generateMask,mask:t.mask,maskBuffer:this._maskBuffer,opcode:o,readOnly:c,rsv1:!1}),n)}dispatch(e,t,n,i){if(!t){this.sendFrame(r.frame(e,n),i);return}let o=this._extensions[FR.extensionName];this._bufferedBytes+=n[nn],this._deflating=!0,o.compress(e,n.fin,(s,a)=>{if(this._socket.destroyed){let c=new Error("The socket was closed while data was being compressed");typeof i=="function"&&i(c);for(let u=0;u<this._queue.length;u++){let l=this._queue[u],p=l[l.length-1];typeof p=="function"&&p(c)}return}this._bufferedBytes-=n[nn],this._deflating=!1,n.readOnly=!1,this.sendFrame(r.frame(a,n),i),this.dequeue()})}dequeue(){for(;!this._deflating&&this._queue.length;){let e=this._queue.shift();this._bufferedBytes-=e[3][nn],Reflect.apply(e[0],this,e.slice(1))}}enqueue(e){this._bufferedBytes+=e[3][nn],this._queue.push(e)}sendFrame(e,t){e.length===2?(this._socket.cork(),this._socket.write(e[0]),this._socket.write(e[1],t),this._socket.uncork()):this._socket.write(e[0],t)}};UR.exports=yv});var KR=_((vie,zR)=>{"use strict";var{kForOnEventAttribute:pl,kListener:vv}=to(),jR=Symbol("kCode"),qR=Symbol("kData"),WR=Symbol("kError"),VR=Symbol("kMessage"),$R=Symbol("kReason"),Qa=Symbol("kTarget"),HR=Symbol("kType"),GR=Symbol("kWasClean"),Si=class{constructor(e){this[Qa]=null,this[HR]=e}get target(){return this[Qa]}get type(){return this[HR]}};Object.defineProperty(Si.prototype,"target",{enumerable:!0});Object.defineProperty(Si.prototype,"type",{enumerable:!0});var ps=class extends Si{constructor(e,t={}){super(e),this[jR]=t.code===void 0?0:t.code,this[$R]=t.reason===void 0?"":t.reason,this[GR]=t.wasClean===void 0?!1:t.wasClean}get code(){return this[jR]}get reason(){return this[$R]}get wasClean(){return this[GR]}};Object.defineProperty(ps.prototype,"code",{enumerable:!0});Object.defineProperty(ps.prototype,"reason",{enumerable:!0});Object.defineProperty(ps.prototype,"wasClean",{enumerable:!0});var Za=class extends Si{constructor(e,t={}){super(e),this[WR]=t.error===void 0?null:t.error,this[VR]=t.message===void 0?"":t.message}get error(){return this[WR]}get message(){return this[VR]}};Object.defineProperty(Za.prototype,"error",{enumerable:!0});Object.defineProperty(Za.prototype,"message",{enumerable:!0});var dl=class extends Si{constructor(e,t={}){super(e),this[qR]=t.data===void 0?null:t.data}get data(){return this[qR]}};Object.defineProperty(dl.prototype,"data",{enumerable:!0});var a3={addEventListener(r,e,t={}){for(let i of this.listeners(r))if(!t[pl]&&i[vv]===e&&!i[pl])return;let n;if(r==="message")n=function(o,s){let a=new dl("message",{data:s?o:o.toString()});a[Qa]=this,$f(e,this,a)};else if(r==="close")n=function(o,s){let a=new ps("close",{code:o,reason:s.toString(),wasClean:this._closeFrameReceived&&this._closeFrameSent});a[Qa]=this,$f(e,this,a)};else if(r==="error")n=function(o){let s=new Za("error",{error:o,message:o.message});s[Qa]=this,$f(e,this,s)};else if(r==="open")n=function(){let o=new Si("open");o[Qa]=this,$f(e,this,o)};else return;n[pl]=!!t[pl],n[vv]=e,t.once?this.once(r,n):this.on(r,n)},removeEventListener(r,e){for(let t of this.listeners(r))if(t[vv]===e&&!t[pl]){this.removeListener(r,t);break}}};zR.exports={CloseEvent:ps,ErrorEvent:Za,Event:Si,EventTarget:a3,MessageEvent:dl};function $f(r,e,t){typeof r=="object"&&r.handleEvent?r.handleEvent.call(r,t):r.call(e,t)}});var _v=_((_ie,JR)=>{"use strict";var{tokenChars:fl}=ll();function Jn(r,e,t){r[e]===void 0?r[e]=[t]:r[e].push(t)}function c3(r){let e=Object.create(null),t=Object.create(null),n=!1,i=!1,o=!1,s,a,c=-1,u=-1,l=-1,p=0;for(;p<r.length;p++)if(u=r.charCodeAt(p),s===void 0)if(l===-1&&fl[u]===1)c===-1&&(c=p);else if(p!==0&&(u===32||u===9))l===-1&&c!==-1&&(l=p);else if(u===59||u===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${p}`);l===-1&&(l=p);let f=r.slice(c,l);u===44?(Jn(e,f,t),t=Object.create(null)):s=f,c=l=-1}else throw new SyntaxError(`Unexpected character at index ${p}`);else if(a===void 0)if(l===-1&&fl[u]===1)c===-1&&(c=p);else if(u===32||u===9)l===-1&&c!==-1&&(l=p);else if(u===59||u===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${p}`);l===-1&&(l=p),Jn(t,r.slice(c,l),!0),u===44&&(Jn(e,s,t),t=Object.create(null),s=void 0),c=l=-1}else if(u===61&&c!==-1&&l===-1)a=r.slice(c,p),c=l=-1;else throw new SyntaxError(`Unexpected character at index ${p}`);else if(i){if(fl[u]!==1)throw new SyntaxError(`Unexpected character at index ${p}`);c===-1?c=p:n||(n=!0),i=!1}else if(o)if(fl[u]===1)c===-1&&(c=p);else if(u===34&&c!==-1)o=!1,l=p;else if(u===92)i=!0;else throw new SyntaxError(`Unexpected character at index ${p}`);else if(u===34&&r.charCodeAt(p-1)===61)o=!0;else if(l===-1&&fl[u]===1)c===-1&&(c=p);else if(c!==-1&&(u===32||u===9))l===-1&&(l=p);else if(u===59||u===44){if(c===-1)throw new SyntaxError(`Unexpected character at index ${p}`);l===-1&&(l=p);let f=r.slice(c,l);n&&(f=f.replace(/\\/g,""),n=!1),Jn(t,a,f),u===44&&(Jn(e,s,t),t=Object.create(null),s=void 0),a=void 0,c=l=-1}else throw new SyntaxError(`Unexpected character at index ${p}`);if(c===-1||o||u===32||u===9)throw new SyntaxError("Unexpected end of input");l===-1&&(l=p);let d=r.slice(c,l);return s===void 0?Jn(e,d,t):(a===void 0?Jn(t,d,!0):n?Jn(t,a,d.replace(/\\/g,"")):Jn(t,a,d),Jn(e,s,t)),e}function u3(r){return Object.keys(r).map(e=>{let t=r[e];return Array.isArray(t)||(t=[t]),t.map(n=>[e].concat(Object.keys(n).map(i=>{let o=n[i];return Array.isArray(o)||(o=[o]),o.map(s=>s===!0?i:`${i}=${s}`).join("; ")})).join("; ")).join(", ")}).join(", ")}JR.exports={format:u3,parse:c3}});var Cv=_((xie,sA)=>{"use strict";var l3=g("events"),p3=g("https"),d3=g("http"),QR=g("net"),f3=g("tls"),{randomBytes:h3,createHash:m3}=g("crypto"),{Duplex:wie,Readable:Sie}=g("stream"),{URL:wv}=g("url"),no=ul(),g3=gv(),y3=bv(),{BINARY_TYPES:YR,EMPTY_BUFFER:Hf,GUID:b3,kForOnEventAttribute:Sv,kListener:v3,kStatusCode:_3,kWebSocket:Mt,NOOP:ZR}=to(),{EventTarget:{addEventListener:w3,removeEventListener:S3}}=KR(),{format:x3,parse:I3}=_v(),{toBuffer:C3}=sl(),P3=30*1e3,eA=Symbol("kAborted"),xv=[8,13],xi=["CONNECTING","OPEN","CLOSING","CLOSED"],T3=/^[!#$%&'*+\-.0-9A-Z^_`|a-z~]+$/,Ze=class r extends l3{constructor(e,t,n){super(),this._binaryType=YR[0],this._closeCode=1006,this._closeFrameReceived=!1,this._closeFrameSent=!1,this._closeMessage=Hf,this._closeTimer=null,this._extensions={},this._paused=!1,this._protocol="",this._readyState=r.CONNECTING,this._receiver=null,this._sender=null,this._socket=null,e!==null?(this._bufferedAmount=0,this._isServer=!1,this._redirects=0,t===void 0?t=[]:Array.isArray(t)||(typeof t=="object"&&t!==null?(n=t,t=[]):t=[t]),tA(this,e,t,n)):(this._autoPong=n.autoPong,this._isServer=!0)}get binaryType(){return this._binaryType}set binaryType(e){YR.includes(e)&&(this._binaryType=e,this._receiver&&(this._receiver._binaryType=e))}get bufferedAmount(){return this._socket?this._socket._writableState.length+this._sender._bufferedBytes:this._bufferedAmount}get extensions(){return Object.keys(this._extensions).join()}get isPaused(){return this._paused}get onclose(){return null}get onerror(){return null}get onopen(){return null}get onmessage(){return null}get protocol(){return this._protocol}get readyState(){return this._readyState}get url(){return this._url}setSocket(e,t,n){let i=new g3({allowSynchronousEvents:n.allowSynchronousEvents,binaryType:this.binaryType,extensions:this._extensions,isServer:this._isServer,maxPayload:n.maxPayload,skipUTF8Validation:n.skipUTF8Validation});this._sender=new y3(e,this._extensions,n.generateMask),this._receiver=i,this._socket=e,i[Mt]=this,e[Mt]=this,i.on("conclude",A3),i.on("drain",k3),i.on("error",D3),i.on("message",O3),i.on("ping",M3),i.on("pong",N3),e.setTimeout&&e.setTimeout(0),e.setNoDelay&&e.setNoDelay(),t.length>0&&e.unshift(t),e.on("close",nA),e.on("data",zf),e.on("end",iA),e.on("error",oA),this._readyState=r.OPEN,this.emit("open")}emitClose(){if(!this._socket){this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage);return}this._extensions[no.extensionName]&&this._extensions[no.extensionName].cleanup(),this._receiver.removeAllListeners(),this._readyState=r.CLOSED,this.emit("close",this._closeCode,this._closeMessage)}close(e,t){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){hr(this,this._req,"WebSocket was closed before the connection was established");return}if(this.readyState===r.CLOSING){this._closeFrameSent&&(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end();return}this._readyState=r.CLOSING,this._sender.close(e,t,!this._isServer,n=>{n||(this._closeFrameSent=!0,(this._closeFrameReceived||this._receiver._writableState.errorEmitted)&&this._socket.end())}),this._closeTimer=setTimeout(this._socket.destroy.bind(this._socket),P3)}}pause(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!0,this._socket.pause())}ping(e,t,n){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=t=void 0):typeof t=="function"&&(n=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){Iv(this,e,n);return}t===void 0&&(t=!this._isServer),this._sender.ping(e||Hf,t,n)}pong(e,t,n){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof e=="function"?(n=e,e=t=void 0):typeof t=="function"&&(n=t,t=void 0),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){Iv(this,e,n);return}t===void 0&&(t=!this._isServer),this._sender.pong(e||Hf,t,n)}resume(){this.readyState===r.CONNECTING||this.readyState===r.CLOSED||(this._paused=!1,this._receiver._writableState.needDrain||this._socket.resume())}send(e,t,n){if(this.readyState===r.CONNECTING)throw new Error("WebSocket is not open: readyState 0 (CONNECTING)");if(typeof t=="function"&&(n=t,t={}),typeof e=="number"&&(e=e.toString()),this.readyState!==r.OPEN){Iv(this,e,n);return}let i={binary:typeof e!="string",mask:!this._isServer,compress:!0,fin:!0,...t};this._extensions[no.extensionName]||(i.compress=!1),this._sender.send(e||Hf,i,n)}terminate(){if(this.readyState!==r.CLOSED){if(this.readyState===r.CONNECTING){hr(this,this._req,"WebSocket was closed before the connection was established");return}this._socket&&(this._readyState=r.CLOSING,this._socket.destroy())}}};Object.defineProperty(Ze,"CONNECTING",{enumerable:!0,value:xi.indexOf("CONNECTING")});Object.defineProperty(Ze.prototype,"CONNECTING",{enumerable:!0,value:xi.indexOf("CONNECTING")});Object.defineProperty(Ze,"OPEN",{enumerable:!0,value:xi.indexOf("OPEN")});Object.defineProperty(Ze.prototype,"OPEN",{enumerable:!0,value:xi.indexOf("OPEN")});Object.defineProperty(Ze,"CLOSING",{enumerable:!0,value:xi.indexOf("CLOSING")});Object.defineProperty(Ze.prototype,"CLOSING",{enumerable:!0,value:xi.indexOf("CLOSING")});Object.defineProperty(Ze,"CLOSED",{enumerable:!0,value:xi.indexOf("CLOSED")});Object.defineProperty(Ze.prototype,"CLOSED",{enumerable:!0,value:xi.indexOf("CLOSED")});["binaryType","bufferedAmount","extensions","isPaused","protocol","readyState","url"].forEach(r=>{Object.defineProperty(Ze.prototype,r,{enumerable:!0})});["open","error","close","message"].forEach(r=>{Object.defineProperty(Ze.prototype,`on${r}`,{enumerable:!0,get(){for(let e of this.listeners(r))if(e[Sv])return e[v3];return null},set(e){for(let t of this.listeners(r))if(t[Sv]){this.removeListener(r,t);break}typeof e=="function"&&this.addEventListener(r,e,{[Sv]:!0})}})});Ze.prototype.addEventListener=w3;Ze.prototype.removeEventListener=S3;sA.exports=Ze;function tA(r,e,t,n){let i={allowSynchronousEvents:!0,autoPong:!0,protocolVersion:xv[1],maxPayload:104857600,skipUTF8Validation:!1,perMessageDeflate:!0,followRedirects:!1,maxRedirects:10,...n,socketPath:void 0,hostname:void 0,protocol:void 0,timeout:void 0,method:"GET",host:void 0,path:void 0,port:void 0};if(r._autoPong=i.autoPong,!xv.includes(i.protocolVersion))throw new RangeError(`Unsupported protocol version: ${i.protocolVersion} (supported versions: ${xv.join(", ")})`);let o;if(e instanceof wv)o=e;else try{o=new wv(e)}catch{throw new SyntaxError(`Invalid URL: ${e}`)}o.protocol==="http:"?o.protocol="ws:":o.protocol==="https:"&&(o.protocol="wss:"),r._url=o.href;let s=o.protocol==="wss:",a=o.protocol==="ws+unix:",c;if(o.protocol!=="ws:"&&!s&&!a?c=`The URL's protocol must be one of "ws:", "wss:", "http:", "https", or "ws+unix:"`:a&&!o.pathname?c="The URL's pathname is empty":o.hash&&(c="The URL contains a fragment identifier"),c){let m=new SyntaxError(c);if(r._redirects===0)throw m;Gf(r,m);return}let u=s?443:80,l=h3(16).toString("base64"),p=s?p3.request:d3.request,d=new Set,f;if(i.createConnection=i.createConnection||(s?R3:E3),i.defaultPort=i.defaultPort||u,i.port=o.port||u,i.host=o.hostname.startsWith("[")?o.hostname.slice(1,-1):o.hostname,i.headers={...i.headers,"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":l,Connection:"Upgrade",Upgrade:"websocket"},i.path=o.pathname+o.search,i.timeout=i.handshakeTimeout,i.perMessageDeflate&&(f=new no(i.perMessageDeflate!==!0?i.perMessageDeflate:{},!1,i.maxPayload),i.headers["Sec-WebSocket-Extensions"]=x3({[no.extensionName]:f.offer()})),t.length){for(let m of t){if(typeof m!="string"||!T3.test(m)||d.has(m))throw new SyntaxError("An invalid or duplicated subprotocol was specified");d.add(m)}i.headers["Sec-WebSocket-Protocol"]=t.join(",")}if(i.origin&&(i.protocolVersion<13?i.headers["Sec-WebSocket-Origin"]=i.origin:i.headers.Origin=i.origin),(o.username||o.password)&&(i.auth=`${o.username}:${o.password}`),a){let m=i.path.split(":");i.socketPath=m[0],i.path=m[1]}let h;if(i.followRedirects){if(r._redirects===0){r._originalIpc=a,r._originalSecure=s,r._originalHostOrSocketPath=a?i.socketPath:o.host;let m=n&&n.headers;if(n={...n,headers:{}},m)for(let[b,I]of Object.entries(m))n.headers[b.toLowerCase()]=I}else if(r.listenerCount("redirect")===0){let m=a?r._originalIpc?i.socketPath===r._originalHostOrSocketPath:!1:r._originalIpc?!1:o.host===r._originalHostOrSocketPath;(!m||r._originalSecure&&!s)&&(delete i.headers.authorization,delete i.headers.cookie,m||delete i.headers.host,i.auth=void 0)}i.auth&&!n.headers.authorization&&(n.headers.authorization="Basic "+Buffer.from(i.auth).toString("base64")),h=r._req=p(i),r._redirects&&r.emit("redirect",r.url,h)}else h=r._req=p(i);i.timeout&&h.on("timeout",()=>{hr(r,h,"Opening handshake has timed out")}),h.on("error",m=>{h===null||h[eA]||(h=r._req=null,Gf(r,m))}),h.on("response",m=>{let b=m.headers.location,I=m.statusCode;if(b&&i.followRedirects&&I>=300&&I<400){if(++r._redirects>i.maxRedirects){hr(r,h,"Maximum redirects exceeded");return}h.abort();let D;try{D=new wv(b,e)}catch{let Z=new SyntaxError(`Invalid URL: ${b}`);Gf(r,Z);return}tA(r,D,t,n)}else r.emit("unexpected-response",h,m)||hr(r,h,`Unexpected server response: ${m.statusCode}`)}),h.on("upgrade",(m,b,I)=>{if(r.emit("upgrade",m),r.readyState!==Ze.CONNECTING)return;h=r._req=null;let D=m.headers.upgrade;if(D===void 0||D.toLowerCase()!=="websocket"){hr(r,b,"Invalid Upgrade header");return}let B=m3("sha1").update(l+b3).digest("base64");if(m.headers["sec-websocket-accept"]!==B){hr(r,b,"Invalid Sec-WebSocket-Accept header");return}let Z=m.headers["sec-websocket-protocol"],F;if(Z!==void 0?d.size?d.has(Z)||(F="Server sent an invalid subprotocol"):F="Server sent a subprotocol but none was requested":d.size&&(F="Server sent no subprotocol"),F){hr(r,b,F);return}Z&&(r._protocol=Z);let X=m.headers["sec-websocket-extensions"];if(X!==void 0){if(!f){hr(r,b,"Server sent a Sec-WebSocket-Extensions header but no extension was requested");return}let H;try{H=I3(X)}catch{hr(r,b,"Invalid Sec-WebSocket-Extensions header");return}let j=Object.keys(H);if(j.length!==1||j[0]!==no.extensionName){hr(r,b,"Server indicated an extension that was not requested");return}try{f.accept(H[no.extensionName])}catch{hr(r,b,"Invalid Sec-WebSocket-Extensions header");return}r._extensions[no.extensionName]=f}r.setSocket(b,I,{allowSynchronousEvents:i.allowSynchronousEvents,generateMask:i.generateMask,maxPayload:i.maxPayload,skipUTF8Validation:i.skipUTF8Validation})}),i.finishRequest?i.finishRequest(h,r):h.end()}function Gf(r,e){r._readyState=Ze.CLOSING,r.emit("error",e),r.emitClose()}function E3(r){return r.path=r.socketPath,QR.connect(r)}function R3(r){return r.path=void 0,!r.servername&&r.servername!==""&&(r.servername=QR.isIP(r.host)?"":r.host),f3.connect(r)}function hr(r,e,t){r._readyState=Ze.CLOSING;let n=new Error(t);Error.captureStackTrace(n,hr),e.setHeader?(e[eA]=!0,e.abort(),e.socket&&!e.socket.destroyed&&e.socket.destroy(),process.nextTick(Gf,r,n)):(e.destroy(n),e.once("error",r.emit.bind(r,"error")),e.once("close",r.emitClose.bind(r)))}function Iv(r,e,t){if(e){let n=C3(e).length;r._socket?r._sender._bufferedBytes+=n:r._bufferedAmount+=n}if(t){let n=new Error(`WebSocket is not open: readyState ${r.readyState} (${xi[r.readyState]})`);process.nextTick(t,n)}}function A3(r,e){let t=this[Mt];t._closeFrameReceived=!0,t._closeMessage=e,t._closeCode=r,t._socket[Mt]!==void 0&&(t._socket.removeListener("data",zf),process.nextTick(rA,t._socket),r===1005?t.close():t.close(r,e))}function k3(){let r=this[Mt];r.isPaused||r._socket.resume()}function D3(r){let e=this[Mt];e._socket[Mt]!==void 0&&(e._socket.removeListener("data",zf),process.nextTick(rA,e._socket),e.close(r[_3])),e.emit("error",r)}function XR(){this[Mt].emitClose()}function O3(r,e){this[Mt].emit("message",r,e)}function M3(r){let e=this[Mt];e._autoPong&&e.pong(r,!this._isServer,ZR),e.emit("ping",r)}function N3(r){this[Mt].emit("pong",r)}function rA(r){r.resume()}function nA(){let r=this[Mt];this.removeListener("close",nA),this.removeListener("data",zf),this.removeListener("end",iA),r._readyState=Ze.CLOSING;let e;!this._readableState.endEmitted&&!r._closeFrameReceived&&!r._receiver._writableState.errorEmitted&&(e=r._socket.read())!==null&&r._receiver.write(e),r._receiver.end(),this[Mt]=void 0,clearTimeout(r._closeTimer),r._receiver._writableState.finished||r._receiver._writableState.errorEmitted?r.emitClose():(r._receiver.on("error",XR),r._receiver.on("finish",XR))}function zf(r){this[Mt]._receiver.write(r)||this.pause()}function iA(){let r=this[Mt];r._readyState=Ze.CLOSING,r._receiver.end(),this.end()}function oA(){let r=this[Mt];this.removeListener("error",oA),this.on("error",ZR),r&&(r._readyState=Ze.CLOSING,this.destroy())}});var cA=_((Iie,aA)=>{"use strict";var{tokenChars:L3}=ll();function F3(r){let e=new Set,t=-1,n=-1,i=0;for(i;i<r.length;i++){let s=r.charCodeAt(i);if(n===-1&&L3[s]===1)t===-1&&(t=i);else if(i!==0&&(s===32||s===9))n===-1&&t!==-1&&(n=i);else if(s===44){if(t===-1)throw new SyntaxError(`Unexpected character at index ${i}`);n===-1&&(n=i);let a=r.slice(t,n);if(e.has(a))throw new SyntaxError(`The "${a}" subprotocol is duplicated`);e.add(a),t=n=-1}else throw new SyntaxError(`Unexpected character at index ${i}`)}if(t===-1||n!==-1)throw new SyntaxError("Unexpected end of input");let o=r.slice(t,i);if(e.has(o))throw new SyntaxError(`The "${o}" subprotocol is duplicated`);return e.add(o),e}aA.exports={parse:F3}});var mA=_((Pie,hA)=>{"use strict";var B3=g("events"),Kf=g("http"),{Duplex:Cie}=g("stream"),{createHash:U3}=g("crypto"),uA=_v(),ds=ul(),j3=cA(),q3=Cv(),{GUID:W3,kWebSocket:V3}=to(),$3=/^[+/0-9A-Za-z]{22}==$/,lA=0,pA=1,fA=2,Pv=class extends B3{constructor(e,t){if(super(),e={allowSynchronousEvents:!0,autoPong:!0,maxPayload:100*1024*1024,skipUTF8Validation:!1,perMessageDeflate:!1,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null,WebSocket:q3,...e},e.port==null&&!e.server&&!e.noServer||e.port!=null&&(e.server||e.noServer)||e.server&&e.noServer)throw new TypeError('One and only one of the "port", "server", or "noServer" options must be specified');if(e.port!=null?(this._server=Kf.createServer((n,i)=>{let o=Kf.STATUS_CODES[426];i.writeHead(426,{"Content-Length":o.length,"Content-Type":"text/plain"}),i.end(o)}),this._server.listen(e.port,e.host,e.backlog,t)):e.server&&(this._server=e.server),this._server){let n=this.emit.bind(this,"connection");this._removeListeners=H3(this._server,{listening:this.emit.bind(this,"listening"),error:this.emit.bind(this,"error"),upgrade:(i,o,s)=>{this.handleUpgrade(i,o,s,n)}})}e.perMessageDeflate===!0&&(e.perMessageDeflate={}),e.clientTracking&&(this.clients=new Set,this._shouldEmitClose=!1),this.options=e,this._state=lA}address(){if(this.options.noServer)throw new Error('The server is operating in "noServer" mode');return this._server?this._server.address():null}close(e){if(this._state===fA){e&&this.once("close",()=>{e(new Error("The server is not running"))}),process.nextTick(hl,this);return}if(e&&this.once("close",e),this._state!==pA)if(this._state=pA,this.options.noServer||this.options.server)this._server&&(this._removeListeners(),this._removeListeners=this._server=null),this.clients?this.clients.size?this._shouldEmitClose=!0:process.nextTick(hl,this):process.nextTick(hl,this);else{let t=this._server;this._removeListeners(),this._removeListeners=this._server=null,t.close(()=>{hl(this)})}}shouldHandle(e){if(this.options.path){let t=e.url.indexOf("?");if((t!==-1?e.url.slice(0,t):e.url)!==this.options.path)return!1}return!0}handleUpgrade(e,t,n,i){t.on("error",dA);let o=e.headers["sec-websocket-key"],s=e.headers.upgrade,a=+e.headers["sec-websocket-version"];if(e.method!=="GET"){fs(this,e,t,405,"Invalid HTTP method");return}if(s===void 0||s.toLowerCase()!=="websocket"){fs(this,e,t,400,"Invalid Upgrade header");return}if(o===void 0||!$3.test(o)){fs(this,e,t,400,"Missing or invalid Sec-WebSocket-Key header");return}if(a!==8&&a!==13){fs(this,e,t,400,"Missing or invalid Sec-WebSocket-Version header");return}if(!this.shouldHandle(e)){ml(t,400);return}let c=e.headers["sec-websocket-protocol"],u=new Set;if(c!==void 0)try{u=j3.parse(c)}catch{fs(this,e,t,400,"Invalid Sec-WebSocket-Protocol header");return}let l=e.headers["sec-websocket-extensions"],p={};if(this.options.perMessageDeflate&&l!==void 0){let d=new ds(this.options.perMessageDeflate,!0,this.options.maxPayload);try{let f=uA.parse(l);f[ds.extensionName]&&(d.accept(f[ds.extensionName]),p[ds.extensionName]=d)}catch{fs(this,e,t,400,"Invalid or unacceptable Sec-WebSocket-Extensions header");return}}if(this.options.verifyClient){let d={origin:e.headers[`${a===8?"sec-websocket-origin":"origin"}`],secure:!!(e.socket.authorized||e.socket.encrypted),req:e};if(this.options.verifyClient.length===2){this.options.verifyClient(d,(f,h,m,b)=>{if(!f)return ml(t,h||401,m,b);this.completeUpgrade(p,o,u,e,t,n,i)});return}if(!this.options.verifyClient(d))return ml(t,401)}this.completeUpgrade(p,o,u,e,t,n,i)}completeUpgrade(e,t,n,i,o,s,a){if(!o.readable||!o.writable)return o.destroy();if(o[V3])throw new Error("server.handleUpgrade() was called more than once with the same socket, possibly due to a misconfiguration");if(this._state>lA)return ml(o,503);let u=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${U3("sha1").update(t+W3).digest("base64")}`],l=new this.options.WebSocket(null,void 0,this.options);if(n.size){let p=this.options.handleProtocols?this.options.handleProtocols(n,i):n.values().next().value;p&&(u.push(`Sec-WebSocket-Protocol: ${p}`),l._protocol=p)}if(e[ds.extensionName]){let p=e[ds.extensionName].params,d=uA.format({[ds.extensionName]:[p]});u.push(`Sec-WebSocket-Extensions: ${d}`),l._extensions=e}this.emit("headers",u,i),o.write(u.concat(`\r
`).join(`\r
`)),o.removeListener("error",dA),l.setSocket(o,s,{allowSynchronousEvents:this.options.allowSynchronousEvents,maxPayload:this.options.maxPayload,skipUTF8Validation:this.options.skipUTF8Validation}),this.clients&&(this.clients.add(l),l.on("close",()=>{this.clients.delete(l),this._shouldEmitClose&&!this.clients.size&&process.nextTick(hl,this)})),a(l,i)}};hA.exports=Pv;function H3(r,e){for(let t of Object.keys(e))r.on(t,e[t]);return function(){for(let n of Object.keys(e))r.removeListener(n,e[n])}}function hl(r){r._state=fA,r.emit("close")}function dA(){this.destroy()}function ml(r,e,t,n){t=t||Kf.STATUS_CODES[e],n={Connection:"close","Content-Type":"text/html","Content-Length":Buffer.byteLength(t),...n},r.once("finish",r.destroy),r.end(`HTTP/1.1 ${e} ${Kf.STATUS_CODES[e]}\r
`+Object.keys(n).map(i=>`${i}: ${n[i]}`).join(`\r
`)+`\r
\r
`+t)}function fs(r,e,t,n,i){if(r.listenerCount("wsClientError")){let o=new Error(i);Error.captureStackTrace(o,fs),r.emit("wsClientError",o,t,e)}else ml(t,n,i)}});var kA=_((poe,AA)=>{"use strict";AA.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var OA=_((doe,DA)=>{DA.exports=function(e){return!e||typeof e=="string"?!1:e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&e.constructor.name!=="String")}});var LA=_((foe,NA)=>{"use strict";var e4=OA(),t4=Array.prototype.concat,r4=Array.prototype.slice,MA=NA.exports=function(e){for(var t=[],n=0,i=e.length;n<i;n++){var o=e[n];e4(o)?t=t4.call(t,r4.call(o)):t.push(o)}return t};MA.wrap=function(r){return function(){return r(MA(arguments))}}});var jA=_((hoe,UA)=>{var bl=kA(),vl=LA(),FA=Object.hasOwnProperty,BA={};for(eh in bl)FA.call(bl,eh)&&(BA[bl[eh]]=eh);var eh,mr=UA.exports={to:{},get:{}};mr.get=function(r){var e=r.substring(0,3).toLowerCase(),t,n;switch(e){case"hsl":t=mr.get.hsl(r),n="hsl";break;case"hwb":t=mr.get.hwb(r),n="hwb";break;default:t=mr.get.rgb(r),n="rgb";break}return t?{model:n,value:t}:null};mr.get.rgb=function(r){if(!r)return null;var e=/^#([a-f0-9]{3,4})$/i,t=/^#([a-f0-9]{6})([a-f0-9]{2})?$/i,n=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,i=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/,o=/^(\w+)$/,s=[0,0,0,1],a,c,u;if(a=r.match(t)){for(u=a[2],a=a[1],c=0;c<3;c++){var l=c*2;s[c]=parseInt(a.slice(l,l+2),16)}u&&(s[3]=parseInt(u,16)/255)}else if(a=r.match(e)){for(a=a[1],u=a[3],c=0;c<3;c++)s[c]=parseInt(a[c]+a[c],16);u&&(s[3]=parseInt(u+u,16)/255)}else if(a=r.match(n)){for(c=0;c<3;c++)s[c]=parseInt(a[c+1],0);a[4]&&(a[5]?s[3]=parseFloat(a[4])*.01:s[3]=parseFloat(a[4]))}else if(a=r.match(i)){for(c=0;c<3;c++)s[c]=Math.round(parseFloat(a[c+1])*2.55);a[4]&&(a[5]?s[3]=parseFloat(a[4])*.01:s[3]=parseFloat(a[4]))}else return(a=r.match(o))?a[1]==="transparent"?[0,0,0,0]:FA.call(bl,a[1])?(s=bl[a[1]],s[3]=1,s):null:null;for(c=0;c<3;c++)s[c]=so(s[c],0,255);return s[3]=so(s[3],0,1),s};mr.get.hsl=function(r){if(!r)return null;var e=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=r.match(e);if(t){var n=parseFloat(t[4]),i=(parseFloat(t[1])%360+360)%360,o=so(parseFloat(t[2]),0,100),s=so(parseFloat(t[3]),0,100),a=so(isNaN(n)?1:n,0,1);return[i,o,s,a]}return null};mr.get.hwb=function(r){if(!r)return null;var e=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,t=r.match(e);if(t){var n=parseFloat(t[4]),i=(parseFloat(t[1])%360+360)%360,o=so(parseFloat(t[2]),0,100),s=so(parseFloat(t[3]),0,100),a=so(isNaN(n)?1:n,0,1);return[i,o,s,a]}return null};mr.to.hex=function(){var r=vl(arguments);return"#"+th(r[0])+th(r[1])+th(r[2])+(r[3]<1?th(Math.round(r[3]*255)):"")};mr.to.rgb=function(){var r=vl(arguments);return r.length<4||r[3]===1?"rgb("+Math.round(r[0])+", "+Math.round(r[1])+", "+Math.round(r[2])+")":"rgba("+Math.round(r[0])+", "+Math.round(r[1])+", "+Math.round(r[2])+", "+r[3]+")"};mr.to.rgb.percent=function(){var r=vl(arguments),e=Math.round(r[0]/255*100),t=Math.round(r[1]/255*100),n=Math.round(r[2]/255*100);return r.length<4||r[3]===1?"rgb("+e+"%, "+t+"%, "+n+"%)":"rgba("+e+"%, "+t+"%, "+n+"%, "+r[3]+")"};mr.to.hsl=function(){var r=vl(arguments);return r.length<4||r[3]===1?"hsl("+r[0]+", "+r[1]+"%, "+r[2]+"%)":"hsla("+r[0]+", "+r[1]+"%, "+r[2]+"%, "+r[3]+")"};mr.to.hwb=function(){var r=vl(arguments),e="";return r.length>=4&&r[3]!==1&&(e=", "+r[3]),"hwb("+r[0]+", "+r[1]+"%, "+r[2]+"%"+e+")"};mr.to.keyword=function(r){return BA[r.slice(0,3)]};function so(r,e,t){return Math.min(Math.max(e,r),t)}function th(r){var e=Math.round(r).toString(16).toUpperCase();return e.length<2?"0"+e:e}});var WA=_((moe,qA)=>{"use strict";qA.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}});var Dv=_((goe,$A)=>{var _l=WA(),VA={};for(let r of Object.keys(_l))VA[_l[r]]=r;var J={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};$A.exports=J;for(let r of Object.keys(J)){if(!("channels"in J[r]))throw new Error("missing channels property: "+r);if(!("labels"in J[r]))throw new Error("missing channel labels property: "+r);if(J[r].labels.length!==J[r].channels)throw new Error("channel and label counts mismatch: "+r);let{channels:e,labels:t}=J[r];delete J[r].channels,delete J[r].labels,Object.defineProperty(J[r],"channels",{value:e}),Object.defineProperty(J[r],"labels",{value:t})}J.rgb.hsl=function(r){let e=r[0]/255,t=r[1]/255,n=r[2]/255,i=Math.min(e,t,n),o=Math.max(e,t,n),s=o-i,a,c;o===i?a=0:e===o?a=(t-n)/s:t===o?a=2+(n-e)/s:n===o&&(a=4+(e-t)/s),a=Math.min(a*60,360),a<0&&(a+=360);let u=(i+o)/2;return o===i?c=0:u<=.5?c=s/(o+i):c=s/(2-o-i),[a,c*100,u*100]};J.rgb.hsv=function(r){let e,t,n,i,o,s=r[0]/255,a=r[1]/255,c=r[2]/255,u=Math.max(s,a,c),l=u-Math.min(s,a,c),p=function(d){return(u-d)/6/l+1/2};return l===0?(i=0,o=0):(o=l/u,e=p(s),t=p(a),n=p(c),s===u?i=n-t:a===u?i=1/3+e-n:c===u&&(i=2/3+t-e),i<0?i+=1:i>1&&(i-=1)),[i*360,o*100,u*100]};J.rgb.hwb=function(r){let e=r[0],t=r[1],n=r[2],i=J.rgb.hsl(r)[0],o=1/255*Math.min(e,Math.min(t,n));return n=1-1/255*Math.max(e,Math.max(t,n)),[i,o*100,n*100]};J.rgb.cmyk=function(r){let e=r[0]/255,t=r[1]/255,n=r[2]/255,i=Math.min(1-e,1-t,1-n),o=(1-e-i)/(1-i)||0,s=(1-t-i)/(1-i)||0,a=(1-n-i)/(1-i)||0;return[o*100,s*100,a*100,i*100]};function n4(r,e){return(r[0]-e[0])**2+(r[1]-e[1])**2+(r[2]-e[2])**2}J.rgb.keyword=function(r){let e=VA[r];if(e)return e;let t=1/0,n;for(let i of Object.keys(_l)){let o=_l[i],s=n4(r,o);s<t&&(t=s,n=i)}return n};J.keyword.rgb=function(r){return _l[r]};J.rgb.xyz=function(r){let e=r[0]/255,t=r[1]/255,n=r[2]/255;e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92;let i=e*.4124+t*.3576+n*.1805,o=e*.2126+t*.7152+n*.0722,s=e*.0193+t*.1192+n*.9505;return[i*100,o*100,s*100]};J.rgb.lab=function(r){let e=J.rgb.xyz(r),t=e[0],n=e[1],i=e[2];t/=95.047,n/=100,i/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;let o=116*n-16,s=500*(t-n),a=200*(n-i);return[o,s,a]};J.hsl.rgb=function(r){let e=r[0]/360,t=r[1]/100,n=r[2]/100,i,o,s;if(t===0)return s=n*255,[s,s,s];n<.5?i=n*(1+t):i=n+t-n*t;let a=2*n-i,c=[0,0,0];for(let u=0;u<3;u++)o=e+1/3*-(u-1),o<0&&o++,o>1&&o--,6*o<1?s=a+(i-a)*6*o:2*o<1?s=i:3*o<2?s=a+(i-a)*(2/3-o)*6:s=a,c[u]=s*255;return c};J.hsl.hsv=function(r){let e=r[0],t=r[1]/100,n=r[2]/100,i=t,o=Math.max(n,.01);n*=2,t*=n<=1?n:2-n,i*=o<=1?o:2-o;let s=(n+t)/2,a=n===0?2*i/(o+i):2*t/(n+t);return[e,a*100,s*100]};J.hsv.rgb=function(r){let e=r[0]/60,t=r[1]/100,n=r[2]/100,i=Math.floor(e)%6,o=e-Math.floor(e),s=255*n*(1-t),a=255*n*(1-t*o),c=255*n*(1-t*(1-o));switch(n*=255,i){case 0:return[n,c,s];case 1:return[a,n,s];case 2:return[s,n,c];case 3:return[s,a,n];case 4:return[c,s,n];case 5:return[n,s,a]}};J.hsv.hsl=function(r){let e=r[0],t=r[1]/100,n=r[2]/100,i=Math.max(n,.01),o,s;s=(2-t)*n;let a=(2-t)*i;return o=t*i,o/=a<=1?a:2-a,o=o||0,s/=2,[e,o*100,s*100]};J.hwb.rgb=function(r){let e=r[0]/360,t=r[1]/100,n=r[2]/100,i=t+n,o;i>1&&(t/=i,n/=i);let s=Math.floor(6*e),a=1-n;o=6*e-s,(s&1)!==0&&(o=1-o);let c=t+o*(a-t),u,l,p;switch(s){default:case 6:case 0:u=a,l=c,p=t;break;case 1:u=c,l=a,p=t;break;case 2:u=t,l=a,p=c;break;case 3:u=t,l=c,p=a;break;case 4:u=c,l=t,p=a;break;case 5:u=a,l=t,p=c;break}return[u*255,l*255,p*255]};J.cmyk.rgb=function(r){let e=r[0]/100,t=r[1]/100,n=r[2]/100,i=r[3]/100,o=1-Math.min(1,e*(1-i)+i),s=1-Math.min(1,t*(1-i)+i),a=1-Math.min(1,n*(1-i)+i);return[o*255,s*255,a*255]};J.xyz.rgb=function(r){let e=r[0]/100,t=r[1]/100,n=r[2]/100,i,o,s;return i=e*3.2406+t*-1.5372+n*-.4986,o=e*-.9689+t*1.8758+n*.0415,s=e*.0557+t*-.204+n*1.057,i=i>.0031308?1.055*i**(1/2.4)-.055:i*12.92,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,i=Math.min(Math.max(0,i),1),o=Math.min(Math.max(0,o),1),s=Math.min(Math.max(0,s),1),[i*255,o*255,s*255]};J.xyz.lab=function(r){let e=r[0],t=r[1],n=r[2];e/=95.047,t/=100,n/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,t=t>.008856?t**(1/3):7.787*t+16/116,n=n>.008856?n**(1/3):7.787*n+16/116;let i=116*t-16,o=500*(e-t),s=200*(t-n);return[i,o,s]};J.lab.xyz=function(r){let e=r[0],t=r[1],n=r[2],i,o,s;o=(e+16)/116,i=t/500+o,s=o-n/200;let a=o**3,c=i**3,u=s**3;return o=a>.008856?a:(o-16/116)/7.787,i=c>.008856?c:(i-16/116)/7.787,s=u>.008856?u:(s-16/116)/7.787,i*=95.047,o*=100,s*=108.883,[i,o,s]};J.lab.lch=function(r){let e=r[0],t=r[1],n=r[2],i;i=Math.atan2(n,t)*360/2/Math.PI,i<0&&(i+=360);let s=Math.sqrt(t*t+n*n);return[e,s,i]};J.lch.lab=function(r){let e=r[0],t=r[1],i=r[2]/360*2*Math.PI,o=t*Math.cos(i),s=t*Math.sin(i);return[e,o,s]};J.rgb.ansi16=function(r,e=null){let[t,n,i]=r,o=e===null?J.rgb.hsv(r)[2]:e;if(o=Math.round(o/50),o===0)return 30;let s=30+(Math.round(i/255)<<2|Math.round(n/255)<<1|Math.round(t/255));return o===2&&(s+=60),s};J.hsv.ansi16=function(r){return J.rgb.ansi16(J.hsv.rgb(r),r[2])};J.rgb.ansi256=function(r){let e=r[0],t=r[1],n=r[2];return e===t&&t===n?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(t/255*5)+Math.round(n/255*5)};J.ansi16.rgb=function(r){let e=r%10;if(e===0||e===7)return r>50&&(e+=3.5),e=e/10.5*255,[e,e,e];let t=(~~(r>50)+1)*.5,n=(e&1)*t*255,i=(e>>1&1)*t*255,o=(e>>2&1)*t*255;return[n,i,o]};J.ansi256.rgb=function(r){if(r>=232){let o=(r-232)*10+8;return[o,o,o]}r-=16;let e,t=Math.floor(r/36)/5*255,n=Math.floor((e=r%36)/6)/5*255,i=e%6/5*255;return[t,n,i]};J.rgb.hex=function(r){let t=(((Math.round(r[0])&255)<<16)+((Math.round(r[1])&255)<<8)+(Math.round(r[2])&255)).toString(16).toUpperCase();return"000000".substring(t.length)+t};J.hex.rgb=function(r){let e=r.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];let t=e[0];e[0].length===3&&(t=t.split("").map(a=>a+a).join(""));let n=parseInt(t,16),i=n>>16&255,o=n>>8&255,s=n&255;return[i,o,s]};J.rgb.hcg=function(r){let e=r[0]/255,t=r[1]/255,n=r[2]/255,i=Math.max(Math.max(e,t),n),o=Math.min(Math.min(e,t),n),s=i-o,a,c;return s<1?a=o/(1-s):a=0,s<=0?c=0:i===e?c=(t-n)/s%6:i===t?c=2+(n-e)/s:c=4+(e-t)/s,c/=6,c%=1,[c*360,s*100,a*100]};J.hsl.hcg=function(r){let e=r[1]/100,t=r[2]/100,n=t<.5?2*e*t:2*e*(1-t),i=0;return n<1&&(i=(t-.5*n)/(1-n)),[r[0],n*100,i*100]};J.hsv.hcg=function(r){let e=r[1]/100,t=r[2]/100,n=e*t,i=0;return n<1&&(i=(t-n)/(1-n)),[r[0],n*100,i*100]};J.hcg.rgb=function(r){let e=r[0]/360,t=r[1]/100,n=r[2]/100;if(t===0)return[n*255,n*255,n*255];let i=[0,0,0],o=e%1*6,s=o%1,a=1-s,c=0;switch(Math.floor(o)){case 0:i[0]=1,i[1]=s,i[2]=0;break;case 1:i[0]=a,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=s;break;case 3:i[0]=0,i[1]=a,i[2]=1;break;case 4:i[0]=s,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=a}return c=(1-t)*n,[(t*i[0]+c)*255,(t*i[1]+c)*255,(t*i[2]+c)*255]};J.hcg.hsv=function(r){let e=r[1]/100,t=r[2]/100,n=e+t*(1-e),i=0;return n>0&&(i=e/n),[r[0],i*100,n*100]};J.hcg.hsl=function(r){let e=r[1]/100,n=r[2]/100*(1-e)+.5*e,i=0;return n>0&&n<.5?i=e/(2*n):n>=.5&&n<1&&(i=e/(2*(1-n))),[r[0],i*100,n*100]};J.hcg.hwb=function(r){let e=r[1]/100,t=r[2]/100,n=e+t*(1-e);return[r[0],(n-e)*100,(1-n)*100]};J.hwb.hcg=function(r){let e=r[1]/100,n=1-r[2]/100,i=n-e,o=0;return i<1&&(o=(n-i)/(1-i)),[r[0],i*100,o*100]};J.apple.rgb=function(r){return[r[0]/65535*255,r[1]/65535*255,r[2]/65535*255]};J.rgb.apple=function(r){return[r[0]/255*65535,r[1]/255*65535,r[2]/255*65535]};J.gray.rgb=function(r){return[r[0]/100*255,r[0]/100*255,r[0]/100*255]};J.gray.hsl=function(r){return[0,0,r[0]]};J.gray.hsv=J.gray.hsl;J.gray.hwb=function(r){return[0,100,r[0]]};J.gray.cmyk=function(r){return[0,0,0,r[0]]};J.gray.lab=function(r){return[r[0],0,0]};J.gray.hex=function(r){let e=Math.round(r[0]/100*255)&255,n=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(n.length)+n};J.rgb.gray=function(r){return[(r[0]+r[1]+r[2])/3/255*100]}});var GA=_((yoe,HA)=>{var rh=Dv();function i4(){let r={},e=Object.keys(rh);for(let t=e.length,n=0;n<t;n++)r[e[n]]={distance:-1,parent:null};return r}function o4(r){let e=i4(),t=[r];for(e[r].distance=0;t.length;){let n=t.pop(),i=Object.keys(rh[n]);for(let o=i.length,s=0;s<o;s++){let a=i[s],c=e[a];c.distance===-1&&(c.distance=e[n].distance+1,c.parent=n,t.unshift(a))}}return e}function s4(r,e){return function(t){return e(r(t))}}function a4(r,e){let t=[e[r].parent,r],n=rh[e[r].parent][r],i=e[r].parent;for(;e[i].parent;)t.unshift(e[i].parent),n=s4(rh[e[i].parent][i],n),i=e[i].parent;return n.conversion=t,n}HA.exports=function(r){let e=o4(r),t={},n=Object.keys(e);for(let i=n.length,o=0;o<i;o++){let s=n[o];e[s].parent!==null&&(t[s]=a4(s,e))}return t}});var KA=_((boe,zA)=>{var Ov=Dv(),c4=GA(),ic={},u4=Object.keys(Ov);function l4(r){let e=function(...t){let n=t[0];return n==null?n:(n.length>1&&(t=n),r(t))};return"conversion"in r&&(e.conversion=r.conversion),e}function p4(r){let e=function(...t){let n=t[0];if(n==null)return n;n.length>1&&(t=n);let i=r(t);if(typeof i=="object")for(let o=i.length,s=0;s<o;s++)i[s]=Math.round(i[s]);return i};return"conversion"in r&&(e.conversion=r.conversion),e}u4.forEach(r=>{ic[r]={},Object.defineProperty(ic[r],"channels",{value:Ov[r].channels}),Object.defineProperty(ic[r],"labels",{value:Ov[r].labels});let e=c4(r);Object.keys(e).forEach(n=>{let i=e[n];ic[r][n]=p4(i),ic[r][n].raw=l4(i)})});zA.exports=ic});var XA=_((voe,YA)=>{var oc=jA(),gr=KA(),JA=["keyword","gray","hex"],Mv={};for(let r of Object.keys(gr))Mv[[...gr[r].labels].sort().join("")]=r;var nh={};function gt(r,e){if(!(this instanceof gt))return new gt(r,e);if(e&&e in JA&&(e=null),e&&!(e in gr))throw new Error("Unknown model: "+e);let t,n;if(r==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(r instanceof gt)this.model=r.model,this.color=[...r.color],this.valpha=r.valpha;else if(typeof r=="string"){let i=oc.get(r);if(i===null)throw new Error("Unable to parse color from string: "+r);this.model=i.model,n=gr[this.model].channels,this.color=i.value.slice(0,n),this.valpha=typeof i.value[n]=="number"?i.value[n]:1}else if(r.length>0){this.model=e||"rgb",n=gr[this.model].channels;let i=Array.prototype.slice.call(r,0,n);this.color=Nv(i,n),this.valpha=typeof r[n]=="number"?r[n]:1}else if(typeof r=="number")this.model="rgb",this.color=[r>>16&255,r>>8&255,r&255],this.valpha=1;else{this.valpha=1;let i=Object.keys(r);"alpha"in r&&(i.splice(i.indexOf("alpha"),1),this.valpha=typeof r.alpha=="number"?r.alpha:0);let o=i.sort().join("");if(!(o in Mv))throw new Error("Unable to parse color from object: "+JSON.stringify(r));this.model=Mv[o];let{labels:s}=gr[this.model],a=[];for(t=0;t<s.length;t++)a.push(r[s[t]]);this.color=Nv(a)}if(nh[this.model])for(n=gr[this.model].channels,t=0;t<n;t++){let i=nh[this.model][t];i&&(this.color[t]=i(this.color[t]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}gt.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(r){let e=this.model in oc.to?this:this.rgb();e=e.round(typeof r=="number"?r:1);let t=e.valpha===1?e.color:[...e.color,this.valpha];return oc.to[e.model](t)},percentString(r){let e=this.rgb().round(typeof r=="number"?r:1),t=e.valpha===1?e.color:[...e.color,this.valpha];return oc.to.rgb.percent(t)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){let r={},{channels:e}=gr[this.model],{labels:t}=gr[this.model];for(let n=0;n<e;n++)r[t[n]]=this.color[n];return this.valpha!==1&&(r.alpha=this.valpha),r},unitArray(){let r=this.rgb().color;return r[0]/=255,r[1]/=255,r[2]/=255,this.valpha!==1&&r.push(this.valpha),r},unitObject(){let r=this.rgb().object();return r.r/=255,r.g/=255,r.b/=255,this.valpha!==1&&(r.alpha=this.valpha),r},round(r){return r=Math.max(r||0,0),new gt([...this.color.map(f4(r)),this.valpha],this.model)},alpha(r){return r!==void 0?new gt([...this.color,Math.max(0,Math.min(1,r))],this.model):this.valpha},red:ze("rgb",0,lt(255)),green:ze("rgb",1,lt(255)),blue:ze("rgb",2,lt(255)),hue:ze(["hsl","hsv","hsl","hwb","hcg"],0,r=>(r%360+360)%360),saturationl:ze("hsl",1,lt(100)),lightness:ze("hsl",2,lt(100)),saturationv:ze("hsv",1,lt(100)),value:ze("hsv",2,lt(100)),chroma:ze("hcg",1,lt(100)),gray:ze("hcg",2,lt(100)),white:ze("hwb",1,lt(100)),wblack:ze("hwb",2,lt(100)),cyan:ze("cmyk",0,lt(100)),magenta:ze("cmyk",1,lt(100)),yellow:ze("cmyk",2,lt(100)),black:ze("cmyk",3,lt(100)),x:ze("xyz",0,lt(95.047)),y:ze("xyz",1,lt(100)),z:ze("xyz",2,lt(108.833)),l:ze("lab",0,lt(100)),a:ze("lab",1),b:ze("lab",2),keyword(r){return r!==void 0?new gt(r):gr[this.model].keyword(this.color)},hex(r){return r!==void 0?new gt(r):oc.to.hex(this.rgb().round().color)},hexa(r){if(r!==void 0)return new gt(r);let e=this.rgb().round().color,t=Math.round(this.valpha*255).toString(16).toUpperCase();return t.length===1&&(t="0"+t),oc.to.hex(e)+t},rgbNumber(){let r=this.rgb().color;return(r[0]&255)<<16|(r[1]&255)<<8|r[2]&255},luminosity(){let r=this.rgb().color,e=[];for(let[t,n]of r.entries()){let i=n/255;e[t]=i<=.04045?i/12.92:((i+.055)/1.055)**2.4}return .2126*e[0]+.7152*e[1]+.0722*e[2]},contrast(r){let e=this.luminosity(),t=r.luminosity();return e>t?(e+.05)/(t+.05):(t+.05)/(e+.05)},level(r){let e=this.contrast(r);return e>=7?"AAA":e>=4.5?"AA":""},isDark(){let r=this.rgb().color;return(r[0]*2126+r[1]*7152+r[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){let r=this.rgb();for(let e=0;e<3;e++)r.color[e]=255-r.color[e];return r},lighten(r){let e=this.hsl();return e.color[2]+=e.color[2]*r,e},darken(r){let e=this.hsl();return e.color[2]-=e.color[2]*r,e},saturate(r){let e=this.hsl();return e.color[1]+=e.color[1]*r,e},desaturate(r){let e=this.hsl();return e.color[1]-=e.color[1]*r,e},whiten(r){let e=this.hwb();return e.color[1]+=e.color[1]*r,e},blacken(r){let e=this.hwb();return e.color[2]+=e.color[2]*r,e},grayscale(){let r=this.rgb().color,e=r[0]*.3+r[1]*.59+r[2]*.11;return gt.rgb(e,e,e)},fade(r){return this.alpha(this.valpha-this.valpha*r)},opaquer(r){return this.alpha(this.valpha+this.valpha*r)},rotate(r){let e=this.hsl(),t=e.color[0];return t=(t+r)%360,t=t<0?360+t:t,e.color[0]=t,e},mix(r,e){if(!r||!r.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof r);let t=r.rgb(),n=this.rgb(),i=e===void 0?.5:e,o=2*i-1,s=t.alpha()-n.alpha(),a=((o*s===-1?o:(o+s)/(1+o*s))+1)/2,c=1-a;return gt.rgb(a*t.red()+c*n.red(),a*t.green()+c*n.green(),a*t.blue()+c*n.blue(),t.alpha()*i+n.alpha()*(1-i))}};for(let r of Object.keys(gr)){if(JA.includes(r))continue;let{channels:e}=gr[r];gt.prototype[r]=function(...t){return this.model===r?new gt(this):t.length>0?new gt(t,r):new gt([...h4(gr[this.model][r].raw(this.color)),this.valpha],r)},gt[r]=function(...t){let n=t[0];return typeof n=="number"&&(n=Nv(t,e)),new gt(n,r)}}function d4(r,e){return Number(r.toFixed(e))}function f4(r){return function(e){return d4(e,r)}}function ze(r,e,t){r=Array.isArray(r)?r:[r];for(let n of r)(nh[n]||(nh[n]=[]))[e]=t;return r=r[0],function(n){let i;return n!==void 0?(t&&(n=t(n)),i=this[r](),i.color[e]=n,i):(i=this[r]().color[e],t&&(i=t(i)),i)}}function lt(r){return function(e){return Math.max(0,Math.min(r,e))}}function h4(r){return Array.isArray(r)?r:[r]}function Nv(r,e){for(let t=0;t<e;t++)typeof r[t]!="number"&&(r[t]=0);return r}YA.exports=gt});var Pi=_(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.findWindowsCandidates=Lt.sort=Lt.preferredEdgePath=Lt.preferredFirefoxPath=Lt.preferredChromePath=Lt.escapeRegexSpecialChars=Lt.canAccess=void 0;var K4=g("path");async function Al({access:r},e){if(!e)return!1;try{return await r(e),!0}catch{return!1}}Lt.canAccess=Al;var J4="/\\.?*()^${}|[]+";function Y4(r,e){let t=J4.split("").filter(i=>!e||e.indexOf(i)<0).join("").replace(/[\\\]]/g,"\\$&"),n=new RegExp(`[${t}]`,"g");return r.replace(n,"\\$&")}Lt.escapeRegexSpecialChars=Y4;async function X4(r,e){if(await Al(r,e.CHROME_PATH))return e.CHROME_PATH}Lt.preferredChromePath=X4;async function Q4(r,e){if(await Al(r,e.FIREFOX_PATH))return e.FIREFOX_PATH}Lt.preferredFirefoxPath=Q4;async function Z4(r,e){if(await Al(r,e.EDGE_PATH))return e.EDGE_PATH}Lt.preferredEdgePath=Z4;function ez(r,e){return[...r].filter(n=>!!n).map(n=>{let i=e.find(o=>o.regex.test(n));return i?{path:n,weight:i.weight,quality:i.quality}:{path:n,weight:10,quality:"dev"}}).sort((n,i)=>i.weight-n.weight).map(n=>({path:n.path,quality:n.quality}))}Lt.sort=ez;async function tz(r,e,t){let n=[r.LOCALAPPDATA,r.PROGRAMFILES,r["PROGRAMFILES(X86)"]].filter(o=>!!o),i=[];for(let o of n)for(let s of t){let a=K4.win32.join(o,s.name);i.push(Al(e,a).then(c=>c?{path:a,quality:s.type}:void 0))}return(await Promise.all(i)).filter(o=>!!o)}Lt.findWindowsCandidates=tz});var Lh=_(Nh=>{"use strict";Object.defineProperty(Nh,"__esModule",{value:!0});Nh.DarwinFinderBase=void 0;var rz=g("path"),nz=g("fs"),y_=Pi(),Xk=/( \(0x[a-f0-9]+\))/,b_=class{constructor(e=process.env,t=nz.promises,n=n){this.env=e,this.fs=t,this.execa=n,this.lsRegisterCommand="/System/Library/Frameworks/CoreServices.framework/Versions/A/Frameworks/LaunchServices.framework/Versions/A/Support/lsregister -dump",this.wellKnownPaths=[]}async findWhere(e){for(let t of this.wellKnownPaths)if(e(t)&&await(0,y_.canAccess)(this.fs,t.path))return t;return(await this.findAll()).find(e)}findAll(){var e;return(e=this.foundAll)!==null&&e!==void 0||(this.foundAll=this.findAllInner()),this.foundAll}async findLaunchRegisteredApps(e,t,n){let{stdout:i}=await this.execa.command(`${this.lsRegisterCommand} | awk 'tolower($0) ~ /${e.toLowerCase()}${Xk.source}?$/ { $1=""; print $0 }'`,{shell:!0,stdio:"pipe"}),o=[...t,...i.split(`
`).map(c=>c.trim().replace(Xk,""))].filter(c=>!!c),s=this.getPreferredPath();s&&o.push(s);let a=new Set;for(let c of o)for(let u of n){let l=rz.posix.join(c.trim(),u);try{await this.fs.access(l),a.add(l)}catch{}}return a}createPriorities(e){let t=this.env.HOME&&(0,y_.escapeRegexSpecialChars)(this.env.HOME),n=this.getPreferredPath(),i=e.reduce((o,s)=>[...o,{regex:new RegExp(`^/Applications/.*${s.name}`),weight:s.weight+100,quality:s.quality},{regex:new RegExp(`^${t}/Applications/.*${s.name}`),weight:s.weight,quality:s.quality},{regex:new RegExp(`^/Volumes/.*${s.name}`),weight:s.weight-100,quality:s.quality}],[]);return n&&i.unshift({regex:new RegExp((0,y_.escapeRegexSpecialChars)(n)),weight:151,quality:"custom"}),i}};Nh.DarwinFinderBase=b_});var Qk=_(Fh=>{"use strict";Object.defineProperty(Fh,"__esModule",{value:!0});Fh.DarwinChromeBrowserFinder=void 0;var iz=Pi(),oz=Lh(),v_=class extends oz.DarwinFinderBase{constructor(){super(...arguments),this.wellKnownPaths=[{path:"/Applications/Google Chrome.app/Contents/MacOS/Google Chrome",quality:"stable"},{path:"/Applications/Google Chrome Canary.app/Contents/MacOS/Google Chrome Canary",quality:"canary"},{path:"/Applications/Google Chrome Beta.app/Contents/MacOS/Google Chrome Beta",quality:"beta"},{path:"/Applications/Google Chrome Dev.app/Contents/MacOS/Google Chrome Dev",quality:"dev"}]}async findAllInner(){let e=["/Contents/MacOS/Google Chrome Canary","/Contents/MacOS/Google Chrome Beta","/Contents/MacOS/Google Chrome Dev","/Contents/MacOS/Google Chrome"],t=["/Applications/Google Chrome.app","/Applications/Google Chrome Canary.app"],n=await this.findLaunchRegisteredApps("google chrome[A-Za-z() ]*.app",t,e);return(0,iz.sort)(n,this.createPriorities([{name:"Chrome.app",weight:0,quality:"stable"},{name:"Chrome Canary.app",weight:1,quality:"canary"},{name:"Chrome Beta.app",weight:2,quality:"beta"},{name:"Chrome Dev.app",weight:3,quality:"dev"}]))}getPreferredPath(){return this.env.CHROME_PATH}};Fh.DarwinChromeBrowserFinder=v_});var Zk=_(Bh=>{"use strict";Object.defineProperty(Bh,"__esModule",{value:!0});Bh.DarwinEdgeBrowserFinder=void 0;var sz=Pi(),az=Lh(),__=class extends az.DarwinFinderBase{constructor(){super(...arguments),this.wellKnownPaths=[{path:"/Applications/Microsoft Edge.app/Contents/MacOS/Microsoft Edge",quality:"stable"},{path:"/Applications/Microsoft Edge Canary.app/Contents/MacOS/Microsoft Edge Canary",quality:"canary"},{path:"/Applications/Microsoft Edge Beta.app/Contents/MacOS/Microsoft Edge Beta",quality:"beta"},{path:"/Applications/Microsoft Edge Dev.app/Contents/MacOS/Microsoft Edge Dev",quality:"dev"}]}async findAllInner(){let e=["/Contents/MacOS/Microsoft Edge Canary","/Contents/MacOS/Microsoft Edge Beta","/Contents/MacOS/Microsoft Edge Dev","/Contents/MacOS/Microsoft Edge"],t=["/Applications/Microsoft Edge.app"],n=await this.findLaunchRegisteredApps("Microsoft Edge[A-Za-z ]*.app",t,e);return(0,sz.sort)(n,this.createPriorities([{name:"Microsoft Edge.app",weight:0,quality:"stable"},{name:"Microsoft Edge Canary.app",weight:1,quality:"canary"},{name:"Microsoft Edge Beta.app",weight:2,quality:"beta"},{name:"Microsoft Edge Dev.app",weight:3,quality:"dev"}]))}getPreferredPath(){return this.env.EDGE_PATH}};Bh.DarwinEdgeBrowserFinder=__});var eD=_(Uh=>{"use strict";Object.defineProperty(Uh,"__esModule",{value:!0});Uh.DarwinFirefoxBrowserFinder=void 0;var cz=Pi(),uz=Lh(),w_=class extends uz.DarwinFinderBase{constructor(){super(...arguments),this.wellKnownPaths=[{path:"/Applications/Firefox.app/Contents/MacOS/firefox",quality:"stable"},{path:"/Applications/Firefox Developer Edition.app/Contents/MacOS/firefox",quality:"dev"},{path:"/Applications/Firefox Nightly.app/Contents/MacOS/firefox",quality:"canary"}]}async findAllInner(){let e=["/Contents/MacOS/firefox"],t=["/Applications/Firefox.app"],n=await this.findLaunchRegisteredApps("Firefox[A-Za-z ]*.app",t,e);return(0,cz.sort)(n,this.createPriorities([{name:"Firefox.app",weight:0,quality:"stable"},{name:"Firefox Nightly.app",weight:1,quality:"canary"},{name:"Firefox Developer Edition.app",weight:2,quality:"dev"}]))}getPreferredPath(){return this.env.FIREFOX_PATH}};Uh.DarwinFirefoxBrowserFinder=w_});var qh=_(jh=>{"use strict";Object.defineProperty(jh,"__esModule",{value:!0});jh.LinuxChromeBrowserFinder=void 0;var lz=g("path"),mc=Pi(),S_=g("child_process"),pz=g("os"),dz=g("fs"),tD=/\r?\n/,x_=class{constructor(e=process.env,t=dz.promises){this.env=e,this.fs=t,this.pathEnvironmentVar="CHROME_PATH",this.priorities=[{regex:/chrome-wrapper$/,weight:54,quality:"custom"},{regex:/google-chrome-dev$/,weight:53,quality:"dev"},{regex:/google-chrome-canary$/,weight:52,quality:"canary"},{regex:/google-chrome-unstable$/,weight:51,quality:"canary"},{regex:/google-chrome-canary$/,weight:51,quality:"canary"},{regex:/google-chrome-stable$/,weight:50,quality:"stable"},{regex:/(google-)?chrome$/,weight:49,quality:"stable"},{regex:/chromium-browser$/,weight:48,quality:"custom"},{regex:/chromium$/,weight:47,quality:"custom"}],this.executablesOnPath=["google-chrome-unstable","google-chrome-dev","google-chrome-beta","google-chrome-canary","google-chrome-stable","google-chrome","chromium-browser","chromium"]}async findWhere(e){return(await this.findAll()).find(e)}async findAll(){let e=new Set,t=this.env[this.pathEnvironmentVar];t&&await(0,mc.canAccess)(this.fs,t)&&e.add(t),[lz.posix.join((0,pz.homedir)(),".local/share/applications/"),"/usr/share/applications/","/usr/bin","/opt/google"].forEach(s=>{for(let a in this.findChromeExecutables(s))e.add(a)}),await Promise.all(this.executablesOnPath.map(async s=>{try{let a=(0,S_.execFileSync)("which",[s],{stdio:"pipe"}).toString().split(tD)[0];await(0,mc.canAccess)(this.fs,a)&&e.add(a)}catch{}}));let o=t?[{regex:new RegExp((0,mc.escapeRegexSpecialChars)(t)),weight:101,quality:"custom"}].concat(this.priorities):this.priorities;return(0,mc.sort)(e,o)}async findChromeExecutables(e){let t=/(^[^ ]+).*/,n=`^Exec=/.*/(${this.executablesOnPath.join("|")})-.*`,i=[];if(await(0,mc.canAccess)(this.fs,e)){let o;try{o=(0,S_.execSync)(`grep -ERI "${n}" ${e} | awk -F '=' '{print $2}'`)}catch{o=(0,S_.execSync)(`grep -Er "${n}" ${e} | awk -F '=' '{print $2}'`)}let s=o.toString().split(tD).map(a=>a.replace(t,"$1"));await Promise.all(s.map(async a=>{await(0,mc.canAccess)(this.fs,a)&&i.push(a)}))}return i}};jh.LinuxChromeBrowserFinder=x_});var rD=_(Wh=>{"use strict";Object.defineProperty(Wh,"__esModule",{value:!0});Wh.LinuxEdgeBrowserFinder=void 0;var fz=qh(),I_=class extends fz.LinuxChromeBrowserFinder{constructor(){super(...arguments),this.pathEnvironmentVar="EDGE_PATH",this.executablesOnPath=["microsoft-edge-dev","microsoft-edge-beta","microsoft-edge-stable","microsoft-edge"],this.priorities=[{regex:/microsoft-edge\-wrapper$/,weight:52,quality:"custom"},{regex:/microsoft-edge\-dev$/,weight:51,quality:"dev"},{regex:/microsoft-edge\-beta$/,weight:51,quality:"beta"},{regex:/microsoft-edge\-stable$/,weight:50,quality:"stable"},{regex:/microsoft-edge$/,weight:49,quality:"stable"}]}};Wh.LinuxEdgeBrowserFinder=I_});var nD=_(Vh=>{"use strict";Object.defineProperty(Vh,"__esModule",{value:!0});Vh.LinuxFirefoxBrowserFinder=void 0;var hz=qh(),C_=class extends hz.LinuxChromeBrowserFinder{constructor(){super(...arguments),this.pathEnvironmentVar="FIREFOX_PATH",this.executablesOnPath=["firefox-aurora","firefox-dev","firefox-developer","firefox-trunk","firefox-nightly","firefox"],this.priorities=[{regex:/firefox\-aurora$/,weight:51,quality:"dev"},{regex:/firefox\-dev$/,weight:51,quality:"dev"},{regex:/firefox\-developer$/,weight:51,quality:"dev"},{regex:/firefox\-trunk'$/,weight:50,quality:"canary"},{regex:/firefox\-nightly'$/,weight:50,quality:"canary"},{regex:/firefox$/,weight:49,quality:"stable"}]}};Vh.LinuxFirefoxBrowserFinder=C_});var oD=_($h=>{"use strict";Object.defineProperty($h,"__esModule",{value:!0});$h.WindowsChromeBrowserFinder=void 0;var mz=g("path"),iD=Pi(),gz=g("fs"),P_=class{constructor(e=process.env,t=gz.promises){this.env=e,this.fs=t}async findWhere(e){return(await this.findAll()).find(e)}async findAll(){let e=mz.win32.sep,t=[{name:`${e}Google${e}Chrome Dev${e}Application${e}chrome.exe`,type:"dev"},{name:`${e}Google${e}Chrome SxS${e}Application${e}chrome.exe`,type:"canary"},{name:`${e}Google${e}Chrome Beta${e}Application${e}chrome.exe`,type:"beta"},{name:`${e}Google${e}Chrome${e}Application${e}chrome.exe`,type:"stable"}],n=await(0,iD.findWindowsCandidates)(this.env,this.fs,t),i=await(0,iD.preferredChromePath)(this.fs,this.env);return i&&n.unshift({path:i,quality:"custom"}),n}};$h.WindowsChromeBrowserFinder=P_});var aD=_(Hh=>{"use strict";Object.defineProperty(Hh,"__esModule",{value:!0});Hh.WindowsEdgeBrowserFinder=void 0;var Ft=g("path"),yz=g("fs"),sD=Pi(),T_=class{constructor(e=process.env,t=yz.promises){this.env=e,this.fs=t}async findWhere(e){return(await this.findAll()).find(e)}async findAll(){let e=[{name:`${Ft.sep}Microsoft${Ft.sep}Edge SxS${Ft.sep}Application${Ft.sep}msedge.exe`,type:"canary"},{name:`${Ft.sep}Microsoft${Ft.sep}Edge Dev${Ft.sep}Application${Ft.sep}msedge.exe`,type:"dev"},{name:`${Ft.sep}Microsoft${Ft.sep}Edge Beta${Ft.sep}Application${Ft.sep}msedge.exe`,type:"beta"},{name:`${Ft.sep}Microsoft${Ft.sep}Edge${Ft.sep}Application${Ft.sep}msedge.exe`,type:"stable"}],t=await(0,sD.findWindowsCandidates)(this.env,this.fs,e),n=await(0,sD.preferredEdgePath)(this.fs,this.env);return n&&t.unshift({path:n,quality:"custom"}),t}};Hh.WindowsEdgeBrowserFinder=T_});var uD=_(Gh=>{"use strict";Object.defineProperty(Gh,"__esModule",{value:!0});Gh.WindowsFirefoxBrowserFinder=void 0;var bz=g("path"),cD=Pi(),vz=g("fs"),E_=class{constructor(e=process.env,t=vz.promises){this.env=e,this.fs=t}async findWhere(e){return(await this.findAll()).find(e)}async findAll(){let e=bz.win32.sep,t=[{name:`${e}Firefox Developer Edition${e}firefox.exe`,type:"dev"},{name:`${e}Firefox Nightly${e}firefox.exe`,type:"canary"},{name:`${e}Mozilla Firefox${e}firefox.exe`,type:"stable"}],n=await(0,cD.findWindowsCandidates)(this.env,this.fs,t),i=await(0,cD.preferredFirefoxPath)(this.fs,this.env);return i&&n.unshift({path:i,quality:"custom"}),n}};Gh.WindowsFirefoxBrowserFinder=E_});var R_=_(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});_r.FirefoxBrowserFinder=_r.EdgeBrowserFinder=_r.ChromeBrowserFinder=_r.isQuality=_r.allQualities=void 0;var _z=Qk(),wz=Zk(),Sz=eD(),xz=qh(),Iz=rD(),Cz=nD(),Pz=oD(),Tz=aD(),Ez=uD(),Rz={canary:null,stable:null,beta:null,dev:null,custom:null};_r.allQualities=new Set(Object.keys(Rz));var Az=r=>_r.allQualities.has(r);_r.isQuality=Az;_r.ChromeBrowserFinder=process.platform==="win32"?Pz.WindowsChromeBrowserFinder:process.platform==="darwin"?_z.DarwinChromeBrowserFinder:xz.LinuxChromeBrowserFinder;_r.EdgeBrowserFinder=process.platform==="win32"?Tz.WindowsEdgeBrowserFinder:process.platform==="darwin"?wz.DarwinEdgeBrowserFinder:Iz.LinuxEdgeBrowserFinder;_r.FirefoxBrowserFinder=process.platform==="win32"?Ez.WindowsFirefoxBrowserFinder:process.platform==="darwin"?Sz.DarwinFirefoxBrowserFinder:Cz.LinuxFirefoxBrowserFinder});var mD=_(Yh=>{"use strict";Object.defineProperty(Yh,"__esModule",{value:!0});Yh.dataUriToBuffer=void 0;function Dz(r){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=[];for(let o=0;o<r.length;o+=4){let s=e.indexOf(r.charAt(o)),a=e.indexOf(r.charAt(o+1)),c=r.charAt(o+2)==="="?0:e.indexOf(r.charAt(o+2)),u=r.charAt(o+3)==="="?0:e.indexOf(r.charAt(o+3)),l=s<<2|a>>4,p=(a&15)<<4|c>>2,d=(c&3)<<6|u;t.push(l),r.charAt(o+2)!=="="&&t.push(p),r.charAt(o+3)!=="="&&t.push(d)}let n=new ArrayBuffer(t.length);return new Uint8Array(n).set(t),n}function Oz(r){let e=new ArrayBuffer(r.length),t=new Uint8Array(e);for(let n=0;n<r.length;n++)t[n]=r.charCodeAt(n);return e}function Mz(r){if(r=String(r),!/^data:/i.test(r))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');r=r.replace(/\r?\n/g,"");let e=r.indexOf(",");if(e===-1||e<=4)throw new TypeError("malformed data: URI");let t=r.substring(5,e).split(";"),n="",i=!1,o=t[0]||"text/plain",s=o;for(let u=1;u<t.length;u++)t[u]==="base64"?i=!0:t[u]&&(s+=`;${t[u]}`,t[u].indexOf("charset=")===0&&(n=t[u].substring(8)));!t[0]&&!n.length&&(s+=";charset=US-ASCII",n="US-ASCII");let a=unescape(r.substring(e+1)),c=i?Dz(a):Oz(a);return{type:o,typeFull:s,charset:n,buffer:c}}Yh.dataUriToBuffer=Mz});var Ei=_((Ti,Xh)=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});var gD=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Nz(r){return gD.includes(r)}var Lz=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Blob","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","FormData","URLSearchParams","HTMLElement",...gD];function Fz(r){return Lz.includes(r)}var Bz=["null","undefined","string","number","bigint","boolean","symbol"];function Uz(r){return Bz.includes(r)}function bc(r){return e=>typeof e===r}var{toString:yD}=Object.prototype,Ol=r=>{let e=yD.call(r).slice(8,-1);if(/HTML\w+Element/.test(e)&&v.domElement(r))return"HTMLElement";if(Fz(e))return e},Pe=r=>e=>Ol(e)===r;function v(r){if(r===null)return"null";switch(typeof r){case"undefined":return"undefined";case"string":return"string";case"number":return"number";case"boolean":return"boolean";case"function":return"Function";case"bigint":return"bigint";case"symbol":return"symbol";default:}if(v.observable(r))return"Observable";if(v.array(r))return"Array";if(v.buffer(r))return"Buffer";let e=Ol(r);if(e)return e;if(r instanceof String||r instanceof Boolean||r instanceof Number)throw new TypeError("Please don't use object wrappers for primitive types");return"Object"}v.undefined=bc("undefined");v.string=bc("string");var jz=bc("number");v.number=r=>jz(r)&&!v.nan(r);v.bigint=bc("bigint");v.function_=bc("function");v.null_=r=>r===null;v.class_=r=>v.function_(r)&&r.toString().startsWith("class ");v.boolean=r=>r===!0||r===!1;v.symbol=bc("symbol");v.numericString=r=>v.string(r)&&!v.emptyStringOrWhitespace(r)&&!Number.isNaN(Number(r));v.array=(r,e)=>Array.isArray(r)?v.function_(e)?r.every(e):!0:!1;v.buffer=r=>{var e,t,n,i;return(i=(n=(t=(e=r)===null||e===void 0?void 0:e.constructor)===null||t===void 0?void 0:t.isBuffer)===null||n===void 0?void 0:n.call(t,r))!==null&&i!==void 0?i:!1};v.blob=r=>Pe("Blob")(r);v.nullOrUndefined=r=>v.null_(r)||v.undefined(r);v.object=r=>!v.null_(r)&&(typeof r=="object"||v.function_(r));v.iterable=r=>{var e;return v.function_((e=r)===null||e===void 0?void 0:e[Symbol.iterator])};v.asyncIterable=r=>{var e;return v.function_((e=r)===null||e===void 0?void 0:e[Symbol.asyncIterator])};v.generator=r=>{var e,t;return v.iterable(r)&&v.function_((e=r)===null||e===void 0?void 0:e.next)&&v.function_((t=r)===null||t===void 0?void 0:t.throw)};v.asyncGenerator=r=>v.asyncIterable(r)&&v.function_(r.next)&&v.function_(r.throw);v.nativePromise=r=>Pe("Promise")(r);var qz=r=>{var e,t;return v.function_((e=r)===null||e===void 0?void 0:e.then)&&v.function_((t=r)===null||t===void 0?void 0:t.catch)};v.promise=r=>v.nativePromise(r)||qz(r);v.generatorFunction=Pe("GeneratorFunction");v.asyncGeneratorFunction=r=>Ol(r)==="AsyncGeneratorFunction";v.asyncFunction=r=>Ol(r)==="AsyncFunction";v.boundFunction=r=>v.function_(r)&&!r.hasOwnProperty("prototype");v.regExp=Pe("RegExp");v.date=Pe("Date");v.error=Pe("Error");v.map=r=>Pe("Map")(r);v.set=r=>Pe("Set")(r);v.weakMap=r=>Pe("WeakMap")(r);v.weakSet=r=>Pe("WeakSet")(r);v.int8Array=Pe("Int8Array");v.uint8Array=Pe("Uint8Array");v.uint8ClampedArray=Pe("Uint8ClampedArray");v.int16Array=Pe("Int16Array");v.uint16Array=Pe("Uint16Array");v.int32Array=Pe("Int32Array");v.uint32Array=Pe("Uint32Array");v.float32Array=Pe("Float32Array");v.float64Array=Pe("Float64Array");v.bigInt64Array=Pe("BigInt64Array");v.bigUint64Array=Pe("BigUint64Array");v.arrayBuffer=Pe("ArrayBuffer");v.sharedArrayBuffer=Pe("SharedArrayBuffer");v.dataView=Pe("DataView");v.enumCase=(r,e)=>Object.values(e).includes(r);v.directInstanceOf=(r,e)=>Object.getPrototypeOf(r)===e.prototype;v.urlInstance=r=>Pe("URL")(r);v.urlString=r=>{if(!v.string(r))return!1;try{return new URL(r),!0}catch{return!1}};v.truthy=r=>!!r;v.falsy=r=>!r;v.nan=r=>Number.isNaN(r);v.primitive=r=>v.null_(r)||Uz(typeof r);v.integer=r=>Number.isInteger(r);v.safeInteger=r=>Number.isSafeInteger(r);v.plainObject=r=>{if(yD.call(r)!=="[object Object]")return!1;let e=Object.getPrototypeOf(r);return e===null||e===Object.getPrototypeOf({})};v.typedArray=r=>Nz(Ol(r));var Wz=r=>v.safeInteger(r)&&r>=0;v.arrayLike=r=>!v.nullOrUndefined(r)&&!v.function_(r)&&Wz(r.length);v.inRange=(r,e)=>{if(v.number(e))return r>=Math.min(0,e)&&r<=Math.max(e,0);if(v.array(e)&&e.length===2)return r>=Math.min(...e)&&r<=Math.max(...e);throw new TypeError(`Invalid range: ${JSON.stringify(e)}`)};var Vz=1,$z=["innerHTML","ownerDocument","style","attributes","nodeValue"];v.domElement=r=>v.object(r)&&r.nodeType===Vz&&v.string(r.nodeName)&&!v.plainObject(r)&&$z.every(e=>e in r);v.observable=r=>{var e,t,n,i;return r?r===((t=(e=r)[Symbol.observable])===null||t===void 0?void 0:t.call(e))||r===((i=(n=r)["@@observable"])===null||i===void 0?void 0:i.call(n)):!1};v.nodeStream=r=>v.object(r)&&v.function_(r.pipe)&&!v.observable(r);v.infinite=r=>r===1/0||r===-1/0;var bD=r=>e=>v.integer(e)&&Math.abs(e%2)===r;v.evenInteger=bD(0);v.oddInteger=bD(1);v.emptyArray=r=>v.array(r)&&r.length===0;v.nonEmptyArray=r=>v.array(r)&&r.length>0;v.emptyString=r=>v.string(r)&&r.length===0;var Hz=r=>v.string(r)&&!/\S/.test(r);v.emptyStringOrWhitespace=r=>v.emptyString(r)||Hz(r);v.nonEmptyString=r=>v.string(r)&&r.length>0;v.nonEmptyStringAndNotWhitespace=r=>v.string(r)&&!v.emptyStringOrWhitespace(r);v.emptyObject=r=>v.object(r)&&!v.map(r)&&!v.set(r)&&Object.keys(r).length===0;v.nonEmptyObject=r=>v.object(r)&&!v.map(r)&&!v.set(r)&&Object.keys(r).length>0;v.emptySet=r=>v.set(r)&&r.size===0;v.nonEmptySet=r=>v.set(r)&&r.size>0;v.emptyMap=r=>v.map(r)&&r.size===0;v.nonEmptyMap=r=>v.map(r)&&r.size>0;v.propertyKey=r=>v.any([v.string,v.number,v.symbol],r);v.formData=r=>Pe("FormData")(r);v.urlSearchParams=r=>Pe("URLSearchParams")(r);var vD=(r,e,t)=>{if(!v.function_(e))throw new TypeError(`Invalid predicate: ${JSON.stringify(e)}`);if(t.length===0)throw new TypeError("Invalid number of values");return r.call(t,e)};v.any=(r,...e)=>(v.array(r)?r:[r]).some(n=>vD(Array.prototype.some,n,e));v.all=(r,...e)=>vD(Array.prototype.every,r,e);var N=(r,e,t,n={})=>{if(!r){let{multipleValues:i}=n,o=i?`received values of types ${[...new Set(t.map(s=>`\`${v(s)}\``))].join(", ")}`:`received value of type \`${v(t)}\``;throw new TypeError(`Expected value which is \`${e}\`, ${o}.`)}};Ti.assert={undefined:r=>N(v.undefined(r),"undefined",r),string:r=>N(v.string(r),"string",r),number:r=>N(v.number(r),"number",r),bigint:r=>N(v.bigint(r),"bigint",r),function_:r=>N(v.function_(r),"Function",r),null_:r=>N(v.null_(r),"null",r),class_:r=>N(v.class_(r),"Class",r),boolean:r=>N(v.boolean(r),"boolean",r),symbol:r=>N(v.symbol(r),"symbol",r),numericString:r=>N(v.numericString(r),"string with a number",r),array:(r,e)=>{N(v.array(r),"Array",r),e&&r.forEach(e)},buffer:r=>N(v.buffer(r),"Buffer",r),blob:r=>N(v.blob(r),"Blob",r),nullOrUndefined:r=>N(v.nullOrUndefined(r),"null or undefined",r),object:r=>N(v.object(r),"Object",r),iterable:r=>N(v.iterable(r),"Iterable",r),asyncIterable:r=>N(v.asyncIterable(r),"AsyncIterable",r),generator:r=>N(v.generator(r),"Generator",r),asyncGenerator:r=>N(v.asyncGenerator(r),"AsyncGenerator",r),nativePromise:r=>N(v.nativePromise(r),"native Promise",r),promise:r=>N(v.promise(r),"Promise",r),generatorFunction:r=>N(v.generatorFunction(r),"GeneratorFunction",r),asyncGeneratorFunction:r=>N(v.asyncGeneratorFunction(r),"AsyncGeneratorFunction",r),asyncFunction:r=>N(v.asyncFunction(r),"AsyncFunction",r),boundFunction:r=>N(v.boundFunction(r),"Function",r),regExp:r=>N(v.regExp(r),"RegExp",r),date:r=>N(v.date(r),"Date",r),error:r=>N(v.error(r),"Error",r),map:r=>N(v.map(r),"Map",r),set:r=>N(v.set(r),"Set",r),weakMap:r=>N(v.weakMap(r),"WeakMap",r),weakSet:r=>N(v.weakSet(r),"WeakSet",r),int8Array:r=>N(v.int8Array(r),"Int8Array",r),uint8Array:r=>N(v.uint8Array(r),"Uint8Array",r),uint8ClampedArray:r=>N(v.uint8ClampedArray(r),"Uint8ClampedArray",r),int16Array:r=>N(v.int16Array(r),"Int16Array",r),uint16Array:r=>N(v.uint16Array(r),"Uint16Array",r),int32Array:r=>N(v.int32Array(r),"Int32Array",r),uint32Array:r=>N(v.uint32Array(r),"Uint32Array",r),float32Array:r=>N(v.float32Array(r),"Float32Array",r),float64Array:r=>N(v.float64Array(r),"Float64Array",r),bigInt64Array:r=>N(v.bigInt64Array(r),"BigInt64Array",r),bigUint64Array:r=>N(v.bigUint64Array(r),"BigUint64Array",r),arrayBuffer:r=>N(v.arrayBuffer(r),"ArrayBuffer",r),sharedArrayBuffer:r=>N(v.sharedArrayBuffer(r),"SharedArrayBuffer",r),dataView:r=>N(v.dataView(r),"DataView",r),enumCase:(r,e)=>N(v.enumCase(r,e),"EnumCase",r),urlInstance:r=>N(v.urlInstance(r),"URL",r),urlString:r=>N(v.urlString(r),"string with a URL",r),truthy:r=>N(v.truthy(r),"truthy",r),falsy:r=>N(v.falsy(r),"falsy",r),nan:r=>N(v.nan(r),"NaN",r),primitive:r=>N(v.primitive(r),"primitive",r),integer:r=>N(v.integer(r),"integer",r),safeInteger:r=>N(v.safeInteger(r),"integer",r),plainObject:r=>N(v.plainObject(r),"plain object",r),typedArray:r=>N(v.typedArray(r),"TypedArray",r),arrayLike:r=>N(v.arrayLike(r),"array-like",r),domElement:r=>N(v.domElement(r),"HTMLElement",r),observable:r=>N(v.observable(r),"Observable",r),nodeStream:r=>N(v.nodeStream(r),"Node.js Stream",r),infinite:r=>N(v.infinite(r),"infinite number",r),emptyArray:r=>N(v.emptyArray(r),"empty array",r),nonEmptyArray:r=>N(v.nonEmptyArray(r),"non-empty array",r),emptyString:r=>N(v.emptyString(r),"empty string",r),emptyStringOrWhitespace:r=>N(v.emptyStringOrWhitespace(r),"empty string or whitespace",r),nonEmptyString:r=>N(v.nonEmptyString(r),"non-empty string",r),nonEmptyStringAndNotWhitespace:r=>N(v.nonEmptyStringAndNotWhitespace(r),"non-empty string and not whitespace",r),emptyObject:r=>N(v.emptyObject(r),"empty object",r),nonEmptyObject:r=>N(v.nonEmptyObject(r),"non-empty object",r),emptySet:r=>N(v.emptySet(r),"empty set",r),nonEmptySet:r=>N(v.nonEmptySet(r),"non-empty set",r),emptyMap:r=>N(v.emptyMap(r),"empty map",r),nonEmptyMap:r=>N(v.nonEmptyMap(r),"non-empty map",r),propertyKey:r=>N(v.propertyKey(r),"PropertyKey",r),formData:r=>N(v.formData(r),"FormData",r),urlSearchParams:r=>N(v.urlSearchParams(r),"URLSearchParams",r),evenInteger:r=>N(v.evenInteger(r),"even integer",r),oddInteger:r=>N(v.oddInteger(r),"odd integer",r),directInstanceOf:(r,e)=>N(v.directInstanceOf(r,e),"T",r),inRange:(r,e)=>N(v.inRange(r,e),"in range",r),any:(r,...e)=>N(v.any(r,...e),"predicate returns truthy for any value",e,{multipleValues:!0}),all:(r,...e)=>N(v.all(r,...e),"predicate returns truthy for all values",e,{multipleValues:!0})};Object.defineProperties(v,{class:{value:v.class_},function:{value:v.function_},null:{value:v.null_}});Object.defineProperties(Ti.assert,{class:{value:Ti.assert.class_},function:{value:Ti.assert.function_},null:{value:Ti.assert.null_}});Ti.default=v;Xh.exports=v;Xh.exports.default=v;Xh.exports.assert=Ti.assert});var _D=_((Yle,k_)=>{"use strict";var Qh=class extends Error{constructor(e){super(e||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}},Zh=class r{static fn(e){return(...t)=>new r((n,i,o)=>{t.push(o),e(...t).then(n,i)})}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise((t,n)=>{this._reject=n;let i=a=>{(!this._isCanceled||!s.shouldReject)&&(this._isPending=!1,t(a))},o=a=>{this._isPending=!1,n(a)},s=a=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(a)};return Object.defineProperties(s,{shouldReject:{get:()=>this._rejectOnCancel,set:a=>{this._rejectOnCancel=a}}}),e(i,o,s)})}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(!(!this._isPending||this._isCanceled)){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(let t of this._cancelHandlers)t()}catch(t){this._reject(t);return}this._rejectOnCancel&&this._reject(new Qh(e))}}get isCanceled(){return this._isCanceled}};Object.setPrototypeOf(Zh.prototype,Promise.prototype);k_.exports=Zh;k_.exports.CancelError=Qh});var wD=_((O_,M_)=>{"use strict";Object.defineProperty(O_,"__esModule",{value:!0});function Gz(r){return r.encrypted}var D_=(r,e)=>{let t;typeof e=="function"?t={connect:e}:t=e;let n=typeof t.connect=="function",i=typeof t.secureConnect=="function",o=typeof t.close=="function",s=()=>{n&&t.connect(),Gz(r)&&i&&(r.authorized?t.secureConnect():r.authorizationError||r.once("secureConnect",t.secureConnect)),o&&r.once("close",t.close)};r.writable&&!r.connecting?s():r.connecting?r.once("connect",s):r.destroyed&&o&&t.close(r._hadError)};O_.default=D_;M_.exports=D_;M_.exports.default=D_});var SD=_((L_,F_)=>{"use strict";Object.defineProperty(L_,"__esModule",{value:!0});var zz=wD(),Kz=g("util"),Jz=Number(process.versions.node.split(".")[0]),N_=r=>{if(r.timings)return r.timings;let e={start:Date.now(),socket:void 0,lookup:void 0,connect:void 0,secureConnect:void 0,upload:void 0,response:void 0,end:void 0,error:void 0,abort:void 0,phases:{wait:void 0,dns:void 0,tcp:void 0,tls:void 0,request:void 0,firstByte:void 0,download:void 0,total:void 0}};r.timings=e;let t=a=>{let c=a.emit.bind(a);a.emit=(u,...l)=>(u==="error"&&(e.error=Date.now(),e.phases.total=e.error-e.start,a.emit=c),c(u,...l))};t(r);let n=()=>{e.abort=Date.now(),(!e.response||Jz>=13)&&(e.phases.total=Date.now()-e.start)};r.prependOnceListener("abort",n);let i=a=>{if(e.socket=Date.now(),e.phases.wait=e.socket-e.start,Kz.types.isProxy(a))return;let c=()=>{e.lookup=Date.now(),e.phases.dns=e.lookup-e.socket};a.prependOnceListener("lookup",c),zz.default(a,{connect:()=>{e.connect=Date.now(),e.lookup===void 0&&(a.removeListener("lookup",c),e.lookup=e.connect,e.phases.dns=e.lookup-e.socket),e.phases.tcp=e.connect-e.lookup},secureConnect:()=>{e.secureConnect=Date.now(),e.phases.tls=e.secureConnect-e.connect}})};r.socket?i(r.socket):r.prependOnceListener("socket",i);let o=()=>{var a;e.upload=Date.now(),e.phases.request=e.upload-((a=e.secureConnect)!==null&&a!==void 0?a:e.connect)};return(typeof r.writableFinished=="boolean"?r.writableFinished:r.finished&&r.outputSize===0&&(!r.socket||r.socket.writableLength===0))?o():r.prependOnceListener("finish",o),r.prependOnceListener("response",a=>{e.response=Date.now(),e.phases.firstByte=e.response-e.upload,a.timings=e,t(a),a.prependOnceListener("end",()=>{e.end=Date.now(),e.phases.download=e.end-e.response,e.phases.total=e.end-e.start}),a.prependOnceListener("aborted",n)}),e};L_.default=N_;F_.exports=N_;F_.exports.default=N_});var RD=_((Xle,j_)=>{"use strict";var{V4MAPPED:Yz,ADDRCONFIG:Xz,ALL:ED,promises:{Resolver:xD},lookup:Qz}=g("dns"),{promisify:B_}=g("util"),Zz=g("os"),vc=Symbol("cacheableLookupCreateConnection"),U_=Symbol("cacheableLookupInstance"),ID=Symbol("expires"),e6=typeof ED=="number",CD=r=>{if(!(r&&typeof r.createConnection=="function"))throw new Error("Expected an Agent instance as the first argument")},t6=r=>{for(let e of r)e.family!==6&&(e.address=`::ffff:${e.address}`,e.family=6)},PD=()=>{let r=!1,e=!1;for(let t of Object.values(Zz.networkInterfaces()))for(let n of t)if(!n.internal&&(n.family==="IPv6"?e=!0:r=!0,r&&e))return{has4:r,has6:e};return{has4:r,has6:e}},r6=r=>Symbol.iterator in r,TD={ttl:!0},n6={all:!0},em=class{constructor({cache:e=new Map,maxTtl:t=1/0,fallbackDuration:n=3600,errorTtl:i=.15,resolver:o=new xD,lookup:s=Qz}={}){if(this.maxTtl=t,this.errorTtl=i,this._cache=e,this._resolver=o,this._dnsLookup=B_(s),this._resolver instanceof xD?(this._resolve4=this._resolver.resolve4.bind(this._resolver),this._resolve6=this._resolver.resolve6.bind(this._resolver)):(this._resolve4=B_(this._resolver.resolve4.bind(this._resolver)),this._resolve6=B_(this._resolver.resolve6.bind(this._resolver))),this._iface=PD(),this._pending={},this._nextRemovalTime=!1,this._hostnamesToFallback=new Set,n<1)this._fallback=!1;else{this._fallback=!0;let a=setInterval(()=>{this._hostnamesToFallback.clear()},n*1e3);a.unref&&a.unref()}this.lookup=this.lookup.bind(this),this.lookupAsync=this.lookupAsync.bind(this)}set servers(e){this.clear(),this._resolver.setServers(e)}get servers(){return this._resolver.getServers()}lookup(e,t,n){if(typeof t=="function"?(n=t,t={}):typeof t=="number"&&(t={family:t}),!n)throw new Error("Callback must be a function.");this.lookupAsync(e,t).then(i=>{t.all?n(null,i):n(null,i.address,i.family,i.expires,i.ttl)},n)}async lookupAsync(e,t={}){typeof t=="number"&&(t={family:t});let n=await this.query(e);if(t.family===6){let i=n.filter(o=>o.family===6);t.hints&Yz&&(e6&&t.hints&ED||i.length===0)?t6(n):n=i}else t.family===4&&(n=n.filter(i=>i.family===4));if(t.hints&Xz){let{_iface:i}=this;n=n.filter(o=>o.family===6?i.has6:i.has4)}if(n.length===0){let i=new Error(`cacheableLookup ENOTFOUND ${e}`);throw i.code="ENOTFOUND",i.hostname=e,i}return t.all?n:n[0]}async query(e){let t=await this._cache.get(e);if(!t){let n=this._pending[e];if(n)t=await n;else{let i=this.queryAndCache(e);this._pending[e]=i;try{t=await i}finally{delete this._pending[e]}}}return t=t.map(n=>({...n})),t}async _resolve(e){let t=async u=>{try{return await u}catch(l){if(l.code==="ENODATA"||l.code==="ENOTFOUND")return[];throw l}},[n,i]=await Promise.all([this._resolve4(e,TD),this._resolve6(e,TD)].map(u=>t(u))),o=0,s=0,a=0,c=Date.now();for(let u of n)u.family=4,u.expires=c+u.ttl*1e3,o=Math.max(o,u.ttl);for(let u of i)u.family=6,u.expires=c+u.ttl*1e3,s=Math.max(s,u.ttl);return n.length>0?i.length>0?a=Math.min(o,s):a=o:a=s,{entries:[...n,...i],cacheTtl:a}}async _lookup(e){try{return{entries:await this._dnsLookup(e,{all:!0}),cacheTtl:0}}catch{return{entries:[],cacheTtl:0}}}async _set(e,t,n){if(this.maxTtl>0&&n>0){n=Math.min(n,this.maxTtl)*1e3,t[ID]=Date.now()+n;try{await this._cache.set(e,t,n)}catch(i){this.lookupAsync=async()=>{let o=new Error("Cache Error. Please recreate the CacheableLookup instance.");throw o.cause=i,o}}r6(this._cache)&&this._tick(n)}}async queryAndCache(e){if(this._hostnamesToFallback.has(e))return this._dnsLookup(e,n6);let t=await this._resolve(e);t.entries.length===0&&this._fallback&&(t=await this._lookup(e),t.entries.length!==0&&this._hostnamesToFallback.add(e));let n=t.entries.length===0?this.errorTtl:t.cacheTtl;return await this._set(e,t.entries,n),t.entries}_tick(e){let t=this._nextRemovalTime;(!t||e<t)&&(clearTimeout(this._removalTimeout),this._nextRemovalTime=e,this._removalTimeout=setTimeout(()=>{this._nextRemovalTime=!1;let n=1/0,i=Date.now();for(let[o,s]of this._cache){let a=s[ID];i>=a?this._cache.delete(o):a<n&&(n=a)}n!==1/0&&this._tick(n-i)},e),this._removalTimeout.unref&&this._removalTimeout.unref())}install(e){if(CD(e),vc in e)throw new Error("CacheableLookup has been already installed");e[vc]=e.createConnection,e[U_]=this,e.createConnection=(t,n)=>("lookup"in t||(t.lookup=this.lookup),e[vc](t,n))}uninstall(e){if(CD(e),e[vc]){if(e[U_]!==this)throw new Error("The agent is not owned by this CacheableLookup instance");e.createConnection=e[vc],delete e[vc],delete e[U_]}}updateInterfaceInfo(){let{_iface:e}=this;this._iface=PD(),(e.has4&&!this._iface.has4||e.has6&&!this._iface.has6)&&this._cache.clear()}clear(e){if(e){this._cache.delete(e);return}this._cache.clear()}};j_.exports=em;j_.exports.default=em});var DD=_((Qle,kD)=>{"use strict";var i6="text/plain",o6="us-ascii",AD=(r,e)=>e.some(t=>t instanceof RegExp?t.test(r):t===r),s6=(r,{stripHash:e})=>{let t=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(r);if(!t)throw new Error(`Invalid URL: ${r}`);let{type:n,data:i,hash:o}=t.groups,s=n.split(";");o=e?"":o;let a=!1;s[s.length-1]==="base64"&&(s.pop(),a=!0);let c=(s.shift()||"").toLowerCase(),l=[...s.map(p=>{let[d,f=""]=p.split("=").map(h=>h.trim());return d==="charset"&&(f=f.toLowerCase(),f===o6)?"":`${d}${f?`=${f}`:""}`}).filter(Boolean)];return a&&l.push("base64"),(l.length!==0||c&&c!==i6)&&l.unshift(c),`data:${l.join(";")},${a?i.trim():i}${o?`#${o}`:""}`},a6=(r,e)=>{if(e={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...e},r=r.trim(),/^data:/i.test(r))return s6(r,e);if(/^view-source:/i.test(r))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let t=r.startsWith("//");!t&&/^\.*\//.test(r)||(r=r.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));let i=new URL(r);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),e.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),e.stripAuthentication&&(i.username="",i.password=""),e.stripHash?i.hash="":e.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname&&(i.pathname=i.pathname.replace(/(?<!\b(?:[a-z][a-z\d+\-.]{1,50}:))\/{2,}/g,"/")),i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(e.removeDirectoryIndex===!0&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let s=i.pathname.split("/"),a=s[s.length-1];AD(a,e.removeDirectoryIndex)&&(s=s.slice(0,s.length-1),i.pathname=s.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)(?:[a-z\-\d]{1,63})\.(?:[a-z.\-\d]{2,63})$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(let s of[...i.searchParams.keys()])AD(s,e.removeQueryParameters)&&i.searchParams.delete(s);e.removeQueryParameters===!0&&(i.search=""),e.sortQueryParameters&&i.searchParams.sort(),e.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let o=r;return r=i.toString(),!e.removeSingleSlash&&i.pathname==="/"&&!o.endsWith("/")&&i.hash===""&&(r=r.replace(/\/$/,"")),(e.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&e.removeSingleSlash&&(r=r.replace(/\/$/,"")),t&&!e.normalizeProtocol&&(r=r.replace(/^http:\/\//,"//")),e.stripProtocol&&(r=r.replace(/^(?:https?:)?\/\//,"")),r};kD.exports=a6});var ND=_((Zle,MD)=>{MD.exports=OD;function OD(r,e){if(r&&e)return OD(r)(e);if(typeof r!="function")throw new TypeError("need wrapper function");return Object.keys(r).forEach(function(n){t[n]=r[n]}),t;function t(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];var o=r.apply(this,n),s=n[n.length-1];return typeof o=="function"&&o!==s&&Object.keys(s).forEach(function(a){o[a]=s[a]}),o}}});var W_=_((epe,q_)=>{var LD=ND();q_.exports=LD(tm);q_.exports.strict=LD(FD);tm.proto=tm(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return tm(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return FD(this)},configurable:!0})});function tm(r){var e=function(){return e.called?e.value:(e.called=!0,e.value=r.apply(this,arguments))};return e.called=!1,e}function FD(r){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=r.apply(this,arguments)},t=r.name||"Function wrapped with `once`";return e.onceError=t+" shouldn't be called more than once",e.called=!1,e}});var jD=_((tpe,UD)=>{var c6=W_(),u6=function(){},l6=function(r){return r.setHeader&&typeof r.abort=="function"},p6=function(r){return r.stdio&&Array.isArray(r.stdio)&&r.stdio.length===3},BD=function(r,e,t){if(typeof e=="function")return BD(r,null,e);e||(e={}),t=c6(t||u6);var n=r._writableState,i=r._readableState,o=e.readable||e.readable!==!1&&r.readable,s=e.writable||e.writable!==!1&&r.writable,a=!1,c=function(){r.writable||u()},u=function(){s=!1,o||t.call(r)},l=function(){o=!1,s||t.call(r)},p=function(b){t.call(r,b?new Error("exited with error code: "+b):null)},d=function(b){t.call(r,b)},f=function(){process.nextTick(h)},h=function(){if(!a){if(o&&!(i&&i.ended&&!i.destroyed))return t.call(r,new Error("premature close"));if(s&&!(n&&n.ended&&!n.destroyed))return t.call(r,new Error("premature close"))}},m=function(){r.req.on("finish",u)};return l6(r)?(r.on("complete",u),r.on("abort",f),r.req?m():r.on("request",m)):s&&!n&&(r.on("end",c),r.on("close",c)),p6(r)&&r.on("exit",p),r.on("end",l),r.on("finish",u),e.error!==!1&&r.on("error",d),r.on("close",f),function(){a=!0,r.removeListener("complete",u),r.removeListener("abort",f),r.removeListener("request",m),r.req&&r.req.removeListener("finish",u),r.removeListener("end",c),r.removeListener("close",c),r.removeListener("finish",u),r.removeListener("exit",p),r.removeListener("end",l),r.removeListener("error",d),r.removeListener("close",f)}};UD.exports=BD});var VD=_((rpe,WD)=>{var d6=W_(),f6=jD(),V_=g("fs"),Ml=function(){},h6=/^v?\.0/.test(process.version),rm=function(r){return typeof r=="function"},m6=function(r){return!h6||!V_?!1:(r instanceof(V_.ReadStream||Ml)||r instanceof(V_.WriteStream||Ml))&&rm(r.close)},g6=function(r){return r.setHeader&&rm(r.abort)},y6=function(r,e,t,n){n=d6(n);var i=!1;r.on("close",function(){i=!0}),f6(r,{readable:e,writable:t},function(s){if(s)return n(s);i=!0,n()});var o=!1;return function(s){if(!i&&!o){if(o=!0,m6(r))return r.close(Ml);if(g6(r))return r.abort();if(rm(r.destroy))return r.destroy();n(s||new Error("stream was destroyed"))}}},qD=function(r){r()},b6=function(r,e){return r.pipe(e)},v6=function(){var r=Array.prototype.slice.call(arguments),e=rm(r[r.length-1]||Ml)&&r.pop()||Ml;if(Array.isArray(r[0])&&(r=r[0]),r.length<2)throw new Error("pump requires two streams per minimum");var t,n=r.map(function(i,o){var s=o<r.length-1,a=o>0;return y6(i,s,a,function(c){t||(t=c),c&&n.forEach(qD),!s&&(n.forEach(qD),e(t))})});return r.reduce(b6)};WD.exports=v6});var HD=_((npe,$D)=>{"use strict";var{PassThrough:_6}=g("stream");$D.exports=r=>{r={...r};let{array:e}=r,{encoding:t}=r,n=t==="buffer",i=!1;e?i=!(t||n):t=t||"utf8",n&&(t=null);let o=new _6({objectMode:i});t&&o.setEncoding(t);let s=0,a=[];return o.on("data",c=>{a.push(c),i?s=a.length:s+=c.length}),o.getBufferedValue=()=>e?a:n?Buffer.concat(a,s):a.join(""),o.getBufferedLength=()=>s,o}});var GD=_((ipe,_c)=>{"use strict";var{constants:w6}=g("buffer"),S6=VD(),x6=HD(),nm=class extends Error{constructor(){super("maxBuffer exceeded"),this.name="MaxBufferError"}};async function im(r,e){if(!r)return Promise.reject(new Error("Expected a stream"));e={maxBuffer:1/0,...e};let{maxBuffer:t}=e,n;return await new Promise((i,o)=>{let s=a=>{a&&n.getBufferedLength()<=w6.MAX_LENGTH&&(a.bufferedData=n.getBufferedValue()),o(a)};n=S6(r,x6(e),a=>{if(a){s(a);return}i()}),n.on("data",()=>{n.getBufferedLength()>t&&s(new nm)})}),n.getBufferedValue()}_c.exports=im;_c.exports.default=im;_c.exports.buffer=(r,e)=>im(r,{...e,encoding:"buffer"});_c.exports.array=(r,e)=>im(r,{...e,array:!0});_c.exports.MaxBufferError=nm});var KD=_((spe,zD)=>{"use strict";var I6=new Set([200,203,204,206,300,301,308,404,405,410,414,501]),C6=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),P6=new Set([500,502,503,504]),T6={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},E6={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function Cs(r){let e=parseInt(r,10);return isFinite(e)?e:0}function R6(r){return r?P6.has(r.status):!0}function $_(r){let e={};if(!r)return e;let t=r.trim().split(/,/);for(let n of t){let[i,o]=n.split(/=/,2);e[i.trim()]=o===void 0?!0:o.trim().replace(/^"|"$/g,"")}return e}function A6(r){let e=[];for(let t in r){let n=r[t];e.push(n===!0?t:t+"="+n)}if(e.length)return e.join(", ")}zD.exports=class{constructor(e,t,{shared:n,cacheHeuristic:i,immutableMinTimeToLive:o,ignoreCargoCult:s,_fromObject:a}={}){if(a){this._fromObject(a);return}if(!t||!t.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(e),this._responseTime=this.now(),this._isShared=n!==!1,this._cacheHeuristic=i!==void 0?i:.1,this._immutableMinTtl=o!==void 0?o:24*3600*1e3,this._status="status"in t?t.status:200,this._resHeaders=t.headers,this._rescc=$_(t.headers["cache-control"]),this._method="method"in e?e.method:"GET",this._url=e.url,this._host=e.headers.host,this._noAuthorization=!e.headers.authorization,this._reqHeaders=t.headers.vary?e.headers:null,this._reqcc=$_(e.headers["cache-control"]),s&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":A6(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),t.headers["cache-control"]==null&&/no-cache/.test(t.headers.pragma)&&(this._rescc["no-cache"]=!0)}now(){return Date.now()}storable(){return!!(!this._reqcc["no-store"]&&(this._method==="GET"||this._method==="HEAD"||this._method==="POST"&&this._hasExplicitExpiration())&&C6.has(this._status)&&!this._rescc["no-store"]&&(!this._isShared||!this._rescc.private)&&(!this._isShared||this._noAuthorization||this._allowsStoringAuthenticated())&&(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||I6.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(e){if(!e||!e.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(e){this._assertRequestHasHeaders(e);let t=$_(e.headers["cache-control"]);return t["no-cache"]||/no-cache/.test(e.headers.pragma)||t["max-age"]&&this.age()>t["max-age"]||t["min-fresh"]&&this.timeToLive()<1e3*t["min-fresh"]||this.stale()&&!(t["max-stale"]&&!this._rescc["must-revalidate"]&&(t["max-stale"]===!0||t["max-stale"]>this.age()-this.maxAge()))?!1:this._requestMatches(e,!1)}_requestMatches(e,t){return(!this._url||this._url===e.url)&&this._host===e.headers.host&&(!e.method||this._method===e.method||t&&e.method==="HEAD")&&this._varyMatches(e)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(e){if(!this._resHeaders.vary)return!0;if(this._resHeaders.vary==="*")return!1;let t=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(let n of t)if(e.headers[n]!==this._reqHeaders[n])return!1;return!0}_copyWithoutHopByHopHeaders(e){let t={};for(let n in e)T6[n]||(t[n]=e[n]);if(e.connection){let n=e.connection.trim().split(/\s*,\s*/);for(let i of n)delete t[i]}if(t.warning){let n=t.warning.split(/,/).filter(i=>!/^\s*1[0-9][0-9]/.test(i));n.length?t.warning=n.join(",").trim():delete t.warning}return t}responseHeaders(){let e=this._copyWithoutHopByHopHeaders(this._resHeaders),t=this.age();return t>3600*24&&!this._hasExplicitExpiration()&&this.maxAge()>3600*24&&(e.warning=(e.warning?`${e.warning}, `:"")+'113 - "rfc7234 5.5.4"'),e.age=`${Math.round(t)}`,e.date=new Date(this.now()).toUTCString(),e}date(){let e=Date.parse(this._resHeaders.date);return isFinite(e)?e:this._responseTime}age(){let e=this._ageValue(),t=(this.now()-this._responseTime)/1e3;return e+t}_ageValue(){return Cs(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"]||this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable||this._resHeaders.vary==="*")return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return Cs(this._rescc["s-maxage"])}if(this._rescc["max-age"])return Cs(this._rescc["max-age"]);let e=this._rescc.immutable?this._immutableMinTtl:0,t=this.date();if(this._resHeaders.expires){let n=Date.parse(this._resHeaders.expires);return Number.isNaN(n)||n<t?0:Math.max(e,(n-t)/1e3)}if(this._resHeaders["last-modified"]){let n=Date.parse(this._resHeaders["last-modified"]);if(isFinite(n)&&t>n)return Math.max(e,(t-n)/1e3*this._cacheHeuristic)}return e}timeToLive(){let e=this.maxAge()-this.age(),t=e+Cs(this._rescc["stale-if-error"]),n=e+Cs(this._rescc["stale-while-revalidate"]);return Math.max(0,e,t,n)*1e3}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+Cs(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+Cs(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(e){return new this(void 0,void 0,{_fromObject:e})}_fromObject(e){if(this._responseTime)throw Error("Reinitialized");if(!e||e.v!==1)throw Error("Invalid serialization");this._responseTime=e.t,this._isShared=e.sh,this._cacheHeuristic=e.ch,this._immutableMinTtl=e.imm!==void 0?e.imm:24*3600*1e3,this._status=e.st,this._resHeaders=e.resh,this._rescc=e.rescc,this._method=e.m,this._url=e.u,this._host=e.h,this._noAuthorization=e.a,this._reqHeaders=e.reqh,this._reqcc=e.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(e){this._assertRequestHasHeaders(e);let t=this._copyWithoutHopByHopHeaders(e.headers);if(delete t["if-range"],!this._requestMatches(e,!0)||!this.storable())return delete t["if-none-match"],delete t["if-modified-since"],t;if(this._resHeaders.etag&&(t["if-none-match"]=t["if-none-match"]?`${t["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag),t["accept-ranges"]||t["if-match"]||t["if-unmodified-since"]||this._method&&this._method!="GET"){if(delete t["if-modified-since"],t["if-none-match"]){let i=t["if-none-match"].split(/,/).filter(o=>!/^\s*W\//.test(o));i.length?t["if-none-match"]=i.join(",").trim():delete t["if-none-match"]}}else this._resHeaders["last-modified"]&&!t["if-modified-since"]&&(t["if-modified-since"]=this._resHeaders["last-modified"]);return t}revalidatedPolicy(e,t){if(this._assertRequestHasHeaders(e),this._useStaleIfError()&&R6(t))return{modified:!1,matches:!1,policy:this};if(!t||!t.headers)throw Error("Response headers missing");let n=!1;if(t.status!==void 0&&t.status!=304?n=!1:t.headers.etag&&!/^\s*W\//.test(t.headers.etag)?n=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===t.headers.etag:this._resHeaders.etag&&t.headers.etag?n=this._resHeaders.etag.replace(/^\s*W\//,"")===t.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?n=this._resHeaders["last-modified"]===t.headers["last-modified"]:!this._resHeaders.etag&&!this._resHeaders["last-modified"]&&!t.headers.etag&&!t.headers["last-modified"]&&(n=!0),!n)return{policy:new this.constructor(e,t),modified:t.status!=304,matches:!1};let i={};for(let s in this._resHeaders)i[s]=s in t.headers&&!E6[s]?t.headers[s]:this._resHeaders[s];let o=Object.assign({},t,{status:this._status,method:this._method,headers:i});return{policy:new this.constructor(e,o,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}}});var om=_((ape,JD)=>{"use strict";JD.exports=r=>{let e={};for(let[t,n]of Object.entries(r))e[t.toLowerCase()]=n;return e}});var XD=_((cpe,YD)=>{"use strict";var k6=g("stream").Readable,D6=om(),H_=class extends k6{constructor(e,t,n,i){if(typeof e!="number")throw new TypeError("Argument `statusCode` should be a number");if(typeof t!="object")throw new TypeError("Argument `headers` should be an object");if(!(n instanceof Buffer))throw new TypeError("Argument `body` should be a buffer");if(typeof i!="string")throw new TypeError("Argument `url` should be a string");super(),this.statusCode=e,this.headers=D6(t),this.body=n,this.url=i}_read(){this.push(this.body),this.push(null)}};YD.exports=H_});var ZD=_((upe,QD)=>{"use strict";var O6=["destroy","setTimeout","socket","headers","trailers","rawHeaders","statusCode","httpVersion","httpVersionMinor","httpVersionMajor","rawTrailers","statusMessage"];QD.exports=(r,e)=>{let t=new Set(Object.keys(r).concat(O6));for(let n of t)n in e||(e[n]=typeof r[n]=="function"?r[n].bind(r):r[n])}});var t1=_((lpe,e1)=>{"use strict";var M6=g("stream").PassThrough,N6=ZD(),L6=r=>{if(!(r&&r.pipe))throw new TypeError("Parameter `response` must be a response stream.");let e=new M6;return N6(r,e),r.pipe(e)};e1.exports=L6});var r1=_(G_=>{G_.stringify=function r(e){if(typeof e>"u")return e;if(e&&Buffer.isBuffer(e))return JSON.stringify(":base64:"+e.toString("base64"));if(e&&e.toJSON&&(e=e.toJSON()),e&&typeof e=="object"){var t="",n=Array.isArray(e);t=n?"[":"{";var i=!0;for(var o in e){var s=typeof e[o]=="function"||!n&&typeof e[o]>"u";Object.hasOwnProperty.call(e,o)&&!s&&(i||(t+=","),i=!1,n?e[o]==null?t+="null":t+=r(e[o]):e[o]!==void 0&&(t+=r(o)+":"+r(e[o])))}return t+=n?"]":"}",t}else return typeof e=="string"?JSON.stringify(/^:/.test(e)?":"+e:e):typeof e>"u"?"null":JSON.stringify(e)};G_.parse=function(r){return JSON.parse(r,function(e,t){return typeof t=="string"?/^:base64:/.test(t)?Buffer.from(t.substring(8),"base64"):/^:/.test(t)?t.substring(1):t:t})}});var s1=_((dpe,o1)=>{"use strict";var F6=g("events"),n1=r1(),B6=r=>{let e={redis:"@keyv/redis",rediss:"@keyv/redis",mongodb:"@keyv/mongo",mongo:"@keyv/mongo",sqlite:"@keyv/sqlite",postgresql:"@keyv/postgres",postgres:"@keyv/postgres",mysql:"@keyv/mysql",etcd:"@keyv/etcd",offline:"@keyv/offline",tiered:"@keyv/tiered"};if(r.adapter||r.uri){let t=r.adapter||/^[^:+]*/.exec(r.uri)[0];return new(g(e[t]))(r)}return new Map},i1=["sqlite","postgres","mysql","mongo","redis","tiered"],z_=class extends F6{constructor(e,{emitErrors:t=!0,...n}={}){if(super(),this.opts={namespace:"keyv",serialize:n1.stringify,deserialize:n1.parse,...typeof e=="string"?{uri:e}:e,...n},!this.opts.store){let o={...this.opts};this.opts.store=B6(o)}if(this.opts.compression){let o=this.opts.compression;this.opts.serialize=o.serialize.bind(o),this.opts.deserialize=o.deserialize.bind(o)}typeof this.opts.store.on=="function"&&t&&this.opts.store.on("error",o=>this.emit("error",o)),this.opts.store.namespace=this.opts.namespace;let i=o=>async function*(){for await(let[s,a]of typeof o=="function"?o(this.opts.store.namespace):o){let c=await this.opts.deserialize(a);if(!(this.opts.store.namespace&&!s.includes(this.opts.store.namespace))){if(typeof c.expires=="number"&&Date.now()>c.expires){this.delete(s);continue}yield[this._getKeyUnprefix(s),c.value]}}};typeof this.opts.store[Symbol.iterator]=="function"&&this.opts.store instanceof Map?this.iterator=i(this.opts.store):typeof this.opts.store.iterator=="function"&&this.opts.store.opts&&this._checkIterableAdaptar()&&(this.iterator=i(this.opts.store.iterator.bind(this.opts.store)))}_checkIterableAdaptar(){return i1.includes(this.opts.store.opts.dialect)||i1.findIndex(e=>this.opts.store.opts.url.includes(e))>=0}_getKeyPrefix(e){return`${this.opts.namespace}:${e}`}_getKeyPrefixArray(e){return e.map(t=>`${this.opts.namespace}:${t}`)}_getKeyUnprefix(e){return e.split(":").splice(1).join(":")}get(e,t){let{store:n}=this.opts,i=Array.isArray(e),o=i?this._getKeyPrefixArray(e):this._getKeyPrefix(e);if(i&&n.getMany===void 0){let s=[];for(let a of o)s.push(Promise.resolve().then(()=>n.get(a)).then(c=>typeof c=="string"?this.opts.deserialize(c):this.opts.compression?this.opts.deserialize(c):c).then(c=>{if(c!=null)return typeof c.expires=="number"&&Date.now()>c.expires?this.delete(a).then(()=>{}):t&&t.raw?c:c.value}));return Promise.allSettled(s).then(a=>{let c=[];for(let u of a)c.push(u.value);return c})}return Promise.resolve().then(()=>i?n.getMany(o):n.get(o)).then(s=>typeof s=="string"?this.opts.deserialize(s):this.opts.compression?this.opts.deserialize(s):s).then(s=>{if(s!=null)return i?s.map((a,c)=>{if(typeof a=="string"&&(a=this.opts.deserialize(a)),a!=null){if(typeof a.expires=="number"&&Date.now()>a.expires){this.delete(e[c]).then(()=>{});return}return t&&t.raw?a:a.value}}):typeof s.expires=="number"&&Date.now()>s.expires?this.delete(e).then(()=>{}):t&&t.raw?s:s.value})}set(e,t,n){let i=this._getKeyPrefix(e);typeof n>"u"&&(n=this.opts.ttl),n===0&&(n=void 0);let{store:o}=this.opts;return Promise.resolve().then(()=>{let s=typeof n=="number"?Date.now()+n:null;return typeof t=="symbol"&&this.emit("error","symbol cannot be serialized"),t={value:t,expires:s},this.opts.serialize(t)}).then(s=>o.set(i,s,n)).then(()=>!0)}delete(e){let{store:t}=this.opts;if(Array.isArray(e)){let i=this._getKeyPrefixArray(e);if(t.deleteMany===void 0){let o=[];for(let s of i)o.push(t.delete(s));return Promise.allSettled(o).then(s=>s.every(a=>a.value===!0))}return Promise.resolve().then(()=>t.deleteMany(i))}let n=this._getKeyPrefix(e);return Promise.resolve().then(()=>t.delete(n))}clear(){let{store:e}=this.opts;return Promise.resolve().then(()=>e.clear())}has(e){let t=this._getKeyPrefix(e),{store:n}=this.opts;return Promise.resolve().then(async()=>typeof n.has=="function"?n.has(t):await n.get(t)!==void 0)}disconnect(){let{store:e}=this.opts;if(typeof e.disconnect=="function")return e.disconnect()}};o1.exports=z_});var u1=_((hpe,c1)=>{"use strict";var U6=g("events"),sm=g("url"),j6=DD(),q6=GD(),K_=KD(),a1=XD(),W6=om(),V6=t1(),$6=s1(),Nl=class r{constructor(e,t){if(typeof e!="function")throw new TypeError("Parameter `request` must be a function");return this.cache=new $6({uri:typeof t=="string"&&t,store:typeof t!="string"&&t,namespace:"cacheable-request"}),this.createCacheableRequest(e)}createCacheableRequest(e){return(t,n)=>{let i;if(typeof t=="string")i=J_(sm.parse(t)),t={};else if(t instanceof sm.URL)i=J_(sm.parse(t.toString())),t={};else{let[p,...d]=(t.path||"").split("?"),f=d.length>0?`?${d.join("?")}`:"";i=J_({...t,pathname:p,search:f})}t={headers:{},method:"GET",cache:!0,strictTtl:!1,automaticFailover:!1,...t,...H6(i)},t.headers=W6(t.headers);let o=new U6,s=j6(sm.format(i),{stripWWW:!1,removeTrailingSlash:!1,stripAuthentication:!1}),a=`${t.method}:${s}`,c=!1,u=!1,l=p=>{u=!0;let d=!1,f,h=new Promise(b=>{f=()=>{d||(d=!0,b())}}),m=b=>{if(c&&!p.forceRefresh){b.status=b.statusCode;let D=K_.fromObject(c.cachePolicy).revalidatedPolicy(p,b);if(!D.modified){let B=D.policy.responseHeaders();b=new a1(c.statusCode,B,c.body,c.url),b.cachePolicy=D.policy,b.fromCache=!0}}b.fromCache||(b.cachePolicy=new K_(p,b,p),b.fromCache=!1);let I;p.cache&&b.cachePolicy.storable()?(I=V6(b),(async()=>{try{let D=q6.buffer(b);if(await Promise.race([h,new Promise(X=>b.once("end",X))]),d)return;let B=await D,Z={cachePolicy:b.cachePolicy.toObject(),url:b.url,statusCode:b.fromCache?c.statusCode:b.statusCode,body:B},F=p.strictTtl?b.cachePolicy.timeToLive():void 0;p.maxTtl&&(F=F?Math.min(F,p.maxTtl):p.maxTtl),await this.cache.set(a,Z,F)}catch(D){o.emit("error",new r.CacheError(D))}})()):p.cache&&c&&(async()=>{try{await this.cache.delete(a)}catch(D){o.emit("error",new r.CacheError(D))}})(),o.emit("response",I||b),typeof n=="function"&&n(I||b)};try{let b=e(p,m);b.once("error",f),b.once("abort",f),o.emit("request",b)}catch(b){o.emit("error",new r.RequestError(b))}};return(async()=>{let p=async f=>{await Promise.resolve();let h=f.cache?await this.cache.get(a):void 0;if(typeof h>"u")return l(f);let m=K_.fromObject(h.cachePolicy);if(m.satisfiesWithoutRevalidation(f)&&!f.forceRefresh){let b=m.responseHeaders(),I=new a1(h.statusCode,b,h.body,h.url);I.cachePolicy=m,I.fromCache=!0,o.emit("response",I),typeof n=="function"&&n(I)}else c=h,f.headers=m.revalidationHeaders(f),l(f)},d=f=>o.emit("error",new r.CacheError(f));this.cache.once("error",d),o.on("response",()=>this.cache.removeListener("error",d));try{await p(t)}catch(f){t.automaticFailover&&!u&&l(t),o.emit("error",new r.CacheError(f))}})(),o}}};function H6(r){let e={...r};return e.path=`${r.pathname||"/"}${r.search||""}`,delete e.pathname,delete e.search,e}function J_(r){return{protocol:r.protocol,auth:r.auth,hostname:r.hostname||r.host||"localhost",port:r.port,pathname:r.pathname,search:r.search}}Nl.RequestError=class extends Error{constructor(r){super(r.message),this.name="RequestError",Object.assign(this,r)}};Nl.CacheError=class extends Error{constructor(r){super(r.message),this.name="CacheError",Object.assign(this,r)}};c1.exports=Nl});var p1=_((ype,l1)=>{"use strict";var G6=["aborted","complete","headers","httpVersion","httpVersionMinor","httpVersionMajor","method","rawHeaders","rawTrailers","setTimeout","socket","statusCode","statusMessage","trailers","url"];l1.exports=(r,e)=>{if(e._readableState.autoDestroy)throw new Error("The second stream must have the `autoDestroy` option set to `false`");let t=new Set(Object.keys(r).concat(G6)),n={};for(let i of t)i in e||(n[i]={get(){let o=r[i];return typeof o=="function"?o.bind(r):o},set(o){r[i]=o},enumerable:!0,configurable:!1});return Object.defineProperties(e,n),r.once("aborted",()=>{e.destroy(),e.emit("aborted")}),r.once("close",()=>{r.complete&&e.readable?e.once("end",()=>{e.emit("close")}):e.emit("close")}),e}});var f1=_((bpe,d1)=>{"use strict";var{Transform:z6,PassThrough:K6}=g("stream"),Y_=g("zlib"),J6=p1();d1.exports=r=>{let e=(r.headers["content-encoding"]||"").toLowerCase();if(!["gzip","deflate","br"].includes(e))return r;let t=e==="br";if(t&&typeof Y_.createBrotliDecompress!="function")return r.destroy(new Error("Brotli is not supported on Node.js < 12")),r;let n=!0,i=new z6({transform(a,c,u){n=!1,u(null,a)},flush(a){a()}}),o=new K6({autoDestroy:!1,destroy(a,c){r.destroy(),c(a)}}),s=t?Y_.createBrotliDecompress():Y_.createUnzip();return s.once("error",a=>{if(n&&!r.readable){o.end();return}o.destroy(a)}),J6(r,o),r.pipe(i).pipe(s).pipe(o),o}});var Q_=_((vpe,h1)=>{"use strict";var X_=class{constructor(e={}){if(!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");this.maxSize=e.maxSize,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_set(e,t){if(this.cache.set(e,t),this._size++,this._size>=this.maxSize){if(this._size=0,typeof this.onEviction=="function")for(let[n,i]of this.oldCache.entries())this.onEviction(n,i);this.oldCache=this.cache,this.cache=new Map}}get(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e)){let t=this.oldCache.get(e);return this.oldCache.delete(e),this._set(e,t),t}}set(e,t){return this.cache.has(e)?this.cache.set(e,t):this._set(e,t),this}has(e){return this.cache.has(e)||this.oldCache.has(e)}peek(e){if(this.cache.has(e))return this.cache.get(e);if(this.oldCache.has(e))return this.oldCache.get(e)}delete(e){let t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}*keys(){for(let[e]of this)yield e}*values(){for(let[,e]of this)yield e}*[Symbol.iterator](){for(let e of this.cache)yield e;for(let e of this.oldCache){let[t]=e;this.cache.has(t)||(yield e)}}get size(){let e=0;for(let t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}};h1.exports=X_});var ew=_((_pe,b1)=>{"use strict";var Y6=g("events"),X6=g("tls"),Q6=g("http2"),Z6=Q_(),zt=Symbol("currentStreamsCount"),m1=Symbol("request"),qr=Symbol("cachedOriginSet"),wc=Symbol("gracefullyClosing"),e8=["maxDeflateDynamicTableSize","maxSessionMemory","maxHeaderListPairs","maxOutstandingPings","maxReservedRemoteStreams","maxSendHeaderBlockLength","paddingStrategy","localAddress","path","rejectUnauthorized","minDHSize","ca","cert","clientCertEngine","ciphers","key","pfx","servername","minVersion","maxVersion","secureProtocol","crl","honorCipherOrder","ecdhCurve","dhparam","secureOptions","sessionIdContext"],t8=(r,e,t)=>{let n=0,i=r.length;for(;n<i;){let o=n+i>>>1;t(r[o],e)?n=o+1:i=o}return n},r8=(r,e)=>r.remoteSettings.maxConcurrentStreams>e.remoteSettings.maxConcurrentStreams,Z_=(r,e)=>{for(let t of r)t[qr].length<e[qr].length&&t[qr].every(n=>e[qr].includes(n))&&t[zt]+e[zt]<=e.remoteSettings.maxConcurrentStreams&&y1(t)},n8=(r,e)=>{for(let t of r)e[qr].length<t[qr].length&&e[qr].every(n=>t[qr].includes(n))&&e[zt]+t[zt]<=t.remoteSettings.maxConcurrentStreams&&y1(e)},g1=({agent:r,isFree:e})=>{let t={};for(let n in r.sessions){let o=r.sessions[n].filter(s=>{let a=s[Ps.kCurrentStreamsCount]<s.remoteSettings.maxConcurrentStreams;return e?a:!a});o.length!==0&&(t[n]=o)}return t},y1=r=>{r[wc]=!0,r[zt]===0&&r.close()},Ps=class r extends Y6{constructor({timeout:e=6e4,maxSessions:t=1/0,maxFreeSessions:n=10,maxCachedTlsSessions:i=100}={}){super(),this.sessions={},this.queue={},this.timeout=e,this.maxSessions=t,this.maxFreeSessions=n,this._freeSessionsCount=0,this._sessionsCount=0,this.settings={enablePush:!1},this.tlsSessionCache=new Z6({maxSize:i})}static normalizeOrigin(e,t){return typeof e=="string"&&(e=new URL(e)),t&&e.hostname!==t&&(e.hostname=t),e.origin}normalizeOptions(e){let t="";if(e)for(let n of e8)e[n]&&(t+=`:${e[n]}`);return t}_tryToCreateNewSession(e,t){if(!(e in this.queue)||!(t in this.queue[e]))return;let n=this.queue[e][t];this._sessionsCount<this.maxSessions&&!n.completed&&(n.completed=!0,n())}getSession(e,t,n){return new Promise((i,o)=>{Array.isArray(n)?(n=[...n],i()):n=[{resolve:i,reject:o}];let s=this.normalizeOptions(t),a=r.normalizeOrigin(e,t&&t.servername);if(a===void 0){for(let{reject:l}of n)l(new TypeError("The `origin` argument needs to be a string or an URL object"));return}if(s in this.sessions){let l=this.sessions[s],p=-1,d=-1,f;for(let h of l){let m=h.remoteSettings.maxConcurrentStreams;if(m<p)break;if(h[qr].includes(a)){let b=h[zt];if(b>=m||h[wc]||h.destroyed)continue;f||(p=m),b>d&&(f=h,d=b)}}if(f){if(n.length!==1){for(let{reject:h}of n){let m=new Error(`Expected the length of listeners to be 1, got ${n.length}.
Please report this to https://github.com/szmarczak/http2-wrapper/`);h(m)}return}n[0].resolve(f);return}}if(s in this.queue){if(a in this.queue[s]){this.queue[s][a].listeners.push(...n),this._tryToCreateNewSession(s,a);return}}else this.queue[s]={};let c=()=>{s in this.queue&&this.queue[s][a]===u&&(delete this.queue[s][a],Object.keys(this.queue[s]).length===0&&delete this.queue[s])},u=()=>{let l=`${a}:${s}`,p=!1;try{let d=Q6.connect(e,{createConnection:this.createConnection,settings:this.settings,session:this.tlsSessionCache.get(l),...t});d[zt]=0,d[wc]=!1;let f=()=>d[zt]<d.remoteSettings.maxConcurrentStreams,h=!0;d.socket.once("session",b=>{this.tlsSessionCache.set(l,b)}),d.once("error",b=>{for(let{reject:I}of n)I(b);this.tlsSessionCache.delete(l)}),d.setTimeout(this.timeout,()=>{d.destroy()}),d.once("close",()=>{if(p){h&&this._freeSessionsCount--,this._sessionsCount--;let b=this.sessions[s];b.splice(b.indexOf(d),1),b.length===0&&delete this.sessions[s]}else{let b=new Error("Session closed without receiving a SETTINGS frame");b.code="HTTP2WRAPPER_NOSETTINGS";for(let{reject:I}of n)I(b);c()}this._tryToCreateNewSession(s,a)});let m=()=>{if(!(!(s in this.queue)||!f())){for(let b of d[qr])if(b in this.queue[s]){let{listeners:I}=this.queue[s][b];for(;I.length!==0&&f();)I.shift().resolve(d);let D=this.queue[s];if(D[b].listeners.length===0&&(delete D[b],Object.keys(D).length===0)){delete this.queue[s];break}if(!f())break}}};d.on("origin",()=>{d[qr]=d.originSet,f()&&(m(),Z_(this.sessions[s],d))}),d.once("remoteSettings",()=>{if(d.ref(),d.unref(),this._sessionsCount++,u.destroyed){let b=new Error("Agent has been destroyed");for(let I of n)I.reject(b);d.destroy();return}d[qr]=d.originSet;{let b=this.sessions;if(s in b){let I=b[s];I.splice(t8(I,d,r8),0,d)}else b[s]=[d]}this._freeSessionsCount+=1,p=!0,this.emit("session",d),m(),c(),d[zt]===0&&this._freeSessionsCount>this.maxFreeSessions&&d.close(),n.length!==0&&(this.getSession(a,t,n),n.length=0),d.on("remoteSettings",()=>{m(),Z_(this.sessions[s],d)})}),d[m1]=d.request,d.request=(b,I)=>{if(d[wc])throw new Error("The session is gracefully closing. No new streams are allowed.");let D=d[m1](b,I);return d.ref(),++d[zt],d[zt]===d.remoteSettings.maxConcurrentStreams&&this._freeSessionsCount--,D.once("close",()=>{if(h=f(),--d[zt],!d.destroyed&&!d.closed&&(n8(this.sessions[s],d),f()&&!d.closed)){h||(this._freeSessionsCount++,h=!0);let B=d[zt]===0;B&&d.unref(),B&&(this._freeSessionsCount>this.maxFreeSessions||d[wc])?d.close():(Z_(this.sessions[s],d),m())}}),D}}catch(d){for(let f of n)f.reject(d);c()}};u.listeners=n,u.completed=!1,u.destroyed=!1,this.queue[s][a]=u,this._tryToCreateNewSession(s,a)})}request(e,t,n,i){return new Promise((o,s)=>{this.getSession(e,t,[{reject:s,resolve:a=>{try{o(a.request(n,i))}catch(c){s(c)}}}])})}createConnection(e,t){return r.connect(e,t)}static connect(e,t){t.ALPNProtocols=["h2"];let n=e.port||443,i=e.hostname||e.host;return typeof t.servername>"u"&&(t.servername=i),X6.connect(n,i,t)}closeFreeSessions(){for(let e of Object.values(this.sessions))for(let t of e)t[zt]===0&&t.close()}destroy(e){for(let t of Object.values(this.sessions))for(let n of t)n.destroy(e);for(let t of Object.values(this.queue))for(let n of Object.values(t))n.destroyed=!0;this.queue={}}get freeSessions(){return g1({agent:this,isFree:!0})}get busySessions(){return g1({agent:this,isFree:!1})}};Ps.kCurrentStreamsCount=zt;Ps.kGracefullyClosing=wc;b1.exports={Agent:Ps,globalAgent:new Ps}});var rw=_((wpe,v1)=>{"use strict";var{Readable:i8}=g("stream"),tw=class extends i8{constructor(e,t){super({highWaterMark:t,autoDestroy:!1}),this.statusCode=null,this.statusMessage="",this.httpVersion="2.0",this.httpVersionMajor=2,this.httpVersionMinor=0,this.headers={},this.trailers={},this.req=null,this.aborted=!1,this.complete=!1,this.upgrade=null,this.rawHeaders=[],this.rawTrailers=[],this.socket=e,this.connection=e,this._dumped=!1}_destroy(e){this.req._request.destroy(e)}setTimeout(e,t){return this.req.setTimeout(e,t),this}_dump(){this._dumped||(this._dumped=!0,this.removeAllListeners("data"),this.resume())}_read(){this.req&&this.req._request.resume()}};v1.exports=tw});var nw=_((Spe,_1)=>{"use strict";_1.exports=r=>{let e={protocol:r.protocol,hostname:typeof r.hostname=="string"&&r.hostname.startsWith("[")?r.hostname.slice(1,-1):r.hostname,host:r.host,hash:r.hash,search:r.search,pathname:r.pathname,href:r.href,path:`${r.pathname||""}${r.search||""}`};return typeof r.port=="string"&&r.port.length!==0&&(e.port=Number(r.port)),(r.username||r.password)&&(e.auth=`${r.username||""}:${r.password||""}`),e}});var S1=_((xpe,w1)=>{"use strict";w1.exports=(r,e,t)=>{for(let n of t)r.on(n,(...i)=>e.emit(n,...i))}});var I1=_((Ipe,x1)=>{"use strict";x1.exports=r=>{switch(r){case":method":case":scheme":case":authority":case":path":return!0;default:return!1}}});var P1=_((Ppe,C1)=>{"use strict";var Sc=(r,e,t)=>{C1.exports[e]=class extends r{constructor(...i){super(typeof t=="string"?t:t(i)),this.name=`${super.name} [${e}]`,this.code=e}}};Sc(TypeError,"ERR_INVALID_ARG_TYPE",r=>{let e=r[0].includes(".")?"property":"argument",t=r[1],n=Array.isArray(t);return n&&(t=`${t.slice(0,-1).join(", ")} or ${t.slice(-1)}`),`The "${r[0]}" ${e} must be ${n?"one of":"of"} type ${t}. Received ${typeof r[2]}`});Sc(TypeError,"ERR_INVALID_PROTOCOL",r=>`Protocol "${r[0]}" not supported. Expected "${r[1]}"`);Sc(Error,"ERR_HTTP_HEADERS_SENT",r=>`Cannot ${r[0]} headers after they are sent to the client`);Sc(TypeError,"ERR_INVALID_HTTP_TOKEN",r=>`${r[0]} must be a valid HTTP token [${r[1]}]`);Sc(TypeError,"ERR_HTTP_INVALID_HEADER_VALUE",r=>`Invalid value "${r[0]} for header "${r[1]}"`);Sc(TypeError,"ERR_INVALID_CHAR",r=>`Invalid character in ${r[0]} [${r[1]}]`)});var cw=_((Tpe,O1)=>{"use strict";var o8=g("http2"),{Writable:s8}=g("stream"),{Agent:T1,globalAgent:a8}=ew(),c8=rw(),u8=nw(),l8=S1(),p8=I1(),{ERR_INVALID_ARG_TYPE:iw,ERR_INVALID_PROTOCOL:d8,ERR_HTTP_HEADERS_SENT:E1,ERR_INVALID_HTTP_TOKEN:f8,ERR_HTTP_INVALID_HEADER_VALUE:h8,ERR_INVALID_CHAR:m8}=P1(),{HTTP2_HEADER_STATUS:R1,HTTP2_HEADER_METHOD:A1,HTTP2_HEADER_PATH:k1,HTTP2_METHOD_CONNECT:g8}=o8.constants,Bt=Symbol("headers"),ow=Symbol("origin"),sw=Symbol("session"),D1=Symbol("options"),am=Symbol("flushedHeaders"),Ll=Symbol("jobs"),y8=/^[\^`\-\w!#$%&*+.|~]+$/,b8=/[^\t\u0020-\u007E\u0080-\u00FF]/,aw=class extends s8{constructor(e,t,n){super({autoDestroy:!1});let i=typeof e=="string"||e instanceof URL;if(i&&(e=u8(e instanceof URL?e:new URL(e))),typeof t=="function"||t===void 0?(n=t,t=i?e:{...e}):t={...e,...t},t.h2session)this[sw]=t.h2session;else if(t.agent===!1)this.agent=new T1({maxFreeSessions:0});else if(typeof t.agent>"u"||t.agent===null)typeof t.createConnection=="function"?(this.agent=new T1({maxFreeSessions:0}),this.agent.createConnection=t.createConnection):this.agent=a8;else if(typeof t.agent.request=="function")this.agent=t.agent;else throw new iw("options.agent",["Agent-like Object","undefined","false"],t.agent);if(t.protocol&&t.protocol!=="https:")throw new d8(t.protocol,"https:");let o=t.port||t.defaultPort||this.agent&&this.agent.defaultPort||443,s=t.hostname||t.host||"localhost";delete t.hostname,delete t.host,delete t.port;let{timeout:a}=t;if(t.timeout=void 0,this[Bt]=Object.create(null),this[Ll]=[],this.socket=null,this.connection=null,this.method=t.method||"GET",this.path=t.path,this.res=null,this.aborted=!1,this.reusedSocket=!1,t.headers)for(let[c,u]of Object.entries(t.headers))this.setHeader(c,u);t.auth&&!("authorization"in this[Bt])&&(this[Bt].authorization="Basic "+Buffer.from(t.auth).toString("base64")),t.session=t.tlsSession,t.path=t.socketPath,this[D1]=t,o===443?(this[ow]=`https://${s}`,":authority"in this[Bt]||(this[Bt][":authority"]=s)):(this[ow]=`https://${s}:${o}`,":authority"in this[Bt]||(this[Bt][":authority"]=`${s}:${o}`)),a&&this.setTimeout(a),n&&this.once("response",n),this[am]=!1}get method(){return this[Bt][A1]}set method(e){e&&(this[Bt][A1]=e.toUpperCase())}get path(){return this[Bt][k1]}set path(e){e&&(this[Bt][k1]=e)}get _mustNotHaveABody(){return this.method==="GET"||this.method==="HEAD"||this.method==="DELETE"}_write(e,t,n){if(this._mustNotHaveABody){n(new Error("The GET, HEAD and DELETE methods must NOT have a body"));return}this.flushHeaders();let i=()=>this._request.write(e,t,n);this._request?i():this[Ll].push(i)}_final(e){if(this.destroyed)return;this.flushHeaders();let t=()=>{if(this._mustNotHaveABody){e();return}this._request.end(e)};this._request?t():this[Ll].push(t)}abort(){this.res&&this.res.complete||(this.aborted||process.nextTick(()=>this.emit("abort")),this.aborted=!0,this.destroy())}_destroy(e,t){this.res&&this.res._dump(),this._request&&this._request.destroy(),t(e)}async flushHeaders(){if(this[am]||this.destroyed)return;this[am]=!0;let e=this.method===g8,t=n=>{if(this._request=n,this.destroyed){n.destroy();return}e||l8(n,this,["timeout","continue","close","error"]);let i=s=>(...a)=>{!this.writable&&!this.destroyed?s(...a):this.once("finish",()=>{s(...a)})};n.once("response",i((s,a,c)=>{let u=new c8(this.socket,n.readableHighWaterMark);this.res=u,u.req=this,u.statusCode=s[R1],u.headers=s,u.rawHeaders=c,u.once("end",()=>{this.aborted?(u.aborted=!0,u.emit("aborted")):(u.complete=!0,u.socket=null,u.connection=null)}),e?(u.upgrade=!0,this.emit("connect",u,n,Buffer.alloc(0))?this.emit("close"):n.destroy()):(n.on("data",l=>{!u._dumped&&!u.push(l)&&n.pause()}),n.once("end",()=>{u.push(null)}),this.emit("response",u)||u._dump())})),n.once("headers",i(s=>this.emit("information",{statusCode:s[R1]}))),n.once("trailers",i((s,a,c)=>{let{res:u}=this;u.trailers=s,u.rawTrailers=c}));let{socket:o}=n.session;this.socket=o,this.connection=o;for(let s of this[Ll])s();this.emit("socket",this.socket)};if(this[sw])try{t(this[sw].request(this[Bt]))}catch(n){this.emit("error",n)}else{this.reusedSocket=!0;try{t(await this.agent.request(this[ow],this[D1],this[Bt]))}catch(n){this.emit("error",n)}}}getHeader(e){if(typeof e!="string")throw new iw("name","string",e);return this[Bt][e.toLowerCase()]}get headersSent(){return this[am]}removeHeader(e){if(typeof e!="string")throw new iw("name","string",e);if(this.headersSent)throw new E1("remove");delete this[Bt][e.toLowerCase()]}setHeader(e,t){if(this.headersSent)throw new E1("set");if(typeof e!="string"||!y8.test(e)&&!p8(e))throw new f8("Header name",e);if(typeof t>"u")throw new h8(t,e);if(b8.test(t))throw new m8("header content",e);this[Bt][e.toLowerCase()]=t}setNoDelay(){}setSocketKeepAlive(){}setTimeout(e,t){let n=()=>this._request.setTimeout(e,t);return this._request?n():this[Ll].push(n),this}get maxHeadersCount(){if(!this.destroyed&&this._request)return this._request.session.localSettings.maxHeaderListSize}set maxHeadersCount(e){}};O1.exports=aw});var N1=_((Epe,M1)=>{"use strict";var v8=g("tls");M1.exports=(r={},e=v8.connect)=>new Promise((t,n)=>{let i=!1,o,s=async()=>{await c,o.off("timeout",a),o.off("error",n),r.resolveSocket?(t({alpnProtocol:o.alpnProtocol,socket:o,timeout:i}),i&&(await Promise.resolve(),o.emit("timeout"))):(o.destroy(),t({alpnProtocol:o.alpnProtocol,timeout:i}))},a=async()=>{i=!0,s()},c=(async()=>{try{o=await e(r,s),o.on("error",n),o.once("timeout",a)}catch(u){n(u)}})()})});var F1=_((Rpe,L1)=>{"use strict";var _8=g("net");L1.exports=r=>{let e=r.host,t=r.headers&&r.headers.host;return t&&(t.startsWith("[")?t.indexOf("]")===-1?e=t:e=t.slice(1,-1):e=t.split(":",1)[0]),_8.isIP(e)?"":e}});var j1=_((Ape,lw)=>{"use strict";var B1=g("http"),uw=g("https"),w8=N1(),S8=Q_(),x8=cw(),I8=F1(),C8=nw(),cm=new S8({maxSize:100}),Fl=new Map,U1=(r,e,t)=>{e._httpMessage={shouldKeepAlive:!0};let n=()=>{r.emit("free",e,t)};e.on("free",n);let i=()=>{r.removeSocket(e,t)};e.on("close",i);let o=()=>{r.removeSocket(e,t),e.off("close",i),e.off("free",n),e.off("agentRemove",o)};e.on("agentRemove",o),r.emit("free",e,t)},P8=async r=>{let e=`${r.host}:${r.port}:${r.ALPNProtocols.sort()}`;if(!cm.has(e)){if(Fl.has(e))return(await Fl.get(e)).alpnProtocol;let{path:t,agent:n}=r;r.path=r.socketPath;let i=w8(r);Fl.set(e,i);try{let{socket:o,alpnProtocol:s}=await i;if(cm.set(e,s),r.path=t,s==="h2")o.destroy();else{let{globalAgent:a}=uw,c=uw.Agent.prototype.createConnection;n?n.createConnection===c?U1(n,o,r):o.destroy():a.createConnection===c?U1(a,o,r):o.destroy()}return Fl.delete(e),s}catch(o){throw Fl.delete(e),o}}return cm.get(e)};lw.exports=async(r,e,t)=>{if((typeof r=="string"||r instanceof URL)&&(r=C8(new URL(r))),typeof e=="function"&&(t=e,e=void 0),e={ALPNProtocols:["h2","http/1.1"],...r,...e,resolveSocket:!0},!Array.isArray(e.ALPNProtocols)||e.ALPNProtocols.length===0)throw new Error("The `ALPNProtocols` option must be an Array with at least one entry");e.protocol=e.protocol||"https:";let n=e.protocol==="https:";e.host=e.hostname||e.host||"localhost",e.session=e.tlsSession,e.servername=e.servername||I8(e),e.port=e.port||(n?443:80),e._defaultAgent=n?uw.globalAgent:B1.globalAgent;let i=e.agent;if(i){if(i.addRequest)throw new Error("The `options.agent` object can contain only `http`, `https` or `http2` properties");e.agent=i[n?"https":"http"]}return n&&await P8(e)==="h2"?(i&&(e.agent=i.http2),new x8(e,t)):B1.request(e,t)};lw.exports.protocolCache=cm});var W1=_((kpe,q1)=>{"use strict";var T8=g("http2"),E8=ew(),pw=cw(),R8=rw(),A8=j1(),k8=(r,e,t)=>new pw(r,e,t),D8=(r,e,t)=>{let n=new pw(r,e,t);return n.end(),n};q1.exports={...T8,ClientRequest:pw,IncomingMessage:R8,...E8,request:k8,get:D8,auto:A8}});var fw=_(dw=>{"use strict";Object.defineProperty(dw,"__esModule",{value:!0});var V1=Ei();dw.default=r=>V1.default.nodeStream(r)&&V1.default.function_(r.getBoundary)});var z1=_(hw=>{"use strict";Object.defineProperty(hw,"__esModule",{value:!0});var H1=g("fs"),G1=g("util"),$1=Ei(),O8=fw(),M8=G1.promisify(H1.stat);hw.default=async(r,e)=>{if(e&&"content-length"in e)return Number(e["content-length"]);if(!r)return 0;if($1.default.string(r))return Buffer.byteLength(r);if($1.default.buffer(r))return r.length;if(O8.default(r))return G1.promisify(r.getLength.bind(r))();if(r instanceof H1.ReadStream){let{size:t}=await M8(r.path);return t===0?void 0:t}}});var gw=_(mw=>{"use strict";Object.defineProperty(mw,"__esModule",{value:!0});function N8(r,e,t){let n={};for(let i of t)n[i]=(...o)=>{e.emit(i,...o)},r.on(i,n[i]);return()=>{for(let i of t)r.off(i,n[i])}}mw.default=N8});var K1=_(yw=>{"use strict";Object.defineProperty(yw,"__esModule",{value:!0});yw.default=()=>{let r=[];return{once(e,t,n){e.once(t,n),r.push({origin:e,event:t,fn:n})},unhandleAll(){for(let e of r){let{origin:t,event:n,fn:i}=e;t.removeListener(n,i)}r.length=0}}}});var Y1=_(Bl=>{"use strict";Object.defineProperty(Bl,"__esModule",{value:!0});Bl.TimeoutError=void 0;var L8=g("net"),F8=K1(),J1=Symbol("reentry"),B8=()=>{},um=class extends Error{constructor(e,t){super(`Timeout awaiting '${t}' for ${e}ms`),this.event=t,this.name="TimeoutError",this.code="ETIMEDOUT"}};Bl.TimeoutError=um;Bl.default=(r,e,t)=>{if(J1 in r)return B8;r[J1]=!0;let n=[],{once:i,unhandleAll:o}=F8.default(),s=(p,d,f)=>{var h;let m=setTimeout(d,p,p,f);(h=m.unref)===null||h===void 0||h.call(m);let b=()=>{clearTimeout(m)};return n.push(b),b},{host:a,hostname:c}=t,u=(p,d)=>{r.destroy(new um(p,d))},l=()=>{for(let p of n)p();o()};if(r.once("error",p=>{if(l(),r.listenerCount("error")===0)throw p}),r.once("close",l),i(r,"response",p=>{i(p,"end",l)}),typeof e.request<"u"&&s(e.request,u,"request"),typeof e.socket<"u"){let p=()=>{u(e.socket,"socket")};r.setTimeout(e.socket,p),n.push(()=>{r.removeListener("timeout",p)})}return i(r,"socket",p=>{var d;let{socketPath:f}=r;if(p.connecting){let h=!!(f??L8.isIP((d=c??a)!==null&&d!==void 0?d:"")!==0);if(typeof e.lookup<"u"&&!h&&typeof p.address().address>"u"){let m=s(e.lookup,u,"lookup");i(p,"lookup",m)}if(typeof e.connect<"u"){let m=()=>s(e.connect,u,"connect");h?i(p,"connect",m()):i(p,"lookup",b=>{b===null&&i(p,"connect",m())})}typeof e.secureConnect<"u"&&t.protocol==="https:"&&i(p,"connect",()=>{let m=s(e.secureConnect,u,"secureConnect");i(p,"secureConnect",m)})}if(typeof e.send<"u"){let h=()=>s(e.send,u,"send");p.connecting?i(p,"connect",()=>{i(r,"upload-complete",h())}):i(r,"upload-complete",h())}}),typeof e.response<"u"&&i(r,"upload-complete",()=>{let p=s(e.response,u,"response");i(r,"response",p)}),l}});var Q1=_(bw=>{"use strict";Object.defineProperty(bw,"__esModule",{value:!0});var X1=Ei();bw.default=r=>{r=r;let e={protocol:r.protocol,hostname:X1.default.string(r.hostname)&&r.hostname.startsWith("[")?r.hostname.slice(1,-1):r.hostname,host:r.host,hash:r.hash,search:r.search,pathname:r.pathname,href:r.href,path:`${r.pathname||""}${r.search||""}`};return X1.default.string(r.port)&&r.port.length>0&&(e.port=Number(r.port)),(r.username||r.password)&&(e.auth=`${r.username||""}:${r.password||""}`),e}});var Z1=_(vw=>{"use strict";Object.defineProperty(vw,"__esModule",{value:!0});var U8=g("url"),j8=["protocol","host","hostname","port","pathname","search"];vw.default=(r,e)=>{var t,n;if(e.path){if(e.pathname)throw new TypeError("Parameters `path` and `pathname` are mutually exclusive.");if(e.search)throw new TypeError("Parameters `path` and `search` are mutually exclusive.");if(e.searchParams)throw new TypeError("Parameters `path` and `searchParams` are mutually exclusive.")}if(e.search&&e.searchParams)throw new TypeError("Parameters `search` and `searchParams` are mutually exclusive.");if(!r){if(!e.protocol)throw new TypeError("No URL protocol specified");r=`${e.protocol}//${(n=(t=e.hostname)!==null&&t!==void 0?t:e.host)!==null&&n!==void 0?n:""}`}let i=new U8.URL(r);if(e.path){let o=e.path.indexOf("?");o===-1?e.pathname=e.path:(e.pathname=e.path.slice(0,o),e.search=e.path.slice(o+1)),delete e.path}for(let o of j8)e[o]&&(i[o]=e[o].toString());return i}});var eO=_(ww=>{"use strict";Object.defineProperty(ww,"__esModule",{value:!0});var _w=class{constructor(){this.weakMap=new WeakMap,this.map=new Map}set(e,t){typeof e=="object"?this.weakMap.set(e,t):this.map.set(e,t)}get(e){return typeof e=="object"?this.weakMap.get(e):this.map.get(e)}has(e){return typeof e=="object"?this.weakMap.has(e):this.map.has(e)}};ww.default=_w});var xw=_(Sw=>{"use strict";Object.defineProperty(Sw,"__esModule",{value:!0});var q8=async r=>{let e=[],t=0;for await(let n of r)e.push(n),t+=Buffer.byteLength(n);return Buffer.isBuffer(e[0])?Buffer.concat(e,t):Buffer.from(e.join(""))};Sw.default=q8});var rO=_(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.dnsLookupIpVersionToFamily=Ts.isDnsLookupIpVersion=void 0;var tO={auto:0,ipv4:4,ipv6:6};Ts.isDnsLookupIpVersion=r=>r in tO;Ts.dnsLookupIpVersionToFamily=r=>{if(Ts.isDnsLookupIpVersion(r))return tO[r];throw new Error("Invalid DNS lookup IP version")}});var Iw=_(lm=>{"use strict";Object.defineProperty(lm,"__esModule",{value:!0});lm.isResponseOk=void 0;lm.isResponseOk=r=>{let{statusCode:e}=r,t=r.request.options.followRedirect?299:399;return e>=200&&e<=t||e===304}});var iO=_(Cw=>{"use strict";Object.defineProperty(Cw,"__esModule",{value:!0});var nO=new Set;Cw.default=r=>{nO.has(r)||(nO.add(r),process.emitWarning(`Got: ${r}`,{type:"DeprecationWarning"}))}});var oO=_(Pw=>{"use strict";Object.defineProperty(Pw,"__esModule",{value:!0});var Le=Ei(),W8=(r,e)=>{if(Le.default.null_(r.encoding))throw new TypeError("To get a Buffer, set `options.responseType` to `buffer` instead");Le.assert.any([Le.default.string,Le.default.undefined],r.encoding),Le.assert.any([Le.default.boolean,Le.default.undefined],r.resolveBodyOnly),Le.assert.any([Le.default.boolean,Le.default.undefined],r.methodRewriting),Le.assert.any([Le.default.boolean,Le.default.undefined],r.isStream),Le.assert.any([Le.default.string,Le.default.undefined],r.responseType),r.responseType===void 0&&(r.responseType="text");let{retry:t}=r;if(e?r.retry={...e.retry}:r.retry={calculateDelay:n=>n.computedValue,limit:0,methods:[],statusCodes:[],errorCodes:[],maxRetryAfter:void 0},Le.default.object(t)?(r.retry={...r.retry,...t},r.retry.methods=[...new Set(r.retry.methods.map(n=>n.toUpperCase()))],r.retry.statusCodes=[...new Set(r.retry.statusCodes)],r.retry.errorCodes=[...new Set(r.retry.errorCodes)]):Le.default.number(t)&&(r.retry.limit=t),Le.default.undefined(r.retry.maxRetryAfter)&&(r.retry.maxRetryAfter=Math.min(...[r.timeout.request,r.timeout.connect].filter(Le.default.number))),Le.default.object(r.pagination)){e&&(r.pagination={...e.pagination,...r.pagination});let{pagination:n}=r;if(!Le.default.function_(n.transform))throw new Error("`options.pagination.transform` must be implemented");if(!Le.default.function_(n.shouldContinue))throw new Error("`options.pagination.shouldContinue` must be implemented");if(!Le.default.function_(n.filter))throw new TypeError("`options.pagination.filter` must be implemented");if(!Le.default.function_(n.paginate))throw new Error("`options.pagination.paginate` must be implemented")}return r.responseType==="json"&&r.headers.accept===void 0&&(r.headers.accept="application/json"),r};Pw.default=W8});var sO=_(Ul=>{"use strict";Object.defineProperty(Ul,"__esModule",{value:!0});Ul.retryAfterStatusCodes=void 0;Ul.retryAfterStatusCodes=new Set([413,429,503]);var V8=({attemptCount:r,retryOptions:e,error:t,retryAfter:n})=>{if(r>e.limit)return 0;let i=e.methods.includes(t.options.method),o=e.errorCodes.includes(t.code),s=t.response&&e.statusCodes.includes(t.response.statusCode);if(!i||!o&&!s)return 0;if(t.response){if(n)return e.maxRetryAfter===void 0||n>e.maxRetryAfter?0:n;if(t.response.statusCode===413)return 0}let a=Math.random()*100;return 2**(r-1)*1e3+a};Ul.default=V8});var Wl=_(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.UnsupportedProtocolError=me.ReadError=me.TimeoutError=me.UploadError=me.CacheError=me.HTTPError=me.MaxRedirectsError=me.RequestError=me.setNonEnumerableProperties=me.knownHookEvents=me.withoutBody=me.kIsNormalizedAlready=void 0;var aO=g("util"),cO=g("stream"),$8=g("fs"),mo=g("url"),uO=g("http"),Tw=g("http"),H8=g("https"),G8=SD(),z8=RD(),lO=u1(),K8=f1(),J8=W1(),Y8=om(),C=Ei(),X8=z1(),pO=fw(),Q8=gw(),dO=Y1(),Z8=Q1(),fO=Z1(),eK=eO(),tK=xw(),hO=rO(),rK=Iw(),go=iO(),nK=oO(),iK=sO(),Ew,It=Symbol("request"),fm=Symbol("response"),xc=Symbol("responseSize"),Ic=Symbol("downloadedSize"),Cc=Symbol("bodySize"),Pc=Symbol("uploadedSize"),pm=Symbol("serverResponsesPiped"),mO=Symbol("unproxyEvents"),gO=Symbol("isFromCache"),Rw=Symbol("cancelTimeouts"),yO=Symbol("startedReading"),Tc=Symbol("stopReading"),dm=Symbol("triggerRead"),yo=Symbol("body"),jl=Symbol("jobs"),bO=Symbol("originalResponse"),vO=Symbol("retryTimeout");me.kIsNormalizedAlready=Symbol("isNormalizedAlready");var oK=C.default.string(process.versions.brotli);me.withoutBody=new Set(["GET","HEAD"]);me.knownHookEvents=["init","beforeRequest","beforeRedirect","beforeError","beforeRetry","afterResponse"];function sK(r){for(let e in r){let t=r[e];if(!C.default.string(t)&&!C.default.number(t)&&!C.default.boolean(t)&&!C.default.null_(t)&&!C.default.undefined(t))throw new TypeError(`The \`searchParams\` value '${String(t)}' must be a string, number, boolean or null`)}}function aK(r){return C.default.object(r)&&!("statusCode"in r)}var Aw=new eK.default,cK=async r=>new Promise((e,t)=>{let n=i=>{t(i)};r.pending||e(),r.once("error",n),r.once("ready",()=>{r.off("error",n),e()})}),uK=new Set([300,301,302,303,304,307,308]),lK=["context","body","json","form"];me.setNonEnumerableProperties=(r,e)=>{let t={};for(let n of r)if(n)for(let i of lK)i in n&&(t[i]={writable:!0,configurable:!0,enumerable:!1,value:n[i]});Object.defineProperties(e,t)};var et=class extends Error{constructor(e,t,n){var i,o;if(super(e),Error.captureStackTrace(this,this.constructor),this.name="RequestError",this.code=(i=t.code)!==null&&i!==void 0?i:"ERR_GOT_REQUEST_ERROR",n instanceof _m?(Object.defineProperty(this,"request",{enumerable:!1,value:n}),Object.defineProperty(this,"response",{enumerable:!1,value:n[fm]}),Object.defineProperty(this,"options",{enumerable:!1,value:n.options})):Object.defineProperty(this,"options",{enumerable:!1,value:n}),this.timings=(o=this.request)===null||o===void 0?void 0:o.timings,C.default.string(t.stack)&&C.default.string(this.stack)){let s=this.stack.indexOf(this.message)+this.message.length,a=this.stack.slice(s).split(`
`).reverse(),c=t.stack.slice(t.stack.indexOf(t.message)+t.message.length).split(`
`).reverse();for(;c.length!==0&&c[0]===a[0];)a.shift();this.stack=`${this.stack.slice(0,s)}${a.reverse().join(`
`)}${c.reverse().join(`
`)}`}}};me.RequestError=et;var hm=class extends et{constructor(e){super(`Redirected ${e.options.maxRedirects} times. Aborting.`,{},e),this.name="MaxRedirectsError",this.code="ERR_TOO_MANY_REDIRECTS"}};me.MaxRedirectsError=hm;var mm=class extends et{constructor(e){super(`Response code ${e.statusCode} (${e.statusMessage})`,{},e.request),this.name="HTTPError",this.code="ERR_NON_2XX_3XX_RESPONSE"}};me.HTTPError=mm;var gm=class extends et{constructor(e,t){super(e.message,e,t),this.name="CacheError",this.code=this.code==="ERR_GOT_REQUEST_ERROR"?"ERR_CACHE_ACCESS":this.code}};me.CacheError=gm;var ym=class extends et{constructor(e,t){super(e.message,e,t),this.name="UploadError",this.code=this.code==="ERR_GOT_REQUEST_ERROR"?"ERR_UPLOAD":this.code}};me.UploadError=ym;var bm=class extends et{constructor(e,t,n){super(e.message,e,n),this.name="TimeoutError",this.event=e.event,this.timings=t}};me.TimeoutError=bm;var ql=class extends et{constructor(e,t){super(e.message,e,t),this.name="ReadError",this.code=this.code==="ERR_GOT_REQUEST_ERROR"?"ERR_READING_RESPONSE_STREAM":this.code}};me.ReadError=ql;var vm=class extends et{constructor(e){super(`Unsupported protocol "${e.url.protocol}"`,{},e),this.name="UnsupportedProtocolError",this.code="ERR_UNSUPPORTED_PROTOCOL"}};me.UnsupportedProtocolError=vm;var pK=["socket","connect","continue","information","upgrade","timeout"],_m=class extends cO.Duplex{constructor(e,t={},n){super({autoDestroy:!1,highWaterMark:0}),this[Ic]=0,this[Pc]=0,this.requestInitialized=!1,this[pm]=new Set,this.redirects=[],this[Tc]=!1,this[dm]=!1,this[jl]=[],this.retryCount=0,this._progressCallbacks=[];let i=()=>this._unlockWrite(),o=()=>this._lockWrite();this.on("pipe",u=>{u.prependListener("data",i),u.on("data",o),u.prependListener("end",i),u.on("end",o)}),this.on("unpipe",u=>{u.off("data",i),u.off("data",o),u.off("end",i),u.off("end",o)}),this.on("pipe",u=>{u instanceof Tw.IncomingMessage&&(this.options.headers={...u.headers,...this.options.headers})});let{json:s,body:a,form:c}=t;if((s||a||c)&&this._lockWrite(),me.kIsNormalizedAlready in t)this.options=t;else try{this.options=this.constructor.normalizeArguments(e,t,n)}catch(u){C.default.nodeStream(t.body)&&t.body.destroy(),this.destroy(u);return}(async()=>{var u;try{this.options.body instanceof $8.ReadStream&&await cK(this.options.body);let{url:l}=this.options;if(!l)throw new TypeError("Missing `url` property");if(this.requestUrl=l.toString(),decodeURI(this.requestUrl),await this._finalizeBody(),await this._makeRequest(),this.destroyed){(u=this[It])===null||u===void 0||u.destroy();return}for(let p of this[jl])p();this[jl].length=0,this.requestInitialized=!0}catch(l){if(l instanceof et){this._beforeError(l);return}this.destroyed||this.destroy(l)}})()}static normalizeArguments(e,t,n){var i,o,s,a,c;let u=t;if(C.default.object(e)&&!C.default.urlInstance(e))t={...n,...e,...t};else{if(e&&t&&t.url!==void 0)throw new TypeError("The `url` option is mutually exclusive with the `input` argument");t={...n,...t},e!==void 0&&(t.url=e),C.default.urlInstance(t.url)&&(t.url=new mo.URL(t.url.toString()))}if(t.cache===!1&&(t.cache=void 0),t.dnsCache===!1&&(t.dnsCache=void 0),C.assert.any([C.default.string,C.default.undefined],t.method),C.assert.any([C.default.object,C.default.undefined],t.headers),C.assert.any([C.default.string,C.default.urlInstance,C.default.undefined],t.prefixUrl),C.assert.any([C.default.object,C.default.undefined],t.cookieJar),C.assert.any([C.default.object,C.default.string,C.default.undefined],t.searchParams),C.assert.any([C.default.object,C.default.string,C.default.undefined],t.cache),C.assert.any([C.default.object,C.default.number,C.default.undefined],t.timeout),C.assert.any([C.default.object,C.default.undefined],t.context),C.assert.any([C.default.object,C.default.undefined],t.hooks),C.assert.any([C.default.boolean,C.default.undefined],t.decompress),C.assert.any([C.default.boolean,C.default.undefined],t.ignoreInvalidCookies),C.assert.any([C.default.boolean,C.default.undefined],t.followRedirect),C.assert.any([C.default.number,C.default.undefined],t.maxRedirects),C.assert.any([C.default.boolean,C.default.undefined],t.throwHttpErrors),C.assert.any([C.default.boolean,C.default.undefined],t.http2),C.assert.any([C.default.boolean,C.default.undefined],t.allowGetBody),C.assert.any([C.default.string,C.default.undefined],t.localAddress),C.assert.any([hO.isDnsLookupIpVersion,C.default.undefined],t.dnsLookupIpVersion),C.assert.any([C.default.object,C.default.undefined],t.https),C.assert.any([C.default.boolean,C.default.undefined],t.rejectUnauthorized),t.https&&(C.assert.any([C.default.boolean,C.default.undefined],t.https.rejectUnauthorized),C.assert.any([C.default.function_,C.default.undefined],t.https.checkServerIdentity),C.assert.any([C.default.string,C.default.object,C.default.array,C.default.undefined],t.https.certificateAuthority),C.assert.any([C.default.string,C.default.object,C.default.array,C.default.undefined],t.https.key),C.assert.any([C.default.string,C.default.object,C.default.array,C.default.undefined],t.https.certificate),C.assert.any([C.default.string,C.default.undefined],t.https.passphrase),C.assert.any([C.default.string,C.default.buffer,C.default.array,C.default.undefined],t.https.pfx)),C.assert.any([C.default.object,C.default.undefined],t.cacheOptions),C.default.string(t.method)?t.method=t.method.toUpperCase():t.method="GET",t.headers===n?.headers?t.headers={...t.headers}:t.headers=Y8({...n?.headers,...t.headers}),"slashes"in t)throw new TypeError("The legacy `url.Url` has been deprecated. Use `URL` instead.");if("auth"in t)throw new TypeError("Parameter `auth` is deprecated. Use `username` / `password` instead.");if("searchParams"in t&&t.searchParams&&t.searchParams!==n?.searchParams){let f;if(C.default.string(t.searchParams)||t.searchParams instanceof mo.URLSearchParams)f=new mo.URLSearchParams(t.searchParams);else{sK(t.searchParams),f=new mo.URLSearchParams;for(let h in t.searchParams){let m=t.searchParams[h];m===null?f.append(h,""):m!==void 0&&f.append(h,m)}}(i=n?.searchParams)===null||i===void 0||i.forEach((h,m)=>{f.has(m)||f.append(m,h)}),t.searchParams=f}if(t.username=(o=t.username)!==null&&o!==void 0?o:"",t.password=(s=t.password)!==null&&s!==void 0?s:"",C.default.undefined(t.prefixUrl)?t.prefixUrl=(a=n?.prefixUrl)!==null&&a!==void 0?a:"":(t.prefixUrl=t.prefixUrl.toString(),t.prefixUrl!==""&&!t.prefixUrl.endsWith("/")&&(t.prefixUrl+="/")),C.default.string(t.url)){if(t.url.startsWith("/"))throw new Error("`input` must not start with a slash when using `prefixUrl`");t.url=fO.default(t.prefixUrl+t.url,t)}else(C.default.undefined(t.url)&&t.prefixUrl!==""||t.protocol)&&(t.url=fO.default(t.prefixUrl,t));if(t.url){"port"in t&&delete t.port;let{prefixUrl:f}=t;Object.defineProperty(t,"prefixUrl",{set:m=>{let b=t.url;if(!b.href.startsWith(m))throw new Error(`Cannot change \`prefixUrl\` from ${f} to ${m}: ${b.href}`);t.url=new mo.URL(m+b.href.slice(f.length)),f=m},get:()=>f});let{protocol:h}=t.url;if(h==="unix:"&&(h="http:",t.url=new mo.URL(`http://unix${t.url.pathname}${t.url.search}`)),t.searchParams&&(t.url.search=t.searchParams.toString()),h!=="http:"&&h!=="https:")throw new vm(t);t.username===""?t.username=t.url.username:t.url.username=t.username,t.password===""?t.password=t.url.password:t.url.password=t.password}let{cookieJar:l}=t;if(l){let{setCookie:f,getCookieString:h}=l;C.assert.function_(f),C.assert.function_(h),f.length===4&&h.length===0&&(f=aO.promisify(f.bind(t.cookieJar)),h=aO.promisify(h.bind(t.cookieJar)),t.cookieJar={setCookie:f,getCookieString:h})}let{cache:p}=t;if(p&&(Aw.has(p)||Aw.set(p,new lO((f,h)=>{let m=f[It](f,h);return C.default.promise(m)&&(m.once=(b,I)=>{if(b==="error")m.catch(I);else if(b==="abort")(async()=>{try{(await m).once("abort",I)}catch{}})();else throw new Error(`Unknown HTTP2 promise event: ${b}`);return m}),m},p))),t.cacheOptions={...t.cacheOptions},t.dnsCache===!0)Ew||(Ew=new z8.default),t.dnsCache=Ew;else if(!C.default.undefined(t.dnsCache)&&!t.dnsCache.lookup)throw new TypeError(`Parameter \`dnsCache\` must be a CacheableLookup instance or a boolean, got ${C.default(t.dnsCache)}`);C.default.number(t.timeout)?t.timeout={request:t.timeout}:n&&t.timeout!==n.timeout?t.timeout={...n.timeout,...t.timeout}:t.timeout={...t.timeout},t.context||(t.context={});let d=t.hooks===n?.hooks;t.hooks={...t.hooks};for(let f of me.knownHookEvents)if(f in t.hooks)if(C.default.array(t.hooks[f]))t.hooks[f]=[...t.hooks[f]];else throw new TypeError(`Parameter \`${f}\` must be an Array, got ${C.default(t.hooks[f])}`);else t.hooks[f]=[];if(n&&!d)for(let f of me.knownHookEvents)n.hooks[f].length>0&&(t.hooks[f]=[...n.hooks[f],...t.hooks[f]]);if("family"in t&&go.default('"options.family" was never documented, please use "options.dnsLookupIpVersion"'),n?.https&&(t.https={...n.https,...t.https}),"rejectUnauthorized"in t&&go.default('"options.rejectUnauthorized" is now deprecated, please use "options.https.rejectUnauthorized"'),"checkServerIdentity"in t&&go.default('"options.checkServerIdentity" was never documented, please use "options.https.checkServerIdentity"'),"ca"in t&&go.default('"options.ca" was never documented, please use "options.https.certificateAuthority"'),"key"in t&&go.default('"options.key" was never documented, please use "options.https.key"'),"cert"in t&&go.default('"options.cert" was never documented, please use "options.https.certificate"'),"passphrase"in t&&go.default('"options.passphrase" was never documented, please use "options.https.passphrase"'),"pfx"in t&&go.default('"options.pfx" was never documented, please use "options.https.pfx"'),"followRedirects"in t)throw new TypeError("The `followRedirects` option does not exist. Use `followRedirect` instead.");if(t.agent){for(let f in t.agent)if(f!=="http"&&f!=="https"&&f!=="http2")throw new TypeError(`Expected the \`options.agent\` properties to be \`http\`, \`https\` or \`http2\`, got \`${f}\``)}return t.maxRedirects=(c=t.maxRedirects)!==null&&c!==void 0?c:0,me.setNonEnumerableProperties([n,u],t),nK.default(t,n)}_lockWrite(){let e=()=>{throw new TypeError("The payload has been already provided")};this.write=e,this.end=e}_unlockWrite(){this.write=super.write,this.end=super.end}async _finalizeBody(){let{options:e}=this,{headers:t}=e,n=!C.default.undefined(e.form),i=!C.default.undefined(e.json),o=!C.default.undefined(e.body),s=n||i||o,a=me.withoutBody.has(e.method)&&!(e.method==="GET"&&e.allowGetBody);if(this._cannotHaveBody=a,s){if(a)throw new TypeError(`The \`${e.method}\` method cannot be used with a body`);if([o,n,i].filter(c=>c).length>1)throw new TypeError("The `body`, `json` and `form` options are mutually exclusive");if(o&&!(e.body instanceof cO.Readable)&&!C.default.string(e.body)&&!C.default.buffer(e.body)&&!pO.default(e.body))throw new TypeError("The `body` option must be a stream.Readable, string or Buffer");if(n&&!C.default.object(e.form))throw new TypeError("The `form` option must be an Object");{let c=!C.default.string(t["content-type"]);o?(pO.default(e.body)&&c&&(t["content-type"]=`multipart/form-data; boundary=${e.body.getBoundary()}`),this[yo]=e.body):n?(c&&(t["content-type"]="application/x-www-form-urlencoded"),this[yo]=new mo.URLSearchParams(e.form).toString()):(c&&(t["content-type"]="application/json"),this[yo]=e.stringifyJson(e.json));let u=await X8.default(this[yo],e.headers);C.default.undefined(t["content-length"])&&C.default.undefined(t["transfer-encoding"])&&!a&&!C.default.undefined(u)&&(t["content-length"]=String(u))}}else a?this._lockWrite():this._unlockWrite();this[Cc]=Number(t["content-length"])||void 0}async _onResponseBase(e){let{options:t}=this,{url:n}=t;this[bO]=e,t.decompress&&(e=K8(e));let i=e.statusCode,o=e;o.statusMessage=o.statusMessage?o.statusMessage:uO.STATUS_CODES[i],o.url=t.url.toString(),o.requestUrl=this.requestUrl,o.redirectUrls=this.redirects,o.request=this,o.isFromCache=e.fromCache||!1,o.ip=this.ip,o.retryCount=this.retryCount,this[gO]=o.isFromCache,this[xc]=Number(e.headers["content-length"])||void 0,this[fm]=e,e.once("end",()=>{this[xc]=this[Ic],this.emit("downloadProgress",this.downloadProgress)}),e.once("error",a=>{e.destroy(),this._beforeError(new ql(a,this))}),e.once("aborted",()=>{this._beforeError(new ql({name:"Error",message:"The server aborted pending request",code:"ECONNRESET"},this))}),this.emit("downloadProgress",this.downloadProgress);let s=e.headers["set-cookie"];if(C.default.object(t.cookieJar)&&s){let a=s.map(async c=>t.cookieJar.setCookie(c,n.toString()));t.ignoreInvalidCookies&&(a=a.map(async c=>c.catch(()=>{})));try{await Promise.all(a)}catch(c){this._beforeError(c);return}}if(t.followRedirect&&e.headers.location&&uK.has(i)){if(e.resume(),this[It]&&(this[Rw](),delete this[It],this[mO]()),(i===303&&t.method!=="GET"&&t.method!=="HEAD"||!t.methodRewriting)&&(t.method="GET","body"in t&&delete t.body,"json"in t&&delete t.json,"form"in t&&delete t.form,this[yo]=void 0,delete t.headers["content-length"]),this.redirects.length>=t.maxRedirects){this._beforeError(new hm(this));return}try{let p=function(d){return d.protocol==="unix:"||d.hostname==="unix"},c=Buffer.from(e.headers.location,"binary").toString(),u=new mo.URL(c,n),l=u.toString();if(decodeURI(l),!p(n)&&p(u)){this._beforeError(new et("Cannot redirect to UNIX socket",{},this));return}u.hostname!==n.hostname||u.port!==n.port?("host"in t.headers&&delete t.headers.host,"cookie"in t.headers&&delete t.headers.cookie,"authorization"in t.headers&&delete t.headers.authorization,(t.username||t.password)&&(t.username="",t.password="")):(u.username=t.username,u.password=t.password),this.redirects.push(l),t.url=u;for(let d of t.hooks.beforeRedirect)await d(t,o);this.emit("redirect",o,t),await this._makeRequest()}catch(c){this._beforeError(c);return}return}if(t.isStream&&t.throwHttpErrors&&!rK.isResponseOk(o)){this._beforeError(new mm(o));return}e.on("readable",()=>{this[dm]&&this._read()}),this.on("resume",()=>{e.resume()}),this.on("pause",()=>{e.pause()}),e.once("end",()=>{this.push(null)}),this.emit("response",e);for(let a of this[pm])if(!a.headersSent){for(let c in e.headers){let u=t.decompress?c!=="content-encoding":!0,l=e.headers[c];u&&a.setHeader(c,l)}a.statusCode=i}}async _onResponse(e){try{await this._onResponseBase(e)}catch(t){this._beforeError(t)}}_onRequest(e){let{options:t}=this,{timeout:n,url:i}=t;G8.default(e),this[Rw]=dO.default(e,n,i);let o=t.cache?"cacheableResponse":"response";e.once(o,c=>{this._onResponse(c)}),e.once("error",c=>{var u;e.destroy(),(u=e.res)===null||u===void 0||u.removeAllListeners("end"),c=c instanceof dO.TimeoutError?new bm(c,this.timings,this):new et(c.message,c,this),this._beforeError(c)}),this[mO]=Q8.default(e,this,pK),this[It]=e,this.emit("uploadProgress",this.uploadProgress);let s=this[yo],a=this.redirects.length===0?this:e;C.default.nodeStream(s)?(s.pipe(a),s.once("error",c=>{this._beforeError(new ym(c,this))})):(this._unlockWrite(),C.default.undefined(s)?(this._cannotHaveBody||this._noPipe)&&(a.end(),this._lockWrite()):(this._writeRequest(s,void 0,()=>{}),a.end(),this._lockWrite())),this.emit("request",e)}async _createCacheableRequest(e,t){return new Promise((n,i)=>{Object.assign(t,Z8.default(e)),delete t.url;let o,s=Aw.get(t.cache)(t,async a=>{a._readableState.autoDestroy=!1,o&&(await o).emit("cacheableResponse",a),n(a)});t.url=e,s.once("error",i),s.once("request",async a=>{o=a,n(o)})})}async _makeRequest(){var e,t,n,i,o;let{options:s}=this,{headers:a}=s;for(let I in a)if(C.default.undefined(a[I]))delete a[I];else if(C.default.null_(a[I]))throw new TypeError(`Use \`undefined\` instead of \`null\` to delete the \`${I}\` header`);if(s.decompress&&C.default.undefined(a["accept-encoding"])&&(a["accept-encoding"]=oK?"gzip, deflate, br":"gzip, deflate"),s.cookieJar){let I=await s.cookieJar.getCookieString(s.url.toString());C.default.nonEmptyString(I)&&(s.headers.cookie=I)}for(let I of s.hooks.beforeRequest){let D=await I(s);if(!C.default.undefined(D)){s.request=()=>D;break}}s.body&&this[yo]!==s.body&&(this[yo]=s.body);let{agent:c,request:u,timeout:l,url:p}=s;if(s.dnsCache&&!("lookup"in s)&&(s.lookup=s.dnsCache.lookup),p.hostname==="unix"){let I=/(?<socketPath>.+?):(?<path>.+)/.exec(`${p.pathname}${p.search}`);if(I?.groups){let{socketPath:D,path:B}=I.groups;Object.assign(s,{socketPath:D,path:B,host:""})}}let d=p.protocol==="https:",f;s.http2?f=J8.auto:f=d?H8.request:uO.request;let h=(e=s.request)!==null&&e!==void 0?e:f,m=s.cache?this._createCacheableRequest:h;c&&!s.http2&&(s.agent=c[d?"https":"http"]),s[It]=h,delete s.request,delete s.timeout;let b=s;if(b.shared=(t=s.cacheOptions)===null||t===void 0?void 0:t.shared,b.cacheHeuristic=(n=s.cacheOptions)===null||n===void 0?void 0:n.cacheHeuristic,b.immutableMinTimeToLive=(i=s.cacheOptions)===null||i===void 0?void 0:i.immutableMinTimeToLive,b.ignoreCargoCult=(o=s.cacheOptions)===null||o===void 0?void 0:o.ignoreCargoCult,s.dnsLookupIpVersion!==void 0)try{b.family=hO.dnsLookupIpVersionToFamily(s.dnsLookupIpVersion)}catch{throw new Error("Invalid `dnsLookupIpVersion` option value")}s.https&&("rejectUnauthorized"in s.https&&(b.rejectUnauthorized=s.https.rejectUnauthorized),s.https.checkServerIdentity&&(b.checkServerIdentity=s.https.checkServerIdentity),s.https.certificateAuthority&&(b.ca=s.https.certificateAuthority),s.https.certificate&&(b.cert=s.https.certificate),s.https.key&&(b.key=s.https.key),s.https.passphrase&&(b.passphrase=s.https.passphrase),s.https.pfx&&(b.pfx=s.https.pfx));try{let I=await m(p,b);C.default.undefined(I)&&(I=f(p,b)),s.request=u,s.timeout=l,s.agent=c,s.https&&("rejectUnauthorized"in s.https&&delete b.rejectUnauthorized,s.https.checkServerIdentity&&delete b.checkServerIdentity,s.https.certificateAuthority&&delete b.ca,s.https.certificate&&delete b.cert,s.https.key&&delete b.key,s.https.passphrase&&delete b.passphrase,s.https.pfx&&delete b.pfx),aK(I)?this._onRequest(I):this.writable?(this.once("finish",()=>{this._onResponse(I)}),this._unlockWrite(),this.end(),this._lockWrite()):this._onResponse(I)}catch(I){throw I instanceof lO.CacheError?new gm(I,this):new et(I.message,I,this)}}async _error(e){try{for(let t of this.options.hooks.beforeError)e=await t(e)}catch(t){e=new et(t.message,t,this)}this.destroy(e)}_beforeError(e){if(this[Tc])return;let{options:t}=this,n=this.retryCount+1;this[Tc]=!0,e instanceof et||(e=new et(e.message,e,this));let i=e,{response:o}=i;(async()=>{if(o&&!o.body){o.setEncoding(this._readableState.encoding);try{o.rawBody=await tK.default(o),o.body=o.rawBody.toString()}catch{}}if(this.listenerCount("retry")!==0){let s;try{let a;o&&"retry-after"in o.headers&&(a=Number(o.headers["retry-after"]),Number.isNaN(a)?(a=Date.parse(o.headers["retry-after"])-Date.now(),a<=0&&(a=1)):a*=1e3),s=await t.retry.calculateDelay({attemptCount:n,retryOptions:t.retry,error:i,retryAfter:a,computedValue:iK.default({attemptCount:n,retryOptions:t.retry,error:i,retryAfter:a,computedValue:0})})}catch(a){this._error(new et(a.message,a,this));return}if(s){let a=async()=>{try{for(let c of this.options.hooks.beforeRetry)await c(this.options,i,n)}catch(c){this._error(new et(c.message,e,this));return}this.destroyed||(this.destroy(),this.emit("retry",n,e))};this[vO]=setTimeout(a,s);return}}this._error(i)})()}_read(){this[dm]=!0;let e=this[fm];if(e&&!this[Tc]){e.readableLength&&(this[dm]=!1);let t;for(;(t=e.read())!==null;){this[Ic]+=t.length,this[yO]=!0;let n=this.downloadProgress;n.percent<1&&this.emit("downloadProgress",n),this.push(t)}}}_write(e,t,n){let i=()=>{this._writeRequest(e,t,n)};this.requestInitialized?i():this[jl].push(i)}_writeRequest(e,t,n){this[It].destroyed||(this._progressCallbacks.push(()=>{this[Pc]+=Buffer.byteLength(e,t);let i=this.uploadProgress;i.percent<1&&this.emit("uploadProgress",i)}),this[It].write(e,t,i=>{!i&&this._progressCallbacks.length>0&&this._progressCallbacks.shift()(),n(i)}))}_final(e){let t=()=>{for(;this._progressCallbacks.length!==0;)this._progressCallbacks.shift()();if(!(It in this)){e();return}if(this[It].destroyed){e();return}this[It].end(n=>{n||(this[Cc]=this[Pc],this.emit("uploadProgress",this.uploadProgress),this[It].emit("upload-complete")),e(n)})};this.requestInitialized?t():this[jl].push(t)}_destroy(e,t){var n;this[Tc]=!0,clearTimeout(this[vO]),It in this&&(this[Rw](),!((n=this[fm])===null||n===void 0)&&n.complete||this[It].destroy()),e!==null&&!C.default.undefined(e)&&!(e instanceof et)&&(e=new et(e.message,e,this)),t(e)}get _isAboutToError(){return this[Tc]}get ip(){var e;return(e=this.socket)===null||e===void 0?void 0:e.remoteAddress}get aborted(){var e,t,n;return((t=(e=this[It])===null||e===void 0?void 0:e.destroyed)!==null&&t!==void 0?t:this.destroyed)&&!(!((n=this[bO])===null||n===void 0)&&n.complete)}get socket(){var e,t;return(t=(e=this[It])===null||e===void 0?void 0:e.socket)!==null&&t!==void 0?t:void 0}get downloadProgress(){let e;return this[xc]?e=this[Ic]/this[xc]:this[xc]===this[Ic]?e=1:e=0,{percent:e,transferred:this[Ic],total:this[xc]}}get uploadProgress(){let e;return this[Cc]?e=this[Pc]/this[Cc]:this[Cc]===this[Pc]?e=1:e=0,{percent:e,transferred:this[Pc],total:this[Cc]}}get timings(){var e;return(e=this[It])===null||e===void 0?void 0:e.timings}get isFromCache(){return this[gO]}pipe(e,t){if(this[yO])throw new Error("Failed to pipe. The response has been emitted already.");return e instanceof Tw.ServerResponse&&this[pm].add(e),super.pipe(e,t)}unpipe(e){return e instanceof Tw.ServerResponse&&this[pm].delete(e),super.unpipe(e),this}};me.default=_m});var Vl=_(on=>{"use strict";var dK=on&&on.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),fK=on&&on.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&dK(e,r,t)};Object.defineProperty(on,"__esModule",{value:!0});on.CancelError=on.ParseError=void 0;var _O=Wl(),kw=class extends _O.RequestError{constructor(e,t){let{options:n}=t.request;super(`${e.message} in "${n.url.toString()}"`,e,t.request),this.name="ParseError",this.code=this.code==="ERR_GOT_REQUEST_ERROR"?"ERR_BODY_PARSE_FAILURE":this.code}};on.ParseError=kw;var Dw=class extends _O.RequestError{constructor(e){super("Promise was canceled",{},e),this.name="CancelError",this.code="ERR_CANCELED"}get isCanceled(){return!0}};on.CancelError=Dw;fK(Wl(),on)});var SO=_(Ow=>{"use strict";Object.defineProperty(Ow,"__esModule",{value:!0});var wO=Vl(),hK=(r,e,t,n)=>{let{rawBody:i}=r;try{if(e==="text")return i.toString(n);if(e==="json")return i.length===0?"":t(i.toString());if(e==="buffer")return i;throw new wO.ParseError({message:`Unknown body type '${e}'`,name:"Error"},r)}catch(o){throw new wO.ParseError(o,r)}};Ow.default=hK});var Mw=_(bo=>{"use strict";var mK=bo&&bo.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),gK=bo&&bo.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&mK(e,r,t)};Object.defineProperty(bo,"__esModule",{value:!0});var yK=g("events"),bK=Ei(),vK=_D(),wm=Vl(),xO=SO(),IO=Wl(),_K=gw(),wK=xw(),CO=Iw(),SK=["request","response","redirect","uploadProgress","downloadProgress"];function PO(r){let e,t,n=new yK.EventEmitter,i=new vK((s,a,c)=>{let u=l=>{let p=new IO.default(void 0,r);p.retryCount=l,p._noPipe=!0,c(()=>p.destroy()),c.shouldReject=!1,c(()=>a(new wm.CancelError(p))),e=p,p.once("response",async h=>{var m;if(h.retryCount=l,h.request.aborted)return;let b;try{b=await wK.default(p),h.rawBody=b}catch{return}if(p._isAboutToError)return;let I=((m=h.headers["content-encoding"])!==null&&m!==void 0?m:"").toLowerCase(),D=["gzip","deflate","br"].includes(I),{options:B}=p;if(D&&!B.decompress)h.body=b;else try{h.body=xO.default(h,B.responseType,B.parseJson,B.encoding)}catch(Z){if(h.body=b.toString(),CO.isResponseOk(h)){p._beforeError(Z);return}}try{for(let[Z,F]of B.hooks.afterResponse.entries())h=await F(h,async X=>{let H=IO.default.normalizeArguments(void 0,{...X,retry:{calculateDelay:()=>0},throwHttpErrors:!1,resolveBodyOnly:!1},B);H.hooks.afterResponse=H.hooks.afterResponse.slice(0,Z);for(let te of H.hooks.beforeRetry)await te(H);let j=PO(H);return c(()=>{j.catch(()=>{}),j.cancel()}),j})}catch(Z){p._beforeError(new wm.RequestError(Z.message,Z,p));return}if(t=h,!CO.isResponseOk(h)){p._beforeError(new wm.HTTPError(h));return}p.destroy(),s(p.options.resolveBodyOnly?h.body:h)});let d=h=>{if(i.isCanceled)return;let{options:m}=p;if(h instanceof wm.HTTPError&&!m.throwHttpErrors){let{response:b}=h;s(p.options.resolveBodyOnly?b.body:b);return}a(h)};p.once("error",d);let f=p.options.body;p.once("retry",(h,m)=>{var b,I;if(f===((b=m.request)===null||b===void 0?void 0:b.options.body)&&bK.default.nodeStream((I=m.request)===null||I===void 0?void 0:I.options.body)){d(m);return}u(h)}),_K.default(p,n,SK)};u(0)});i.on=(s,a)=>(n.on(s,a),i);let o=s=>{let a=(async()=>{await i;let{options:c}=t.request;return xO.default(t,s,c.parseJson,c.encoding)})();return Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)),a};return i.json=()=>{let{headers:s}=e.options;return!e.writableFinished&&s.accept===void 0&&(s.accept="application/json"),o("json")},i.buffer=()=>o("buffer"),i.text=()=>o("text"),i}bo.default=PO;gK(Vl(),bo)});var TO=_(Nw=>{"use strict";Object.defineProperty(Nw,"__esModule",{value:!0});var xK=Vl();function IK(r,...e){let t=(async()=>{if(r instanceof xK.RequestError)try{for(let i of e)if(i)for(let o of i)r=await o(r)}catch(i){r=i}throw r})(),n=()=>t;return t.json=n,t.text=n,t.buffer=n,t.on=n,t}Nw.default=IK});var AO=_(Lw=>{"use strict";Object.defineProperty(Lw,"__esModule",{value:!0});var EO=Ei();function RO(r){for(let e of Object.values(r))(EO.default.plainObject(e)||EO.default.array(e))&&RO(e);return Object.freeze(r)}Lw.default=RO});var DO=_(kO=>{"use strict";Object.defineProperty(kO,"__esModule",{value:!0})});var Fw=_(Vr=>{"use strict";var CK=Vr&&Vr.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),PK=Vr&&Vr.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&CK(e,r,t)};Object.defineProperty(Vr,"__esModule",{value:!0});Vr.defaultHandler=void 0;var OO=Ei(),Wr=Mw(),TK=TO(),xm=Wl(),EK=AO(),RK={RequestError:Wr.RequestError,CacheError:Wr.CacheError,ReadError:Wr.ReadError,HTTPError:Wr.HTTPError,MaxRedirectsError:Wr.MaxRedirectsError,TimeoutError:Wr.TimeoutError,ParseError:Wr.ParseError,CancelError:Wr.CancelError,UnsupportedProtocolError:Wr.UnsupportedProtocolError,UploadError:Wr.UploadError},AK=async r=>new Promise(e=>{setTimeout(e,r)}),{normalizeArguments:Sm}=xm.default,MO=(...r)=>{let e;for(let t of r)e=Sm(void 0,t,e);return e},kK=r=>r.isStream?new xm.default(void 0,r):Wr.default(r),DK=r=>"defaults"in r&&"options"in r.defaults,OK=["get","post","put","patch","head","delete"];Vr.defaultHandler=(r,e)=>e(r);var NO=(r,e)=>{if(r)for(let t of r)t(e)},LO=r=>{r._rawHandlers=r.handlers,r.handlers=r.handlers.map(n=>(i,o)=>{let s,a=n(i,c=>(s=o(c),s));if(a!==s&&!i.isStream&&s){let c=a,{then:u,catch:l,finally:p}=c;Object.setPrototypeOf(c,Object.getPrototypeOf(s)),Object.defineProperties(c,Object.getOwnPropertyDescriptors(s)),c.then=u,c.catch=l,c.finally=p}return a});let e=(n,i={},o)=>{var s,a;let c=0,u=l=>r.handlers[c++](l,c===r.handlers.length?kK:u);if(OO.default.plainObject(n)){let l={...n,...i};xm.setNonEnumerableProperties([n,i],l),i=l,n=void 0}try{let l;try{NO(r.options.hooks.init,i),NO((s=i.hooks)===null||s===void 0?void 0:s.init,i)}catch(d){l=d}let p=Sm(n,i,o??r.options);if(p[xm.kIsNormalizedAlready]=!0,l)throw new Wr.RequestError(l.message,l,p);return u(p)}catch(l){if(i.isStream)throw l;return TK.default(l,r.options.hooks.beforeError,(a=i.hooks)===null||a===void 0?void 0:a.beforeError)}};e.extend=(...n)=>{let i=[r.options],o=[...r._rawHandlers],s;for(let a of n)DK(a)?(i.push(a.defaults.options),o.push(...a.defaults._rawHandlers),s=a.defaults.mutableDefaults):(i.push(a),"handlers"in a&&o.push(...a.handlers),s=a.mutableDefaults);return o=o.filter(a=>a!==Vr.defaultHandler),o.length===0&&o.push(Vr.defaultHandler),LO({options:MO(...i),handlers:o,mutableDefaults:!!s})};let t=async function*(n,i){let o=Sm(n,i,r.options);o.resolveBodyOnly=!1;let s=o.pagination;if(!OO.default.object(s))throw new TypeError("`options.pagination` must be implemented");let a=[],{countLimit:c}=s,u=0;for(;u<s.requestLimit;){u!==0&&await AK(s.backoff);let l=await e(void 0,void 0,o),p=await s.transform(l),d=[];for(let h of p)if(s.filter(h,a,d)&&(!s.shouldContinue(h,a,d)||(yield h,s.stackAllItems&&a.push(h),d.push(h),--c<=0)))return;let f=s.paginate(l,a,d);if(f===!1)return;f===l.request.options?o=l.request.options:f!==void 0&&(o=Sm(void 0,f,o)),u++}};e.paginate=t,e.paginate.all=async(n,i)=>{let o=[];for await(let s of t(n,i))o.push(s);return o},e.paginate.each=t,e.stream=(n,i)=>e(n,{...i,isStream:!0});for(let n of OK)e[n]=(i,o)=>e(i,{...o,method:n}),e.stream[n]=(i,o)=>e(i,{...o,method:n,isStream:!0});return Object.assign(e,RK),Object.defineProperty(e,"defaults",{value:r.mutableDefaults?r:EK.default(r),writable:r.mutableDefaults,configurable:r.mutableDefaults,enumerable:!0}),e.mergeOptions=MO,e};Vr.default=LO;PK(DO(),Vr)});var UO=_((Ri,Im)=>{"use strict";var MK=Ri&&Ri.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),FO=Ri&&Ri.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&MK(e,r,t)};Object.defineProperty(Ri,"__esModule",{value:!0});var NK=g("url"),BO=Fw(),LK={options:{method:"GET",retry:{limit:2,methods:["GET","PUT","HEAD","DELETE","OPTIONS","TRACE"],statusCodes:[408,413,429,500,502,503,504,521,522,524],errorCodes:["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","ENETUNREACH","EAI_AGAIN"],maxRetryAfter:void 0,calculateDelay:({computedValue:r})=>r},timeout:{},headers:{"user-agent":"got (https://github.com/sindresorhus/got)"},hooks:{init:[],beforeRequest:[],beforeRedirect:[],beforeRetry:[],beforeError:[],afterResponse:[]},cache:void 0,dnsCache:void 0,decompress:!0,throwHttpErrors:!0,followRedirect:!0,isStream:!1,responseType:"text",resolveBodyOnly:!1,maxRedirects:10,prefixUrl:"",methodRewriting:!0,ignoreInvalidCookies:!1,context:{},http2:!1,allowGetBody:!1,https:void 0,pagination:{transform:r=>r.request.options.responseType==="json"?r.body:JSON.parse(r.body),paginate:r=>{if(!Reflect.has(r.headers,"link"))return!1;let e=r.headers.link.split(","),t;for(let n of e){let i=n.split(";");if(i[1].includes("next")){t=i[0].trimStart().trim(),t=t.slice(1,-1);break}}return t?{url:new NK.URL(t)}:!1},filter:()=>!0,shouldContinue:()=>!0,countLimit:1/0,backoff:0,requestLimit:1e4,stackAllItems:!0},parseJson:r=>JSON.parse(r),stringifyJson:r=>JSON.stringify(r),cacheOptions:{}},handlers:[BO.defaultHandler],mutableDefaults:!1},Bw=BO.default(LK);Ri.default=Bw;Im.exports=Bw;Im.exports.default=Bw;Im.exports.__esModule=!0;FO(Fw(),Ri);FO(Mw(),Ri)});async function Uw(){if(JO.default.platform!=="darwin")throw new Error("macOS only");let{stdout:r}=await jK("defaults",["read","com.apple.LaunchServices/com.apple.launchservices.secure","LSHandlers"]);return/LSHandlerRoleAll = "(?!-)(?<id>[^"]+?)";\s+?LSHandlerURLScheme = (?:http|https);/.exec(r)?.groups.id??"com.apple.Safari"}var KO,JO,YO,jK,XO=lu(()=>{KO=g("node:util"),JO=S(g("node:process"),1),YO=g("node:child_process"),jK=(0,KO.promisify)(YO.execFile)});async function eM(r,{humanReadableOutput:e=!0}={}){if(QO.default.platform!=="darwin")throw new Error("macOS only");let t=e?[]:["-ss"],{stdout:n}=await qK("osascript",["-e",r,t]);return n.trim()}var QO,ZO,jw,qK,tM=lu(()=>{QO=S(g("node:process"),1),ZO=g("node:util"),jw=g("node:child_process"),qK=(0,ZO.promisify)(jw.execFile)});async function qw(r){return eM(`tell application "Finder" to set app_path to application file id "${r}" as string
tell application "System Events" to get value of property list item "CFBundleName" of property list file (app_path & ":Contents:Info.plist")`)}var rM=lu(()=>{tM()});async function Ww(r=WK){let{stdout:e}=await r("reg",["QUERY"," HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\Shell\\Associations\\UrlAssociations\\http\\UserChoice","/v","ProgId"]),t=/ProgId\s*REG_SZ\s*(?<id>\S+)/.exec(e);if(!t)throw new Tm(`Cannot find Windows browser in stdout: ${JSON.stringify(e)}`);let{id:n}=t.groups,i=VK[n];if(!i)throw new Tm(`Unknown browser ID: ${n}`);return i}var nM,iM,WK,VK,Tm,oM=lu(()=>{nM=g("node:util"),iM=g("node:child_process"),WK=(0,nM.promisify)(iM.execFile),VK={AppXq0fevzme2pys62n3e0fbqa7peapykr8v:{name:"Edge",id:"com.microsoft.edge.old"},MSEdgeDHTML:{name:"Edge",id:"com.microsoft.edge"},MSEdgeHTM:{name:"Edge",id:"com.microsoft.edge"},"IE.HTTP":{name:"Internet Explorer",id:"com.microsoft.ie"},FirefoxURL:{name:"Firefox",id:"org.mozilla.firefox"},ChromeHTML:{name:"Chrome",id:"com.google.chrome"},BraveHTML:{name:"Brave",id:"com.brave.Browser"},BraveBHTML:{name:"Brave Beta",id:"com.brave.Browser.beta"},BraveSSHTM:{name:"Brave Nightly",id:"com.brave.Browser.nightly"}},Tm=class extends Error{}});var uM={};YF(uM,{default:()=>cM});async function cM(){if(Em.default.platform==="darwin"){let r=await Uw();return{name:await qw(r),id:r}}if(Em.default.platform==="linux"){let{stdout:r}=await $K("xdg-mime",["query","default","x-scheme-handler/http"]),e=r.trim();return{name:HK(e.replace(/.desktop$/,"").replace("-"," ")),id:e}}if(Em.default.platform==="win32")return Ww();throw new Error("Only macOS, Linux, and Windows are supported")}var sM,Em,aM,$K,HK,lM=lu(()=>{sM=g("node:util"),Em=S(g("node:process"),1),aM=g("node:child_process");XO();rM();oM();$K=(0,sM.promisify)(aM.execFile),HK=r=>r.toLowerCase().replaceAll(/(?:^|\s|-)\S/g,e=>e.toUpperCase())});var mM=_((Tfe,hM)=>{"use strict";function zK(r){var e=new r,t=e;function n(){var o=e;return o.next?e=o.next:(e=new r,t=e),o.next=null,o}function i(o){t.next=o,t=o}return{get:n,release:i}}hM.exports=zK});var yM=_((Efe,$w)=>{"use strict";var KK=mM();function gM(r,e,t){if(typeof r=="function"&&(t=e,e=r,r=null),t<1)throw new Error("fastqueue concurrency must be greater than 1");var n=KK(JK),i=null,o=null,s=0,a=null,c={push:m,drain:Gr,saturated:Gr,pause:l,paused:!1,concurrency:t,running:u,resume:f,idle:h,length:p,getQueue:d,unshift:b,empty:Gr,kill:D,killAndDrain:B,error:Z};return c;function u(){return s}function l(){c.paused=!0}function p(){for(var F=i,X=0;F;)F=F.next,X++;return X}function d(){for(var F=i,X=[];F;)X.push(F.value),F=F.next;return X}function f(){if(c.paused){c.paused=!1;for(var F=0;F<c.concurrency;F++)s++,I()}}function h(){return s===0&&c.length()===0}function m(F,X){var H=n.get();H.context=r,H.release=I,H.value=F,H.callback=X||Gr,H.errorHandler=a,s===c.concurrency||c.paused?o?(o.next=H,o=H):(i=H,o=H,c.saturated()):(s++,e.call(r,H.value,H.worked))}function b(F,X){var H=n.get();H.context=r,H.release=I,H.value=F,H.callback=X||Gr,s===c.concurrency||c.paused?i?(H.next=i,i=H):(i=H,o=H,c.saturated()):(s++,e.call(r,H.value,H.worked))}function I(F){F&&n.release(F);var X=i;X?c.paused?s--:(o===i&&(o=null),i=X.next,X.next=null,e.call(r,X.value,X.worked),o===null&&c.empty()):--s===0&&c.drain()}function D(){i=null,o=null,c.drain=Gr}function B(){i=null,o=null,c.drain(),c.drain=Gr}function Z(F){a=F}}function Gr(){}function JK(){this.value=null,this.callback=Gr,this.next=null,this.release=Gr,this.context=null,this.errorHandler=null;var r=this;this.worked=function(t,n){var i=r.callback,o=r.errorHandler,s=r.value;r.value=null,r.callback=Gr,r.errorHandler&&o(t,s),i.call(r.context,t,n),r.release(r)}}function YK(r,e,t){typeof r=="function"&&(t=e,e=r,r=null);function n(l,p){e.call(this,l).then(function(d){p(null,d)},p)}var i=gM(r,n,t),o=i.push,s=i.unshift;return i.push=a,i.unshift=c,i.drained=u,i;function a(l){var p=new Promise(function(d,f){o(l,function(h,m){if(h){f(h);return}d(m)})});return p.catch(Gr),p}function c(l){var p=new Promise(function(d,f){s(l,function(h,m){if(h){f(h);return}d(m)})});return p.catch(Gr),p}function u(){if(i.idle())return new Promise(function(d){d()});var l=i.drain,p=new Promise(function(d){i.drain=function(){l(),d()}});return p}}$w.exports=gM;$w.exports.promise=YK});var Hw=_((Rfe,bM)=>{bM.exports=function(r,e){if(typeof r!="string")throw new TypeError("expected path to be a string");if(r==="\\"||r==="/")return"/";var t=r.length;if(t<=1)return r;var n="";if(t>4&&r[3]==="\\"){var i=r[2];(i==="?"||i===".")&&r.slice(0,2)==="\\\\"&&(r=r.slice(2),n="//")}var o=r.split(/[/\\]+/);return e!==!1&&o[o.length-1]===""&&o.pop(),n+o.join("/")}});var IM=_((SM,xM)=>{"use strict";Object.defineProperty(SM,"__esModule",{value:!0});var wM=Zb(),XK=Hw(),vM="!",QK={returnIndex:!1},ZK=r=>Array.isArray(r)?r:[r],e9=(r,e)=>{if(typeof r=="function")return r;if(typeof r=="string"){let t=wM(r,e);return n=>r===n||t(n)}return r instanceof RegExp?t=>r.test(t):t=>!1},_M=(r,e,t,n)=>{let i=Array.isArray(t),o=i?t[0]:t;if(!i&&typeof o!="string")throw new TypeError("anymatch: second argument must be a string: got "+Object.prototype.toString.call(o));let s=XK(o,!1);for(let c=0;c<e.length;c++){let u=e[c];if(u(s))return n?-1:!1}let a=i&&[s].concat(t.slice(1));for(let c=0;c<r.length;c++){let u=r[c];if(i?u(...a):u(s))return n?c:!0}return n?-1:!1},Gw=(r,e,t=QK)=>{if(r==null)throw new TypeError("anymatch: specify first argument");let n=typeof t=="boolean"?{returnIndex:t}:t,i=n.returnIndex||!1,o=ZK(r),s=o.filter(c=>typeof c=="string"&&c.charAt(0)===vM).map(c=>c.slice(1)).map(c=>wM(c,n)),a=o.filter(c=>typeof c!="string"||typeof c=="string"&&c.charAt(0)!==vM).map(c=>e9(c,n));return e==null?(c,u=!1)=>_M(a,s,c,typeof u=="boolean"?u:!1):_M(a,s,e,i)};Gw.default=Gw;xM.exports=Gw});var PM=_((Afe,CM)=>{CM.exports=typeof queueMicrotask=="function"?queueMicrotask:r=>Promise.resolve().then(r)});var EM=_((kfe,TM)=>{TM.exports=typeof process<"u"&&typeof process.nextTick=="function"?process.nextTick.bind(process):PM()});var AM=_((Ofe,RM)=>{RM.exports=class{constructor(e){if(!(e>0)||(e-1&e)!==0)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}clear(){this.top=this.btm=0,this.next=null,this.buffer.fill(void 0)}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}}});var OM=_((Nfe,DM)=>{var kM=AM();DM.exports=class{constructor(e){this.hwm=e||16,this.head=new kM(this.hwm),this.tail=this.head,this.length=0}clear(){this.head=this.tail,this.head.clear(),this.length=0}push(e){if(this.length++,!this.head.push(e)){let t=this.head;this.head=t.next=new kM(2*this.head.buffer.length),this.head.push(e)}}shift(){this.length!==0&&this.length--;let e=this.tail.shift();if(e===void 0&&this.tail.next){let t=this.tail.next;return this.tail.next=null,this.tail=t,this.tail.shift()}return e}peek(){let e=this.tail.peek();return e===void 0&&this.tail.next?this.tail.next.peek():e}isEmpty(){return this.length===0}}});var rN=_((Lfe,tN)=>{var{EventEmitter:t9}=g("events"),Lm=new Error("Stream was destroyed"),zw=new Error("Premature close"),BM=EM(),UM=OM(),ot=(1<<27)-1,Ms=1,eS=2,ks=4,Hl=8,jM=ot^Ms,r9=ot^eS,Ql=16,Gl=32,Nc=64,wo=128,zl=256,tS=512,Ds=1024,Kw=2048,rS=4096,nS=8192,sn=16384,kc=32768,Fm=65536,qM=zl|tS,n9=Ql|Fm,i9=Nc|Ql,o9=rS|wo,s9=ot^Ql,a9=ot^Nc,c9=ot^(Nc|Fm),u9=ot^Fm,l9=ot^zl,p9=ot^(wo|nS),d9=ot^Ds,MM=ot^qM,WM=ot^kc,f9=ot^Gl,So=1<<17,Oc=2<<17,Zl=4<<17,Os=8<<17,ep=16<<17,Ns=32<<17,Jw=64<<17,Dc=128<<17,iS=256<<17,Mc=512<<17,VM=ot^(So|iS),$M=ot^Zl,h9=ot^Mc,m9=ot^ep,g9=ot^Os,HM=ot^Dc,y9=ot^Oc,Kl=Ql|So,GM=ot^Kl,oS=sn|Ns,Ai=ks|Hl|eS,wr=Ai|Ms,zM=Ai|oS,b9=$M&a9,sS=Dc|kc,v9=sS&GM,KM=wr|v9,_9=wr|Ds|sn,NM=wr|sn|wo,w9=wr|Ds|wo,S9=wr|rS|wo|nS,x9=wr|Ql|Ds|sn|Fm,I9=Ai|Ds|sn,C9=Gl|wr|kc|Nc,P9=wr|Mc|Ns,T9=Os|ep,JM=Os|So,E9=Os|ep|wr|So,LM=wr|So|Os,R9=Zl|So,A9=So|iS,k9=wr|Mc|JM|Ns,D9=ep|Ai|Mc|Ns,O9=Oc|wr|Dc|Zl,km=Symbol.asyncIterator||Symbol("asyncIterator"),Dm=class{constructor(e,{highWaterMark:t=16384,map:n=null,mapWritable:i,byteLength:o,byteLengthWritable:s}={}){this.stream=e,this.queue=new UM,this.highWaterMark=t,this.buffered=0,this.error=null,this.pipeline=null,this.drains=null,this.byteLength=s||o||eN,this.map=i||n,this.afterWrite=L9.bind(this),this.afterUpdateNextTick=U9.bind(this)}get ended(){return(this.stream._duplexState&Ns)!==0}push(e){return this.map!==null&&(e=this.map(e)),this.buffered+=this.byteLength(e),this.queue.push(e),this.buffered<this.highWaterMark?(this.stream._duplexState|=Os,!0):(this.stream._duplexState|=T9,!1)}shift(){let e=this.queue.shift();return this.buffered-=this.byteLength(e),this.buffered===0&&(this.stream._duplexState&=g9),e}end(e){typeof e=="function"?this.stream.once("finish",e):e!=null&&this.push(e),this.stream._duplexState=(this.stream._duplexState|Mc)&$M}autoBatch(e,t){let n=[],i=this.stream;for(n.push(e);(i._duplexState&LM)===JM;)n.push(i._writableState.shift());if((i._duplexState&wr)!==0)return t(null);i._writev(n,t)}update(){let e=this.stream;e._duplexState|=Oc;do{for(;(e._duplexState&LM)===Os;){let t=this.shift();e._duplexState|=A9,e._write(t,this.afterWrite)}(e._duplexState&R9)===0&&this.updateNonPrimary()}while(this.continueUpdate()===!0);e._duplexState&=y9}updateNonPrimary(){let e=this.stream;if((e._duplexState&k9)===Mc){e._duplexState=(e._duplexState|So)&h9,e._final(N9.bind(this));return}if((e._duplexState&Ai)===ks){(e._duplexState&sS)===0&&(e._duplexState|=Kl,e._destroy(YM.bind(this)));return}(e._duplexState&KM)===Ms&&(e._duplexState=(e._duplexState|Kl)&jM,e._open(XM.bind(this)))}continueUpdate(){return(this.stream._duplexState&Dc)===0?!1:(this.stream._duplexState&=HM,!0)}updateCallback(){(this.stream._duplexState&O9)===Zl?this.update():this.updateNextTick()}updateNextTick(){(this.stream._duplexState&Dc)===0&&(this.stream._duplexState|=Dc,(this.stream._duplexState&Oc)===0&&BM(this.afterUpdateNextTick))}},Yw=class{constructor(e,{highWaterMark:t=16384,map:n=null,mapReadable:i,byteLength:o,byteLengthReadable:s}={}){this.stream=e,this.queue=new UM,this.highWaterMark=t,this.buffered=0,this.error=null,this.pipeline=null,this.byteLength=s||o||eN,this.map=i||n,this.pipeTo=null,this.afterRead=F9.bind(this),this.afterUpdateNextTick=B9.bind(this)}get ended(){return(this.stream._duplexState&sn)!==0}pipe(e,t){if(this.pipeTo!==null)throw new Error("Can only pipe to one destination");if(typeof t!="function"&&(t=null),this.stream._duplexState|=tS,this.pipeTo=e,this.pipeline=new Qw(this.stream,e,t),t&&this.stream.on("error",FM),Xl(e))e._writableState.pipeline=this.pipeline,t&&e.on("error",FM),e.on("finish",this.pipeline.finished.bind(this.pipeline));else{let n=this.pipeline.done.bind(this.pipeline,e),i=this.pipeline.done.bind(this.pipeline,e,null);e.on("error",n),e.on("close",i),e.on("finish",this.pipeline.finished.bind(this.pipeline))}e.on("drain",M9.bind(this)),this.stream.emit("piping",e),e.emit("pipe",this.stream)}push(e){let t=this.stream;return e===null?(this.highWaterMark=0,t._duplexState=(t._duplexState|Ds)&c9,!1):(this.map!==null&&(e=this.map(e)),this.buffered+=this.byteLength(e),this.queue.push(e),t._duplexState=(t._duplexState|wo)&u9,this.buffered<this.highWaterMark)}shift(){let e=this.queue.shift();return this.buffered-=this.byteLength(e),this.buffered===0&&(this.stream._duplexState&=p9),e}unshift(e){let t=[this.map!==null?this.map(e):e];for(;this.buffered>0;)t.push(this.shift());for(let n=0;n<t.length-1;n++){let i=t[n];this.buffered+=this.byteLength(i),this.queue.push(i)}this.push(t[t.length-1])}read(){let e=this.stream;if((e._duplexState&NM)===wo){let t=this.shift();return this.pipeTo!==null&&this.pipeTo.write(t)===!1&&(e._duplexState&=MM),(e._duplexState&Kw)!==0&&e.emit("data",t),t}return null}drain(){let e=this.stream;for(;(e._duplexState&NM)===wo&&(e._duplexState&qM)!==0;){let t=this.shift();this.pipeTo!==null&&this.pipeTo.write(t)===!1&&(e._duplexState&=MM),(e._duplexState&Kw)!==0&&e.emit("data",t)}}update(){let e=this.stream;e._duplexState|=Gl;do{for(this.drain();this.buffered<this.highWaterMark&&(e._duplexState&x9)===0;)e._duplexState|=n9,e._read(this.afterRead),this.drain();(e._duplexState&S9)===o9&&(e._duplexState|=nS,e.emit("readable")),(e._duplexState&i9)===0&&this.updateNonPrimary()}while(this.continueUpdate()===!0);e._duplexState&=f9}updateNonPrimary(){let e=this.stream;if((e._duplexState&w9)===Ds&&(e._duplexState=(e._duplexState|sn)&d9,e.emit("end"),(e._duplexState&zM)===oS&&(e._duplexState|=ks),this.pipeTo!==null&&this.pipeTo.end()),(e._duplexState&Ai)===ks){(e._duplexState&sS)===0&&(e._duplexState|=Kl,e._destroy(YM.bind(this)));return}(e._duplexState&KM)===Ms&&(e._duplexState=(e._duplexState|Kl)&jM,e._open(XM.bind(this)))}continueUpdate(){return(this.stream._duplexState&kc)===0?!1:(this.stream._duplexState&=WM,!0)}updateCallback(){(this.stream._duplexState&C9)===Nc?this.update():this.updateNextTick()}updateNextTick(){(this.stream._duplexState&kc)===0&&(this.stream._duplexState|=kc,(this.stream._duplexState&Gl)===0&&BM(this.afterUpdateNextTick))}},Xw=class{constructor(e){this.data=null,this.afterTransform=q9.bind(e),this.afterFinal=null}},Qw=class{constructor(e,t,n){this.from=e,this.to=t,this.afterPipe=n,this.error=null,this.pipeToFinished=!1}finished(){this.pipeToFinished=!0}done(e,t){if(t&&(this.error=t),e===this.to&&(this.to=null,this.from!==null)){((this.from._duplexState&sn)===0||!this.pipeToFinished)&&this.from.destroy(this.error||new Error("Writable stream closed prematurely"));return}if(e===this.from&&(this.from=null,this.to!==null)){(e._duplexState&sn)===0&&this.to.destroy(this.error||new Error("Readable stream closed before ending"));return}this.afterPipe!==null&&this.afterPipe(this.error),this.to=this.from=this.afterPipe=null}};function M9(){this.stream._duplexState|=tS,this.updateCallback()}function N9(r){let e=this.stream;r&&e.destroy(r),(e._duplexState&Ai)===0&&(e._duplexState|=Ns,e.emit("finish")),(e._duplexState&zM)===oS&&(e._duplexState|=ks),e._duplexState&=VM,(e._duplexState&Oc)===0?this.update():this.updateNextTick()}function YM(r){let e=this.stream;!r&&this.error!==Lm&&(r=this.error),r&&e.emit("error",r),e._duplexState|=Hl,e.emit("close");let t=e._readableState,n=e._writableState;if(t!==null&&t.pipeline!==null&&t.pipeline.done(e,r),n!==null){for(;n.drains!==null&&n.drains.length>0;)n.drains.shift().resolve(!1);n.pipeline!==null&&n.pipeline.done(e,r)}}function L9(r){let e=this.stream;r&&e.destroy(r),e._duplexState&=VM,this.drains!==null&&j9(this.drains),(e._duplexState&E9)===ep&&(e._duplexState&=m9,(e._duplexState&Jw)===Jw&&e.emit("drain")),this.updateCallback()}function F9(r){r&&this.stream.destroy(r),this.stream._duplexState&=s9,this.updateCallback()}function B9(){(this.stream._duplexState&Gl)===0&&(this.stream._duplexState&=WM,this.update())}function U9(){(this.stream._duplexState&Oc)===0&&(this.stream._duplexState&=HM,this.update())}function j9(r){for(let e=0;e<r.length;e++)--r[e].writes===0&&(r.shift().resolve(!0),e--)}function XM(r){let e=this.stream;r&&e.destroy(r),(e._duplexState&ks)===0&&((e._duplexState&_9)===0&&(e._duplexState|=Nc),(e._duplexState&P9)===0&&(e._duplexState|=Zl),e.emit("open")),e._duplexState&=GM,e._writableState!==null&&e._writableState.updateCallback(),e._readableState!==null&&e._readableState.updateCallback()}function q9(r,e){e!=null&&this.push(e),this._writableState.afterWrite(r)}function W9(r){this._readableState!==null&&(r==="data"&&(this._duplexState|=Kw|zl,this._readableState.updateNextTick()),r==="readable"&&(this._duplexState|=rS,this._readableState.updateNextTick())),this._writableState!==null&&r==="drain"&&(this._duplexState|=Jw,this._writableState.updateNextTick())}var Jl=class extends t9{constructor(e){super(),this._duplexState=0,this._readableState=null,this._writableState=null,e&&(e.open&&(this._open=e.open),e.destroy&&(this._destroy=e.destroy),e.predestroy&&(this._predestroy=e.predestroy),e.signal&&e.signal.addEventListener("abort",K9.bind(this))),this.on("newListener",W9)}_open(e){e(null)}_destroy(e){e(null)}_predestroy(){}get readable(){return this._readableState!==null?!0:void 0}get writable(){return this._writableState!==null?!0:void 0}get destroyed(){return(this._duplexState&Hl)!==0}get destroying(){return(this._duplexState&Ai)!==0}destroy(e){(this._duplexState&Ai)===0&&(e||(e=Lm),this._duplexState=(this._duplexState|ks)&b9,this._readableState!==null&&(this._readableState.highWaterMark=0,this._readableState.error=e),this._writableState!==null&&(this._writableState.highWaterMark=0,this._writableState.error=e),this._duplexState|=eS,this._predestroy(),this._duplexState&=r9,this._readableState!==null&&this._readableState.updateNextTick(),this._writableState!==null&&this._writableState.updateNextTick())}},Om=class r extends Jl{constructor(e){super(e),this._duplexState|=Ms|Ns,this._readableState=new Yw(this,e),e&&(e.read&&(this._read=e.read),e.eagerOpen&&this._readableState.updateNextTick())}_read(e){e(null)}pipe(e,t){return this._readableState.updateNextTick(),this._readableState.pipe(e,t),e}read(){return this._readableState.updateNextTick(),this._readableState.read()}push(e){return this._readableState.updateNextTick(),this._readableState.push(e)}unshift(e){return this._readableState.updateNextTick(),this._readableState.unshift(e)}resume(){return this._duplexState|=zl,this._readableState.updateNextTick(),this}pause(){return this._duplexState&=l9,this}static _fromAsyncIterator(e,t){let n,i=new r({...t,read(s){e.next().then(o).then(s.bind(null,null)).catch(s)},predestroy(){n=e.return()},destroy(s){if(!n)return s(null);n.then(s.bind(null,null)).catch(s)}});return i;function o(s){s.done?i.push(null):i.push(s.value)}}static from(e,t){if(G9(e))return e;if(e[km])return this._fromAsyncIterator(e[km](),t);Array.isArray(e)||(e=e===void 0?[]:[e]);let n=0;return new r({...t,read(i){this.push(n===e.length?null:e[n++]),i(null)}})}static isBackpressured(e){return(e._duplexState&I9)!==0||e._readableState.buffered>=e._readableState.highWaterMark}static isPaused(e){return(e._duplexState&zl)===0}[km](){let e=this,t=null,n=null,i=null;return this.on("error",u=>{t=u}),this.on("readable",o),this.on("close",s),{[km](){return this},next(){return new Promise(function(u,l){n=u,i=l;let p=e.read();p!==null?a(p):(e._duplexState&Hl)!==0&&a(null)})},return(){return c(null)},throw(u){return c(u)}};function o(){n!==null&&a(e.read())}function s(){n!==null&&a(null)}function a(u){i!==null&&(t?i(t):u===null&&(e._duplexState&sn)===0?i(Lm):n({value:u,done:u===null}),i=n=null)}function c(u){return e.destroy(u),new Promise((l,p)=>{if(e._duplexState&Hl)return l({value:void 0,done:!0});e.once("close",function(){u?p(u):l({value:void 0,done:!0})})})}}},Mm=class extends Jl{constructor(e){super(e),this._duplexState|=Ms|sn,this._writableState=new Dm(this,e),e&&(e.writev&&(this._writev=e.writev),e.write&&(this._write=e.write),e.final&&(this._final=e.final),e.eagerOpen&&this._writableState.updateNextTick())}_writev(e,t){t(null)}_write(e,t){this._writableState.autoBatch(e,t)}_final(e){e(null)}static isBackpressured(e){return(e._duplexState&D9)!==0}static drained(e){if(e.destroyed)return Promise.resolve(!1);let t=e._writableState,i=(J9(e)?Math.min(1,t.queue.length):t.queue.length)+(e._duplexState&iS?1:0);return i===0?Promise.resolve(!0):(t.drains===null&&(t.drains=[]),new Promise(o=>{t.drains.push({writes:i,resolve:o})}))}write(e){return this._writableState.updateNextTick(),this._writableState.push(e)}end(e){return this._writableState.updateNextTick(),this._writableState.end(e),this}},Yl=class extends Om{constructor(e){super(e),this._duplexState=Ms,this._writableState=new Dm(this,e),e&&(e.writev&&(this._writev=e.writev),e.write&&(this._write=e.write),e.final&&(this._final=e.final))}_writev(e,t){t(null)}_write(e,t){this._writableState.autoBatch(e,t)}_final(e){e(null)}write(e){return this._writableState.updateNextTick(),this._writableState.push(e)}end(e){return this._writableState.updateNextTick(),this._writableState.end(e),this}},Nm=class extends Yl{constructor(e){super(e),this._transformState=new Xw(this),e&&(e.transform&&(this._transform=e.transform),e.flush&&(this._flush=e.flush))}_write(e,t){this._readableState.buffered>=this._readableState.highWaterMark?this._transformState.data=e:this._transform(e,this._transformState.afterTransform)}_read(e){if(this._transformState.data!==null){let t=this._transformState.data;this._transformState.data=null,e(null),this._transform(t,this._transformState.afterTransform)}else e(null)}destroy(e){super.destroy(e),this._transformState.data!==null&&(this._transformState.data=null,this._transformState.afterTransform())}_transform(e,t){t(null,e)}_flush(e){e(null)}_final(e){this._transformState.afterFinal=e,this._flush(V9.bind(this))}},Zw=class extends Nm{};function V9(r,e){let t=this._transformState.afterFinal;if(r)return t(r);e!=null&&this.push(e),this.push(null),t(null)}function $9(...r){return new Promise((e,t)=>QM(...r,n=>{if(n)return t(n);e()}))}function QM(r,...e){let t=Array.isArray(r)?[...r,...e]:[r,...e],n=t.length&&typeof t[t.length-1]=="function"?t.pop():null;if(t.length<2)throw new Error("Pipeline requires at least 2 streams");let i=t[0],o=null,s=null;for(let u=1;u<t.length;u++)o=t[u],Xl(i)?i.pipe(o,c):(a(i,!0,u>1,c),i.pipe(o)),i=o;if(n){let u=!1,l=Xl(o)||!!(o._writableState&&o._writableState.autoDestroy);o.on("error",p=>{s===null&&(s=p)}),o.on("finish",()=>{u=!0,l||n(s)}),l&&o.on("close",()=>n(s||(u?null:zw)))}return o;function a(u,l,p,d){u.on("error",d),u.on("close",f);function f(){if(l&&u._readableState&&!u._readableState.ended||p&&u._writableState&&!u._writableState.ended)return d(zw)}}function c(u){if(!(!u||s)){s=u;for(let l of t)l.destroy(u)}}}function ZM(r){return!!r._readableState||!!r._writableState}function Xl(r){return typeof r._duplexState=="number"&&ZM(r)}function H9(r){let e=r._readableState&&r._readableState.error||r._writableState&&r._writableState.error;return e===Lm?null:e}function G9(r){return Xl(r)&&r.readable}function z9(r){return typeof r=="object"&&r!==null&&typeof r.byteLength=="number"}function eN(r){return z9(r)?r.byteLength:1024}function FM(){}function K9(){this.destroy(new Error("Stream aborted."))}function J9(r){return r._writev!==Mm.prototype._writev&&r._writev!==Yl.prototype._writev}tN.exports={pipeline:QM,pipelinePromise:$9,isStream:ZM,isStreamx:Xl,getStreamError:H9,Stream:Jl,Writable:Mm,Readable:Om,Duplex:Yl,Transform:Nm,PassThrough:Zw}});var iN=_((Ffe,nN)=>{nN.exports=function(e){if(typeof e!="string"||e==="")return!1;for(var t;t=/(\\).|([@?!+*]\(.*\))/g.exec(e);){if(t[2])return!0;e=e.slice(t.index+t[0].length)}return!1}});var aS=_((Bfe,sN)=>{var Y9=iN(),oN={"{":"}","(":")","[":"]"},X9=function(r){if(r[0]==="!")return!0;for(var e=0,t=-2,n=-2,i=-2,o=-2,s=-2;e<r.length;){if(r[e]==="*"||r[e+1]==="?"&&/[\].+)]/.test(r[e])||n!==-1&&r[e]==="["&&r[e+1]!=="]"&&(n<e&&(n=r.indexOf("]",e)),n>e&&(s===-1||s>n||(s=r.indexOf("\\",e),s===-1||s>n)))||i!==-1&&r[e]==="{"&&r[e+1]!=="}"&&(i=r.indexOf("}",e),i>e&&(s=r.indexOf("\\",e),s===-1||s>i))||o!==-1&&r[e]==="("&&r[e+1]==="?"&&/[:!=]/.test(r[e+2])&&r[e+3]!==")"&&(o=r.indexOf(")",e),o>e&&(s=r.indexOf("\\",e),s===-1||s>o))||t!==-1&&r[e]==="("&&r[e+1]!=="|"&&(t<e&&(t=r.indexOf("|",e)),t!==-1&&r[t+1]!==")"&&(o=r.indexOf(")",t),o>t&&(s=r.indexOf("\\",t),s===-1||s>o))))return!0;if(r[e]==="\\"){var a=r[e+1];e+=2;var c=oN[a];if(c){var u=r.indexOf(c,e);u!==-1&&(e=u+1)}if(r[e]==="!")return!0}else e++}return!1},Q9=function(r){if(r[0]==="!")return!0;for(var e=0;e<r.length;){if(/[*?{}()[\]]/.test(r[e]))return!0;if(r[e]==="\\"){var t=r[e+1];e+=2;var n=oN[t];if(n){var i=r.indexOf(n,e);i!==-1&&(e=i+1)}if(r[e]==="!")return!0}else e++}return!1};sN.exports=function(e,t){if(typeof e!="string"||e==="")return!1;if(Y9(e))return!0;var n=X9;return t&&t.strict===!1&&(n=Q9),n(e)}});var cN=_((Ufe,aN)=>{"use strict";var Z9=aS(),e7=g("path").posix.dirname,t7=g("os").platform()==="win32",Bm="/",r7=/\\/g,n7=/\\([!*?|[\](){}])/g;aN.exports=function(e,t){var n=Object.assign({flipBackslashes:!0},t);n.flipBackslashes&&t7&&e.indexOf(Bm)<0&&(e=e.replace(r7,Bm)),i7(e)&&(e+=Bm),e+="a";do e=e7(e);while(o7(e));return e.replace(n7,"$1")};function i7(r){var e=r.slice(-1),t;switch(e){case"}":t="{";break;case"]":t="[";break;default:return!1}var n=r.indexOf(t);return n<0?!1:r.slice(n+1,-1).includes(Bm)}function o7(r){return/\([^()]+$/.test(r)||r[0]==="{"||r[0]==="["||/[^\\][{[]/.test(r)?!0:Z9(r)}});var Um=_((jfe,uN)=>{"use strict";uN.exports=function(r){if(typeof r!="string")throw new TypeError("expected a string");var e={negated:!1,pattern:r,original:r};return r.charAt(0)==="!"&&r.charAt(1)!=="("&&(e.negated=!0,e.pattern=r.slice(1)),e}});var hN=_((qfe,fN)=>{"use strict";var jm=g("path"),s7=Um();fN.exports=function(r,e){var t=e||{},n=pN(t.cwd?t.cwd:process.cwd());n=jm.resolve(n),n=cS(n),n=lN(n);var i=t.root;i&&(i=pN(i),i=cS(i),(process.platform==="win32"||!jm.isAbsolute(i))&&(i=cS(jm.resolve(i))),i=lN(i));var o=r.slice(-1),s=s7(r);return r=s.pattern,r.slice(0,2)==="./"&&(r=r.slice(2)),r.length===1&&r==="."&&(r=""),i&&r.charAt(0)==="/"?r=dN(i,r):(!jm.isAbsolute(r)||r.slice(0,1)==="\\")&&(r=dN(n,r)),o==="/"&&r.slice(-1)!=="/"&&(r+="/"),s.negated?"!"+r:r};function lN(r){return r.replace(/([({[\]})*?!])/g,"\\$1")}function pN(r){return r.replace(/\\([({[\]})*?!])/g,"$1")}function cS(r){return r.replace(/\\/g,"/")}function dN(r,e){if(r.charAt(r.length-1)==="/"&&(r=r.slice(0,-1)),e.charAt(0)==="/"&&(e=e.slice(1)),!e)return r;for(;e.slice(0,3)==="../";)r=r.slice(0,r.lastIndexOf("/")),e=e.slice(3);return r+"/"+e}});var yN=_((Wfe,gN)=>{"use strict";var a7=g("fs"),uS=g("path"),c7=g("events"),u7=yM(),l7=IM(),p7=rN().Readable,d7=aS(),f7=cN(),mN=Hw(),h7=Um(),m7=hN(),g7="File not found with singular glob: ",y7=" (if this was purposeful, use `allowEmpty` option)";function b7(r){return d7(r)}function v7(){var r={withFileTypes:!0},e=new c7,t=u7(i,1);t.drain=function(){e.emit("end")},t.error(n);function n(o){o&&e.emit("error",o)}e.pause=function(){t.pause()},e.resume=function(){t.resume()},e.end=function(){t.kill()},e.walk=function(o){t.push(o)};function i(o,s){a7.readdir(o,r,a);function a(u,l){if(u)return s(u);l.forEach(c),s()}function c(u){var l=uS.join(o,u.name);e.emit("path",l,u),u.isDirectory()&&t.push(l)}}return e}function _7(r){var e=!1;r.forEach(t);function t(n,i){if(typeof n!="string")throw new Error("Invalid glob at index "+i);var o=h7(n);o.negated===!1&&(e=!0)}if(e===!1)throw new Error("Missing positive glob")}function w7(r){if(typeof r.cwd!="string")throw new Error("The `cwd` option must be a string");if(typeof r.dot!="boolean")throw new Error("The `dot` option must be a boolean");if(typeof r.cwdbase!="boolean")throw new Error("The `cwdbase` option must be a boolean");if(typeof r.uniqueBy!="string"&&typeof r.uniqueBy!="function")throw new Error("The `uniqueBy` option must be a string or function");if(typeof r.allowEmpty!="boolean")throw new Error("The `allowEmpty` option must be a boolean");if(r.base&&typeof r.base!="string")throw new Error("The `base` option must be a string if specified");if(!Array.isArray(r.ignore))throw new Error("The `ignore` option must be a string or array")}function S7(r){var e=new Set;if(typeof r=="string")return n;return i;function t(o){return e.has(o)?!1:(e.add(o),!0)}function n(o){return t(o[r])}function i(o){return t(r(o))}}function x7(r,e){Array.isArray(r)||(r=[r]),_7(r);var t=Object.assign({},{cwd:process.cwd(),dot:!1,cwdbase:!1,uniqueBy:"path",allowEmpty:!1,ignore:[]},e);t.ignore=typeof t.ignore=="string"?[t.ignore]:t.ignore,w7(t),t.cwd=mN(uS.resolve(t.cwd),!0);var n=t.base;t.cwdbase&&(n=t.cwd);var i=v7(),o=new p7({highWaterMark:t.highWaterMark,read:l,predestroy:p}),s=r.map(d);t.ignore=t.ignore.map(d);var a=s.map(b7),c=l7(s,null,t),u=S7(t.uniqueBy);i.on("path",f),i.once("end",h),i.once("error",m),i.walk(t.cwd);function l(b){i.resume(),b()}function p(){i.end()}function d(b){return m7(b,t)}function f(b,I){var D=c(b,!0);if(D===-1&&I.isDirectory()&&(D=c(b+uS.sep,!0)),D!==-1){a[D]=!0;var B=n||f7(s[D]),Z={cwd:t.cwd,base:B,path:mN(b,!0)},F=u(Z);if(F){var X=o.push(Z);X||i.pause()}}}function h(){var b=!1;a.forEach(function(I,D){if(t.allowEmpty!==!0&&!I){b=!0;var B=new Error(g7+s[D]+y7);return o.destroy(B)}}),b===!1&&o.push(null)}function m(b){o.destroy(b)}return o}gN.exports=x7});var vN=_(($fe,bN)=>{"use strict";bN.exports=function(){return/^[\\\/]{2,}[^\\\/]+[\\\/]+[^\\\/]+/}});var wN=_((Hfe,_N)=>{"use strict";var I7=vN()();_N.exports=function(r){if(typeof r!="string")throw new TypeError("expected a string");return I7.test(r)}});var xN=_((Gfe,SN)=>{"use strict";var C7=wN();SN.exports=function(e){if(typeof e!="string")throw new TypeError("expected filepath to be a string");return!C7(e)&&!/^([a-z]:)?[\\\/]/i.test(e)}});var IN=_((lS,pS)=>{(function(r){lS&&typeof lS=="object"&&typeof pS<"u"?pS.exports=r():typeof define=="function"&&define.amd?define([],r):typeof window<"u"?window.isWindows=r():typeof global<"u"?global.isWindows=r():typeof self<"u"?self.isWindows=r():this.isWindows=r()})(function(){"use strict";return function(){return process&&(process.platform==="win32"||/^(msys|cygwin)$/.test(process.env.OSTYPE))}})});var PN=_((zfe,CN)=>{"use strict";var P7=xN(),T7=IN();CN.exports=tp;function tp(r){if(typeof r!="string")throw new TypeError("isAbsolute expects a string.");return T7()?tp.win32(r):tp.posix(r)}tp.posix=function(e){return e.charAt(0)==="/"};tp.win32=function(e){return/[a-z]/i.test(e.charAt(0))&&e.charAt(1)===":"&&e.charAt(2)==="\\"||e.slice(0,2)==="\\\\"?!0:!P7(e)}});var ON=_((Kfe,DN)=>{"use strict";var TN=g("path"),E7=Um(),EN=PN();DN.exports=function(r,e){var t=e||{},n=AN(t.cwd?t.cwd:process.cwd());n=TN.resolve(n),n=dS(n),n=RN(n);var i=t.root;i&&(i=AN(i),i=dS(i),(process.platform==="win32"||!EN(i))&&(i=dS(TN.resolve(i))),i=RN(i)),r.slice(0,2)==="./"&&(r=r.slice(2)),r.length===1&&r==="."&&(r="");var o=r.slice(-1),s=E7(r);return r=s.pattern,i&&r.charAt(0)==="/"?r=kN(i,r):(!EN(r)||r.slice(0,1)==="\\")&&(r=kN(n,r)),o==="/"&&r.slice(-1)!=="/"&&(r+="/"),s.negated?"!"+r:r};function RN(r){return r.replace(/([({[\]})*?!])/g,"\\$1")}function AN(r){return r.replace(/\\([({[\]})*?!])/g,"$1")}function dS(r){return r.replace(/\\/g,"/")}function kN(r,e){return r.charAt(r.length-1)==="/"&&(r=r.slice(0,-1)),e.charAt(0)==="/"&&(e=e.slice(1)),e?r+"/"+e:r}});var dL=_((vye,pL)=>{try{pL.exports=g("./win32-app-container-tokens.win32-arm64-msvc-4ZJZ3U55.node")}catch{}});var hL=_((_ye,fL)=>{try{fL.exports=g("./win32-app-container-tokens.win32-x64-msvc-VCQE7GJP.node")}catch{}});var kL=_((vve,H7)=>{H7.exports={name:"dotenv",version:"16.4.1",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{types:"./lib/main.d.ts",require:"./lib/main.js",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},funding:"https://github.com/motdotla/dotenv?sponsor=1",keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@definitelytyped/dtslint":"^0.0.133","@types/node":"^18.11.3",decache:"^4.6.1",sinon:"^14.0.1",standard:"^17.0.0","standard-markdown":"^7.1.0","standard-version":"^9.5.0",tap:"^16.3.0",tar:"^6.1.11",typescript:"^4.8.4"},engines:{node:">=12"},browser:{fs:!1}}});var ML=_((_ve,Ni)=>{var dg=g("fs"),PS=g("path"),G7=g("os"),z7=g("crypto"),K7=kL(),TS=K7.version,J7=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function Y7(r){let e={},t=r.toString();t=t.replace(/\r\n?/mg,`
`);let n;for(;(n=J7.exec(t))!=null;){let i=n[1],o=n[2]||"";o=o.trim();let s=o[0];o=o.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),s==='"'&&(o=o.replace(/\\n/g,`
`),o=o.replace(/\\r/g,"\r")),e[i]=o}return e}function X7(r){let e=OL(r),t=vt.configDotenv({path:e});if(!t.parsed){let s=new Error(`MISSING_DATA: Cannot parse ${e} for an unknown reason`);throw s.code="MISSING_DATA",s}let n=DL(r).split(","),i=n.length,o;for(let s=0;s<i;s++)try{let a=n[s].trim(),c=eJ(t,a);o=vt.decrypt(c.ciphertext,c.key);break}catch(a){if(s+1>=i)throw a}return vt.parse(o)}function Q7(r){console.log(`[dotenv@${TS}][INFO] ${r}`)}function Z7(r){console.log(`[dotenv@${TS}][WARN] ${r}`)}function fg(r){console.log(`[dotenv@${TS}][DEBUG] ${r}`)}function DL(r){return r&&r.DOTENV_KEY&&r.DOTENV_KEY.length>0?r.DOTENV_KEY:process.env.DOTENV_KEY&&process.env.DOTENV_KEY.length>0?process.env.DOTENV_KEY:""}function eJ(r,e){let t;try{t=new URL(e)}catch(a){if(a.code==="ERR_INVALID_URL"){let c=new Error("INVALID_DOTENV_KEY: Wrong format. Must be in valid uri format like dotenv://:key_1234@dotenv.org/vault/.env.vault?environment=development");throw c.code="INVALID_DOTENV_KEY",c}throw a}let n=t.password;if(!n){let a=new Error("INVALID_DOTENV_KEY: Missing key part");throw a.code="INVALID_DOTENV_KEY",a}let i=t.searchParams.get("environment");if(!i){let a=new Error("INVALID_DOTENV_KEY: Missing environment part");throw a.code="INVALID_DOTENV_KEY",a}let o=`DOTENV_VAULT_${i.toUpperCase()}`,s=r.parsed[o];if(!s){let a=new Error(`NOT_FOUND_DOTENV_ENVIRONMENT: Cannot locate environment ${o} in your .env.vault file.`);throw a.code="NOT_FOUND_DOTENV_ENVIRONMENT",a}return{ciphertext:s,key:n}}function OL(r){let e=null;if(r&&r.path&&r.path.length>0)if(Array.isArray(r.path))for(let t of r.path)dg.existsSync(t)&&(e=t.endsWith(".vault")?t:`${t}.vault`);else e=r.path.endsWith(".vault")?r.path:`${r.path}.vault`;else e=PS.resolve(process.cwd(),".env.vault");return dg.existsSync(e)?e:null}function tJ(r){return r[0]==="~"?PS.join(G7.homedir(),r.slice(1)):r}function rJ(r){Q7("Loading env from encrypted .env.vault");let e=vt._parseVault(r),t=process.env;return r&&r.processEnv!=null&&(t=r.processEnv),vt.populate(t,e,r),{parsed:e}}function nJ(r){let e=PS.resolve(process.cwd(),".env"),t="utf8",n=!!(r&&r.debug);if(r){if(r.path!=null){let i=r.path;if(Array.isArray(i)){for(let o of r.path)if(dg.existsSync(o)){i=o;break}}e=tJ(i)}r.encoding!=null?t=r.encoding:n&&fg("No encoding is specified. UTF-8 is used by default")}try{let i=vt.parse(dg.readFileSync(e,{encoding:t})),o=process.env;return r&&r.processEnv!=null&&(o=r.processEnv),vt.populate(o,i,r),{parsed:i}}catch(i){return n&&fg(`Failed to load ${e} ${i.message}`),{error:i}}}function iJ(r){if(DL(r).length===0)return vt.configDotenv(r);let e=OL(r);return e?vt._configVault(r):(Z7(`You set DOTENV_KEY but you are missing a .env.vault file at ${e}. Did you forget to build it?`),vt.configDotenv(r))}function oJ(r,e){let t=Buffer.from(e.slice(-64),"hex"),n=Buffer.from(r,"base64"),i=n.subarray(0,12),o=n.subarray(-16);n=n.subarray(12,-16);try{let s=z7.createDecipheriv("aes-256-gcm",t,i);return s.setAuthTag(o),`${s.update(n)}${s.final()}`}catch(s){let a=s instanceof RangeError,c=s.message==="Invalid key length",u=s.message==="Unsupported state or unable to authenticate data";if(a||c){let l=new Error("INVALID_DOTENV_KEY: It must be 64 characters long (or more)");throw l.code="INVALID_DOTENV_KEY",l}else if(u){let l=new Error("DECRYPTION_FAILED: Please check your DOTENV_KEY");throw l.code="DECRYPTION_FAILED",l}else throw s}}function sJ(r,e,t={}){let n=!!(t&&t.debug),i=!!(t&&t.override);if(typeof e!="object"){let o=new Error("OBJECT_REQUIRED: Please check the processEnv argument being passed to populate");throw o.code="OBJECT_REQUIRED",o}for(let o of Object.keys(e))Object.prototype.hasOwnProperty.call(r,o)?(i===!0&&(r[o]=e[o]),n&&fg(i===!0?`"${o}" is already defined and WAS overwritten`:`"${o}" is already defined and was NOT overwritten`)):r[o]=e[o]}var vt={configDotenv:nJ,_configVault:rJ,_parseVault:X7,config:iJ,decrypt:oJ,parse:Y7,populate:sJ};Ni.exports.configDotenv=vt.configDotenv;Ni.exports._configVault=vt._configVault;Ni.exports._parseVault=vt._parseVault;Ni.exports.config=vt.config;Ni.exports.decrypt=vt.decrypt;Ni.exports.parse=vt.parse;Ni.exports.populate=vt.populate;Ni.exports=vt});var Lg=S(He()),MF=S(g("fs")),NF=S(g("net")),LF=S(g("os")),Fg=S(g("path")),_Ce=S(qg());var jr=S(He());var wt=r=>!!r,Xs=r=>vp(r,e=>e!==null),GS=r=>vp(r,e=>e!==void 0),Fo=r=>e=>e instanceof r,bp=(r,e)=>{debugger;throw new Error(e.replace("{value}",JSON.stringify(r)))};function vp(r,e){let t={};for(let n of Object.keys(r)){let i=r[n];e(i,n)&&(t[n]=i)}return t}function ai(r,e){let t={};for(let n of Object.keys(r)){let i=r[n];t[n]=e(i,n)}return t}function zS(r,e){let t={};for(let n of Object.keys(r))e(n,r[n])&&(t[n]=r[n]);return t}function KS(...r){if(r.length===0)return{};let e={},t=Object.create(null);for(let n of r)if(n)for(let i of Object.keys(n)){let o=i.toLowerCase();t[o]?e[t[o]]=n[i]:(t[o]=i,e[i]=n[i])}return e}function JS(r,e){if(r.hasOwnProperty(e))return r[e];let t=e.toLowerCase();for(let n of Object.keys(r))if(n.toLowerCase()===t)return r[n]}var Wg=Symbol("unset");function ne(r){let e=Wg,t=(...n)=>(e===Wg&&(t.value=e=r(...n)),e);return t.forget=()=>{e=Wg,t.value=void 0},t.value=void 0,t}function Bo(r){let e=new Map,t=n=>{if(e.has(n))return e.get(n);let i=r(n);return e.set(n,i),i};return t.clear=()=>e.clear(),t}function YS(r){let e,t=n=>(e?.arg===n||(e={arg:n,val:r(n)}),e.val);return t.clear=()=>e=void 0,t}function XS(r,e){let t,n=()=>{t!==void 0&&clearTimeout(t),t=setTimeout(()=>{t=void 0,e()},r)};return n.clear=()=>{t&&(clearTimeout(t),t=void 0)},n}function QS(r,e){let t,n=()=>{t===void 0&&(t=setTimeout(()=>{t=void 0,e()},r))};return n.queued=()=>!!t,n.clear=()=>{t&&(clearTimeout(t),t=void 0)},n}async function ZS(r,e){let t=[],n=[];for(let i of r)await e(i)?t.push(i):n.push(i);return[t,n]}function Uo(r){let e=[];for(let t of r)e=e.concat(t);return e}var lB=2**31-1,_p=()=>{let r=0;return()=>r++&lB};var Qs={dispose:()=>{}},De=class{constructor(e){this.disposed=!1;this.items=[];e&&(this.items=e.slice())}get isDisposed(){return this.disposed}callback(...e){for(let t of e)this.push({dispose:t})}push(...e){return this.disposed?(e.forEach(t=>t.dispose()),e[0]):(this.items.push(...e),e[0])}disposeObject(e){this.items=this.items.filter(t=>t!==e),e.dispose()}clear(){let e=Promise.all(this.items.map(t=>t.dispose()));return this.items=[],e}dispose(){let e=Promise.all(this.items.map(t=>t.dispose()));return this.items=[],this.disposed=!0,e}};var tx=g("crypto"),rx=g("os"),nx=S(g("path"));var Sp=g("fs"),ex=g("path"),pB=(r,e)=>e instanceof Error?{message:e.message,stack:e.stack}:typeof e=="bigint"?e.toString():e,wp=class{constructor(e,t){this.file=e;this.dap=t;try{(0,Sp.mkdirSync)((0,ex.dirname)(e),{recursive:!0})}catch{}this.stream=(0,Sp.createWriteStream)(e)}async setup(){this.dap?.output({category:"console",output:`Verbose logs are written to:
${this.file}
`})}dispose(){this.stream&&(this.stream.end(),this.stream=void 0)}write(e){this.stream&&this.stream.write(JSON.stringify(e,pB)+`
`)}};var dB={runtime:null,"runtime.sourcecreate":null,"runtime.assertion":null,"runtime.launch":null,"runtime.target":null,"runtime.welcome":null,"runtime.exception":null,"runtime.sourcemap":null,"runtime.breakpoints":null,"sourcemap.parsing":null,"perf.function":null,"cdp.send":null,"cdp.receive":null,"dap.send":null,"dap.receive":null,internal:null,proxyActivity:null},qJ=Object.keys(dB),W=Symbol("ILogger");function fB(r,e=(0,rx.tmpdir)()){if(r===!1)return{stdio:!1,logFile:null};let t={stdio:!0,logFile:nx.join(e,`vscode-debugadapter-${(0,tx.randomBytes)(4).toString("hex")}.json`)};return r===!0?t:{...t,...r}}function ix(r,e){let t=fB(e),n={sinks:[]};return t.logFile&&n.sinks.push(new wp(t.logFile,r)),n}var Oe=class{constructor(e,t){this.lineNumber=e;this.columnNumber=t}get base0(){return this}get base1(){return new Fe(this.lineNumber+1,this.columnNumber+1)}get base01(){return new Jt(this.lineNumber,this.columnNumber+1)}compare(e){let t=e.base0;return this.lineNumber-t.lineNumber||this.columnNumber-t.columnNumber}},Fe=class{constructor(e,t){this.lineNumber=e;this.columnNumber=t}get base0(){return new Oe(this.lineNumber-1,this.columnNumber-1)}get base1(){return this}get base01(){return new Jt(this.lineNumber-1,this.columnNumber)}compare(e){let t=e.base1;return this.lineNumber-t.lineNumber||this.columnNumber-t.columnNumber||0}},Jt=class{constructor(e,t){this.lineNumber=e;this.columnNumber=t}get base0(){return new Oe(this.lineNumber-1,this.columnNumber)}get base1(){return new Fe(this.lineNumber,this.columnNumber+1)}get base01(){return this}compare(e){let t=e.base01;return this.lineNumber-t.lineNumber||this.columnNumber-t.columnNumber}},Pt=class r{constructor(e,t){this.begin=e;this.end=t}static{this.ZERO=new r(new Oe(0,0),new Oe(0,0))}static{this.INFINITE=new r(new Oe(0,0),new Oe(1/0,1/0))}static simplify(e){if(e.length===0)return[];let t=e.slice().sort((o,s)=>o.begin.compare(s.begin)),n=[],i=t[0];for(let o=1;o<t.length;o++){let s=t[o];i.end.compare(s.begin)>=0?i=new r(i.begin,s.end):(n.push(i),i=s)}return n.push(i),n}contains(e){return e.compare(this.begin)>=0&&e.compare(this.end)<=0}containsRange(e){return this.contains(e.begin)&&this.contains(e.end)}toString(){let e=this.begin.base0,t=this.end.base0;return`Range[${e.lineNumber}:${e.columnNumber} -> ${t.lineNumber}:${t.columnNumber}]`}};var ue=r=>isFinite(r)?new Promise(e=>setTimeout(e,r)):new Promise(()=>{}),ox=(r,e)=>{let t=setTimeout(r,e);return{dispose:()=>clearTimeout(t)}};function Zs(r){return new Promise((e,t)=>{let n=r.length;for(let i of r)i.then(o=>{o?(e(o),n=-1):--n===0&&e(void 0)}).catch(t)})}async function sx(r,e){for(let t=0;t<r.length;t++)if(await e(r[t]))return t;return-1}function be(){let r=null,e=null,t=!1,n,i=new Promise((o,s)=>{r=a=>{t=!0,n=a,o(a)},e=a=>{t=!0,s(a)}});return{resolve:r,reject:e,promise:i,get settledValue(){return n},hasSettled:()=>t}}var Ra=S(G());var XT=S(He()),QT=g("path"),ZT=g("url");var BP=g("fs");var li=S(g("fs")),OI=S(g("util"));async function sa({access:r},e){if(!e)return!1;try{return await r(e),!0}catch{return!1}}async function Ui({stat:r},e){if(e)try{return await r(e)}catch{return}}function MI(r){return new Promise(e=>{li.readFile(r,"utf8",async(t,n)=>{e(t?"":n)})})}var $Y=OI.promisify(li.writeFile);var Zt=Symbol("FsUtils"),Qr=class{constructor(e){this.fs=e}realPath(e){return this.fs.realpath(e)}async exists(e){try{return await this.fs.access(e,li.constants.F_OK),!0}catch{return!1}}readFile(e){return this.fs.readFile(e)}},vy=class{constructor(e){this.dap=e}async realPath(){throw new Error("not implemented")}async exists(e){try{let{doesExists:t}=await this.dap.remoteFileExistsRequest({localFilePath:e});return t}catch{return!1}}readFile(){throw new Error("not implemented")}},td=class{constructor(e,t,n){this.remoteFilePrefix=e;this.localFsUtils=t;this.remoteFsUtils=n}static create(e,t,n){let i=new Qr(t);return e!==void 0?new this(e.toLowerCase(),i,new vy(n)):i}async exists(e){return this.selectFs(e).exists(e)}async readFile(e){return this.selectFs(e).readFile(e)}async realPath(e){return this.selectFs(e).realPath(e)}selectFs(e){return e.toLowerCase().startsWith(this.remoteFilePrefix)?this.remoteFsUtils:this.localFsUtils}};var mP=g("crypto"),gP=S(jy()),yP=g("os"),fe=S(g("path"));var YV=process.platform==="win32"?"\\\\.\\pipe\\":(0,yP.tmpdir)(),XV=0,bP=()=>fe.join(YV,`node-cdp.${process.pid}-${(0,mP.randomBytes)(4).toString("hex")}-${XV++}.sock`);function QV(r){return process.platform!=="win32"?[""]:r.lookup("PATHEXT")?.split(";")||[".exe"]}async function fd(r,e,t){let n;if(process.platform==="win32"){let i=t.WINDIR||"C:\\Windows";n=fe.join(i,"System32","where.exe")}else n="/usr/bin/which";try{if(await Ui(r,n)){let o=(await(0,gP.default)(n,[e],{env:Xs(t)})).stdout.split(/\r?\n/);if(process.platform==="win32"){let s=String(t.PATHEXT||".exe").toUpperCase().split(";");for(let a of o){let c=fe.extname(a).toUpperCase();if(c&&s.includes(c))return a}}else if(o.length>0)return o[0];return}return e}catch{}}async function qy(r,e,t){if(e){if(process.platform==="win32"&&!fe.extname(e))for(let n of QV(t)){let i=e+n;if(await Ui(r,i))return i}if(await Ui(r,e))return e}}var vP=r=>r.includes(`.asar${fe.sep}`);function ji(...r){return fe.posix.isAbsolute(r[0])?Be(fe.posix.join(...r)):fe.win32.isAbsolute(r[0])?fe.win32.join(...r):fe.join(...r)}function cr(...r){return fe.posix.isAbsolute(r[0])?fe.posix.resolve(...r):fe.win32.isAbsolute(r[0])?fe.win32.resolve(...r):fe.resolve(...r)}function Cu(r,e){return fe.posix.isAbsolute(r)?fe.posix.relative(r,e):fe.win32.isAbsolute(r)?fe.win32.relative(r,e):fe.relative(r,e)}var ZV=/\/|\\/,Iu="file:///",_P=r=>r.startsWith(Iu)&&r[Iu.length+1]===":",Wy=r=>r.split(ZV);function Vy(r,e=!1){if(!r)return r;if(_P(r)){let t=Iu.length;r=Iu+r[t].toLowerCase()+r.substr(t+1)}else md(r)&&(r=(e?r[0].toUpperCase():r[0].toLowerCase())+r.substr(1));return r}function We(r,e=!1){if(!r)return r;if(r=Vy(r,e),_P(r)){let t=Iu.length;r=r.substr(0,t+1)+r.substr(t+1).replace(/\//g,"\\")}else md(r)&&(r=r.replace(/\//g,"\\"));return r}function Be(r){return r.replace(/\\\//g,"/").replace(/\\/g,"/")}var wP=(r,e)=>{let t=fe.relative(r,e);return t.length&&!fe.isAbsolute(t)&&!t.startsWith("..")},hd=(r,e)=>{let t=fe.relative(r,e);return!fe.isAbsolute(t)&&!t.startsWith("..")},$y=r=>r.startsWith("\\\\"),md=r=>/^[A-Za-z]:/.test(r)||$y(r);var NP=g("path"),LP=g("worker_threads");var qi=S(DP()),Id=g("crypto"),Ky=g("fs"),Jy=g("worker_threads");var y$=r=>(0,Id.createHash)("sha256").update(r).digest("hex"),b$=Buffer.from("(function (exports, require, module, __filename, __dirname) { "),v$=Buffer.from(`
});`),_$=Buffer.from("(function (exports, require, module, __filename, __dirname, process, global, Buffer) { return function (exports, require, module, __filename, __dirname) { "),w$=Buffer.from(`
}.call(this, exports, require, module, __filename, __dirname); });`),S$=Buffer.from("#!"),x$=Buffer.from("\r")[0],I$=Buffer.from(`
`)[0],C$=(r,e)=>r.slice(0,e.length).equals(e),xd=(r,...e)=>{if(r.length!==64)return(0,qi.hash)(e.length===1?e[0]:Buffer.concat(e))===r;let t=(0,Id.createHash)("sha256");for(let o of e)t.update(o);if(t.digest("hex")===r)return!0;let n=e.length===1?e[0]:Buffer.concat(e),i=(0,qi.normalizeShaBuffer)(n);return n===i?!1:(0,Id.createHash)("sha256").update(i).digest("hex")===r},OP=(r,e,t)=>{if(xd(e,r))return!0;if(t){if(C$(r,S$)){let n=r.indexOf(I$);return r[n-1]===x$&&n--,xd(e,r.subarray(n))}if(xd(e,b$,r,v$))return!0}return!!xd(e,_$,r,w$)},MP=r=>r instanceof Buffer?r:Buffer.from(r,"utf-8");async function P$(r){switch(r.type){case 0:try{let e=await Ky.promises.readFile(r.file);return{id:r.id,hash:r.mode===0?(0,qi.hash)(e):r.mode===2?y$(e):(0,qi.shaHash)(e)}}catch{return{id:r.id}}case 1:try{return{id:r.id,hash:(0,qi.hash)(MP(r.data))}}catch{return{id:r.id}}case 2:try{let e=await Ky.promises.readFile(r.file);return{id:r.id,matches:OP(e,r.expected,r.checkNode)}}catch{return{id:r.id,matches:!1}}case 3:try{return{id:r.id,matches:OP(MP(r.data),r.expected,r.checkNode)}}catch{return{id:r.id,matches:!1}}}}function T$(r){r.on("message",e=>{P$(e).then(t=>r.postMessage(t))})}Jy.parentPort&&T$(Jy.parentPort);var Cd=class{constructor(e=3,t=(0,NP.join)(__dirname,"hash.js")){this.maxFailures=e;this.hasherScriptPath=t;this.idCounter=0;this.failureCount=0;this.deferredMap=new Map;this.deferCleanup=XS(3e4,()=>this.cleanup())}async hashBytes(e,t){return(await this.send({type:1,data:t,mode:e,id:this.idCounter++})).hash}async hashFile(e,t){return(await this.send({type:0,file:t,mode:e,id:this.idCounter++})).hash}async verifyBytes(e,t,n){return(await this.send({type:3,data:e,id:this.idCounter++,expected:t,checkNode:n})).matches}async verifyFile(e,t,n){return(await this.send({type:2,file:e,id:this.idCounter++,expected:t,checkNode:n})).matches}dispose(){this.cleanup(),this.deferCleanup.clear()}send(e){let t=this.getProcess();if(!t)throw new Error("hash.js process unexpectedly exited");this.deferCleanup();let n=be();return this.deferredMap.set(e.id,{deferred:n,request:e}),t.postMessage(e),n.promise}cleanup(){this.instance&&(this.instance.removeAllListeners("exit"),this.instance.terminate(),this.instance=void 0,this.failureCount=0)}getProcess(){if(this.instance)return this.instance;if(this.failureCount>this.maxFailures)return;let e=this.instance=new LP.Worker(this.hasherScriptPath);return e.setMaxListeners(1/0),e.on("message",t=>{let n=t,i=this.deferredMap.get(n.id);i&&(i.deferred.resolve(n),this.deferredMap.delete(n.id))}),e.on("exit",()=>{this.instance=void 0,this.failureCount++;let t=this.getProcess();if(t){this.deferCleanup();for(let{request:n}of this.deferredMap.values())t.postMessage(n)}else{for(let{deferred:n}of this.deferredMap.values())n.reject(new Error("hash.js process unexpectedly exited"));this.deferredMap.clear(),this.deferCleanup.clear()}}),e}};var FP=new Cd;async function UP(r,e,t){return!r||vP(r)?void 0:e?(typeof t=="string"?await FP.verifyBytes(t,e,!0):await FP.verifyFile(r,e,!0))?r:void 0:await new Qr(BP.promises).exists(r)?r:void 0}var Zr="node:",di="<node_internals>";var jP,fa,E$,Tu=class{constructor(){this._indexes={__proto__:null},this.array=[]}};jP=(r,e)=>r._indexes[e],fa=(r,e)=>{let t=jP(r,e);if(t!==void 0)return t;let{array:n,_indexes:i}=r;return i[e]=n.push(e)-1},E$=r=>{let{array:e,_indexes:t}=r;if(e.length===0)return;let n=e.pop();t[n]=void 0};var qP="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",VP=new Uint8Array(64),$P=new Uint8Array(128);for(let r=0;r<qP.length;r++){let e=qP.charCodeAt(r);VP[r]=e,$P[e]=r}var Yy=typeof TextDecoder<"u"?new TextDecoder:typeof Buffer<"u"?{decode(r){return Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString()}}:{decode(r){let e="";for(let t=0;t<r.length;t++)e+=String.fromCharCode(r[t]);return e}};function HP(r){let e=new Int32Array(5),t=[],n=0;do{let i=R$(r,n),o=[],s=!0,a=0;e[0]=0;for(let c=n;c<i;c++){let u;c=Eu(r,c,e,0);let l=e[0];l<a&&(s=!1),a=l,WP(r,c,i)?(c=Eu(r,c,e,1),c=Eu(r,c,e,2),c=Eu(r,c,e,3),WP(r,c,i)?(c=Eu(r,c,e,4),u=[l,e[1],e[2],e[3],e[4]]):u=[l,e[1],e[2],e[3]]):u=[l],o.push(u)}s||A$(o),t.push(o),n=i+1}while(n<=r.length);return t}function R$(r,e){let t=r.indexOf(";",e);return t===-1?r.length:t}function Eu(r,e,t,n){let i=0,o=0,s=0;do{let c=r.charCodeAt(e++);s=$P[c],i|=(s&31)<<o,o+=5}while(s&32);let a=i&1;return i>>>=1,a&&(i=-2147483648|-i),t[n]+=i,e}function WP(r,e,t){return e>=t?!1:r.charCodeAt(e)!==44}function A$(r){r.sort(k$)}function k$(r,e){return r[0]-e[0]}function Pd(r){let e=new Int32Array(5),t=1024*16,n=t-36,i=new Uint8Array(t),o=i.subarray(0,n),s=0,a="";for(let c=0;c<r.length;c++){let u=r[c];if(c>0&&(s===t&&(a+=Yy.decode(i),s=0),i[s++]=59),u.length!==0){e[0]=0;for(let l=0;l<u.length;l++){let p=u[l];s>n&&(a+=Yy.decode(o),i.copyWithin(0,n,s),s-=n),l>0&&(i[s++]=44),s=Ru(i,s,e,p,0),p.length!==1&&(s=Ru(i,s,e,p,1),s=Ru(i,s,e,p,2),s=Ru(i,s,e,p,3),p.length!==4&&(s=Ru(i,s,e,p,4)))}}}return a+Yy.decode(i.subarray(0,s))}function Ru(r,e,t,n,i){let o=n[i],s=o-t[i];t[i]=o,s=s<0?-s<<1|1:s<<1;do{let a=s&31;s>>>=5,s>0&&(a|=32),r[e++]=VP[a]}while(s>0);return e}var D$=/^[\w+.-]+:\/\//,O$=/^([\w+.-]+:)\/\/([^@/#?]*@)?([^:/#?]*)(:\d+)?(\/[^#?]*)?(\?[^#]*)?(#.*)?/,M$=/^file:(?:\/\/((?![a-z]:)[^/#?]*)?)?(\/?[^#?]*)(\?[^#]*)?(#.*)?/i,Ye;(function(r){r[r.Empty=1]="Empty",r[r.Hash=2]="Hash",r[r.Query=3]="Query",r[r.RelativePath=4]="RelativePath",r[r.AbsolutePath=5]="AbsolutePath",r[r.SchemeRelative=6]="SchemeRelative",r[r.Absolute=7]="Absolute"})(Ye||(Ye={}));function N$(r){return D$.test(r)}function L$(r){return r.startsWith("//")}function KP(r){return r.startsWith("/")}function F$(r){return r.startsWith("file:")}function GP(r){return/^[.?#]/.test(r)}function Td(r){let e=O$.exec(r);return JP(e[1],e[2]||"",e[3],e[4]||"",e[5]||"/",e[6]||"",e[7]||"")}function B$(r){let e=M$.exec(r),t=e[2];return JP("file:","",e[1]||"","",KP(t)?t:"/"+t,e[3]||"",e[4]||"")}function JP(r,e,t,n,i,o,s){return{scheme:r,user:e,host:t,port:n,path:i,query:o,hash:s,type:Ye.Absolute}}function zP(r){if(L$(r)){let t=Td("http:"+r);return t.scheme="",t.type=Ye.SchemeRelative,t}if(KP(r)){let t=Td("http://foo.com"+r);return t.scheme="",t.host="",t.type=Ye.AbsolutePath,t}if(F$(r))return B$(r);if(N$(r))return Td(r);let e=Td("http://foo.com/"+r);return e.scheme="",e.host="",e.type=r?r.startsWith("?")?Ye.Query:r.startsWith("#")?Ye.Hash:Ye.RelativePath:Ye.Empty,e}function U$(r){if(r.endsWith("/.."))return r;let e=r.lastIndexOf("/");return r.slice(0,e+1)}function j$(r,e){YP(e,e.type),r.path==="/"?r.path=e.path:r.path=U$(e.path)+r.path}function YP(r,e){let t=e<=Ye.RelativePath,n=r.path.split("/"),i=1,o=0,s=!1;for(let c=1;c<n.length;c++){let u=n[c];if(!u){s=!0;continue}if(s=!1,u!=="."){if(u===".."){o?(s=!0,o--,i--):t&&(n[i++]=u);continue}n[i++]=u,o++}}let a="";for(let c=1;c<i;c++)a+="/"+n[c];(!a||s&&!a.endsWith("/.."))&&(a+="/"),r.path=a}function XP(r,e){if(!r&&!e)return"";let t=zP(r),n=t.type;if(e&&n!==Ye.Absolute){let o=zP(e),s=o.type;switch(n){case Ye.Empty:t.hash=o.hash;case Ye.Hash:t.query=o.query;case Ye.Query:case Ye.RelativePath:j$(t,o);case Ye.AbsolutePath:t.user=o.user,t.host=o.host,t.port=o.port;case Ye.SchemeRelative:t.scheme=o.scheme}s>n&&(n=s)}YP(t,n);let i=t.query+t.hash;switch(n){case Ye.Hash:case Ye.Query:return i;case Ye.RelativePath:{let o=t.path.slice(1);return o?GP(e||r)&&!GP(o)?"./"+o+i:o+i:i||"."}case Ye.AbsolutePath:return t.path+i;default:return t.scheme+"//"+t.user+t.host+t.port+t.path+i}}function QP(r,e){return e&&!e.endsWith("/")&&(e+="/"),XP(r,e)}function q$(r){if(!r)return"";let e=r.lastIndexOf("/");return r.slice(0,e+1)}var tn=0,Zy=1,eb=2,tb=3,nT=4,iT=1,oT=2;function W$(r,e){let t=ZP(r,0);if(t===r.length)return r;e||(r=r.slice());for(let n=t;n<r.length;n=ZP(r,n+1))r[n]=$$(r[n],e);return r}function ZP(r,e){for(let t=e;t<r.length;t++)if(!V$(r[t]))return t;return r.length}function V$(r){for(let e=1;e<r.length;e++)if(r[e][tn]<r[e-1][tn])return!1;return!0}function $$(r,e){return e||(r=r.slice()),r.sort(H$)}function H$(r,e){return r[tn]-e[tn]}var Ho=!1;function G$(r,e,t,n){for(;t<=n;){let i=t+(n-t>>1),o=r[i][tn]-e;if(o===0)return Ho=!0,i;o<0?t=i+1:n=i-1}return Ho=!1,t-1}function rb(r,e,t){for(let n=t+1;n<r.length&&r[n][tn]===e;t=n++);return t}function sT(r,e,t){for(let n=t-1;n>=0&&r[n][tn]===e;t=n--);return t}function aT(){return{lastKey:-1,lastNeedle:-1,lastIndex:-1}}function cT(r,e,t,n){let{lastKey:i,lastNeedle:o,lastIndex:s}=t,a=0,c=r.length-1;if(n===i){if(e===o)return Ho=s!==-1&&r[s][tn]===e,s;e>=o?a=s===-1?0:s:c=s}return t.lastKey=n,t.lastNeedle=e,t.lastIndex=G$(r,e,a,c)}function z$(r,e){let t=e.map(J$);for(let n=0;n<r.length;n++){let i=r[n];for(let o=0;o<i.length;o++){let s=i[o];if(s.length===1)continue;let a=s[Zy],c=s[eb],u=s[tb],l=t[a],p=l[c]||(l[c]=[]),d=e[a],f=rb(p,u,cT(p,u,d,c));K$(p,d.lastIndex=f+1,[u,n,s[tn]])}}return t}function K$(r,e,t){for(let n=r.length;n>e;n--)r[n]=r[n-1];r[e]=t}function J$(){return{__proto__:null}}var Ad=function(r,e){let t=typeof r=="string"?JSON.parse(r):r;if(!("sections"in t))return new Go(t,e);let n=[],i=[],o=[],s=[];uT(t,e,n,i,o,s,0,0,1/0,1/0);let a={version:3,file:t.file,names:s,sources:i,sourcesContent:o,mappings:n};return lT(a)};function uT(r,e,t,n,i,o,s,a,c,u){let{sections:l}=r;for(let p=0;p<l.length;p++){let{map:d,offset:f}=l[p],h=c,m=u;if(p+1<l.length){let b=l[p+1].offset;h=Math.min(c,s+b.line),h===c?m=Math.min(u,a+b.column):h<c&&(m=a+b.column)}Y$(d,e,t,n,i,o,s+f.line,a+f.column,h,m)}}function Y$(r,e,t,n,i,o,s,a,c,u){if("sections"in r)return uT(...arguments);let l=new Go(r,e),p=n.length,d=o.length,f=en(l),{resolvedSources:h,sourcesContent:m}=l;if(Xy(n,h),Xy(o,l.names),m)Xy(i,m);else for(let b=0;b<h.length;b++)i.push(null);for(let b=0;b<f.length;b++){let I=s+b;if(I>c)return;let D=X$(t,I),B=b===0?a:0,Z=f[b];for(let F=0;F<Z.length;F++){let X=Z[F],H=B+X[tn];if(I===c&&H>=u)return;if(X.length===1){D.push([H]);continue}let j=p+X[Zy],te=X[eb],Se=X[tb];D.push(X.length===4?[H,j,te,Se]:[H,j,te,Se,d+X[nT]])}}}function Xy(r,e){for(let t=0;t<e.length;t++)r.push(e[t])}function X$(r,e){for(let t=r.length;t<=e;t++)r[t]=[];return r[e]}var eT="`line` must be greater than 0 (lines start at line 1)",tT="`column` must be greater than or equal to 0 (columns start at column 0)",ha=-1,An=1,rT,en,Q$,nb,ib,ob,sb,Z$,lT,eH,tH,Go=class{constructor(e,t){let n=typeof e=="string";if(!n&&e._decodedMemo)return e;let i=n?JSON.parse(e):e,{version:o,file:s,names:a,sourceRoot:c,sources:u,sourcesContent:l}=i;this.version=o,this.file=s,this.names=a||[],this.sourceRoot=c,this.sources=u,this.sourcesContent=l;let p=QP(c||"",q$(t));this.resolvedSources=u.map(f=>QP(f||"",p));let{mappings:d}=i;typeof d=="string"?(this._encoded=d,this._decoded=void 0):(this._encoded=void 0,this._decoded=W$(d,n)),this._decodedMemo=aT(),this._bySources=void 0,this._bySourceMemos=void 0}};(()=>{rT=e=>{var t;return(t=e._encoded)!==null&&t!==void 0?t:e._encoded=Pd(e._decoded)},en=e=>e._decoded||(e._decoded=HP(e._encoded)),Q$=(e,t,n)=>{let i=en(e);if(t>=i.length)return null;let o=i[t],s=Rd(o,e._decodedMemo,t,n,An);return s===-1?null:o[s]},nb=(e,{line:t,column:n,bias:i})=>{if(t--,t<0)throw new Error(eT);if(n<0)throw new Error(tT);let o=en(e);if(t>=o.length)return Ed(null,null,null,null);let s=o[t],a=Rd(s,e._decodedMemo,t,n,i||An);if(a===-1)return Ed(null,null,null,null);let c=s[a];if(c.length===1)return Ed(null,null,null,null);let{names:u,resolvedSources:l}=e;return Ed(l[c[Zy]],c[eb]+1,c[tb],c.length===5?u[c[nT]]:null)},ob=(e,{source:t,line:n,column:i,bias:o})=>r(e,t,n,i,o||ha,!0),ib=(e,{source:t,line:n,column:i,bias:o})=>r(e,t,n,i,o||An,!1),sb=(e,t)=>{let n=en(e),{names:i,resolvedSources:o}=e;for(let s=0;s<n.length;s++){let a=n[s];for(let c=0;c<a.length;c++){let u=a[c],l=s+1,p=u[0],d=null,f=null,h=null,m=null;u.length!==1&&(d=o[u[1]],f=u[2]+1,h=u[3]),u.length===5&&(m=i[u[4]]),t({generatedLine:l,generatedColumn:p,source:d,originalLine:f,originalColumn:h,name:m})}}},Z$=(e,t)=>{let{sources:n,resolvedSources:i,sourcesContent:o}=e;if(o==null)return null;let s=n.indexOf(t);return s===-1&&(s=i.indexOf(t)),s===-1?null:o[s]},lT=(e,t)=>{let n=new Go(Qy(e,[]),t);return n._decoded=e.mappings,n},eH=e=>Qy(e,en(e)),tH=e=>Qy(e,rT(e));function r(e,t,n,i,o,s){if(n--,n<0)throw new Error(eT);if(i<0)throw new Error(tT);let{sources:a,resolvedSources:c}=e,u=a.indexOf(t);if(u===-1&&(u=c.indexOf(t)),u===-1)return s?[]:Au(null,null);let p=(e._bySources||(e._bySources=z$(en(e),e._bySourceMemos=a.map(aT))))[u][n];if(p==null)return s?[]:Au(null,null);let d=e._bySourceMemos[u];if(s)return rH(p,d,n,i,o);let f=Rd(p,d,n,i,o);if(f===-1)return Au(null,null);let h=p[f];return Au(h[iT]+1,h[oT])}})();function Qy(r,e){return{version:r.version,file:r.file,names:r.names,sourceRoot:r.sourceRoot,sources:r.sources,sourcesContent:r.sourcesContent,mappings:e}}function Ed(r,e,t,n){return{source:r,line:e,column:t,name:n}}function Au(r,e){return{line:r,column:e}}function Rd(r,e,t,n,i){let o=cT(r,n,e,t);return Ho?o=(i===ha?rb:sT)(r,n,o):i===ha&&o++,o===-1||o===r.length?-1:o}function rH(r,e,t,n,i){let o=Rd(r,e,t,n,An);if(!Ho&&i===ha&&o++,o===-1||o===r.length)return[];let s=Ho?n:r[o][tn];Ho||(o=sT(r,s,o));let a=rb(r,s,o),c=[];for(;o<=a;o++){let u=r[o];c.push(Au(u[iT]+1,u[oT]))}return c}var hT=0,mT=1,gT=2,yT=3,bT=4,vT=-1,ab,nH,iH,oH,cb,kd,sH,aH,cH,ku,Du=class{constructor({file:e,sourceRoot:t}={}){this._names=new Tu,this._sources=new Tu,this._sourcesContent=[],this._mappings=[],this.file=e,this.sourceRoot=t}};ab=(r,e,t,n,i,o,s,a)=>ku(!1,r,e,t,n,i,o,s,a),iH=(r,e,t,n,i,o,s,a)=>ku(!0,r,e,t,n,i,o,s,a),nH=(r,e)=>fT(!1,r,e),oH=(r,e)=>fT(!0,r,e),cb=(r,e,t)=>{let{_sources:n,_sourcesContent:i}=r;i[fa(n,e)]=t},kd=r=>{let{file:e,sourceRoot:t,_mappings:n,_sources:i,_sourcesContent:o,_names:s}=r;return pH(n),{version:3,file:e||void 0,names:s.array,sourceRoot:t||void 0,sources:i.array,sourcesContent:o,mappings:n}},sH=r=>{let e=kd(r);return Object.assign(Object.assign({},e),{mappings:Pd(e.mappings)})},cH=r=>{let e=[],{_mappings:t,_sources:n,_names:i}=r;for(let o=0;o<t.length;o++){let s=t[o];for(let a=0;a<s.length;a++){let c=s[a],u={line:o+1,column:c[hT]},l,p,d;c.length!==1&&(l=n.array[c[mT]],p={line:c[gT]+1,column:c[yT]},c.length===5&&(d=i.array[c[bT]])),e.push({generated:u,source:l,original:p,name:d})}}return e},aH=r=>{let e=new Go(r),t=new Du({file:e.file,sourceRoot:e.sourceRoot});return dT(t._names,e.names),dT(t._sources,e.sources),t._sourcesContent=e.sourcesContent||e.sources.map(()=>null),t._mappings=en(e),t},ku=(r,e,t,n,i,o,s,a,c)=>{let{_mappings:u,_sources:l,_sourcesContent:p,_names:d}=e,f=uH(u,t),h=lH(f,n);if(!i)return r&&dH(f,h)?void 0:pT(f,h,[n]);let m=fa(l,i),b=a?fa(d,a):vT;if(m===p.length&&(p[m]=c??null),!(r&&fH(f,h,m,o,s,b)))return pT(f,h,a?[n,m,o,s,b]:[n,m,o,s])};function uH(r,e){for(let t=r.length;t<=e;t++)r[t]=[];return r[e]}function lH(r,e){let t=r.length;for(let n=t-1;n>=0;t=n--){let i=r[n];if(e>=i[hT])break}return t}function pT(r,e,t){for(let n=r.length;n>e;n--)r[n]=r[n-1];r[e]=t}function pH(r){let{length:e}=r,t=e;for(let n=t-1;n>=0&&!(r[n].length>0);t=n,n--);t<e&&(r.length=t)}function dT(r,e){for(let t=0;t<e.length;t++)fa(r,e[t])}function dH(r,e){return e===0?!0:r[e-1].length===1}function fH(r,e,t,n,i,o){if(e===0)return!1;let s=r[e-1];return s.length===1?!1:t===s[mT]&&n===s[gT]&&i===s[yT]&&o===(s.length===5?s[bT]:vT)}function fT(r,e,t){let{generated:n,source:i,original:o,name:s,content:a}=t;if(!i)return ku(r,e,n.line-1,n.column,null,null,null,null,null);let c=i;return ku(r,e,n.line-1,n.column,c,o.line-1,o.column,s,a)}var Jd=g("./vendor/acorn.js");var{stringify:mH}=JSON;if(!String.prototype.repeat)throw new Error("String.prototype.repeat is undefined, see https://github.com/davidbonnet/astring#installation");if(!String.prototype.endsWith)throw new Error("String.prototype.endsWith is undefined, see https://github.com/davidbonnet/astring#installation");var Dd={"||":2,"??":3,"&&":4,"|":5,"^":6,"&":7,"==":8,"!=":8,"===":8,"!==":8,"<":9,">":9,"<=":9,">=":9,in:9,instanceof:9,"<<":10,">>":10,">>>":10,"+":11,"-":11,"*":12,"%":12,"/":12,"**":13},rn=17,gH={ArrayExpression:20,TaggedTemplateExpression:20,ThisExpression:20,Identifier:20,PrivateIdentifier:20,Literal:18,TemplateLiteral:20,Super:20,SequenceExpression:20,MemberExpression:19,ChainExpression:19,CallExpression:19,NewExpression:19,ArrowFunctionExpression:rn,ClassExpression:rn,FunctionExpression:rn,ObjectExpression:rn,UpdateExpression:16,UnaryExpression:15,AwaitExpression:15,BinaryExpression:14,LogicalExpression:13,ConditionalExpression:4,AssignmentExpression:3,YieldExpression:2,RestElement:1};function ma(r,e){let{generator:t}=r;if(r.write("("),e!=null&&e.length>0){t[e[0].type](e[0],r);let{length:n}=e;for(let i=1;i<n;i++){let o=e[i];r.write(", "),t[o.type](o,r)}}r.write(")")}function PT(r,e,t,n){let i=r.expressionsPrecedence[e.type];if(i===rn)return!0;let o=r.expressionsPrecedence[t.type];return i!==o?!n&&i===15&&o===14&&t.operator==="**"||i<o:i!==13&&i!==14?!1:e.operator==="**"&&t.operator==="**"?!n:i===13&&o===13&&(e.operator==="??"||t.operator==="??")?!0:n?Dd[e.operator]<=Dd[t.operator]:Dd[e.operator]<Dd[t.operator]}function Od(r,e,t,n){let{generator:i}=r;PT(r,e,t,n)?(r.write("("),i[e.type](e,r),r.write(")")):i[e.type](e,r)}function yH(r,e,t,n){let i=e.split(`
`),o=i.length-1;if(r.write(i[0].trim()),o>0){r.write(n);for(let s=1;s<o;s++)r.write(t+i[s].trim()+n);r.write(t+i[o].trim())}}function qt(r,e,t,n){let{length:i}=e;for(let o=0;o<i;o++){let s=e[o];r.write(t),s.type[0]==="L"?r.write("// "+s.value.trim()+`
`,s):(r.write("/*"),yH(r,s.value,t,n),r.write("*/"+n))}}function bH(r){let e=r;for(;e!=null;){let{type:t}=e;if(t[0]==="C"&&t[1]==="a")return!0;if(t[0]==="M"&&t[1]==="e"&&t[2]==="m")e=e.object;else return!1}}function ub(r,e){let{generator:t}=r,{declarations:n}=e;r.write(e.kind+" ");let{length:i}=n;if(i>0){t.VariableDeclarator(n[0],r);for(let o=1;o<i;o++)r.write(", "),t.VariableDeclarator(n[o],r)}}var _T,wT,ST,xT,IT,CT,vH={Program(r,e){let t=e.indent.repeat(e.indentLevel),{lineEnd:n,writeComments:i}=e;i&&r.comments!=null&&qt(e,r.comments,t,n);let o=r.body,{length:s}=o;for(let a=0;a<s;a++){let c=o[a];i&&c.comments!=null&&qt(e,c.comments,t,n),e.write(t),this[c.type](c,e),e.write(n)}i&&r.trailingComments!=null&&qt(e,r.trailingComments,t,n)},BlockStatement:CT=function(r,e){let t=e.indent.repeat(e.indentLevel++),{lineEnd:n,writeComments:i}=e,o=t+e.indent;e.write("{");let s=r.body;if(s!=null&&s.length>0){e.write(n),i&&r.comments!=null&&qt(e,r.comments,o,n);let{length:a}=s;for(let c=0;c<a;c++){let u=s[c];i&&u.comments!=null&&qt(e,u.comments,o,n),e.write(o),this[u.type](u,e),e.write(n)}e.write(t)}else i&&r.comments!=null&&(e.write(n),qt(e,r.comments,o,n),e.write(t));i&&r.trailingComments!=null&&qt(e,r.trailingComments,o,n),e.write("}"),e.indentLevel--},ClassBody:CT,StaticBlock(r,e){e.write("static "),this.BlockStatement(r,e)},EmptyStatement(r,e){e.write(";")},ExpressionStatement(r,e){let t=e.expressionsPrecedence[r.expression.type];t===rn||t===3&&r.expression.left.type[0]==="O"?(e.write("("),this[r.expression.type](r.expression,e),e.write(")")):this[r.expression.type](r.expression,e),e.write(";")},IfStatement(r,e){e.write("if ("),this[r.test.type](r.test,e),e.write(") "),this[r.consequent.type](r.consequent,e),r.alternate!=null&&(e.write(" else "),this[r.alternate.type](r.alternate,e))},LabeledStatement(r,e){this[r.label.type](r.label,e),e.write(": "),this[r.body.type](r.body,e)},BreakStatement(r,e){e.write("break"),r.label!=null&&(e.write(" "),this[r.label.type](r.label,e)),e.write(";")},ContinueStatement(r,e){e.write("continue"),r.label!=null&&(e.write(" "),this[r.label.type](r.label,e)),e.write(";")},WithStatement(r,e){e.write("with ("),this[r.object.type](r.object,e),e.write(") "),this[r.body.type](r.body,e)},SwitchStatement(r,e){let t=e.indent.repeat(e.indentLevel++),{lineEnd:n,writeComments:i}=e;e.indentLevel++;let o=t+e.indent,s=o+e.indent;e.write("switch ("),this[r.discriminant.type](r.discriminant,e),e.write(") {"+n);let{cases:a}=r,{length:c}=a;for(let u=0;u<c;u++){let l=a[u];i&&l.comments!=null&&qt(e,l.comments,o,n),l.test?(e.write(o+"case "),this[l.test.type](l.test,e),e.write(":"+n)):e.write(o+"default:"+n);let{consequent:p}=l,{length:d}=p;for(let f=0;f<d;f++){let h=p[f];i&&h.comments!=null&&qt(e,h.comments,s,n),e.write(s),this[h.type](h,e),e.write(n)}}e.indentLevel-=2,e.write(t+"}")},ReturnStatement(r,e){e.write("return"),r.argument&&(e.write(" "),this[r.argument.type](r.argument,e)),e.write(";")},ThrowStatement(r,e){e.write("throw "),this[r.argument.type](r.argument,e),e.write(";")},TryStatement(r,e){if(e.write("try "),this[r.block.type](r.block,e),r.handler){let{handler:t}=r;t.param==null?e.write(" catch "):(e.write(" catch ("),this[t.param.type](t.param,e),e.write(") ")),this[t.body.type](t.body,e)}r.finalizer&&(e.write(" finally "),this[r.finalizer.type](r.finalizer,e))},WhileStatement(r,e){e.write("while ("),this[r.test.type](r.test,e),e.write(") "),this[r.body.type](r.body,e)},DoWhileStatement(r,e){e.write("do "),this[r.body.type](r.body,e),e.write(" while ("),this[r.test.type](r.test,e),e.write(");")},ForStatement(r,e){if(e.write("for ("),r.init!=null){let{init:t}=r;t.type[0]==="V"?ub(e,t):this[t.type](t,e)}e.write("; "),r.test&&this[r.test.type](r.test,e),e.write("; "),r.update&&this[r.update.type](r.update,e),e.write(") "),this[r.body.type](r.body,e)},ForInStatement:_T=function(r,e){e.write(`for ${r.await?"await ":""}(`);let{left:t}=r;t.type[0]==="V"?ub(e,t):this[t.type](t,e),e.write(r.type[3]==="I"?" in ":" of "),this[r.right.type](r.right,e),e.write(") "),this[r.body.type](r.body,e)},ForOfStatement:_T,DebuggerStatement(r,e){e.write("debugger;",r)},FunctionDeclaration:wT=function(r,e){e.write((r.async?"async ":"")+(r.generator?"function* ":"function ")+(r.id?r.id.name:""),r),ma(e,r.params),e.write(" "),this[r.body.type](r.body,e)},FunctionExpression:wT,VariableDeclaration(r,e){ub(e,r),e.write(";")},VariableDeclarator(r,e){this[r.id.type](r.id,e),r.init!=null&&(e.write(" = "),this[r.init.type](r.init,e))},ClassDeclaration(r,e){if(e.write("class "+(r.id?`${r.id.name} `:""),r),r.superClass){e.write("extends ");let{superClass:t}=r,{type:n}=t,i=e.expressionsPrecedence[n];(n[0]!=="C"||n[1]!=="l"||n[5]!=="E")&&(i===rn||i<e.expressionsPrecedence.ClassExpression)?(e.write("("),this[r.superClass.type](t,e),e.write(")")):this[t.type](t,e),e.write(" ")}this.ClassBody(r.body,e)},ImportDeclaration(r,e){e.write("import ");let{specifiers:t}=r,{length:n}=t,i=0;if(n>0){for(;i<n;){i>0&&e.write(", ");let o=t[i],s=o.type[6];if(s==="D")e.write(o.local.name,o),i++;else if(s==="N")e.write("* as "+o.local.name,o),i++;else break}if(i<n){for(e.write("{");;){let o=t[i],{name:s}=o.imported;if(e.write(s,o),s!==o.local.name&&e.write(" as "+o.local.name),++i<n)e.write(", ");else break}e.write("}")}e.write(" from ")}this.Literal(r.source,e),e.write(";")},ImportExpression(r,e){e.write("import("),this[r.source.type](r.source,e),e.write(")")},ExportDefaultDeclaration(r,e){e.write("export default "),this[r.declaration.type](r.declaration,e),e.expressionsPrecedence[r.declaration.type]!=null&&r.declaration.type[0]!=="F"&&e.write(";")},ExportNamedDeclaration(r,e){if(e.write("export "),r.declaration)this[r.declaration.type](r.declaration,e);else{e.write("{");let{specifiers:t}=r,{length:n}=t;if(n>0)for(let i=0;;){let o=t[i],{name:s}=o.local;if(e.write(s,o),s!==o.exported.name&&e.write(" as "+o.exported.name),++i<n)e.write(", ");else break}e.write("}"),r.source&&(e.write(" from "),this.Literal(r.source,e)),e.write(";")}},ExportAllDeclaration(r,e){r.exported!=null?e.write("export * as "+r.exported.name+" from "):e.write("export * from "),this.Literal(r.source,e),e.write(";")},MethodDefinition(r,e){r.static&&e.write("static ");let t=r.kind[0];(t==="g"||t==="s")&&e.write(r.kind+" "),r.value.async&&e.write("async "),r.value.generator&&e.write("*"),r.computed?(e.write("["),this[r.key.type](r.key,e),e.write("]")):this[r.key.type](r.key,e),ma(e,r.value.params),e.write(" "),this[r.value.body.type](r.value.body,e)},ClassExpression(r,e){this.ClassDeclaration(r,e)},ArrowFunctionExpression(r,e){e.write(r.async?"async ":"",r);let{params:t}=r;t!=null&&(t.length===1&&t[0].type[0]==="I"?e.write(t[0].name,t[0]):ma(e,r.params)),e.write(" => "),r.body.type[0]==="O"?(e.write("("),this.ObjectExpression(r.body,e),e.write(")")):this[r.body.type](r.body,e)},ThisExpression(r,e){e.write("this",r)},Super(r,e){e.write("super",r)},RestElement:ST=function(r,e){e.write("..."),this[r.argument.type](r.argument,e)},SpreadElement:ST,YieldExpression(r,e){e.write(r.delegate?"yield*":"yield"),r.argument&&(e.write(" "),this[r.argument.type](r.argument,e))},AwaitExpression(r,e){e.write("await ",r),Od(e,r.argument,r)},TemplateLiteral(r,e){let{quasis:t,expressions:n}=r;e.write("`");let{length:i}=n;for(let s=0;s<i;s++){let a=n[s],c=t[s];e.write(c.value.raw,c),e.write("${"),this[a.type](a,e),e.write("}")}let o=t[t.length-1];e.write(o.value.raw,o),e.write("`")},TemplateElement(r,e){e.write(r.value.raw,r)},TaggedTemplateExpression(r,e){Od(e,r.tag,r),this[r.quasi.type](r.quasi,e)},ArrayExpression:IT=function(r,e){if(e.write("["),r.elements.length>0){let{elements:t}=r,{length:n}=t;for(let i=0;;){let o=t[i];if(o!=null&&this[o.type](o,e),++i<n)e.write(", ");else{o==null&&e.write(", ");break}}}e.write("]")},ArrayPattern:IT,ObjectExpression(r,e){let t=e.indent.repeat(e.indentLevel++),{lineEnd:n,writeComments:i}=e,o=t+e.indent;if(e.write("{"),r.properties.length>0){e.write(n),i&&r.comments!=null&&qt(e,r.comments,o,n);let s=","+n,{properties:a}=r,{length:c}=a;for(let u=0;;){let l=a[u];if(i&&l.comments!=null&&qt(e,l.comments,o,n),e.write(o),this[l.type](l,e),++u<c)e.write(s);else break}e.write(n),i&&r.trailingComments!=null&&qt(e,r.trailingComments,o,n),e.write(t+"}")}else i?r.comments!=null?(e.write(n),qt(e,r.comments,o,n),r.trailingComments!=null&&qt(e,r.trailingComments,o,n),e.write(t+"}")):r.trailingComments!=null?(e.write(n),qt(e,r.trailingComments,o,n),e.write(t+"}")):e.write("}"):e.write("}");e.indentLevel--},Property(r,e){r.method||r.kind[0]!=="i"?this.MethodDefinition(r,e):(r.shorthand||(r.computed?(e.write("["),this[r.key.type](r.key,e),e.write("]")):this[r.key.type](r.key,e),e.write(": ")),this[r.value.type](r.value,e))},PropertyDefinition(r,e){if(r.static&&e.write("static "),r.computed&&e.write("["),this[r.key.type](r.key,e),r.computed&&e.write("]"),r.value==null){r.key.type[0]!=="F"&&e.write(";");return}e.write(" = "),this[r.value.type](r.value,e),e.write(";")},ObjectPattern(r,e){if(e.write("{"),r.properties.length>0){let{properties:t}=r,{length:n}=t;for(let i=0;this[t[i].type](t[i],e),++i<n;)e.write(", ")}e.write("}")},SequenceExpression(r,e){ma(e,r.expressions)},UnaryExpression(r,e){if(r.prefix){let{operator:t,argument:n,argument:{type:i}}=r;e.write(t);let o=PT(e,n,r);!o&&(t.length>1||i[0]==="U"&&(i[1]==="n"||i[1]==="p")&&n.prefix&&n.operator[0]===t&&(t==="+"||t==="-"))&&e.write(" "),o?(e.write(t.length>1?" (":"("),this[i](n,e),e.write(")")):this[i](n,e)}else this[r.argument.type](r.argument,e),e.write(r.operator)},UpdateExpression(r,e){r.prefix?(e.write(r.operator),this[r.argument.type](r.argument,e)):(this[r.argument.type](r.argument,e),e.write(r.operator))},AssignmentExpression(r,e){this[r.left.type](r.left,e),e.write(" "+r.operator+" "),this[r.right.type](r.right,e)},AssignmentPattern(r,e){this[r.left.type](r.left,e),e.write(" = "),this[r.right.type](r.right,e)},BinaryExpression:xT=function(r,e){let t=r.operator==="in";t&&e.write("("),Od(e,r.left,r,!1),e.write(" "+r.operator+" "),Od(e,r.right,r,!0),t&&e.write(")")},LogicalExpression:xT,ConditionalExpression(r,e){let{test:t}=r,n=e.expressionsPrecedence[t.type];n===rn||n<=e.expressionsPrecedence.ConditionalExpression?(e.write("("),this[t.type](t,e),e.write(")")):this[t.type](t,e),e.write(" ? "),this[r.consequent.type](r.consequent,e),e.write(" : "),this[r.alternate.type](r.alternate,e)},NewExpression(r,e){e.write("new ");let t=e.expressionsPrecedence[r.callee.type];t===rn||t<e.expressionsPrecedence.CallExpression||bH(r.callee)?(e.write("("),this[r.callee.type](r.callee,e),e.write(")")):this[r.callee.type](r.callee,e),ma(e,r.arguments)},CallExpression(r,e){let t=e.expressionsPrecedence[r.callee.type];t===rn||t<e.expressionsPrecedence.CallExpression?(e.write("("),this[r.callee.type](r.callee,e),e.write(")")):this[r.callee.type](r.callee,e),r.optional&&e.write("?."),ma(e,r.arguments)},ChainExpression(r,e){this[r.expression.type](r.expression,e)},MemberExpression(r,e){let t=e.expressionsPrecedence[r.object.type];t===rn||t<e.expressionsPrecedence.MemberExpression?(e.write("("),this[r.object.type](r.object,e),e.write(")")):this[r.object.type](r.object,e),r.computed?(r.optional&&e.write("?."),e.write("["),this[r.property.type](r.property,e),e.write("]")):(r.optional?e.write("?."):e.write("."),this[r.property.type](r.property,e))},MetaProperty(r,e){e.write(r.meta.name+"."+r.property.name,r)},Identifier(r,e){e.write(r.name,r)},PrivateIdentifier(r,e){e.write(`#${r.name}`,r)},Literal(r,e){r.raw!=null?e.write(r.raw,r):r.regex!=null?this.RegExpLiteral(r,e):r.bigint!=null?e.write(r.bigint+"n",r):e.write(mH(r.value),r)},RegExpLiteral(r,e){let{regex:t}=r;e.write(`/${t.pattern}/${t.flags}`,r)}},_H={};var lb=class{constructor(e){let t=e??_H;this.output="",t.output!=null?(this.output=t.output,this.write=this.writeToStream):this.output="",this.generator=t.generator!=null?t.generator:vH,this.expressionsPrecedence=t.expressionsPrecedence!=null?t.expressionsPrecedence:gH,this.indent=t.indent!=null?t.indent:"  ",this.lineEnd=t.lineEnd!=null?t.lineEnd:`
`,this.indentLevel=t.startingIndentLevel!=null?t.startingIndentLevel:0,this.writeComments=t.comments?t.comments:!1,t.sourceMap!=null&&(this.write=t.output==null?this.writeAndMap:this.writeToStreamAndMap,this.sourceMap=t.sourceMap,this.line=1,this.column=0,this.lineEndSize=this.lineEnd.split(`
`).length-1,this.mapping={original:null,generated:this,name:void 0,source:t.sourceMap.file||t.sourceMap._file})}write(e){this.output+=e}writeToStream(e){this.output.write(e)}writeAndMap(e,t){this.output+=e,this.map(e,t)}writeToStreamAndMap(e,t){this.output.write(e),this.map(e,t)}map(e,t){if(t!=null){let{type:o}=t;if(o[0]==="L"&&o[2]==="n"){this.column=0,this.line++;return}if(t.loc!=null){let{mapping:s}=this;s.original=t.loc.start,s.name=t.name,this.sourceMap.addMapping(s)}if(o[0]==="T"&&o[8]==="E"||o[0]==="L"&&o[1]==="i"&&typeof t.value=="string"){let{length:s}=e,{column:a,line:c}=this;for(let u=0;u<s;u++)e[u]===`
`?(a=0,c++):a++;this.column=a,this.line=c;return}}let{length:n}=e,{lineEnd:i}=this;n>0&&(this.lineEndSize>0&&(i.length===1?e[n-1]===i:e.endsWith(i))?(this.line+=this.lineEndSize,this.column=0):this.column+=n)}toString(){return this.output}};function fi(r,e){let t=new lb(e);return t.generator[r.type](r,t),t.output}var TT=g("./vendor/acorn.js"),Ld=g("./vendor/acorn-loose.js");var Md={ArrayExpression:["elements"],ArrayPattern:["elements"],ArrowFunctionExpression:["params","body"],AssignmentExpression:["left","right"],AssignmentPattern:["left","right"],AwaitExpression:["argument"],BinaryExpression:["left","right"],BlockStatement:["body"],BreakStatement:["label"],CallExpression:["callee","arguments"],CatchClause:["param","body"],ChainExpression:["expression"],ClassBody:["body"],ClassDeclaration:["id","superClass","body"],ClassExpression:["id","superClass","body"],ConditionalExpression:["test","consequent","alternate"],ContinueStatement:["label"],DebuggerStatement:[],DoWhileStatement:["body","test"],EmptyStatement:[],ExperimentalRestProperty:["argument"],ExperimentalSpreadProperty:["argument"],ExportAllDeclaration:["exported","source"],ExportDefaultDeclaration:["declaration"],ExportNamedDeclaration:["declaration","specifiers","source"],ExportSpecifier:["exported","local"],ExpressionStatement:["expression"],ForInStatement:["left","right","body"],ForOfStatement:["left","right","body"],ForStatement:["init","test","update","body"],FunctionDeclaration:["id","params","body"],FunctionExpression:["id","params","body"],Identifier:[],IfStatement:["test","consequent","alternate"],ImportDeclaration:["specifiers","source"],ImportDefaultSpecifier:["local"],ImportExpression:["source"],ImportNamespaceSpecifier:["local"],ImportSpecifier:["imported","local"],JSXAttribute:["name","value"],JSXClosingElement:["name"],JSXClosingFragment:[],JSXElement:["openingElement","children","closingElement"],JSXEmptyExpression:[],JSXExpressionContainer:["expression"],JSXFragment:["openingFragment","children","closingFragment"],JSXIdentifier:[],JSXMemberExpression:["object","property"],JSXNamespacedName:["namespace","name"],JSXOpeningElement:["name","attributes"],JSXOpeningFragment:[],JSXSpreadAttribute:["argument"],JSXSpreadChild:["expression"],JSXText:[],LabeledStatement:["label","body"],Literal:[],LogicalExpression:["left","right"],MemberExpression:["object","property"],MetaProperty:["meta","property"],MethodDefinition:["key","value"],NewExpression:["callee","arguments"],ObjectExpression:["properties"],ObjectPattern:["properties"],PrivateIdentifier:[],Program:["body"],Property:["key","value"],PropertyDefinition:["key","value"],RestElement:["argument"],ReturnStatement:["argument"],SequenceExpression:["expressions"],SpreadElement:["argument"],StaticBlock:["body"],Super:[],SwitchCase:["test","consequent"],SwitchStatement:["discriminant","cases"],TaggedTemplateExpression:["tag","quasi"],TemplateElement:[],TemplateLiteral:["quasis","expressions"],ThisExpression:[],ThrowStatement:["argument"],TryStatement:["block","handler","finalizer"],UnaryExpression:["argument"],UpdateExpression:["argument"],VariableDeclaration:["declarations"],VariableDeclarator:["id","init"],WhileStatement:["test","body"],WithStatement:["object","body"],YieldExpression:["argument"]},wH=Object.keys(Md);for(let r of wH)Object.freeze(Md[r]);Object.freeze(Md);var pb=Md;var db={ecmaVersion:"latest",locations:!0,allowAwaitOutsideFunction:!0,allowImportExportEverywhere:!0,allowReserved:!0,allowReturnOutsideFunction:!0},Wi=r=>r.start,fb=r=>r.end,ET=(r,e)=>r.slice(Wi(e),fb(e)),kn=(r,e=!1)=>(e?TT.parse:Ld.parse)(r,db),Ou=r=>{let e=kn(r);for(let t of e.body)t.type==="FunctionDeclaration"&&t.id&&(0,Ld.isDummy)(t.id)&&(t.id=null);return e.body};function RT(r,e,t){return e.length>1||e[0].type!=="FunctionDeclaration"?DT(r,e,!0,t):AT(r,[{type:"ReturnStatement",argument:{type:"CallExpression",optional:!1,arguments:[{type:"ThisExpression"},...r.map(n=>({type:"Identifier",name:n}))],callee:{type:"MemberExpression",property:{type:"Identifier",name:"call"},computed:!1,optional:!1,object:{type:"FunctionExpression",params:e[0].params,body:e[0].body}}}}],!0,t)}var AT=(r,e,t,n)=>{let i={type:"Identifier",name:"e"},s=n?[{type:"TryStatement",block:{type:"BlockStatement",body:e},handler:{type:"CatchClause",param:i,body:{type:"BlockStatement",body:[{type:"ReturnStatement",argument:{type:"LogicalExpression",left:{type:"LogicalExpression",left:{type:"MemberExpression",object:i,property:{type:"Identifier",name:"stack"},computed:!1,optional:!1},operator:"||",right:{type:"MemberExpression",object:i,property:{type:"Identifier",name:"message"},computed:!1,optional:!1}},operator:"||",right:{type:"CallExpression",callee:{type:"Identifier",name:"String"},arguments:[i],optional:!1}}}]}}}]:e;return t?{type:"FunctionExpression",id:{type:"Identifier",name:"_generatedCode"},params:r.map(a=>({type:"Identifier",name:a})),body:{type:"BlockStatement",body:s}}:{type:"ArrowFunctionExpression",params:r.map(a=>({type:"Identifier",name:a})),expression:!1,body:{type:"BlockStatement",body:s}}},xH=(r,e)=>({type:"CallExpression",arguments:r.map(t=>({type:"Identifier",name:t})),callee:e,optional:!1}),kT=(r,e,t)=>xH(r,DT(r,e,t,!0));function DT(r,e,t,n){let i=e[e.length-1];if(i.type!=="ReturnStatement"){let o=IH(i);o&&(e=[...e.slice(0,-1),{type:"ReturnStatement",argument:o}])}return AT(r,e,t,n)}function IH(r){switch(r.type){case"ExpressionStatement":return r.expression;case"BlockStatement":return{type:"CallExpression",arguments:[],callee:{type:"ArrowFunctionExpression",params:[],expression:!1,body:r},optional:!1};case"ReturnStatement":return r.argument||void 0;default:return}}var Vi=(r,e)=>{Nd(r,e)},Fd=(r,e)=>{let t=Nd(r,e);return t&&typeof t=="object"?t.replace:r},Nd=(r,e,t)=>{if(!r)return;let n=e.enter(r,t);if(n===0)return 0;if(n&&typeof n=="object")return n;if(n===1)return;let i=pb[r.type];if(i)for(let o of i){let s=r[o];if(s instanceof Array)for(let[a,c]of s.entries()){let u=Nd(c,e,r);if(u===0)return 0;u&&typeof u=="object"&&(s[a]=u.replace)}else if(s){let a=Nd(s,e,r);if(a===0)return 0;a&&typeof a=="object"&&(r[o]=a.replace)}}e.leave?.(r)};var $T=g("dns"),pr=S(g("path")),Mn=g("url");var LT=g("url");var k=class{constructor(){this._listeners=new Set;this.event=(e,t,n)=>{let i={listener:e,thisArg:t};this._listeners.add(i);let o={dispose:()=>{o.dispose=()=>{},this._listeners.delete(i)}};return n&&n.push(o),o}}get size(){return this._listeners.size}fire(e){let t=!this._deliveryQueue;this._deliveryQueue||(this._deliveryQueue=[]);for(let n of this._listeners)this._deliveryQueue.push({data:n,event:e});if(t){for(let n=0;n<this._deliveryQueue.length;n++){let{data:i,event:o}=this._deliveryQueue[n];i.listener.call(i.thisArg,o)}this._deliveryQueue=void 0}}dispose(){this._listeners.clear(),this._deliveryQueue&&(this._deliveryQueue=[])}},Mu=class{constructor(){this.map=new Map;this.listeners=this.map}listen(e,t){let n=this.map.get(e);n||(n=new k,this.map.set(e,n));let i=n.event(t);return{dispose:ne(()=>{i.dispose(),n?.size===0&&this.map.delete(e)})}}emit(e,t){this.listeners.get(e)?.fire(t)}};var OT=g("./vendor/acorn.js"),MT=g("crypto");var Ve=(r=hb())=>`
//# sourceURL=${r}
`,hb=()=>`eval-${(0,MT.randomBytes)(4).toString("hex")}.cdp`;function hi(r,e){return CH(""+r,e)}function CH(r,e){let t=(0,OT.parseExpressionAt)(r,0,{ecmaVersion:"latest",locations:!0});if(t.type!=="FunctionExpression")throw new Error(`Could not find function declaration for:

${r}`);let n=t.params.map(a=>{if(a.type!=="Identifier")throw new Error("Parameter must be identifier");return a.name}),{start:i,end:o}=t.body,s=(a,c,u)=>{let l=c,p=[];for(let[d,f]of a.entries())l+=`let ${n[d]}=`,p.push(new Pt(new Oe(0,l.length),new Oe(0,l.length+f.length))),l+=f,l+=";";return l+=r.slice(i+1,o-1),l+=u,l+=`
${Ve(e)}`,{out:l,argRanges:p}};return{expr:(...a)=>s(a,"(()=>{","})();").out,exprArgRanges:(...a)=>s(a,"(()=>{","})();").argRanges,decl:(...a)=>s(a,"function(...runtimeArgs){","}").out}}var zo=class extends Error{constructor(t){super(t.text);this.details=t}},Nu=class{constructor(e){this.objectId=e}};function nt(r,e){let t=""+r,n=t.lastIndexOf("}");t=t.slice(0,n)+Ve(e)+t.slice(n);let i=async({cdp:o,args:s,...a})=>{let c=await o.Runtime.callFunctionOn({functionDeclaration:t,arguments:s.map(u=>u instanceof Nu?{objectId:u.objectId}:{value:u}),...a});if(!c)throw new zo({exceptionId:0,text:"No response from CDP",lineNumber:0,columnNumber:0});if(c.exceptionDetails)throw new zo(c.exceptionDetails);return c.result};return i.source=t,i}var NT=()=>"globalThis.__jsDebugIsReady = true; "+Ve();var Lu=new Set(["page","iframe","worker","service_worker"]),Ud=new Set(["page","iframe"]),mb=new Set(["page","iframe"]),PH=mb,jd=class r{constructor(e,t,n,i,o,s,a,c,u){this._manager=e;this._targetInfo=t;this.launchConfig=s;this.sessionId=a;this.logger=c;this._attached=!1;this._onNameChangedEmitter=new k;this.onNameChanged=this._onNameChangedEmitter.event;this.entryBreakpoint=void 0;this._children=new Map;this.willWaitForDebugger=Promise.resolve();this.sourcePathResolver=this._manager._sourcePathResolver;this._cdp=n,n.pause(),this.parentTarget=i,this._waitingForDebugger=o,this._updateFromInfo(t),this._ondispose=u}get targetInfo(){return this._targetInfo}get targetId(){return this._targetInfo.targetId}get independentLifeycle(){return mb.has(this.type())}get supplementalConfig(){let e=this.type();return{__browserTargetType:e,__usePerformanceFromParent:e!=="page"}}targetOrigin(){return this._manager._targetOrigin}id(){return this.sessionId}cdp(){return this._cdp}name(){return this._computeName()}fileName(){return this._targetInfo.url}type(){return this._targetInfo.type}afterBind(){return this._cdp.resume(),Promise.resolve()}initialize(){return Promise.resolve()}async runIfWaitingForDebugger(){await Promise.all([!this._targetInfo.canAccessOpener&&this._cdp.Runtime.runIfWaitingForDebugger({}),this._cdp.Runtime.evaluate({expression:NT()})])}parent(){return this.parentTarget&&!Lu.has(this.parentTarget.type())?this.parentTarget.parentTarget:this.parentTarget}children(){let e=[];for(let t of this._children.values())Lu.has(t.type())?e.push(t):e.push(...t.children());return e}canStop(){return PH.has(this.type())}stop(){if(this._manager.targetList().includes(this))if(this.type()==="service_worker"){if(this._manager.serviceWorkerModel.stopWorker(this.id()),!this.parentTarget)return;this._manager.serviceWorkerModel.stopWorker(this.parentTarget.id())}else this._cdp.Target.closeTarget({targetId:this._targetInfo.targetId})}canRestart(){return mb.has(this.type())}restart(){this._cdp.Page.reload({})}waitingForDebugger(){return this._waitingForDebugger}canAttach(){return!this._attached}async attach(){return this._waitingForDebugger=!1,this._attached=!0,Promise.resolve(this._cdp)}canDetach(){return this._attached}async detach(){this._attached=!1,this._manager._detachedFromTarget(this.sessionId)}executionContextName(e){let t=e.auxData,n=e.name;if(!t)return n;let i=t.frameId,o=i?this._manager.frameModel.frameForId(i):void 0;return o&&t.isDefault&&!o.parentFrame()?"top":o&&t.isDefault?o.displayName():o?`${n}`:n}supportsCustomBreakpoints(){return Ud.has(this.type())}supportsXHRBreakpoints(){return Ud.has(this.type())}scriptUrlToUrl(e){return $i(this._targetInfo.url,e)||e}_updateFromInfo(e){this._targetInfo={...e,type:this._targetInfo.type},this._onNameChangedEmitter.fire()}setComputeNameFn(e){this._customNameComputeFn=e,this._onNameChangedEmitter.fire()}_computeName(){let e=this._customNameComputeFn?.(this);if(e)return e;if(this.type()==="service_worker"){let i=this._manager.serviceWorkerModel.version(this.id());if(i)return i.label()+" [Service Worker]"}let t=this._targetInfo.title;if(!(t&&this._manager.targetList().some(i=>i instanceof r&&i!==this&&i._targetInfo.title===this._targetInfo.title)))return t;try{let i=new LT.URL(this._targetInfo.url);i.protocol==="data:"?t=" <data>":i?t+=` (${this._targetInfo.url.replace(/^[a-z]+:\/\/|\/$/gi,"")})`:t+=` (${this._targetInfo.url})`}catch{t+=` (${this._targetInfo.url})`}return t}async _detached(){await this._manager.serviceWorkerModel.detached(this._cdp),this._ondispose(this)}};function Fu(r){return r instanceof Array?r:[r]}function FT(r,e,t){let n=0,i=r.length-1;for(;n<=i;){let o=(n+i)/2|0,s=t(r[o],e);if(s<0)n=o+1;else if(s>0)i=o-1;else return o}return n}function BT(r,e){let t=new Map;for(let n of r){let i=e(n),o=t.get(i);o?o.push(n):t.set(i,[n])}return t}function ga(r){return r.next().value}var qd=class{constructor(e,t){this.key=e;this.value=t}toString(){return`${this.key}: ${this.value}`}},Dn=class{constructor(e,t){this.projection=e;this.initialContents=t;let n=Array.from(t||[]).map(i=>[this.projection(i[0]),new qd(i[0],i[1])]);this.projectionToKeyAndValue=new Map(n)}clear(){this.projectionToKeyAndValue.clear()}delete(e){let t=this.projection(e);return this.projectionToKeyAndValue.delete(t)}forEach(e,t){this.projectionToKeyAndValue.forEach(n=>{e.call(t,n.value,n.key,this)},t)}get(e){let t=this.projection(e),n=this.projectionToKeyAndValue.get(t);return n?n.value:void 0}has(e){return this.projectionToKeyAndValue.has(this.projection(e))}set(e,t){return this.projectionToKeyAndValue.set(this.projection(e),new qd(e,t)),this}get size(){return this.projectionToKeyAndValue.size}*entries(){for(let e of this.projectionToKeyAndValue.values())yield[e.key,e.value]}*keys(){for(let e of this.projectionToKeyAndValue.values())yield e.key}*values(){for(let e of this.projectionToKeyAndValue.values())yield e.value}[Symbol.iterator](){return this.entries()}get[Symbol.toStringTag](){return JSON.stringify(Array.from(this.entries()))}toString(){return`MapUsingProjection<${JSON.stringify([...this.entries()])}>`}};function On(r,e){return r.length<=e?r:r.substr(0,e-1)+"\u2026"}function ya(r,e){if(r.length<=e)return r;let t=e>>1,n=e-t-1,i=r.codePointAt(r.length-n-1);i&&i>=65536&&(--n,++t);let o=r.codePointAt(t-1);return t>0&&o&&o>=65536&&--t,r.substr(0,t)+"\u2026"+r.substr(r.length-n,n)}var UT="/\\.?*()^${}|[]+",jT=r=>UT.includes(r);function Wt(r,e){let t=UT.split("").filter(i=>!e||e.indexOf(i)<0).join("").replace(/[\\\]]/g,"\\$&"),n=new RegExp(`[${t}]`,"g");return r.replace(n,"\\$&")}var Hi=class{constructor(e){this.source=e;this.lines=[];this.lines.push(0);for(let t=e.indexOf(`
`);t!==-1;t=e.indexOf(`
`,t+1))this.lines.push(t+1)}getLineOffset(e){return e>=this.lines.length?this.source.length:this.lines[e]}convert(e){let t=e.base0;if(t.lineNumber>this.lines.length)return this.source.length;let n=this.lines[t.lineNumber],i=this.lines[t.lineNumber+1]??this.source.length+1;return n+Math.min(i-n-1,t.columnNumber)}};var Vd=process.platform!=="win32";function yb(){return Vd}function $d(r){return Vd?r:r.toLowerCase()}function Hd(r,e){return Vd?r===e:r.toLowerCase()===e.toLowerCase()}function Ko(){return yb()?new Map:new Dn($d)}var qT=process.platform==="win32"?process.env.PATHEXT?.toLowerCase().split(";"):void 0,bb=r=>{let e=$d(pr.basename(r));if(qT){for(let t of qT)if(e.endsWith(t))return e.slice(0,-t.length)}return e},vb=async(r,e)=>{for(;;){let t=await e(r);if(t!==void 0)return t;let n=pr.dirname(r);if(n===r)return;r=n}},Gd=(r,e,t)=>vb(e,async n=>await r.exists(pr.join(n,t))?n:void 0),EH=new Set(["localhost","127.0.0.1","::1"]);var WT=r=>EH.has(r.toLowerCase()),RH=r=>{try{return new Mn.URL(r).hostname.replace(/^\[|\]$/g,"")}catch{return r}};var ba=Bo(async r=>{let e=RH(r);if(WT(e))return!0;try{let t=await $T.promises.lookup(e);return WT(t.address)}catch{return!1}});function $i(r,e){try{return new Mn.URL(e,r).href}catch{}}function _b(r){try{return new Mn.URL(r).pathname}catch{return}}function zd(r,e){try{return new Mn.URL(e),e}catch{}let t;try{t=new Mn.URL(r||"")}catch{return e}let n=t.protocol+"//";return t.username&&(n+=t.username+":"+t.password+"@"),n+=t.host,n+=pr.dirname(t.pathname),n[n.length-1]!=="/"&&(n+="/"),n+=e,n}function Kd(r){try{return new Mn.URL(r),!0}catch{return!1}}function HT(r){return r.replace(/\/$/,"").replace(/\\$/,"")}var AH=/^https:\/\/([a-z0-9\-]+)\+\.vscode-resource\.vscode-(?:webview|cdn)\.net\/(.+)/i,VT="vscode-file://vscode-app/";function $e(r){let e=AH.exec(r);if(e)r=`${e[1]}:///${e[2]}`;else if(r.startsWith("vscode-webview-resource://"))r=new Mn.URL(r).pathname.replace(/%2F/gi,"/").replace(/^\/([a-z0-9\-]+)(\/{1,2})/i,(n,i,o)=>o.length===1?`${i}:///`:`${i}://`);else if(r.startsWith(VT))r=r.slice(VT.length);else if(!Rr(r))return;return r=r.replace("file:///",""),r=decodeURIComponent(r),r.startsWith("/")&&process.platform==="win32"&&r[1]!=="/"&&(r="/"+r),r[0]!=="/"&&!r.match(/^[A-Za-z]:/)&&(r="/"+r),We(r)}function GT(r){return Rr(r)&&(r=r.replace("file:///","\\\\"),r=r.replace(/\//g,"\\"),r=decodeURIComponent(r)),r}function ge(r){return wb==="win32"?"file:///"+Gi(r):"file://"+Gi(r)}function va(r){return r.startsWith("/")?"file://"+Gi(r):"file:///"+Gi(r)}function kt(r){return pr.posix.isAbsolute(r)||pr.win32.isAbsolute(r)}function xt(r){return!!r&&r.startsWith("data:")}var gb=(r,e,t)=>{if(!t||r===":"){e.add(r);return}if(r==="/"){e.add(`\\${r}`);return}jT(r)?e.add(`\\${r}`):e.add(r);let n=encodeURIComponent(r);r!=="\\"&&n!==r&&e.add(n)},kH=r=>{switch(r.size){case 0:return"";case 1:return ga(r.values());default:let e=[...r];return e.some(t=>t.length>1)?`(?:${e.join("|")})`:`[${e.join("")}]`}},Bu=new Set;function Uu(r,e,t,n,i=Vd){let o="";for(let s of r.slice(e,t))i?gb(s,Bu,n):(gb(s.toLowerCase(),Bu,n),gb(s.toUpperCase(),Bu,n)),o+=kH(Bu),Bu.clear();return o}function Er(r,[e,t]=[0,r.length]){if(t<=e)return r;let n=[],i=Uu(r,0,e,!1),o=Uu(r,t,r.length,!1),s=r.slice(e,t);for(let a of[decodeURIComponent(s),$e(s)]){if(!a)continue;let c=Uu(a,0,a.length,!0);n.push(DH(`${i}${c}${o}`).concat("($|\\?)"))}return n.join("|")}var DH=r=>r.replace(/^(file:\\\/\\\/\\\/)?([a-z]):/i,(e,t="",n)=>`${t}[${n.toUpperCase()}${n.toLowerCase()}]:`);function Rr(r){return r.startsWith("file:///")}var wb=process.platform;function Gi(r){return r=mi(r),wb==="win32"?($y(r)&&(r=r.slice(1)),r.split(/[\\//]/g).map((e,t)=>t>0?encodeURIComponent(e):e).join("/")):r.split("/").map(encodeURIComponent).join("/")}function mi(r){return r&&wb==="win32"&&r[1]===":"?r[0].toUpperCase()+r.substring(1):r}var zi=(r,e=[])=>{let t=r.urlFilter||"file"in r&&r.file||r.url,n=t?MH(t,...e):void 0;return i=>!i.url.startsWith("devtools://")&&n?.(i.url)!==!1},_a=r=>e=>e.type==="page"&&!e.url.startsWith("edge://force-signin")&&r(e);function OH(r){return!!r&&!pr.isAbsolute(r)&&!!(0,Mn.parse)(r).protocol}var MH=(...r)=>{let e=i=>{i=i.toLowerCase();let o=$e(i);o?i=o:OH(i)&&i.includes("://")&&(i=i.substr(i.indexOf("://")+3)),i.endsWith("/")&&(i=i.substr(0,i.length-1));let s=i.indexOf("#");return s!==-1&&(i=i.slice(0,i[s-1]==="/"?s-1:s)),i},t=r.map(i=>Wt(e(i),"/*").replace(/(\/\*$)|\*/g,".*")),n=new RegExp("^("+t.join("|")+")$","g");return i=>(n.lastIndex=0,n.test(e(i)))};var wa=class r{constructor(e,t,n,i,o){this.original=e;this.metadata=t;this.actualRoot=n;this.actualSources=i;this.hasNames=o;this.sourceActualToOriginal=new Map;this.sourceOriginalToActual=new Map;this.id=r.idCounter++;if(i.length!==e.sources.length)throw new Error("Expected actualSources.length === original.source.length");for(let s=0;s<i.length;s++){let a=i[s],c=e.sources[s];a!==null&&c!==null&&(this.sourceActualToOriginal.set(a,c),this.sourceOriginalToActual.set(c,a))}}static{this.idCounter=0}get sources(){return this.actualSources.slice()}get sourceRoot(){return this.actualRoot}computedSourceUrl(e){return We(zd(xt(this.metadata.sourceMapUrl)?this.metadata.compiledPath:this.metadata.sourceMapUrl,this.sourceRoot+e))}originalPositionFor(e){let t=nb(this.original,e);return t.source&&(t.source=this.sourceOriginalToActual.get(t.source)??t.source),t}generatedPositionFor(e){let t=this.sourceActualToOriginal.get(e.source)??e.source;if(!isFinite(e.line)){let n=e.bias||An;return this.getBestGeneratedForOriginal(t,(i,o)=>NH(i,o)*n)}return ib(this.original,{...e,source:t})}allGeneratedPositionsFor(e){return ob(this.original,{...e,source:this.sourceActualToOriginal.get(e.source)??e.source})}sourceContentFor(e){e=this.sourceActualToOriginal.get(e)??e;let t=this.original.sources.indexOf(e);return t===-1?null:this.original.sourcesContent?.[t]??null}eachMapping(e){sb(this.original,e)}decodedMappings(){return en(this.original)}names(){return this.original.names}getBestGeneratedForOriginal(e,t){let n;return this.eachMapping(i=>{i.source===e&&(!n||t(i,n)>0)&&(n=i)}),n?{column:n.generatedColumn,line:n.generatedLine}:{column:null,line:null}}},NH=({originalLine:r,originalColumn:e},{originalLine:t,originalColumn:n})=>(r||0)-(t||0)||(e||0)-(n||0);async function KT(r,e,t,n){let i=Jd.Parser.parse(e,{locations:!0,ecmaVersion:"latest"}),o=new Du({file:r}),s=fi(i,{sourceMap:{addMapping:a=>ab(o,a.original.line-1,a.original.column,r,a.generated.line-1,a.generated.column)}});return cb(o,r,s),new wa(new Ad(kd(o)),{sourceMapUrl:n,compiledPath:t},"",[r],!1)}function JT(r){let e;try{e=kn(r)}catch{return}let t=(c,u)=>({type:"ExpressionStatement",expression:{type:"AssignmentExpression",operator:"=",left:c,right:u}}),n=!1,i=!1,o=Fd(e,{enter(c,u){switch(c.type){case"ClassDeclaration":return{replace:t(c.id||{type:"Identifier",name:"_default"},{...c,type:"ClassExpression"})};case"FunctionDeclaration":return{replace:t(c.id||{type:"Identifier",name:"_default"},{...c,type:"FunctionExpression"})};case"FunctionExpression":case"ArrowFunctionExpression":case"MethodDefinition":return 1;case"AwaitExpression":n=!0;return;case"ForOfStatement":c.await&&(n=!0);return;case"ReturnStatement":i=!0;return;case"VariableDeclaration":if(!u||!("body"in u)||!(u.body instanceof Array))return;let l=u.body,p=c.declarations.map(d=>({type:"ExpressionStatement",expression:{type:"UnaryExpression",operator:"void",prefix:!0,argument:{type:"AssignmentExpression",operator:"=",left:d.id,right:d.init||{type:"Identifier",name:"undefined"}}}}));l.splice(l.indexOf(c),1,...p)}}});if(!n||i)return;let s=e.body[e.body.length-1];s.type==="ExpressionStatement"&&(e.body[e.body.length-1]={type:"ReturnStatement",argument:s.expression});let a={type:"ExpressionStatement",expression:{type:"CallExpression",callee:{type:"ArrowFunctionExpression",params:[],generator:!1,expression:!1,async:!0,body:{type:"BlockStatement",body:o.body}},arguments:[],optional:!1}};return fi(a)}function ju(r){try{let e=(0,Jd.parseExpressionAt)(r,0,db);return e.end<r.length||e.type!=="ObjectExpression"?r:`(${r})`}catch{return r}}function Sa(r){if(!r)return;let e="sourceMappingURL",t=r.length,n=e.length,i=t,o=0;for(;;){if(i=r.lastIndexOf(e,i),i===-1||i<4)return;if(i-=4,r[i]==="/"&&r[i+1]==="/"&&!(r[i+2]!=="#"&&r[i+2]!=="@")&&!(r[i+3]!==" "&&r[i+3]!=="	")&&(o=i+4+n,!(o<t&&r[o]!=="=")))break}let s=r.substring(o+1),a=s.indexOf(`
`);return a!==-1&&(s=s.substring(0,a)),s.trim()}function Yd(r,e,t){let n=t.generatedPositionFor({source:r,line:e.lineNumber,column:e.columnNumber-1,bias:An}),i=a=>{if(a.line===null||a.column===null)return 1e11;let c=t.originalPositionFor(a);return c.line!==null?Math.abs(e.lineNumber-c.line):1e11},o=i(n),s=t.allGeneratedPositionsFor({source:r,line:e.lineNumber,column:e.columnNumber-1}).filter(a=>a.line!==null&&a.column!==null).sort((a,c)=>a.line!==c.line?a.line-c.line:a.column-c.column).map(a=>[a,i(a)]);return s.push([n,o]),s.sort(([a,c],[u,l])=>c-l||a.line-u.line||a.column-u.column),s[0][0]}var Sb=(r,e)=>!!e&&((e.type==="FunctionExpression"||e.type==="FunctionDeclaration"||e.type==="ArrowFunctionExpression")&&e.params.includes(r)||(e.type==="ForInStatement"||e.type==="ForOfStatement")&&e.left===r||e.type==="VariableDeclarator"&&e.id===r||e.type==="AssignmentPattern"&&e.left===r||e.type==="CatchClause"&&e.param===r||"kind"in e&&e.kind==="init"&&e.value===r||e.type==="RestElement"&&e.argument===r||e.type==="AssignmentPattern"&&e.left===r);function Ki(r){try{new Function(r)}catch(e){return e}}function FH(r,e){let t=kn(r),n,i;return Vi(t,{enter:o=>{let s=o;e>=s.start&&e<s.end&&(o.type==="CallExpression"||o.type==="NewExpression"?i=o:n=o)}}),i||n}var zT=/^[^()]+/g;function YT(r,e){try{let n=FH(r,e);if(n&&"callee"in n){let i=n.callee;return{text:`${r.slice(i.start,i.end)}(...)`,start:i.start,end:i.end}}else{let i=n;return{text:r.slice(i.start,i.end),start:i.start,end:i.end}}}catch{}zT.lastIndex=e-1;let t=zT.exec(r);if(t)return{text:t[0],start:e,end:e+t[0].length}}var Jo=class{constructor(e,t,n,i,o,s,a,c){this.url=t;this.inlineScriptOffset=s;this.runtimeScriptOffset=a;this.contentHash=c;this._scripts=[];this.hasBeenAnnounced=!1;this.sourceReference=e.getSourceReference(t),this._contentGetter=ne(i),this._container=e,this.absolutePath=n||"",this._fqname=this._fullyQualifiedName(),this._name=this._humanName(),this.setSourceMapUrl(o),this._existingAbsolutePath=this.checkContentHash(c)}get sendLazy(){return!this.url}checkContentHash(e){return UP(this.absolutePath,this.inlineScriptOffset||this.runtimeScriptOffset?void 0:e,this._container._fileContentOverridesForTest.get(this.absolutePath))}offsetScriptToSource(e){return this.runtimeScriptOffset?{...e,lineNumber:Math.max(1,e.lineNumber-this.runtimeScriptOffset.lineOffset),columnNumber:e.columnNumber-this.runtimeScriptOffset.columnOffset}:e}offsetSourceToScript(e){return this.runtimeScriptOffset?{...e,lineNumber:e.lineNumber+this.runtimeScriptOffset.lineOffset,columnNumber:e.columnNumber+this.runtimeScriptOffset.columnOffset}:e}async equalsDap(e){let t=await this._existingAbsolutePath;return t?!e.sourceReference&&t===e.path:e.sourceReference===this.sourceReference}setSourceMapUrl(e){if(!e){this.sourceMap=void 0;return}this.sourceMap={type:0,sourceByUrl:new Map,value:be(),metadata:e}}addScript(e){this._scripts.push(e)}filterScripts(e){this._scripts=this._scripts.filter(e)}get scripts(){return this._scripts}get getSuggestedMimeType(){if(this.url.endsWith(".wat"))return"text/wat";if(!/\.[^/]+$/.test(this.url)||this.url.includes("?"))return"text/javascript"}async content(){let e=await this._contentGetter();return this.inlineScriptOffset?.lineOffset&&(e=`
`.repeat(this.inlineScriptOffset.lineOffset)+e),e}async prettyPrint(){if(!this._container)return;if(Yo(this)&&this.sourceMap.metadata.sourceMapUrl.endsWith("-pretty.map")){let c=this.sourceMap.value.settledValue;return c&&{map:c,source:[...this.sourceMap.sourceByUrl.values()][0]}}let e=await this.content();if(!e)return;let t=this.url||`eval://${this.sourceReference}.js`,n=t+"-pretty.map",o=t.split(/[\/\\]/).pop()+"-pretty.js",s=await KT(o,e,t,n);if(!s)return;this.setSourceMapUrl({compiledPath:this.absolutePath,sourceMapUrl:""}),this.sourceMap.value.resolve(s);let a=this;return await this._container._addSourceMapSources(a,s),{map:s,source:[...a.sourceMap.sourceByUrl.values()][0]}}async toDap(){let e=await this._existingAbsolutePath,t={name:this._name,path:this._fqname,sourceReference:this.sourceReference,presentationHint:this.blackboxed()?"deemphasize":void 0,origin:this.blackboxed()?XT.t("Skipped by skipFiles"):void 0};return e&&(t.sourceReference=0,t.path=e),this.hasBeenAnnounced||(this.hasBeenAnnounced=!0,this._container.emitLoadedSource(this)),t}existingAbsolutePath(){return this._existingAbsolutePath}async prettyName(){let e=await this._existingAbsolutePath;return e||this._fqname}_humanName(){if(kt(this._fqname)){for(let e of this._container.rootPaths)if(wP(e,this._fqname))return Be((0,QT.relative)(e,this._fqname))}return this._fqname}_fullyQualifiedName(){if(!this.url)return"<eval>/VM"+this.sourceReference;if(this.url.endsWith(".repl"))return"repl";if(this.url.startsWith(Zr))return di+"/"+this.url.slice(Zr.length);if(this.absolutePath.startsWith(di))return this.absolutePath;if(kt(this.url))return this.url;let e=$e(this.url);if(e)return e;let t=this.url;try{let n=[],i=new ZT.URL(this.url);if(i.protocol==="data:")return"<eval>/VM"+this.sourceReference;i.hostname&&n.push(i.hostname),i.port&&n.push("\uA789"+i.port),i.pathname&&n.push(/^\/[a-z]:/.test(i.pathname)?i.pathname.slice(1):i.pathname);let o=i.searchParams?.toString();o&&n.push("?"+o),t=n.join("")}catch{}return t.endsWith("/")&&(t+="(index)"),this.inlineScriptOffset&&(t+=`\uA789${this.inlineScriptOffset.lineOffset+1}:${this.inlineScriptOffset.columnOffset+1}`),t}blackboxed(){return this._container.isSourceSkipped(this.url)}};var qu;(n=>{async function r(i){return i.value.promise}n.waitForValue=r;function e(i,o){return i.type===0&&i.value.settledValue?Promise.resolve(i.value.settledValue):Promise.race([r(i),ue(o)])}n.waitForValueWithTimeout=e;async function t(i){return await r(i),i.sourceByUrl}n.waitForSources=t})(qu||={});var Xe=class extends Jo{constructor(){super(...arguments);this.compiledToSourceUrl=new Map}},Qd=class extends Jo{constructor(t,n,i){super(t,n.url,i,()=>Promise.resolve("Binary content not shown, see the decompiled WAT file"),void 0,void 0,void 0,void 0);this.event=n;this.sourceMap={type:1,value:be(),sourceByUrl:new Map}}checkContentHash(){return Promise.resolve(void 0)}offsetScriptToSource(t){return t}offsetSourceToScript(t){return t}},Vt=r=>!!r&&r instanceof Jo&&!!r.sourceMap,Yo=r=>Vt(r)&&r.sourceMap.type===0,Xo=r=>Vt(r)&&r.sourceMap.type===1,xb=r=>!!r&&typeof r.getDisassembly=="function";function e0(r,e){if(!e)return r;let{lineNumber:t,columnNumber:n}=r;return e&&(t+=e.lineOffset,t<=1&&(n+=e.columnOffset)),{...r,lineNumber:t,columnNumber:n}}function t0(r,e){if(!e)return r;let{lineNumber:t,columnNumber:n}=r;return e&&(t=Math.max(1,t-e.lineOffset),t<=1&&(n=Math.max(1,n-e.columnOffset))),{...r,lineNumber:t,columnNumber:n}}var r0=r=>({lineNumber:r.lineNumber+1,columnNumber:r.columnNumber+1}),gi=r=>({lineNumber:r.lineNumber-1,columnNumber:r.columnNumber-1});var n0=g("os");var BH={"pwa-extensionHost":null,"node-terminal":null,"pwa-node":null,"pwa-chrome":null,"pwa-msedge":null},UH={"extension.js-debug.addCustomBreakpoints":null,"extension.js-debug.addXHRBreakpoints":null,"extension.js-debug.editXHRBreakpoints":null,"extension.pwa-node-debug.attachNodeProcess":null,"extension.js-debug.clearAutoAttachVariables":null,"extension.js-debug.setAutoAttachVariables":null,"extension.js-debug.autoAttachToProcess":null,"extension.js-debug.createDebuggerTerminal":null,"extension.js-debug.createDiagnostics":null,"extension.js-debug.getDiagnosticLogs":null,"extension.js-debug.debugLink":null,"extension.js-debug.npmScript":null,"extension.js-debug.pickNodeProcess":null,"extension.js-debug.prettyPrint":null,"extension.js-debug.removeXHRBreakpoint":null,"extension.js-debug.removeAllCustomBreakpoints":null,"extension.js-debug.revealPage":null,"extension.js-debug.startProfile":null,"extension.js-debug.stopProfile":null,"extension.js-debug.toggleSkippingFile":null,"extension.node-debug.startWithStopOnEntry":null,"extension.js-debug.requestCDPProxy":null,"extension.js-debug.openEdgeDevTools":null,"extension.js-debug.callers.add":null,"extension.js-debug.callers.goToCaller":null,"extension.js-debug.callers.gotToTarget":null,"extension.js-debug.callers.remove":null,"extension.js-debug.callers.removeAll":null,"extension.js-debug.enableSourceMapStepping":null,"extension.js-debug.disableSourceMapStepping":null,"extension.js-debug.network.viewRequest":null,"extension.js-debug.network.copyUri":null,"extension.js-debug.network.openBody":null,"extension.js-debug.network.openBodyInHex":null,"extension.js-debug.network.replayXHR":null,"extension.js-debug.network.clear":null,"extension.js-debug.completion.nodeTool":null},XQ=new Set(Object.keys(UH)),QQ=new Set(Object.keys(BH));var le=Symbol("AnyLaunchConfiguration"),i0={type:"",name:"",request:"",trace:!1,outputCapture:"console",timeout:1e4,timeouts:{},showAsyncStacks:!0,skipFiles:[],smartStep:!0,sourceMaps:!0,sourceMapRenames:!0,pauseForSourceMap:!0,resolveSourceMapLocations:null,rootPath:"${workspaceFolder}",outFiles:["${workspaceFolder}/**/*.(m|c|)js","!**/node_modules/**"],sourceMapPathOverrides:Cb("${workspaceFolder}"),enableContentValidation:!0,cascadeTerminateToConfigurations:[],enableDWARF:!0,__workspaceFolder:"",__remoteFilePrefix:void 0,__breakOnConditionalError:!1,customDescriptionGenerator:void 0,customPropertiesGenerator:void 0},Vu={...i0,cwd:"${workspaceFolder}",env:{},envFile:null,pauseForSourceMap:!1,sourceMaps:!0,localRoot:null,remoteRoot:null,resolveSourceMapLocations:["**","!**/node_modules/**"],autoAttachChildProcesses:!0,runtimeSourcemapPausePatterns:[],skipFiles:[`${di}/**`]},o0={...Vu,showAsyncStacks:{onceBreakpointResolved:16},type:"node-terminal",request:"launch",name:"JavaScript Debug Terminal"},jH={...Vu,type:"node-terminal",request:"attach",name:o0.name,showAsyncStacks:{onceBreakpointResolved:16},delegateId:-1},qH={...Vu,type:"pwa-extensionHost",name:"Debug Extension",request:"launch",args:["--extensionDevelopmentPath=${workspaceFolder}"],outFiles:["${workspaceFolder}/out/**/*.js"],resolveSourceMapLocations:["${workspaceFolder}/**","!**/node_modules/**"],rendererDebugOptions:{},runtimeExecutable:"${execPath}",autoAttachChildProcesses:!1,debugWebviews:!1,debugWebWorkerHost:!1,__sessionId:""},WH={...Vu,type:"pwa-node",request:"launch",program:"",cwd:"${workspaceFolder}",stopOnEntry:!1,console:"internalConsole",restart:!1,args:[],runtimeExecutable:"node",runtimeVersion:"default",runtimeArgs:[],profileStartup:!1,attachSimplePort:null,experimentalNetworking:"auto",killBehavior:"forceful"},Ib={...i0,type:"pwa-chrome",request:"attach",address:"localhost",port:0,disableNetworkCache:!0,pathMapping:{},url:null,restart:!1,urlFilter:"",sourceMapPathOverrides:Cb("${webRoot}"),webRoot:"${workspaceFolder}",server:null,browserAttachLocation:"workspace",targetSelection:"automatic",vueComponentPaths:["${workspaceFolder}/**/*.vue","!**/node_modules/**"],perScriptSourcemaps:"auto"},VH={...Ib,type:"pwa-msedge",useWebView:!1},s0={...Ib,type:"pwa-chrome",request:"launch",cwd:null,file:null,env:{},urlFilter:"*",includeDefaultArgs:!0,includeLaunchArgs:!0,runtimeArgs:null,runtimeExecutable:"*",userDataDir:!0,browserLaunchLocation:"workspace",profileStartup:!1,cleanUp:"wholeBrowser",killBehavior:"forceful"},$H={...s0,type:"pwa-msedge",useWebView:!1},HH={...Vu,type:"pwa-node",attachExistingChildren:!0,address:"localhost",port:9229,restart:!1,request:"attach",continueOnAttach:!1};function Cb(r){return{"webpack:///./~/*":`${r}/node_modules/*`,"webpack:////*":"/*","webpack://@?:*/?:*/*":`${r}/*`,"webpack://?:*/*":`${r}/*`,"webpack:///([a-z]):/(.+)":"$1:/$2","meteor://\u{1F4BB}app/*":`${r}/*`,"turbopack://[project]/*":"${workspaceFolder}/*","turbopack:///[project]/*":"${workspaceFolder}/*"}}var a0=r=>{!r.sourceMapPathOverrides&&r.cwd&&(r.sourceMapPathOverrides=Cb(r.cwd)),r.resolveSourceMapLocations===void 0&&(r.resolveSourceMapLocations=r.outFiles)};function GH({...r}){return a0(r),r.request==="attach"?{...HH,...r}:{...WH,...r}}function zH(r,e){return r.request==="attach"?{...Ib,browserAttachLocation:e,...r}:{...s0,browserLaunchLocation:e,...r}}function KH(r,e){return r.request==="attach"?{...VH,browserAttachLocation:e,...r}:{...$H,browserLaunchLocation:e,...r}}function JH(r){let e={...qH,...r};return e.skipFiles=[...e.skipFiles,"**/node_modules.asar/**","**/bootstrap-fork.js"],e}function YH(r){return a0(r),r.request==="launch"?{...o0,...r}:{...jH,...r}}function xa(r,e){let t,n=e==="remote"?"ui":"workspace";switch(r.type){case"pwa-node":t=GH(r);break;case"pwa-msedge":t=KH(r,n);break;case"pwa-chrome":t=zH(r,n);break;case"pwa-extensionHost":t=JH(r);break;case"node-terminal":t=YH(r);break;default:throw bp(r,"Unknown config: {value}")}return QH(t)}function XH(r){let e="${workspaceFolder}",t={...r,rootPath:void 0,outFiles:r.outFiles.filter(n=>!n.includes(e)),sourceMapPathOverrides:vp(r.sourceMapPathOverrides,n=>!n.includes("${workspaceFolder}"))};return"vueComponentPaths"in t&&(t.vueComponentPaths=t.vueComponentPaths.filter(n=>!n.includes(e))),"resolveSourceMapLocations"in t&&(t.resolveSourceMapLocations=t.resolveSourceMapLocations?.filter(n=>!n.includes(e))??null),"cwd"in t&&t.cwd?.includes(e)&&(t.cwd=t.request==="launch"&&t.type==="pwa-node"?(0,n0.homedir)():void 0),"webRoot"in t&&t.webRoot?.includes(e)&&(t.webRoot="/"),t}function QH(r){return r.__workspaceFolder||(r=XH(r)),r=Wu(r,"workspaceFolder",r.__workspaceFolder),r=Wu(r,"webRoot","webRoot"in r?r.webRoot:r.__workspaceFolder),r}function Wu(r,e,t){let n;if(typeof r=="string")n=r.replace(new RegExp(`\\$\\{${e}\\}`,"g"),()=>{if(!t)throw new Error(`Unable to resolve \${${e}} in configuration (${JSON.stringify(e)})`);return t});else if(r instanceof Array)n=r.map(i=>Wu(i,e,t));else if(typeof r=="object"&&r){let i={};for(let[o,s]of Object.entries(r))i[Wu(o,e,t)]=Wu(s,e,t);n=i}else n=r;return n}var Zd="js-debug",$u="1.104.0",ZH="ms-vscode",c0=Zd.includes("nightly"),nZ=`${ZH}.${Zd}`;var u0=g("worker_threads");var Ia=g("worker_threads");function Pb(r){let e=kn(r),t=[],n=(s,{loc:a}=s,{loc:c}=s)=>{if(!a||!c)throw new Error("should include locations");t.push({start:a.start,end:c.end,depth:o.length}),o.push(s)},i=new Set,o=[];return Vi(e,{enter:s=>{switch(s.type){case"FunctionDeclaration":case"ArrowFunctionExpression":n(s,s.params[0]||s.body,s.body),i.add(s.body);break;case"Program":n(s);break;case"ForStatement":case"ForOfStatement":case"ForInStatement":n(s),i.add(s.body);break;case"BlockStatement":i.has(s)||n(s);break}},leave:s=>{s===o[o.length-1]&&o.pop()}}),t}Ia.isMainThread||Ia.parentPort?.postMessage(Pb(Ia.workerData));var Ca=class r{constructor(e){this.range=e}static hydrate(e,t){let n=new r(new Pt(new Jt(e[0].start.line,e[0].start.column),new Jt(e[0].end.line,e[0].end.column))),i=[n],o=1;for(let s=1;s<e.length;s++){let a=e[s];for(;a.depth<o;)o--,i[o].data=t(i[o]);let c=new r(new Pt(new Jt(a.start.line,a.start.column),new Jt(a.end.line,a.end.column))),u=i[o-1];u.children??=[],u.children.push(c),i[o++]=c}for(let s=o-1;s>=0;s--)i[s].data=t(i[s]);return n}search(e){if(this.range.contains(e)){if(!this.children)return this;for(let t of this.children){let n=t.search(e);if(n)return n}return this}}findDeepest(e,t){if(this.range.contains(e)){if(this.children)for(let n of this.children){let i=n.findDeepest(e,t);if(i!==void 0)return i}return t(this)}}filterHoist(e){if(this.children)for(let t=0;t<this.children.length;t++){let n=this.children[t];if(n.filterHoist(e),!e(n)){let i=n.children||[];this.children.splice(t,1,...i),t--}}}forEach(e){e(this),this.children?.forEach(t=>t.forEach(e))}forEachDepthFirst(e){this.children?.forEach(t=>t.forEach(e)),e(this)}toJSON(){return{range:this.range,children:this.children}}},e5=1024*512;function l0(r,e){return r.length<e5?Ca.hydrate(Pb(r),e):new Promise((t,n)=>{let i=new u0.Worker(`${__dirname}/renameWorker.js`,{workerData:r});i.on("message",o=>t(Ca.hydrate(o,e))),i.on("error",n),i.on("exit",()=>n("rename worker exited"))})}var p0=/[$a-z_][$0-9A-Z_$]*/iy,d0=async(r,e)=>{let t=new Hi(r),n=new Set,i=e.decodedMappings(),o=e.names(),s=(u,l,p)=>{let d=u*2147483647+l;if(n.has(d))return;n.add(d);let f=new Oe(u,l),h=t.convert(f);p0.lastIndex=h;let m=p0.exec(r);if(!m)return;let b=m[0];if(b!==p)return b},c=await l0(r,u=>{let l=u.range.begin.base0,p=u.range.end.base0,d;for(let f=l.lineNumber;f<=p.lineNumber;f++){let h=i[f];if(h)for(let m=0;m<h.length;m++){let b=h[m];if(b.length<=4)continue;let I=f,D=b[0];if(I===l.lineNumber&&l.columnNumber>D||I===p.lineNumber&&p.columnNumber<D)continue;let B=o[b[4]],Z=s(I,D,B);Z&&(d??=[],d.some(F=>F.compiled==Z)||d.push({compiled:Z,original:B}))}}return d});return c.filterHoist(u=>!!u.data),c};var Nn=S(G());var ef=class extends Error{constructor(t,n,i){super(`Unexpected ${t} response from ${n}: ${i??"<empty body>"}`);this.statusCode=t;this.url=n;this.body=i}},Qo=Symbol("IResourceProvider");var xe=S(He());var O=class extends Error{get cause(){return this._cause}constructor(e){super("__errorMarker"in e?e.error.format:e.format),this._cause="__errorMarker"in e?e.error:e}};function f0(r,e){r.output({category:"console",output:e+`
`})}function ve(r,e=9222){return{__errorMarker:!0,error:{id:e,format:r,showUser:!1}}}function _e(r,e=9223){return{__errorMarker:!0,error:{id:e,format:r,showUser:!0}}}var Tb=()=>_e(xe.t("Attribute 'runtimeVersion' requires Node.js version manager 'nvs', 'nvm' or 'fnm' to be installed."),9224),h0=()=>_e(xe.t("Attribute 'runtimeVersion' with a flavor/architecture requires 'nvs' to be installed."),9225),m0=()=>_e(xe.t("Attribute 'runtimeVersion' requires Node.js version manager 'nvm-windows' or 'nvs'."),9226),Eb=(r,e)=>_e(xe.t("Node.js version '{0}' not installed using version manager {1}.",r,e),9226),g0=r=>_e(xe.t("Cannot launch debug target in terminal ({0}).",r),9227),y0=r=>_e(xe.t("Can't load environment variables from file ({0}).",r),9228),b0=r=>_e(xe.t("The configured `cwd` {0} does not exist.",r),9245),Rb=(r,e)=>_e(xe.t(`Can't find Node.js binary "{0}": {1}. Make sure Node.js is installed and in your PATH, or set the "runtimeExecutable" in your launch.json`,r,e),9229),v0=(r,e)=>_e(xe.t('The Node version in "{0}" is outdated (version {1}), we require at least Node 8.x.',e,r),9230),Ab=r=>_e(xe.t('Invalid hit condition "{0}". Expected an expression like "> 42" or "== 2".',r),9231),Pa=()=>_e(xe.t("An error occurred taking a profile from the target."),9235),_0=()=>_e(xe.t("Please stop the running profile before starting a new one."),9236),w0=r=>ve(r,9238),tf=(r,e,t)=>_e(e==="*"&&!t.length?xe.t('Unable to find an installation of the browser on your system. Try installing it, or providing an absolute path to the browser in the "runtimeExecutable" in your launch.json.'):xe.t('Unable to find {0} version {1}. Available auto-discovered versions are: {2}. You can set the "runtimeExecutable" in your launch.json to one of these, or provide an absolute path to the browser executable.',r,e,JSON.stringify([...new Set(t)])),9233),kb=r=>_e(xe.t('Unable to launch browser: "{0}"',r.message),9240),Hu=r=>_e(r??xe.t("Unable to attach to browser"),9242),rf=()=>_e(xe.t('Target page not found. You may need to update your "urlFilter" to match the page you want to debug.'),9241);var S0=()=>ve(xe.t("Variables not available in async stacks"),9234),Ji=(r,e)=>_e(xe.t("Syntax error setting breakpoint with condition {0} on line {1}: {2}",JSON.stringify(r.condition),r.line,e),9237),Db=()=>ve(xe.t("Thread not found"),9244),nf=(r,e)=>_e(xe.t("Could not read source map for {0}: {1}",r,e)),x0=()=>_e(xe.t("UWP webview debugging is not available on your platform.")),I0=()=>_e(xe.t("Networking not available.")),C0=()=>_e(xe.t("Could not connect to any UWP Webview pipe. Make sure your webview is hosted in debug mode, and that the `pipeName` in your `launch.json` is correct.")),Gu=()=>_e(xe.t("Could not find a location for the variable")),P0=()=>ve(xe.t('Missing source information. Did you set "originalUrl" or "source"?')),T0=r=>typeof r=="object"&&!!r&&"__errorMarker"in r,E0=(r,e)=>r instanceof O&&r.cause.id===e,R0=r=>_e(xe.t("The browser process exited with code {0} before connecting to the debug server. Make sure the `runtimeExecutable` is configured correctly and that it can run without errors.",r));var A0=new WeakSet;var t5="Request",r5=r=>r.endsWith("Request"),er=Symbol("IDapApi"),Ta=Symbol("IRootDapApi"),zu=class{constructor(e,t){this.transport=e;this.logger=t;this._pendingRequests=new Map;this._requestHandlers=new Map;this._eventListeners=new Map;this.disposables=[];this._initialized=be();this.closed=!1;this._sequence=1,this.disposables.push(this.transport.messageReceived(n=>this._onMessage(n.message,n.receivedTime))),this._dap=this._createApi()}get initializedBlocker(){return this._initialized.promise}attachTelemetry(e){this.telemetryReporter=e,e.attachDap(this._dap)}dap(){return this._dap}_createApi(){return new Proxy({},{get:(e,t)=>{if(t!=="then")return t==="on"?(n,i)=>(this._requestHandlers.set(n,i),()=>this._requestHandlers.delete(n)):t==="off"?n=>this._requestHandlers.delete(n):n=>{if(r5(t))return this.enqueueRequest(t.slice(0,-t5.length),n);this._send({seq:0,type:"event",event:t,body:n})}}})}createTestApi(){let e=(i,o)=>{let s=this._eventListeners.get(i);s||(s=new Set,this._eventListeners.set(i,s)),s.add(o)},t=(i,o)=>{let s=this._eventListeners.get(i);s&&s.delete(o)},n=(i,o)=>new Promise(s=>{let a=c=>{o&&!o(c)||(t(i,a),s(c))};e(i,a)});return new Proxy({},{get:(i,o)=>o==="on"?e:o==="off"?t:o==="once"?n:s=>this.enqueueRequest(o,s)})}enqueueRequest(e,t){return new Promise(n=>{let i={seq:0,type:"request",command:e,arguments:t||{}};this._send(i),this._pendingRequests.set(i.seq,n)})}stop(){this.closed=!0,this.transport.close()}_send(e,t){if(this.closed)this.logger.warn("dap.send","Not sending message because the connection has ended",e),t?.();else{e.seq=this._sequence++;let n=e.type!=="event"||!A0.has(e.body);this.transport.send(e,n,t)}}async _onMessage(e,t){if(e.type==="request"){let n={seq:0,type:"response",request_seq:e.seq,command:e.command,success:!0};try{let i=this._requestHandlers.get(e.command);if(!i)console.error(`Unknown request: ${e.command}`);else{let o=await i(e.arguments);if(T0(o))this._send({...n,success:!1,message:o.error.format,body:{error:o.error}});else{let s={...n,body:o};n.command==="initialize"?(this._send(s),this._initialized.resolve(this)):n.command==="disconnect"?this._send({...n,body:o},()=>{this.stop()}):this._send(s)}}this.telemetryReporter?.reportOperation("dapOperation",e.command,t.elapsed().ms)}catch(i){i instanceof O?this._send({...n,success:!1,body:{error:i.cause}}):(console.error(i),this._send({...n,success:!1,body:{error:{id:9221,format:`Error processing ${e.command}: ${i.stack||i.message}`,showUser:!1,sendTelemetry:!1}}})),this.telemetryReporter?.reportOperation("dapOperation",e.command,t.elapsed().ms,i)}}if(e.type==="event"){let n=this._eventListeners.get(e.event)||new Set;for(let i of n)i(e.body)}if(e.type==="response"){let n=this._pendingRequests.get(e.request_seq);if(!this.logger.assert(n,`Expected callback for request sequence ID ${e.request_seq}`))return;if(this._pendingRequests.delete(e.request_seq),e.success)n(e.body);else{let i=e.body?.error?.format;n(i||e.message||"Unknown error")}}}};var Ce=Symbol("ISourcePathResolver");var Ln=Symbol("ISourceMapFactory"),Ob=Symbol("IRootSourceMapFactory"),Zo=class{constructor(e,t){this.root=e;this.resourceProvider=t}load(e){return this.root.load(this.resourceProvider,e)}guardSourceMapFn(e,t,n){return this.root.guardSourceMapFn(e,t,n)}};Zo=P([(0,Nn.injectable)(),y(0,(0,Nn.inject)(Ob)),y(1,(0,Nn.inject)(Qo))],Zo);var Ku=class{constructor(e,t,n){this.pathResolve=e;this.dap=t;this.logger=n;this.hasWarnedAboutMaps=new WeakSet}async load(e,t){let n=await this.parseSourceMap(e,t.sourceMapUrl),i;"sourceRoot"in n&&(i=n.sourceRoot,n.sourceRoot=void 0);let o=!1,s=[];if("sections"in n){s=[];let a=0;for(let c of n.sections){let u=c.map;s.push(...u.sources),u.sources=u.sources.map(()=>`source${a++}.js`),o||=!!u.names?.length}}else"sources"in n&&Array.isArray(n.sources)&&(s=n.sources,n.sources=n.sources.map((a,c)=>`source${c}.js`),o=!!n.names?.length);return new wa(new Ad(n),t,i??"",s,o)}async parseSourceMap(e,t){let n;try{n=await this.parseSourceMapDirect(e,t)}catch(i){if(n=await this.parsePathMappedSourceMap(e,t),!n)throw i}if("sections"in n){let i=await Promise.all(n.sections.map((o,s)=>"url"in o?this.parseSourceMap(e,o.url).then(a=>({offset:o.offset,map:a})).catch(a=>{this.logger.warn("sourcemap.parsing",`Error parsing nested map ${s}: ${a}`)}):o));n.sections=i.filter(wt)}return n}async parsePathMappedSourceMap(e,t){if(xt(t))return;let n=await this.pathResolve.urlToAbsolutePath({url:t});if(n)try{return this.parseSourceMapDirect(e,n)}catch(i){this.logger.info("sourcemap.parsing","Parsing path mapped source map failed.",i)}}guardSourceMapFn(e,t,n){try{return t()}catch(i){if(!/error parsing/i.test(String(i.message)))throw i;if(!this.hasWarnedAboutMaps.has(e)){let o=nf(e.metadata.compiledPath,i.message).error;this.dap.output({output:o.format+`
`,category:"stderr"}),this.hasWarnedAboutMaps.add(e)}return n()}}dispose(){}async parseSourceMapDirect(e,t){let n=$e(t);n&&(n=this.pathResolve.rebaseRemoteToLocal(n));let i=await e.fetch(n||t);if(!i.ok)throw i.error;let o=i.body;return o.slice(0,3)===")]}"&&(o=o.substring(o.indexOf(`
`))),JSON.parse(o)}};Ku=P([(0,Nn.injectable)(),y(0,(0,Nn.inject)(Ce)),y(1,(0,Nn.inject)(Ta)),y(2,(0,Nn.inject)(W))],Ku);var Yi=class extends Ku{constructor(){super(...arguments);this.knownMaps=new Dn(t=>t.toLowerCase())}load(t,n){let i=this.knownMaps.get(n.sourceMapUrl);if(!i)return this.loadNewSourceMap(t,n);let o=n.cacheKey,s=i.metadata.cacheKey;return i.reloadIfNoMtime?o&&s&&o===s?(i.reloadIfNoMtime=!1,i.prom):this.loadNewSourceMap(t,n):s&&o&&o!==s?this.loadNewSourceMap(t,n):i.prom}loadNewSourceMap(t,n){let i=super.load(t,n);return this.knownMaps.set(n.sourceMapUrl,{metadata:n,reloadIfNoMtime:!1,prom:i}),i}dispose(){this.knownMaps.clear()}invalidateCache(){for(let t of this.knownMaps.values())t.reloadIfNoMtime=!0}};Yi=P([(0,Nn.injectable)()],Yi);var Xi=Symbol("IRenameProvider"),Ea=class{constructor(e,t,n){this.logger=e;this.sourceMapFactory=t;this.launchConfig=n;this.renames=new Map}provideOnStackframe(e){if(!this.launchConfig.sourceMapRenames)return Ar.None;let t=e.uiLocation();return t===void 0?Ar.None:"then"in t?t.then(n=>this.provideForSource(n?.source)):this.provideForSource(t?.source)}provideForSource(e){if(!this.launchConfig.sourceMapRenames||!(e instanceof Xe))return Ar.None;let t=ga(e.compiledToSourceUrl.keys());if(!t)throw new Error("unreachable");if(!Yo(t))return Ar.None;let n=this.renames.get(t.url);if(n)return n;let i=this.sourceMapFactory.load(t.sourceMap.metadata).then(async o=>{if(!o?.hasNames)return Ar.None;let s=await t.content();return s?await this.createFromSourceMap(o,s):Ar.None}).catch(()=>Ar.None);return this.renames.set(t.url,i),i}async createFromSourceMap(e,t){let n=Date.now(),i;try{i=await d0(t,e)}catch(s){return this.logger.info("runtime",`Error parsing content for source tree: ${s}}`,{url:e.metadata.compiledPath}),Ar.None}let o=Date.now();return this.logger.info("runtime",`renames calculated in ${o-n}ms`,{url:e.metadata.compiledPath}),new Ar(i)}};Ea=P([(0,Ra.injectable)(),y(0,(0,Ra.inject)(W)),y(1,(0,Ra.inject)(Ln)),y(2,(0,Ra.inject)(le))],Ea);var Ar=class r{constructor(e){this.renames=e}static{this.None=new r(new Ca(Pt.ZERO))}getOriginalName(e,t){return this.getClosestRename(t,n=>n.compiled===e)?.original}getCompiledName(e,t){return this.getClosestRename(t,n=>n.original===e)?.compiled}getClosestRename(e,t){return this.renames.findDeepest(e,n=>n.data?.find(t))}};var Aa=Symbol("IContainer"),Fn=Symbol("StoragePath"),Dt=Symbol("IInitializeParams"),Bn=Symbol("VSCodeApi"),es=Symbol("IsVSCode"),k0=Symbol("ExtensionContext"),Mb=Symbol("ProcessEnv"),Nb=Symbol("execa"),Re=Symbol("FS"),yi="ExtensionLocation",ts=Symbol("IBrowserFinder"),tee=Symbol("DwarfDebugging"),D0=Symbol("SessionSubStates"),sf=new WeakMap,Ge=(r,e)=>{if(!(typeof e=="object"&&e&&"dispose"in e))return e;let t=e,n=sf.get(r.container);return n?n.push(t):sf.set(r.container,[t]),e},af=r=>{sf.get(r)?.forEach(e=>e.dispose()),sf.delete(r)},ree=Symbol("IExtensionContribution"),nee=Symbol("IDebugTerminalOptionsProviders");var Ot=Symbol("ITelemetryReporter");var O0=S(G());var Qi=Symbol("IShutdownParticipants"),ka=class{constructor(){this.participants=[]}register(e,t){if(this.shutdownStage!==void 0&&this.shutdownStage>=e)return t(!0),Qs;for(;this.participants.length<=e;)this.participants.push(new Set);return this.participants[e].add(t),{dispose:()=>this.participants[e].delete(t)}}async shutdownContext(){(this.shutdownStage===void 0||this.shutdownStage<0)&&await Promise.all([...this.participants[0]].map(e=>e(!1)))}async shutdownAll(){for(this.shutdownStage=0;this.shutdownStage<this.participants.length;this.shutdownStage++)await Promise.all([...this.participants[this.shutdownStage]].map(e=>e(!0)))}};ka=P([(0,O0.injectable)()],ka);var Gn=S(G());var cf=class{constructor(e=!1,t=!1){this.verified=e;this.hit=t}},uf=class{constructor(){this._statisticsById=new Map}registerBreakpoints(e){e.forEach(t=>{t.id!==void 0&&!this._statisticsById.has(t.id)&&this._statisticsById.set(t.id,new cf(t.verified,!1))})}registerResolvedBreakpoint(e){this.getStatistics(e).verified=!0}registerBreakpointHit(e){this.getStatistics(e).hit=!0}getStatistics(e){let t=this._statisticsById.get(e);if(t!==void 0)return t;{let n=new cf;return this._statisticsById.set(e,n),n}}statistics(){let e=0,t=0,n=0;for(let i of this._statisticsById.values())e++,i.hit&&n++,i.verified&&t++;return{set:e,verified:t,hit:n}}};var lf=async(r,e,t,n={})=>{let i=Date.now();try{return await t()}finally{r.verbose("perf.function","",{method:e,duration:Date.now()-i,...n})}};var Yu=g("fs"),ht=S(G()),pf=S(g("path"));var rs=S(G()),Ju=S(g("path"));var Da=class{get empty(){return this.patterns.length===0}constructor({rootPath:e,patterns:t}){!e||!t?(this.rootPath="",this.patterns=[]):(this.rootPath=e,this.patterns=t.map(n=>{let i=n.startsWith("!");return{negated:i,pattern:n.slice(i?1:0)}}))}*explode(){for(let e=0;e<this.patterns.length;e++){let{negated:t,pattern:n}=this.patterns[e];if(t)continue;let i=Ju.resolve(this.rootPath,n).split(/[\\/]/g),o=i.findIndex(c=>c.includes("*"));if(o===-1){yield{cwd:i.slice(0,-1).join("/"),pattern:i[i.length-1],negations:[]};continue}let s=i.slice(0,o).join("/"),a=[];for(let c=e+1;c<this.patterns.length;c++){let{negated:u,pattern:l}=this.patterns[c];if(u)if(l.startsWith("**"))a.push(Be(l));else{let p=Ju.relative(s,Ju.resolve(this.rootPath,l));p.startsWith("..")||a.push(Be(p))}}yield{cwd:s,negations:a,pattern:i.slice(o).join("/")}}}};Da=P([(0,rs.injectable)()],Da);var Un=class extends Da{constructor({rootPath:e,outFiles:t}){super({rootPath:e,patterns:t})}};Un=P([(0,rs.injectable)(),y(0,(0,rs.inject)(le))],Un);var bi=class extends Da{constructor(e){super({rootPath:e.rootPath,patterns:"vueComponentPaths"in e?e.vueComponentPaths:[]})}};bi=P([(0,rs.injectable)(),y(0,(0,rs.inject)(le))],bi);var M0=g("path");var Oa=Symbol("ISearchStrategy"),wee=Symbol("ISearchStrategyFallback"),N0=async(r,e,t)=>{let n,o=`${(0,M0.basename)(r)}.map`;if(e.siblings.includes(o)&&(n=o),n||(typeof t>"u"&&(t=await MI(r)),n=Sa(t)),!(!n||(xt(n)||(n=$i(ge(r),n)),!n))&&!(!n.startsWith("data:")&&!n.startsWith("file://")))return{compiledPath:r,sourceMapUrl:n,cacheKey:e.mtime}};var Lb=Symbol("InlineSourceMapUrl"),L0=10*1e3,ns=class{constructor(e){e.__workspaceCachePath&&(this.path=pf.join(e.__workspaceCachePath,"bp-predict.json"))}async load(){if(this.value||!this.path)return this.value;try{this.value=JSON.parse(await Yu.promises.readFile(this.path,"utf-8"))}catch{}return this.value}async store(e){this.value=e,this.path&&(await Yu.promises.mkdir(pf.dirname(this.path),{recursive:!0}),await Yu.promises.writeFile(this.path,JSON.stringify(e)))}};ns=P([(0,ht.injectable)(),y(0,(0,ht.inject)(le))],ns);var jn=class{constructor(e,t,n,i,o,s){this.outFiles=e;this.repo=t;this.logger=n;this.sourceMapFactory=i;this.sourcePathResolver=o;this.state=s}async createMapping(e){if(this.outFiles.empty)return new Map;let t=Ko(),n=await this.state.load();try{let{state:i}=await this.repo.streamChildrenWithSourcemaps({files:this.outFiles,processMap:async o=>{let s=[],a=await this.sourceMapFactory.load(o);for(let c of a.sources){if(c===null)continue;let u=this.sourcePathResolver?await this.sourcePathResolver.urlToAbsolutePath({url:c,map:a}):$e(c);u&&s.push({...o,sourceMapUrl:xt(o.sourceMapUrl)?{[Lb]:o.sourceMapUrl}:o.sourceMapUrl,resolvedPath:u,sourceUrl:c})}return{discovered:s,compiledPath:We(o.compiledPath)}},onProcessedMap:({discovered:o})=>{for(let s of o){let a=t.get(s.resolvedPath);a||(a=new Set,t.set(s.resolvedPath,a)),a.add(s)}},lastState:n,...e});i&&this.state.store(i).catch(o=>this.logger.warn("runtime.exception","Error saving sourcemap cache",{error:o}))}catch(i){this.logger.warn("runtime.exception","Error reading sourcemaps from disk",{error:i})}return t}};jn=P([(0,ht.injectable)(),y(0,(0,ht.inject)(Un)),y(1,(0,ht.inject)(Oa)),y(2,(0,ht.inject)(W)),y(3,(0,ht.inject)(Ln)),y(4,(0,ht.inject)(Ce)),y(5,(0,ht.inject)(ns))],jn);var Ma=class extends jn{async getMetadataForPaths(e){this.sourcePathToCompiled||(this.sourcePathToCompiled=this.createInitialMapping());let t=await this.sourcePathToCompiled;return e.map(n=>t.get(n))}async createInitialMapping(){return lf(this.logger,"BreakpointsPredictor.createInitialMapping",()=>this.createMapping())}};Ma=P([(0,ht.injectable)()],Ma);var Na=class extends jn{constructor(){super(...arguments);this.sourcePathToCompiled=new Map}async getMetadataForPaths(t){let n=t.map(s=>this.sourcePathToCompiled.get(s)),i=t.map((s,a)=>a).filter(s=>!n[s]);if(i.length){let s=new Set(i.map(c=>We(t[c]))),a=this.createMapping({filter:(c,u)=>!u||u.discovered.some(l=>s.has(l.resolvedPath))});for(let c of i)this.sourcePathToCompiled.set(t[c],a),n[c]=a}return await Promise.all(n.map(async(s,a)=>(await s).get(t[a])))}};Na=P([(0,ht.injectable)()],Na);var os=Symbol("IBreakpointsPredictor"),is=class{constructor(e,t,n,i){this.bpSearch=e;this.outFiles=t;this.logger=n;this.sourceMapFactory=i;this.predictedLocations=new Map;this.longParseEmitter=new k;this.targetedMode=!1;this.onLongParse=this.longParseEmitter.event}async predictBreakpoints(e){if(!e.source.path||!e.breakpoints?.length)return;let t=await this.getMetadataForPaths([e.source.path]).then(i=>i[0]);if(!t)return;let n=async(i,o,s)=>{let a=typeof s.sourceMapUrl=="string"?s.sourceMapUrl:s.sourceMapUrl.hasOwnProperty(Lb)?s.sourceMapUrl[Lb]:await Yu.promises.readFile(s.compiledPath,"utf8").then(Sa);if(!a)return[];let c=await this.sourceMapFactory.load({...s,sourceMapUrl:a}),u=this.sourceMapFactory.guardSourceMapFn(c,()=>Yd(s.sourceUrl,{lineNumber:i,columnNumber:o||1},c),()=>null);if(!u||u.line===null)return[];let l=await this.getMetadataForPaths([s.compiledPath]).then(p=>p[0]);return l?(await Promise.all([...l].map(d=>n(u.line,u.column,d)))).flat():[{absolutePath:s.compiledPath,lineNumber:u.line||1,columnNumber:u.column?u.column+1:1}]};for(let i of e.breakpoints??[]){let o=`${e.source.path}:${i.line}:${i.column||1}`;if(this.predictedLocations.has(o))return;let s=[];this.predictedLocations.set(o,s);for(let a of t)s.push(...await n(i.line,i.column||0,a))}}async getPredictionForSource(e){return this.getMetadataForPaths([e]).then(t=>t[0])}async getMetadataForPaths(e){let t=setTimeout(()=>{this.longParseEmitter.fire(),this.logger.warn("runtime.sourcemap","Long breakpoint predictor runtime",{longPredictionWarning:L0,patterns:[...this.outFiles.explode()].join(", ")})},L0),n=await this.bpSearch.getMetadataForPaths(e);return clearTimeout(t),n}predictedResolvedLocations(e){let t=`${e.absolutePath}:${e.lineNumber}:${e.columnNumber||1}`;return this.predictedLocations.get(t)??[]}};is=P([(0,ht.injectable)(),y(0,(0,ht.inject)(jn)),y(1,(0,ht.inject)(Un)),y(2,(0,ht.inject)(W)),y(3,(0,ht.inject)(Ln))],is);var ja=S(G());var B0=g("crypto"),Fa=S(G());var n5=0,Ue=Symbol("ICdpApi"),ss=class extends Error{constructor(t){super("<<message>>");this.method=t}setCause(t,n){return this.cause={code:t,message:n},this.message=`CDP error ${t} calling method ${this.method}: ${n}`,this.stack=this.stack?.replace("<<message>>",this.message),this}},it=class{constructor(e,t,n){this.logger=t;this.telemetryReporter=n;this._connectionId=n5++;this._lastId=1e3;this._disposedSessions=new Map;this._onDisconnectedEmitter=new k;this.waitWrapper=o5();this.onDisconnected=this._onDisconnectedEmitter.event;this._transport=e,this._transport.onMessage(([i,o])=>this._onMessage(i,o)),this._transport.onEnd(()=>this._onTransportClose()),this._sessions=new Map,this._closed=!1,this._rootSession=new df(this,"",this.logger),this._sessions.set("",this._rootSession)}rootSession(){return this._rootSession.cdp()}_send(e,t={},n){let i=++this._lastId,o={id:i,method:e,params:t};n&&(o.sessionId=n);let s=JSON.stringify(o);return this.logger.verbose("cdp.send",void 0,{connectionId:this._connectionId,message:o}),this._transport.send(s),i}_onMessage(e,t){let n=JSON.parse(e),i=n;n.result&&n.result.scriptSource?i={...n,result:{...n.result,scriptSource:"<script source>"}}:n.method==="Debugger.scriptParsed"&&n.params&&xt(n.params.sourceMapURL)&&(i={...n,params:{...n.params,sourceMapURL:"<data source map url>"}}),this.logger.verbose("cdp.receive",void 0,{connectionId:this._connectionId,message:i});let o=this._sessions.get(n.sessionId||"");if(!o){let c=this._disposedSessions.get(n.sessionId);if(c){let u=(Date.now()-c.getTime())/1e3;this.logger.warn("internal",`Got message for a session disposed ${u} seconds ago`,{sessionId:n.sessionId,disposeOn:c});return}else throw new Error(`Unknown session id: ${n.sessionId} while processing: ${n.method}`)}let s=n.method,a;try{o._onMessage(n)}catch(c){a=c}s&&this.telemetryReporter.reportOperation("cdpOperation",s,t.elapsed().ms,a)}_onTransportClose(){if(!this._closed){this._closed=!0,this._transport.dispose(),this.logger.info("cdp.receive","Connection closed",{connectionId:this._connectionId});for(let e of this._sessions.values())e._onClose();this._sessions.clear(),this._onDisconnectedEmitter.fire()}}close(){this._onTransportClose()}isClosed(){return this._closed}createSession(e){let t=new df(this,e,this.logger);return this._sessions.set(e,t),t.cdp()}disposeSession(e){let t=this._sessions.get(e);t&&(t._onClose(),this._disposedSessions.set(t.sessionId(),new Date),this._sessions.delete(t.sessionId()))}},i5=+process.version.substring(1).split(".")[0]<11,df=class{constructor(e,t,n){this.logger=n;this._queue=[];this._prefixListeners=new Mu;this._directListeners=new Mu;this.paused=!1;this._callbacks=new Map,this._connection=e,this._sessionId=t,this._cdp=this._createApi()}pause(){this.paused=!0}resume(){if(!this.paused)return;this.paused=!1;let e=this._queue;this._queue=[],this.logger.verbose("cdp.receive","Dequeue messages",{message:e});for(let t of e)this._processResponse(t)}cdp(){return this._cdp}sessionId(){return this._sessionId}_createApi(){return new Proxy({},{get:(e,t)=>t==="pause"?()=>this.pause():t==="resume"?()=>this.resume():t==="session"?this:new Proxy({},{get:(n,i)=>{if(i!=="then")return i==="on"?(o,s)=>this.on(`${t}.${o}`,s):o=>this.send(`${t}.${i}`,o)}})})}on(e,t){return this._directListeners.listen(e,t)}onPrefix(e,t){return this._prefixListeners.listen(e,t)}send(e,t={}){return this.sendOrDie(e,t).catch(()=>{})}sendOrDie(e,t={}){if(!this._connection)return Promise.reject(new ss(e).setCause(0,"Connection is closed"));let n=this._connection._send(e,t,this._sessionId);return new Promise((i,o)=>{this._callbacks.set(n,{resolve:i,reject:o,from:new ss(e),method:e})})}_onMessage(e){if(this.paused&&e.id){this._processResponse(e);return}if(this._queue.length>0){this._queue.push(e);return}if(!i5&&!this.paused){this._processResponse(e);return}this._queue.push(e),this.paused||this._processQueue()}_processQueue(){this._connection?.waitWrapper(()=>{if(this.paused)return;let e=this._queue.shift();e&&(this._processResponse(e),this._queue.length&&this._processQueue())})}_processResponse(e){if(e.id===void 0){let n=e;this._directListeners.emit(n.method,n.params);for(let[i,o]of this._prefixListeners.listeners)n.method.startsWith(i)&&o.fire(n);return}let t=this._callbacks.get(e.id);t&&(this._callbacks.delete(e.id),"error"in e?t.reject(t.from.setCause(e.error.code,e.error.message)):"result"in e&&t.resolve(e.result))}async detach(){if(!this._connection)throw new Error("Session already detached. Most likely the target has been closed.");this._connection._send("Target.detachFromTarget",{},this._sessionId)}isClosed(){return!this._connection}_onClose(){for(let e of this._callbacks.values())e.reject(e.from.setCause(0,"Connection is closed"));this._callbacks.clear(),this._connection=void 0}};function o5(){if(parseInt(process.versions.node,10)>=11)return setImmediate;let r=!1,e=[],t=()=>{let n=e.shift();if(!n){r=!1;return}setImmediate(t),n()};return n=>{e.push(n),r||(r=!0,setImmediate(t))}}var vi="$returnValue",s5="__js_debug_hoisted_",F0=()=>s5+(0,B0.randomBytes)(8).toString("hex"),kr=Symbol("IEvaluator"),La=class{constructor(e,t,n){this.cdp=e;this.renameProvider=t;this.logger=n}get hasReturnValue(){return!!this.returnValue}setReturnedValue(e){this.returnValue=e}prepare(e,{isInternalScript:t,hoist:n,renames:i,transformRanges:o}={}){t!==!1&&(e+=Ve());let s=new Map;s.set(vi,F0());for(let u of n??[])s.set(u,F0());let{transformed:a,hoisted:c}=this.replaceVariableInExpression(e,s,i,o);return c.size?{canEvaluateDirectly:!1,invoke:(u,l)=>Promise.all([...s].map(async([p,d])=>{await this.hoistValue(p===vi?this.returnValue:await l?.(p),d)||(a=a.replaceAll(d,p))})).then(()=>this.cdp.Debugger.evaluateOnCallFrame({...u,expression:a}))}:{canEvaluateDirectly:!0,invoke:u=>this.cdp.Debugger.evaluateOnCallFrame({...u,expression:a})}}async evaluate(e,t={}){if(!("callFrameId"in e))return this.cdp.Runtime.evaluate(e);let n={...t},{location:i,stackFrame:o}=t,s;if(i)await Promise.all([Promise.resolve(this.renameProvider.provideForSource(i.source)).then(a=>{n.renames={mapping:a,position:i.position}}),o&&this.setupShadowedVariableHoisting(i,o).then(a=>{a&&(s=a.doHoist,n.hoist=[...a.hoistable])})]);else if(o){let a=await this.renameProvider.provideOnStackframe(o);n.renames={mapping:a,position:o.rawPosition}}return this.prepare(e.expression,n).invoke(e,s)}async hoistValue(e,t){if(e===void 0)return!1;let n=e?.objectId,i=`setTimeout(() => { delete globalThis.${t} }, 0)`,o;return n?o=await this.cdp.Runtime.callFunctionOn({objectId:n,functionDeclaration:`function() { globalThis.${t} = this; ${i}; ${Ve()} }`}):o=await this.cdp.Runtime.evaluate({expression:`globalThis.${t} = ${JSON.stringify(e?.value)};${i};`+Ve()}),!!o&&!o.exceptionDetails}async setupShadowedVariableHoisting({position:e,source:t,variables:n},i){let{scopes:o}=await i.scopes(),s=await sx(o,async u=>u.source&&u.line&&u.endLine&&new Pt(new Fe(u.line,u.column||1),new Fe(u.endLine,u.endColumn||1/0)).contains(e)&&await t.equalsDap(u.source));if(s===-1)return;this.logger.verbose("runtime",`Evaluating expression in scope ${o[s].name}`);let a=new Set;return await Promise.all(o.slice(0,s).map(async u=>{let l=await n.getVariableNames({variablesReference:u.variablesReference});for(let{name:p}of l)a.add(p)})),{hoistable:a,doHoist:async u=>{for(let l=s;l<o.length;l++)return(await n.getVariableNames({variablesReference:o[l].variablesReference})).find(d=>d.name===u)?.remoteObject}}}replaceVariableInExpression(e,t,n,i){let o=new Set,s=!1,a=(d,f)=>({type:"ConditionalExpression",test:{type:"BinaryExpression",left:{type:"UnaryExpression",operator:"typeof",prefix:!0,argument:{type:"Identifier",name:d}},operator:"!==",right:{type:"Literal",value:"undefined"}},consequent:{type:"Identifier",name:d},alternate:f}),c=[],u=kn(e),l=Fd(u,{enter(d,f){let h=d;if(d.type!=="Identifier"||e[h.start-1]===".")return;if(i){if(!d.loc)throw new Error("Node should have location");let I=new Pt(new Jt(d.loc.start.line,d.loc.start.column),new Jt(d.loc.end.line,d.loc.end.column));if(!i.some(D=>D.containsRange(I)))return}let m=t.get(d.name);if(m)return o.add(d.name),s=!0,{replace:Sb(d,f)?{type:"Identifier",name:m}:a(m,a5)};let b=n?.mapping.getCompiledName(d.name,n.position);if(b)return s=!0,{replace:Sb(d,f)?{type:"Identifier",name:b}:a(b,d)}},leave:()=>{c.pop()}});if(!s)return{hoisted:o,transformed:e};let p=u.body[u.body.length-1].end;return{hoisted:o,transformed:fi(l)+e.slice(p)}}};La=P([(0,Fa.injectable)(),y(0,(0,Fa.inject)(Ue)),y(1,(0,Fa.inject)(Xi)),y(2,(0,Fa.inject)(W))],La);var a5={type:"Identifier",name:"undefined"};var ff=class r{static parse(e,t,n,i){t=Fb(t,n);let o=t&&Ki(t);if(o)throw new O(Ji(e,o.message));let{canEvaluateDirectly:s,invoke:a}=i.prepare(t);return new r(s?t:a)}constructor(e){typeof e=="function"?this.invoke=e:this.breakCondition=e}async shouldStayPaused(e){return this.invoke?(await this.invoke({callFrameId:e.callFrames[0].callFrameId,returnByValue:!0}))?.result.value===!0:Promise.resolve(!0)}},Fb=(r,e)=>`(()=>{try{return ${r};}catch(e){console.error(\`Breakpoint condition error: \${e.message||e}\`);return ${!!e}}})()`;var c5=/^(>|>=|={1,3}|<|<=|%)?\s*([0-9]+)$/,Ba=class r{constructor(e){this.predicate=e;this.hits=0;this.breakCondition=void 0}shouldStayPaused(){return Promise.resolve(this.predicate(++this.hits))}static parse(e){let t=c5.exec(e);if(!t)throw new O(Ab(e));let[,n="=",i]=t;return new r(u5(e,n,Number(i)))}},u5=(r,e,t)=>{switch(e){case"=":case"==":case"===":return n=>n===t;case">":return n=>n>t;case">=":return n=>n>=t;case"<":return n=>n<t;case"<=":return n=>n<=t;case"%":return n=>n%t===0;default:throw new O(Ab(r))}};var U0=g("crypto"),mf=S(G());var hf=class{constructor(e){this.invoke=e;this.breakCondition=void 0}async shouldStayPaused(e){return await this.invoke({callFrameId:e.callFrames[0].callFrameId}),!1}};var as=class{constructor(e,t){this.breakCondition=t;let n=t&&Ki(t);if(n)throw new O(Ji(e,n.message))}shouldStayPaused(){return Promise.resolve(!0)}};var Zi=class{constructor(e){this.evaluator=e}compile(e,t){let n=this.logMessageToExpression(t),i=Ki(n);if(i)throw new O(Ji(e,i.message));let{canEvaluateDirectly:o,invoke:s}=this.evaluator.prepare(n);return o?new as(e,this.logMessageToExpression(t)):new hf(s)}serializeLogStatements(e){return kT([],e,!1)}logMessageToExpression(e){let t=u=>u.replace(/%/g,"%%"),n=[],i=[],o=0;for(;;){let u=e.indexOf("{",o);if(u===-1){n.push(t(e.slice(o)));break}n.push(t(e.slice(o,u)));let[l]=Ou(e.slice(u));if(o=u+l.end,o-1===u+1||e[o-1]!=="}"){n.push(t(e.slice(u,o)));continue}if(l.type!=="BlockStatement")break;l.body.length===1&&l.body[0].type==="BlockStatement"&&(l.body=Ou(`(${e.slice(u+1,o-2)}})`)),i.push(fi(this.serializeLogStatements(l.body))),n.push("%O")}let a=`console.log(${[JSON.stringify(n.join("")),...i].join(", ")}), false`,c=(0,U0.createHash)("sha256").update(a).digest("hex").slice(0,7);return a+`
//# sourceURL=logpoint-${c}.cdp`}};Zi=P([(0,mf.injectable)(),y(0,(0,mf.inject)(kr))],Zi);var l5=new as({line:0},void 0),Ete=new as({line:0},"false"),gf=Symbol("IBreakpointConditionFactory"),Ua=class{constructor(e,t,n){this.logPointCompiler=e;this.evaluator=t;this.breakOnError=n.__breakOnConditionalError}getConditionFor(e){return e.condition?ff.parse(e,e.condition,this.breakOnError,this.evaluator):e.logMessage?this.logPointCompiler.compile(e,e.logMessage):e.hitCondition?Ba.parse(e.hitCondition):l5}};Ua=P([(0,ja.injectable)(),y(0,(0,ja.inject)(Zi)),y(1,(0,ja.inject)(kr)),y(2,(0,ja.inject)(le))],Ua);var vf=g("path");var yf=(r,e)=>r.lineNumber===e.lineNumber&&r.columnNumber===e.columnNumber;var bf=r=>!("location"in r),j0=r=>"location"in r,p5=(r,e)=>r.url&&e===r.url||r.urlRegex&&new RegExp(r.urlRegex).test(e),qa=class{constructor(e,t,n){this._manager=e;this._source=t;this._originalPosition=n;this.isEnabled=!1;this.setInCdpScriptIds=new Set;this.cdpScriptIds=this.setInCdpScriptIds;this.cdpBreakpoints=[];this._cdpIds=new Set}get enabled(){return this.isEnabled}get cdpIds(){return this._cdpIds}get source(){return this._source}get originalPosition(){return this._originalPosition}async updateSourceLocation(e,t,n){this._source=t,this._originalPosition=n;let i=[];for(let o of this.cdpBreakpoints)o.state===1&&i.push(this.updateUiLocations(e,o.cdpId,o.locations));await Promise.all(i)}async refreshUiLocations(e){await Promise.all(this.cdpBreakpoints.filter(t=>t.state===1).map(t=>this.updateUiLocations(e,t.cdpId,t.locations)))}async enable(e){if(this.isEnabled)return;this.isEnabled=!0;let t=[this._setPredicted(e)],n=this._manager._sourceContainer.source(this.source);if((!n||!(n instanceof Xe))&&t.push(this._setByPath(e,n?.offsetSourceToScript(this.originalPosition)||this.originalPosition)),await Promise.all(t),n&&this.isEnabled){let i=await this._manager._sourceContainer.currentSiblingUiLocations({lineNumber:this.originalPosition.lineNumber,columnNumber:this.originalPosition.columnNumber,source:n});await Promise.all(i.map(o=>this._setByUiLocation(e,n.offsetSourceToScript(o))))}}async updateUiLocations(e,t,n){this.updateExistingCdpRef(t,a=>({...a,locations:n}));let i=(await Promise.all(n.map(a=>e.rawLocationToUiLocation(e.rawLocation(a))))).find(a=>!!a);if(!i)return;let o=this._manager._sourceContainer.source(this.source);if(!o)return;let s=await this._manager._sourceContainer.currentSiblingUiLocations(i);this.updateExistingCdpRef(t,a=>{let c=s.filter(u=>u.source===o);return{...a,locations:n,uiLocations:c.length?c:s}})}compare(e){let t=this.originalPosition,n=e.originalPosition;return t.lineNumber!==n.lineNumber?t.lineNumber-n.lineNumber:t.columnNumber-n.columnNumber}async disable(){if(!this.isEnabled)return;this.isEnabled=!1;let e=this.cdpBreakpoints.map(t=>this.removeCdpBreakpoint(t));await Promise.all(e)}async updateForNewLocations(e,t){let n=this._manager._sourceContainer.source(this.source);if(!n)return[];let i=await this._manager._sourceContainer.currentSiblingUiLocations({lineNumber:this.originalPosition.lineNumber,columnNumber:this.originalPosition.columnNumber,source:n},await t.source);if(!i.length)return[];let o=[];for(let s of i)o.push(this._setForSpecific(e,t,n.offsetSourceToScript(s)));for(let s of this.cdpBreakpoints){if(!bf(s.args)||!p5(s.args,t.url))continue;let a=s.args;i.some(c=>c.columnNumber-1===a.columnNumber&&c.lineNumber-1===a.lineNumber)||(this._manager.logger.verbose("runtime.sourcemap","Adjusted breakpoint due to overlaid sourcemap",{url:n.url}),o.push(this.removeCdpBreakpoint(s)))}return await Promise.all(o),i}executionContextWasCleared(){this.updateCdpRefs(e=>e.filter(t=>bf(t.args)))}hasResolvedAt(e,t){let{lineNumber:n,columnNumber:i}=t.base0;return this.cdpBreakpoints.some(o=>o.state===1&&o.locations.some(s=>s.scriptId===e&&s.lineNumber===n&&(s.columnNumber===void 0||s.columnNumber===i)))}getBreakCondition(){}updateExistingCdpRef(e,t){this.updateCdpRefs(n=>n.map(i=>i.state!==1||i.cdpId!==e?i:t(i)))}updateCdpRefs(e){let t=this;t.cdpBreakpoints=e(this.cdpBreakpoints);let n=new Set;this.setInCdpScriptIds.clear();for(let i of this.cdpBreakpoints)if(i.state===1){n.add(i.cdpId);for(let o of i.locations)this.setInCdpScriptIds.add(o.scriptId)}this._cdpIds=n}async _setPredicted(e){if(!this.source.path||!this._manager._breakpointsPredictor)return;let t=this._manager._breakpointsPredictor.predictedResolvedLocations({absolutePath:this.source.path,lineNumber:this.originalPosition.lineNumber,columnNumber:this.originalPosition.columnNumber}),n=[];for(let i of t){let o=this._manager._sourceContainer.sourcePathResolver.absolutePathToUrlRegexp(i.absolutePath);o!==void 0&&(typeof o=="string"?n.push(this._setByUrlRegexp(e,o,i)):n.push(o.then(s=>s?this._setByUrlRegexp(e,s,i):void 0)))}await Promise.all(n)}async _setByUiLocation(e,t){await Promise.all(t.source.scripts.map(n=>this._setForSpecific(e,n,t)))}async _setByPath(e,t){let n=this._manager._sourceContainer.source({path:this.source.path});if(!(n instanceof Xe&&[...n.compiledToSourceUrl.keys()].some(o=>o.absolutePath===this.source.path)))if(this.source.path){let i=await this._manager._sourceContainer.sourcePathResolver.absolutePathToUrlRegexp(this.source.path);if(!i)return;await this._setByUrlRegexp(e,i,t)}else{let o=this._manager._sourceContainer.source(this.source)?.url;if(!o)return;await this._setByUrl(e,o,t),this.source.path!==o&&this.source.path!==void 0&&await this._setByUrl(e,ge(this.source.path),t)}}hasSetOnLocation(e,t){return this.cdpBreakpoints.find(n=>e.scriptId&&j0(n.args)&&n.args.location.scriptId===e.scriptId&&yf(n.args.location,t)||e.url&&!e.hasSourceURL&&bf(n.args)&&(n.args.urlRegex?new RegExp(n.args.urlRegex).test(e.url):e.url===n.args.url)&&yf(n.args,t))}hasSetOnLocationByUrl(e,t,n){return this.cdpBreakpoints.find(i=>{if(bf(i.args))return yf(i.args,n)?e==="url"?i.args.urlRegex?new RegExp(i.args.urlRegex).test(t):i.args.url===t:e==="re"&&i.args.urlRegex===t:!1;let o=this._manager._sourceContainer.getScriptById(i.args.location.scriptId);if(o)return yf(i.args.location,n)&&e==="re"?new RegExp(t).test(o.url):o.url===t})}async _setForSpecific(e,t,n){return t.url&&!t.hasSourceURL&&(!t.embedderName||t.embedderName===t.url)?this._setByUrl(e,t.url,n):this._setByScriptId(e,t,n)}async _setByUrl(e,t,n){n=gi(n);let i=this.hasSetOnLocationByUrl("url",t,n);if(i){i.state===0&&await i.done;return}return this._setAny(e,{url:t,condition:this.getBreakCondition(),...n})}async _setByUrlRegexp(e,t,n){n=gi(n);let i=this.hasSetOnLocationByUrl("re",t,n);if(i){i.state===0&&await i.done;return}return this._setAny(e,{urlRegex:t,condition:this.getBreakCondition(),...n})}async _setByScriptId(e,t,n){n=gi(n);let i=this.hasSetOnLocation(t,n);if(i){i.state===0&&await i.done;return}return this._setAny(e,{condition:this.getBreakCondition(),location:{scriptId:t.scriptId,...n}})}async _setAny(e,t){if(!this.isEnabled)return;let n={state:0,args:t,deadletter:!1};n.done=(async()=>{let i=j0(t)?await e.cdp().Debugger.setBreakpoint(t):await e.cdp().Debugger.setBreakpointByUrl(t);if(!i)return;if(n.deadletter){await e.cdp().Debugger.removeBreakpoint({breakpointId:i.breakpointId});return}let o="actualLocation"in i?[i.actualLocation]:i.locations;this._manager._resolvedBreakpoints.set(i.breakpointId,this);let s={state:1,cdpId:i.breakpointId,args:t,locations:o,uiLocations:[]};return this.updateCdpRefs(a=>a.map(c=>c===n?s:c)),await this.updateUiLocations(e,i.breakpointId,o),s})(),this.updateCdpRefs(i=>[...i,n]),await n.done}async removeCdpBreakpoint(e){this.updateCdpRefs(t=>t.filter(n=>n!==e)),e.state===0?(e.deadletter=!0,await e.done):(await this._manager._thread?.cdp().Debugger.removeBreakpoint({breakpointId:e.cdpId}),this._manager._resolvedBreakpoints.delete(e.cdpId))}};var qn=class r extends qa{constructor(t,n,i){super(t,n,{lineNumber:1,columnNumber:1});this.mode=i}static getModeKeyForSource(t,n){return t===1?(0,vf.basename)(n,(0,vf.extname)(n)||void 0):n}_setPredicted(){return Promise.resolve()}_setByPath(t,n){if(!this.source.path)return Promise.resolve();let i=r.getModeKeyForSource(this.mode,this.source.path);return this.mode===1?super._setByUrlRegexp(t,Wt(i),n):super._setByPath(t,n)}};var W0=S(He());var Dr=class extends qa{constructor(t,n,i,o,s){super(t,i,{lineNumber:o.line,columnNumber:o.column||1});this.dapId=n;this.dapParams=o;this.condition=s;this.completedSet=be()}equivalentTo(t){return t.dapParams.column===this.dapParams.column&&t.dapParams.line===this.dapParams.line&&t.dapParams.hitCondition===this.dapParams.hitCondition&&t.dapParams.condition===this.dapParams.condition&&t.dapParams.logMessage===this.dapParams.logMessage}untilSetCompleted(){return this.completedSet.promise}markSetCompleted(){this.completedSet.resolve()}testHitCondition(t){return this.condition.shouldStayPaused(t)}async toDap(){let t=this.enabled&&this.getResolvedUiLocation();return t?{id:this.dapId,verified:!0,source:await t.source.toDap(),line:t.lineNumber,column:t.columnNumber}:{id:this.dapId,verified:!1,message:W0.t("Unbound breakpoint")}}diagnosticDump(){return{source:this.source,params:this.dapParams,cdp:this.cdpBreakpoints}}getBreakCondition(){return this.condition.breakCondition}updateCdpRefs(t){let n=this.getResolvedUiLocation();super.updateCdpRefs(t),this.getResolvedUiLocation()!==n&&this.notifyResolved()}getResolvedUiLocation(){for(let t of this.cdpBreakpoints)if(t.state===1&&t.uiLocations.length)return t.uiLocations[0]}async notifyResolved(){await this.completedSet.promise,await this._manager.notifyBreakpointChange(this,!0)}};var _f=class extends Dr{constructor(e,t,n,i){super(e,t,n,i,new Ba(()=>!1))}getResolvedUiLocation(){}};var JE=S(tl());var rl=class extends qn{constructor(t,n){super(t,{path:n},1);this.pattern=n}async enable(t){if(this.isEnabled)return;this.isEnabled=!0;let n=(0,JE.makeRe)(Be(this.pattern),{contains:!0,lookbehinds:!1});await this._setAny(t,{urlRegex:n.source.replace(/([a-z]):/i,(i,o)=>`[${o.toLowerCase()}${o.toUpperCase()}]:`),lineNumber:0,columnNumber:0})}};var $a=S(G());var Ef=Symbol("IExperimentationService");var TG=/\/node_modules\/|^node\:/,EG=2,YE=5e3,RG=YE/2,je=class{constructor(e,t,n){this.telemetry=t;this.experimentation=n;this.disposable=new De;this.hadBreakpoint=!1;this.didVerifyBreakpoint=!1;this.hadNonModuleSourcemap=!1;this.startedAt=Date.now();this.disposable.push(je.didVerifyEmitter.event(()=>{this.didVerifyBreakpoint=!0})),je.consecutiveQualifyingSessions>=EG&&this.disposable.push(ox(async()=>{this.currentlyQualifying&&await this.experimentation.getTreatment("diagnosticPrompt",!0)&&(t.report("diagnosticPrompt",{event:"suggested"}),je.didSuggest=!0,e.suggestDiagnosticTool({}))},YE))}get currentlyQualifying(){return this.hadBreakpoint&&!this.didVerifyBreakpoint&&this.hadNonModuleSourcemap}notifyHadBreakpoint(){this.hadBreakpoint=!0}notifyVerifiedBreakpoint(){this.didVerifyBreakpoint||(je.didVerifyEmitter.fire(),je.didSuggest&&(je.didSuggest=!1,this.telemetry.report("diagnosticPrompt",{event:"resolved"})))}attach(e){if(!this.hadNonModuleSourcemap){let t=this.disposable.push(e.Debugger.on("scriptParsed",n=>{n.sourceMapURL&&!TG.test(n.url)&&(this.hadNonModuleSourcemap=!0,this.disposable.disposeObject(t))}))}}dispose(){this.currentlyQualifying&&Date.now()-RG>this.startedAt?je.consecutiveQualifyingSessions++:je.consecutiveQualifyingSessions=0,this.disposable.dispose()}};je.consecutiveQualifyingSessions=0,je.didVerifyEmitter=new k,je.didSuggest=!1,je=P([(0,$a.injectable)(),y(0,(0,$a.inject)(Ta)),y(1,(0,$a.inject)(Ot)),y(2,(0,$a.inject)(Ef))],je);var Mr=S(G());function AG(r){let e=[];for(let t=0,n=r.length;t<n;++t){let i=r.charCodeAt(t);if(i<128)e.push(i);else if(i<2048)e.push(192|i>>6,128|i&63);else if(i<55296||i>=57344)e.push(224|i>>12,128|i>>6&63,128|i&63);else{let o=65536+((i&1023)<<10|r.charCodeAt(++t)&1023);e.push(240|o>>18&7,128|o>>12&63,128|o>>6&63,128|o&63)}}return new Uint8Array(e)}var XE=AG;var Ha=2654435761,Ga=2246822519,Rf=3266489917,QE=668265263,ZE=374761393;function tv(r,e=0){r=typeof r=="string"?XE(r):r;let t=r,n=e+ZE&4294967295,i=0;if(t.length>=16){let s=[e+Ha+Ga&4294967295,e+Ga&4294967295,e+0&4294967295,e-Ha&4294967295],a=r,c=a.length-16,u=0;for(i=0;(i&4294967280)<=c;i+=4){let l=i,p=a[l+0]+(a[l+1]<<8),d=a[l+2]+(a[l+3]<<8),f=p*Ga+(d*Ga<<16),h=s[u]+f&4294967295;h=h<<13|h>>>19;let m=h&65535,b=h>>>16;s[u]=m*Ha+(b*Ha<<16)&4294967295,u=u+1&3}n=(s[0]<<1|s[0]>>>31)+(s[1]<<7|s[1]>>>25)+(s[2]<<12|s[2]>>>20)+(s[3]<<18|s[3]>>>14)&4294967295}n=n+r.length&4294967295;let o=r.length-4;for(;i<=o;i+=4){let s=i,a=t[s+0]+(t[s+1]<<8),c=t[s+2]+(t[s+3]<<8),u=a*Rf+(c*Rf<<16);n=n+u&4294967295,n=n<<17|n>>>15,n=(n&65535)*QE+((n>>>16)*QE<<16)&4294967295}for(;i<t.length;++i){let s=t[i];n=n+s*ZE,n=n<<11|n>>>21,n=(n&65535)*Ha+((n>>>16)*Ha<<16)&4294967295}return n=n^n>>>15,n=((n&65535)*Ga&4294967295)+((n>>>16)*Ga<<16),n=n^n>>>13,n=((n&65535)*Rf&4294967295)+((n>>>16)*Rf<<16),n=n^n>>>16,n<0?n+4294967296:n}var kf=S(G());var eR=S(g("fs")),Af=S(g("path")),tR=r=>{let e={};f(e);function t(m,b){return r({category:"telemetry",output:m,data:b})}let n=m=>t("js-debug/dap/operation",{...e,...m}),i=m=>t("js-debug/cdp/operation",{...e,...m}),o=m=>t("js-debug/error",{...e,...m}),s=m=>t("blazor-debug/blazorDebugException",{...e,...m}),a=m=>{e.browser=(m.targetProject||m.targetProject)+"/"+m.targetVersion,t("js-debug/browserVersion",{...e,...m})},c=m=>t("js-debug/breakpointStats",{...e,...m}),u=m=>t("js-debug/statistics",{...e,...m}),l=m=>{e.nodeVersion=m.version,t("js-debug/nodeRuntime",{...e,...m})},p=m=>{t("js-debug/launch",{...e,...m,parameters:JSON.stringify(m.parameters)})},d=m=>{t("js-debug/diagnosticPrompt",{...e,...m})};function f(m){try{let b=Af.resolve(Af.dirname(__filename),"..","..",".gitcommit");m.jsDebugCommitId=eR.readFileSync(b,"utf8")}catch{}}return{breakpointStats:c,statistics:u,browserVersion:a,cdpOperation:i,dapOperation:n,error:o,launch:p,nodeRuntime:l,diagnosticPrompt:d,setGlobalMetric:(m,b)=>{e[m]=b},blazorDebugException:s}};var nl=class{constructor(e=!0){this.isVSCode=e;this.measurements=Object.create(null)}add(e,t,n){let i=this.measurements[e];i||(i=this.measurements[e]={times:[],errors:[]}),i.times.push(t),n&&i.errors.push(n)}flush(){let e={errors:[]};for(let t in this.measurements){let{times:n,errors:i}=this.measurements[t],o={operation:t,totalTime:0,max:0,avg:0,stddev:0,count:n.length,failed:i.length};for(let s of n)o.totalTime+=s,o.max=Math.max(o.max,s);o.avg=o.totalTime/o.count;for(let s of n)o.stddev+=(s-o.avg)**2;o.stddev=Math.sqrt(o.stddev/(n.length-1)),e[o.operation]=o,e[`!${o.operation}.errors`]=i,this.isVSCode||(e[`${o.operation}.errors`]=i)}return this.measurements=Object.create(null),e}};var $n=class{constructor(e=!0){this.isVsCode=e;this.target=[];this.flushEmitter=new k;this.loggers=tR(e=>this.pushOutput(e));this.batchFlushTimeout={};this.batchers={dapOperation:new nl(this.isVsCode),cdpOperation:new nl(this.isVsCode)};this.onFlush=this.flushEmitter.event;this.setGlobalMetric=this.loggers.setGlobalMetric}report(e,...t){let n=this.loggers[e];n(...t)}reportOperation(e,t,n,i){this.batchers[e].add(t,n,i),this.batchFlushTimeout[e]===void 0&&(this.batchFlushTimeout[e]=setTimeout(()=>{this.report(e,this.batchers[e].flush()),this.batchFlushTimeout[e]=void 0},$n.batchFlushInterval))}attachDap(e){this.target instanceof Array&&this.target.forEach(t=>e.output(t)),this.target=e}flush(){this.flushEmitter.fire();let e=Object.entries(this.batchFlushTimeout);for(let[t,n]of e){let i=this.batchers[t].flush();i.length&&this.report(t,i),this.batchFlushTimeout[t]=void 0,clearTimeout(n)}}dispose(){for(let e of Object.values(this.batchFlushTimeout))e&&clearTimeout(e)}pushOutput(e){e.data=rv(e.data),this.target instanceof Array?this.target.push(e):this.target.output(e)}};$n.batchFlushInterval=5e3,$n=P([(0,kf.injectable)(),y(0,(0,kf.inject)(es))],$n);var rv=r=>typeof r=="number"?Number(r.toFixed(1)):typeof r!="object"||!r?r:r instanceof Error?nv(r):r instanceof Array?r.map(rv):ai(r,rv),rR=/(?:[A-z]:)?(?:[\\/][^:]*)+[\\/]([^:]*:)/g;function nv(r){let e=String(r.message),t=String(r.name);rR.lastIndex=0;let n=typeof r.stack=="string"?r.stack.replace(rR,"$1"):void 0;return{error:{message:e,name:t,stack:n}}}var oR=g("crypto"),Hn=S(G());var il=Symbol("IDwarfModuleProvider");var Mf=Symbol("IWasmSymbolProvider"),ov=Symbol("IWasmWorkerFactory"),Nf=r=>r.replace(/\.wasm$/i,"")+".wat",za=class{constructor(e,t){this.dwarf=e;this.launchConfig=t;this.cdpCounter=0;this.cdp=new Map;this.prompt=ne(()=>this.dwarf.prompt())}async spawn(e){if(!this.launchConfig.enableDWARF)return null;this.worker??=this.dwarf.load().then(i=>{if(!i)return null;let o=i.spawn({getWasmGlobal:(s,a)=>this.loadWasmValue(`globals[${s}]`,a),getWasmLocal:(s,a)=>this.loadWasmValue(`locals[${s}]`,a),getWasmOp:(s,a)=>this.loadWasmValue(`stack[${s}]`,a),getWasmLinearMemory:(s,a,c)=>this.loadWasmValue(`[].slice.call(new Uint8Array(memories[0].buffer, ${+s}, ${+a}))`,c).then(u=>new Uint8Array(u).buffer)});return o.rpc.sendMessage("hello",[],!1),o});let t=await this.worker;if(!t)return null;let n=this.cdpCounter++;return this.cdp.set(n,e),{rpc:t.rpc,getStopId:i=>`${n}:${i}`,dispose:()=>(this.cdp.delete(n),this.cdp.size>0?Promise.resolve():(this.worker=void 0,t.dispose()))}}async dispose(){await this.worker?.then(e=>e?.dispose()),this.worker=Promise.resolve(null)}async loadWasmValue(e,t){let n=t,i=n.indexOf(":"),o=n.substring(0,i),s=n.substring(i+1),a=await this.cdp.get(+o)?.Debugger.evaluateOnCallFrame({callFrameId:s,expression:e+Ve(),silent:!0,returnByValue:!0,throwOnSideEffect:!0});if(!a||a.exceptionDetails)throw new Error(`evaluate failed: ${a?.exceptionDetails?.text||"unknown"}`);return a.result.value}};za=P([(0,Hn.injectable)(),y(0,(0,Hn.inject)(il)),y(1,(0,Hn.inject)(le))],za);var Ka=class{constructor(e,t,n,i){this.dwarf=e;this.cdp=t;this.logger=n;this.launchConfig=i;this.worker=ne(()=>this.dwarf.spawn(this.cdp))}async loadWasmSymbols(e){if(!this.launchConfig.enableDWARF)return this.defaultSymbols(e);let t=await this.worker();if(!t){let l=this.defaultSymbols(e);return l.onDidDisassemble=this.dwarf.prompt,l}let{rpc:n}=t,i=(0,oR.randomUUID)(),o;try{let l=e.debugSymbols;if(kG(l)&&l.externalURL)o=new URL(l.externalURL);else if(Array.isArray(l)){let p=e.debugSymbols?.find(d=>(d.type==="EmbeddedDWARF"||d.type==="ExternalDWARF")&&d.externalURL);p?.externalURL&&(o=new URL(p.externalURL))}}catch{}let s=new URL(e.url),a=s.hostname==="localhost"?["127.0.0.1","[::1]","localhost"]:[s.hostname],c=o?.hostname==="localhost",u;for(let l of a){s.hostname=l,o&&c&&(o.hostname=l);try{u=await n.sendMessage("addRawModule",i,o?.toString(),{url:s.toString(),code:!o&&s.protocol.startsWith("wasm:")?await this.getBytecode(e.scriptId):void 0});break}catch(p){this.logger.warn("sourcemap.parsing",`failed to load wasm symbols for ${s}`,{error:p})}}return u?!(u instanceof Array)||u.length===0?(n.sendMessage("removeRawModule",i),this.defaultSymbols(e)):(this.logger.info("sourcemap.parsing","parsed files from wasm",{files:u}),new iv(e,this.cdp,i,t,u)):this.defaultSymbols(e)}async dispose(){await this.worker.value?.then(e=>e?.dispose())}defaultSymbols(e){return new Df(e,this.cdp,[])}async getBytecode(e){let n=(await this.cdp.Debugger.getScriptSource({scriptId:e}))?.bytecode;return n?Buffer.from(n,"base64").buffer:void 0}};Ka=P([(0,Hn.injectable)(),y(0,(0,Hn.inject)(ov)),y(1,(0,Hn.inject)(Ue)),y(2,(0,Hn.inject)(W)),y(3,(0,Hn.inject)(le))],Ka);var kG=r=>!!r?.externalURL;var Df=class{constructor(e,t,n){this.event=e;this.cdp=t;this.doDisassemble=ne(async()=>{let e=[],t;for await(let n of this.getDisassembledStream()){e=e.concat(n.lines);let i;if(t){let o=new Uint32Array(t.length+n.lines.length);i=t.length,o.set(t),t=o}else t=new Uint32Array(n.lines.length),i=0;for(let o=0;o<n.lines.length;o++)t[i+o]=n.bytecodeOffsets[o]}return t??=new Uint32Array(0),{lines:e,byteOffsetsOfLines:t}});this.decompiledUrl=Nf(e.url),n.push(this.decompiledUrl),this.files=n}async getDisassembly(){let{lines:e}=await this.doDisassemble();return this.onDidDisassemble?.(),e.join(`
`)}originalPositionFor(e){return this.disassembledPositionFor(e)}async disassembledPositionFor(e){let{byteOffsetsOfLines:t}=await this.doDisassemble(),n=FT(t,e.base0.columnNumber,(i,o)=>i-o);if(n!==t.length)return{url:this.decompiledUrl,position:new Oe(n,0)}}async compiledPositionFor(e,t){if(e!==this.decompiledUrl)return[];let{byteOffsetsOfLines:n}=await this.doDisassemble(),{lineNumber:i}=t.base0;if(i>=n.length)return[];let o=n[t.base0.lineNumber];return[new Oe(0,o)]}dispose(){}async*getDisassembledStream(){let{scriptId:e}=this.event,t=await this.cdp.Debugger.disassembleWasmModule({scriptId:e});if(t)for(yield t.chunk;t.streamId;){let n=await this.cdp.Debugger.nextWasmDisassemblyChunk({streamId:t.streamId});if(!n)return;yield n.chunk}}},iv=class extends Df{constructor(t,n,i,o,s){super(t,n,s);this.moduleId=i;this.worker=o;this.mappedLines=new Map}get codeOffset(){return this.event.codeOffset||0}async originalPositionFor(t){let n=await this.worker.rpc.sendMessage("rawLocationToSourceLocation",{codeOffset:t.base0.columnNumber-this.codeOffset,inlineFrameIndex:t.base0.lineNumber,rawModuleId:this.moduleId});return n.length?{position:new Oe(n[0].lineNumber,n[0].columnNumber),url:n[0].sourceFileURL}:super.originalPositionFor(t)}async compiledPositionFor(t,n){if(t===this.decompiledUrl)return super.compiledPositionFor(t,n);let{lineNumber:i,columnNumber:o}=n.base0,s=await this.worker.rpc.sendMessage("sourceLocationToRawLocation",{lineNumber:i,columnNumber:o===0?-1:o,rawModuleId:this.moduleId,sourceFileURL:t});if(o===0&&s.length===0){let a=await this.getMappedLines(t),c=a.find(u=>u>i);if(!a.includes(i)&&c)return this.compiledPositionFor(t,new Oe(c,0))}return s.filter(a=>a.rawModuleId===this.moduleId).map(a=>new Oe(0,this.codeOffset+a.startOffset))}dispose(){return this.worker.rpc.sendMessage("removeRawModule",this.moduleId)}async getVariablesInScope(t,n){let i={codeOffset:n.base0.columnNumber-this.codeOffset,inlineFrameIndex:n.base0.lineNumber,rawModuleId:this.moduleId};return(await this.worker.rpc.sendMessage("listVariablesInScope",i)).map(s=>({name:s.name,scope:s.scope,type:s.type,evaluate:async()=>{let a=await this.worker.rpc.sendMessage("evaluate",s.name,i,this.worker.getStopId(t));return a?new Of(a,this.worker.rpc):nR}}))}async getFunctionStack(t){let n=await this.worker.rpc.sendMessage("getFunctionInfo",{codeOffset:t.base0.columnNumber-this.codeOffset,inlineFrameIndex:t.base0.lineNumber,rawModuleId:this.moduleId});return"frames"in n?n.frames:[]}async getStepSkipList(t,n,i,o){if(i===this.decompiledUrl)return[];let s={codeOffset:n.base0.columnNumber-this.codeOffset,inlineFrameIndex:n.base0.lineNumber,rawModuleId:this.moduleId},a=()=>o&&i?this.worker.rpc.sendMessage("sourceLocationToRawLocation",{lineNumber:o.base0.lineNumber,columnNumber:-1,rawModuleId:this.moduleId,sourceFileURL:i}):[],c;switch(t){case 2:{c=await this.worker.rpc.sendMessage("getInlinedFunctionRanges",s);break}case 1:{let u=await Promise.all([this.worker.rpc.sendMessage("getInlinedCalleesRanges",s),a()]);c=Uo(u);break}case 0:c=await a();break;default:c=[];break}return c.map(u=>new Pt(new Oe(0,u.startOffset+this.codeOffset),new Oe(0,u.endOffset+this.codeOffset)))}async evaluate(t,n,i){try{let o=await this.worker.rpc.sendMessage("evaluate",i,{codeOffset:n.base0.columnNumber-this.codeOffset,inlineFrameIndex:n.base0.lineNumber,rawModuleId:this.moduleId},this.worker.getStopId(t));return o?new Of(o,this.worker.rpc):nR}catch(o){throw new O(ve(o.message))}}getMappedLines(t){let n=this.mappedLines.get(t);if(n)return n;let i=(async()=>{try{let o=await this.worker.rpc.sendMessage("getMappedLines",this.moduleId,t);return new Uint32Array(o?.sort((s,a)=>s-a)||[])}catch{return new Uint32Array}})();return this.mappedLines.set(t,i),i}},nR={type:"null",description:"no properties"},Of=class r{constructor(e,t){if(this.type=e.type,this.description=e.description,this.linearMemoryAddress=e.linearMemoryAddress,this.linearMemorySize=e.linearMemoryAddress,e.objectId&&e.hasChildren){let n=e.objectId;this.getChildren=ne(()=>this._getChildren(t,n))}}async _getChildren(e,t){return(await e.sendMessage("getProperties",t)).map(i=>({name:i.name,value:new r(i.value,e)}))}};var eo=Symbol("IScriptSkipper");function sR(r){return typeof r.lineNumber=="number"&&typeof r.columnNumber=="number"&&!!r.source}var aR=()=>({source:null,line:null,column:null,name:null,lastColumn:null,isSourceMapLoadFailure:!0}),DG=/\?t=[0-9]+$/,OG=r=>r.endsWith(".hot-update.js")||DG.test(r),MG={load:0,resolveLocation:2e3,sourceMapMinPause:1e3,output:1e3,sourceMapCumulativePause:1e4},cR=(r,e)=>e instanceof Xe&&e.compiledToSourceUrl.has(r);var uR=2**31-1,mt=class{constructor(e,t,n,i,o,s,a,c,u){this.sourceMapFactory=t;this.logger=n;this.launchConfig=i;this.initializeConfig=o;this.sourcePathResolver=s;this.scriptSkipper=a;this.resourceProvider=c;this.wasmSymbols=u;this.rootPaths=[];this.scriptsById=new Map;this.onSourceMappedSteppingChangeEmitter=new k;this.onScriptEmitter=new k;this._sourceByOriginalUrl=new Dn(e=>e.toLowerCase());this._sourceByReference=new Map;this._sourceMapSourcesByUrl=new Map;this._sourceByAbsolutePath=Ko();this._sourceMapTimeouts=MG;this._fileContentOverridesForTest=new Map;this._temporarilyDisabledSourceMaps=new Set;this._permanentlyDisabledSourceMaps=new Set;this.onScript=this.onScriptEmitter.event;this._statistics={fallbackSourceMapCount:0};this._doSourceMappedStepping=this.launchConfig.sourceMaps;this.onSourceMappedSteppingChange=this.onSourceMappedSteppingChangeEmitter.event;this._dap=e;let l="webRoot"in i?i.webRoot:i.rootPath;l&&(this.rootPaths=[l,cr(l,"..","ClientApp")]),a.setSourceContainer(this),this.setSourceMapTimeouts({...this.sourceMapTimeouts(),...i.timeouts})}get sources(){return this._sourceByReference.values()}statistics(){return this._statistics}get doSourceMappedStepping(){return this._doSourceMappedStepping}set doSourceMappedStepping(e){e!==this._doSourceMappedStepping&&(this._doSourceMappedStepping=e,this.onSourceMappedSteppingChangeEmitter.fire(e))}setSourceMapTimeouts(e){this._sourceMapTimeouts=e}sourceMapTimeouts(){return this._sourceMapTimeouts}setFileContentOverrideForTest(e,t){t===void 0?this._fileContentOverridesForTest.delete(e):this._fileContentOverridesForTest.set(e,t)}async loadedSources(){let e=[];for(let t of this._sourceByReference.values())e.push(t.toDap());return await Promise.all(e)}source(e){if(e.sourceReference)return this._sourceByReference.get(e.sourceReference);if(e.path)return this._sourceByAbsolutePath.get(e.path)}isSourceSkipped(e){return this.scriptSkipper.isScriptSkipped(e)}addScriptById(e){this.scriptsById.set(e.scriptId,e),"source"in e&&this.onScriptEmitter.fire(e)}getSourceScriptById(e){return this.scriptsById.get(e)}getScriptById(e){let t=this.scriptsById.get(e);return t&&"source"in t?t:void 0}getSourceByOriginalUrl(e){return this._sourceByOriginalUrl.get(e)}getSourceReference(e){let t=tv(e)&uR;for(let n=0;n<65535;n++){if(!this._sourceByReference.has(t))return t;t===uR&&(t=0),t++}return this.logger.assert(!1,"Max iterations exceeding for source reference assignment"),t}async preferredUiLocation(e){let t=!1,n=4;for(;;){let i=await this._originalPositionFor(e);if(!sR(i)){n=t?void 0:i;break}e=i,t=!0,n=void 0}return{...e,isMapped:t,unmappedReason:n}}async currentSiblingUiLocations(e,t){let n=await this._uiLocations(e);return t?n.filter(i=>i.source===t):n}clear(e){this.scriptsById.clear();for(let t of this._sourceByReference.values())this.removeSource(t,e);this._sourceByReference.clear(),this.sourceMapFactory instanceof Yi&&this.sourceMapFactory.invalidateCache()}async _uiLocations(e){let[t,n]=await Promise.all([this.getSourceMapUiLocations(e),this.getCompiledLocations(e)]);return[...t,e,...n]}async getSourceMapUiLocations(e){let t=await this._originalPositionFor(e);if(!sR(t))return[];let n=await this.getSourceMapUiLocations(t);return n.push(t),n}async _originalPositionFor(e){if(!Vt(e.source))return 1;let t=await qu.waitForValueWithTimeout(e.source.sourceMap,this._sourceMapTimeouts.resolveLocation);if(!t)return 2;if(this._doSourceMappedStepping)return this._originalPositionForMap(e,t);if(xb(t)){let n=await t.disassembledPositionFor(new Fe(e.lineNumber,e.columnNumber)),i=n&&e.source.sourceMap.sourceByUrl.get(n.url);if(i)return i?{columnNumber:n.position.base1.lineNumber,lineNumber:n.position.base1.lineNumber,source:i}:3}return 0}async _originalPositionForMap(e,t){let n=e.source;if(!Vt(n))return 1;if(this._temporarilyDisabledSourceMaps.has(n)||this._permanentlyDisabledSourceMaps.has(n))return 0;let i=await this.getOptiminalOriginalPosition(t,t0(e,n.inlineScriptOffset));if(!i)return 3;let o=n.sourceMap.sourceByUrl.get(i.url);if(!o)return 3;let s=i.position.base1;return{lineNumber:s.lineNumber,columnNumber:s.columnNumber,source:o}}async getCompiledLocations(e){if(!(e.source instanceof Xe))return[];let t=[];for(let[n,i]of e.source.compiledToSourceUrl){let o=await qu.waitForValueWithTimeout(n.sourceMap,this._sourceMapTimeouts.resolveLocation);if(!o)continue;let s;if("decompiledUrl"in o){let a=await o.compiledPositionFor(i,new Fe(e.lineNumber,e.columnNumber));if(!a)continue;s=a.map(c=>({lineNumber:c.base1.lineNumber,columnNumber:c.base1.columnNumber,source:n}))}else{let a=this.sourceMapFactory.guardSourceMapFn(o,()=>Yd(i,e,o),aR);if(!a||a.line===null)continue;let{lineNumber:c,columnNumber:u}=e0({lineNumber:a.line||1,columnNumber:(a.column||0)+1},n.inlineScriptOffset),l={lineNumber:c,columnNumber:u,source:n};s=[l,...await this.getCompiledLocations(l)]}t=t.concat(s)}return t}async getOptiminalOriginalPosition(e,t){if(xb(e))return await e.originalPositionFor(new Fe(t.lineNumber,t.columnNumber));let n=this.sourceMapFactory.guardSourceMapFn(e,()=>{let i=e.originalPositionFor({line:t.lineNumber,column:t.columnNumber-1,bias:An});return i.line!==null?i:e.originalPositionFor({line:t.lineNumber,column:t.columnNumber-1,bias:ha})},aR);if(!(n.column===null||n.line===null||n.source===null))return{position:new Jt(n.line,n.column),url:n.source}}async addSource(e,t,n,i,o,s){let a=await this.sourcePathResolver.urlToAbsolutePath({url:e.url});this.logger.verbose("runtime.sourcecreate","Creating source from url",{inputUrl:e.url,absolutePath:a});let c;return e.scriptLanguage==="WebAssembly"?c=new Qd(this,e,a):c=new Jo(this,e.url,a,t,n&&this.sourcePathResolver.shouldResolveSourceMap({sourceMapUrl:n,compiledPath:a||e.url})?{sourceMapUrl:n,compiledPath:a||e.url,cacheKey:e.hash}:void 0,i,o,s),this._addSource(c),c}async _addSource(e){let t=e.url&&this._sourceByOriginalUrl.get(e.url);t&&!cR(t,e)&&this.removeSource(t,!0),this._sourceByOriginalUrl.set(e.url,e),this._sourceByReference.set(e.sourceReference,e),e instanceof Xe&&this._sourceMapSourcesByUrl.set(e.url,e);let n=this._sourceByAbsolutePath.get(e.absolutePath);(n===void 0||n.url.length>=e.url.length||cR(n,e))&&this._sourceByAbsolutePath.set(e.absolutePath,e),this.scriptSkipper.initializeSkippingValueForSource(e),e.sendLazy||this.emitLoadedSource(e),Yo(e)?this._finishAddSourceWithSourceMap(e):Xo(e)&&this._finishAddSourceWithWasm(e)}async _finishAddSourceWithWasm(e){let t=await this.wasmSymbols.loadWasmSymbols(e.event),n=[];for(let i of t.files){let o,s,a;i===t.decompiledUrl?(o=Nf(e.absolutePath),s=Nf(e.url),a=()=>t.getDisassembly()):(o=await this.sourcePathResolver.urlToAbsolutePath({url:i}),s=o?ge(o):i,a=()=>this.resourceProvider.fetch(s).then(u=>u.body)),this.logger.verbose("runtime.sourcecreate","Creating wasm source from source map",{inputUrl:i,absolutePath:o,resolvedUrl:s});let c=new Xe(this,s,o,a);c.compiledToSourceUrl.set(e,i),e.sourceMap.sourceByUrl.set(i,c),n.push(this._addSource(c))}await Promise.all(n),e.sourceMap.value.resolve(t)}async _finishAddSourceWithSourceMap(e){let t=e.sourceMap.value,n;try{n=await this.sourceMapFactory.load(e.sourceMap.metadata)}catch(i){if(this.initializeConfig.clientID==="visualstudio"){let o=e.sourceMap.metadata.sourceMapUrl;try{let s=await this.sourcePathResolver.urlToAbsolutePath({url:o});s&&(e.sourceMap.metadata.sourceMapUrl=ge(s)),n=await this.sourceMapFactory.load(e.sourceMap.metadata),this._statistics.fallbackSourceMapCount++,this.logger.info("sourcemap.parsing","Failed to process original source-map; falling back to storage source-map",{fallbackSourceMapUrl:e.sourceMap.metadata.sourceMapUrl,originalSourceMapUrl:o,originalSourceMapError:nv(i)})}catch{}}if(n===void 0)return this._dap.output({output:nf(e.url,i.message).error.format+`
`,category:"stderr"}),t.resolve(void 0)}if(this._sourceByReference.get(e.sourceReference)!==e)return t.resolve(void 0);this.logger.verbose("sourcemap.parsing","Creating sources from source map",{sourceMapId:n.id,metadata:n.metadata});try{await this._addSourceMapSources(e,n)}finally{t.resolve(n)}this.scriptSkipper.initializeSkippingValueForSource(e)}removeSource(e,t=!1){let n=this._sourceByReference.get(e.sourceReference);if(n!==void 0){if(this.logger.assert(e===n,"Expected source to be the same as the existing reference"),this._sourceByReference.delete(e.sourceReference),this._sourceByOriginalUrl.get(e.url)===e&&this._sourceByOriginalUrl.delete(e.url),e instanceof Xe){this._sourceMapSourcesByUrl.delete(e.url);for(let[i,o]of e.compiledToSourceUrl)i.sourceMap.sourceByUrl.delete(o)}this._sourceByAbsolutePath.delete(e.absolutePath),Vt(e)&&(this._permanentlyDisabledSourceMaps.delete(e),this._temporarilyDisabledSourceMaps.delete(e)),!t&&e.hasBeenAnnounced&&e.toDap().then(i=>this._dap.loadedSource({reason:"removed",source:i})),Xo(e)&&e.sourceMap.value.promise.then(i=>i?.dispose()),Vt(e)&&this._removeSourceMapSources(e,t)}}emitLoadedSource(e){return e.hasBeenAnnounced=!0,e.toDap().then(t=>this._dap.loadedSource({reason:"new",source:t}))}async _addSourceMapSources(e,t){let n=[];for(let i of t.sources){if(i===null)continue;let o=await this.sourcePathResolver.urlToAbsolutePath({url:i,map:t}),s=o?ge(o):t.computedSourceUrl(i),a=this._sourceMapSourcesByUrl.get(s);if(e===a)continue;if(a)if(OG(e.url))this.removeSource(a);else{a.compiledToSourceUrl.set(e,i),e.sourceMap.sourceByUrl.set(i,a);continue}this.logger.verbose("runtime.sourcecreate","Creating source from source map",{inputUrl:i,sourceMapId:t.id,absolutePath:o,resolvedUrl:s});let c=o&&ge(o),u=this.sourceMapFactory.guardSourceMapFn(t,()=>t.sourceContentFor(i),()=>null),l;if(u){let d=Sa(u);if(d&&(!xt(d)&&o?l=$i(o?ge(o):i,d):l=d),o&&l){let f={sourceMapUrl:l,compiledPath:o};this.sourcePathResolver.shouldResolveSourceMap(f)||(l=void 0)}}let p=new Xe(this,s,o,u!==null?()=>Promise.resolve(u):c?()=>this.resourceProvider.fetch(c).then(d=>d.body):()=>e.content(),l?{compiledPath:o||s,sourceMapUrl:l,cacheKey:t.metadata.cacheKey}:void 0,void 0,e.runtimeScriptOffset);p.compiledToSourceUrl.set(e,i),e.sourceMap.sourceByUrl.set(i,p),n.push(this._addSource(p))}await Promise.all(n)}_removeSourceMapSources(e,t){for(let n of e.sourceMap.sourceByUrl.keys()){let i=e.sourceMap.sourceByUrl.get(n);i&&(e.sourceMap.sourceByUrl.delete(n),i.compiledToSourceUrl.delete(e),!i.compiledToSourceUrl.size&&this.removeSource(i,t))}}async waitForSourceMapSources(e){return Vt(e)?[...(await qu.waitForSources(e.sourceMap)).values()]:[]}async revealUiLocation(e){this._dap.revealLocationRequested({source:await e.source.toDap(),line:e.lineNumber,column:e.columnNumber})}disableSourceMapForSource(e,t=!1){t?this._permanentlyDisabledSourceMaps.add(e):this._temporarilyDisabledSourceMaps.add(e)}clearDisabledSourceMaps(e){e?this._temporarilyDisabledSourceMaps.delete(e):this._temporarilyDisabledSourceMaps.clear()}};mt=P([(0,Mr.injectable)(),y(0,(0,Mr.inject)(er)),y(1,(0,Mr.inject)(Ln)),y(2,(0,Mr.inject)(W)),y(3,(0,Mr.inject)(le)),y(4,(0,Mr.inject)(Dt)),y(5,(0,Mr.inject)(Ce)),y(6,(0,Mr.inject)(eo)),y(7,(0,Mr.inject)(Qo)),y(8,(0,Mr.inject)(Mf))],mt);var lR=r=>r.originalPosition.columnNumber===1&&r.originalPosition.lineNumber===1,pR=500,dR=Symbol("DontCompare");var Nr=class{constructor(e,t,n,i,o,s,a){this.logger=n;this.launchConfig=i;this.conditionFactory=o;this.suggester=s;this._breakpointsPredictor=a;this._resolvedBreakpoints=new Map;this._totalBreakpointsCount=0;this._launchBlocker=new Set;this._predictorDisabledForTest=!1;this._breakpointsStatisticsCalculator=new uf;this.entryBreakpointMode=0;this._enabledFilter=()=>!0;this._byDapId=new Map;this._byPath=Ko();this._byRef=new Map;this.moduleEntryBreakpoints=Ko();this._dap=e,this._sourceContainer=t,a?.onLongParse(()=>e.longPrediction({})),t.onScript(c=>{c.source.then(u=>{let l=this._thread;l&&this._byRef.get(u.sourceReference)?.forEach(p=>p.updateForNewLocations(l,c))})}),t.onSourceMappedSteppingChange(()=>{if(this._thread)for(let c of this._byDapId.values())c.refreshUiLocations(this._thread)}),this._scriptSourceMapHandler=async(c,u)=>{if(!n.assert(this._thread,"Expected thread to be set for the breakpoint source map handler"))return[];let l=[],p=[u];for(let d=0;d<p.length;d++)for(let f of p[d]){let h=f.absolutePath,m=h?this._byPath.get(h):void 0;for(let I of m||[])l.push(I.updateForNewLocations(this._thread,c));let b=this._byRef.get(f.sourceReference);for(let I of b||[])l.push(I.updateForNewLocations(this._thread,c));f.sourceMap&&p.push(f.sourceMap.sourceByUrl.values())}return Uo(await Promise.all(l))}}get appliedByPath(){return this._byPath}get appliedByRef(){return this._byRef}hasAtLocation(e){let t=this._byPath.get(e.source.absolutePath)||[],n=this._byRef.get(e.source.sourceReference)||[];return t.concat(n).some(i=>i.originalPosition.columnNumber===e.columnNumber&&i.originalPosition.lineNumber===e.lineNumber)}async moveBreakpoints(e,t,n,i){let o=l=>ZS(l,async p=>{let d=await this._sourceContainer.getOptiminalOriginalPosition(n,p.originalPosition);if(!d)return!1;let f=d.position.base1;return p.updateSourceLocation(e,{path:i.absolutePath,sourceReference:i.sourceReference},{lineNumber:f.lineNumber,columnNumber:f.columnNumber,source:i}),!1}),s=t.absolutePath,a=i.absolutePath,c=s?this._byPath.get(s):void 0;if(c&&a){let[l,p]=await o(c);this._byPath.set(s,l),this._byPath.set(a,p)}let u=this._byRef.get(t.sourceReference);if(u){let[l,p]=await o(u);this._byRef.set(t.sourceReference,l),this._byRef.set(i.sourceReference,p)}}async updateEntryBreakpointMode(e,t){if(t===this.entryBreakpointMode)return;let n=[...this.moduleEntryBreakpoints.values()];this.moduleEntryBreakpoints.clear(),this.entryBreakpointMode=t,await Promise.all(n.map(i=>this.ensureModuleEntryBreakpoint(e,i.source)))}async applyEnabledFilter(e,t=dR){if(t!==dR&&this._enabledFilter!==t)return;this._enabledFilter=e||(()=>!0);let n=this._thread;n&&await Promise.all([...this._byDapId.values()].map(i=>this._enabledFilter(i)?i.enable(n):i.disable()))}async getBreakpointLocations(e,t,n,i){let o=n.base1,s=i.base1,[a,c]=await Promise.all([this._sourceContainer.currentSiblingUiLocations({source:t,lineNumber:o.lineNumber,columnNumber:o.columnNumber}),this._sourceContainer.currentSiblingUiLocations({source:t,lineNumber:s.lineNumber,columnNumber:s.columnNumber})]);if(a.length!==c.length)return this.logger.warn("internal","Expected to have the same number of start and end locations"),[];let u=[],l=[];for(let p=0;p<a.length;p++){let d=a[p],f=c[p];if(d.source!==f.source){this.logger.warn("internal","Expected to have the same number of start and end scripts");continue}let h=d.source;if(!h.scripts.length)continue;let{scriptId:m}=h.scripts[h.scripts.length-1];u.push(e.cdp().Debugger.getPossibleBreakpoints({restrictToFunction:!1,start:{scriptId:m,...h.offsetSourceToScript(gi(d))},end:{scriptId:m,...h.offsetSourceToScript(gi(f))}}).then(b=>{if(b?.locations)return Promise.all(b.locations.map(async I=>{let{lineNumber:D,columnNumber:B=0}=I,Z=await this._sourceContainer.currentSiblingUiLocations({source:h,...h.offsetScriptToSource(r0({lineNumber:D,columnNumber:B}))});l.push({breakLocation:I,uiLocations:Z})}))}))}return await Promise.all(u),l}setThread(e){this._thread=e,this._thread.cdp().Debugger.on("breakpointResolved",t=>{let n=this._resolvedBreakpoints.get(t.breakpointId);n&&n.updateUiLocations(e,t.breakpointId,[t.location])}),this._thread.setSourceMapDisabler(t=>{let n=[];for(let i of t){let o=this._resolvedBreakpoints.get(i);if(o){let s=this._sourceContainer.source(o.source);Vt(s)&&n.push(s)}}return n});for(let t of this._byPath.values())t.forEach(n=>this._setBreakpoint(n,e)),this.ensureModuleEntryBreakpoint(e,t[0]?.source);for(let t of this._byRef.values())t.forEach(n=>this._setBreakpoint(n,e));"runtimeSourcemapPausePatterns"in this.launchConfig&&this.launchConfig.runtimeSourcemapPausePatterns.length&&this.setRuntimeSourcemapPausePatterns(e,this.launchConfig.runtimeSourcemapPausePatterns),this._byDapId.size>0&&this._installSourceMapHandler(this._thread)}async launchBlocker(){lf(this.logger,"BreakpointManager.launchBlocker",async()=>{this._predictorDisabledForTest||await Promise.all([...this._launchBlocker])})}setRuntimeSourcemapPausePatterns(e,t){return Promise.all(t.map(n=>this._setBreakpoint(new rl(this,n),e)))}addLaunchBlocker(...e){for(let t of e)this._launchBlocker.add(t),t.finally(()=>this._launchBlocker.delete(t))}setPredictorDisabledForTest(e){this._predictorDisabledForTest=e}_installSourceMapHandler(e){let t=this.launchConfig.perScriptSourcemaps==="yes",n;t?n=Promise.all([this.updateEntryBreakpointMode(e,1),e.setScriptSourceMapHandler(!1,this._scriptSourceMapHandler)]).then(()=>!0):this._breakpointsPredictor&&!this.launchConfig.pauseForSourceMap?n=e.setScriptSourceMapHandler(!1,this._scriptSourceMapHandler):n=e.setScriptSourceMapHandler(!0,this._scriptSourceMapHandler),this._sourceMapHandlerInstalled={entryBpSet:n}}async _uninstallSourceMapHandler(e){e.setScriptSourceMapHandler(!1),this._sourceMapHandlerInstalled=void 0}_setBreakpoint(e,t){this._enabledFilter(e)&&this.addLaunchBlocker(Promise.race([ue(pR),e.enable(t)]))}async setBreakpoints(e,t){!this._sourceMapHandlerInstalled&&this._thread&&e.breakpoints?.length&&this._installSourceMapHandler(this._thread);let n=await this._sourceMapHandlerInstalled?.entryBpSet;e.source.path=We(e.source.path,!0);let i=this._sourceContainer.source(e.source);if(!n&&this._breakpointsPredictor&&!i){let l=this._breakpointsPredictor.predictBreakpoints(e);this.addLaunchBlocker(l),await l}let o=this._thread;if(o?.debuggerReady.hasSettled()===!1){let l=o.debuggerReady.promise;this.addLaunchBlocker(l),await l}let s=l=>{let p={unbound:l.slice(),new:[],list:[]};if(!e.breakpoints)return p;for(let d=0;d<e.breakpoints.length;d++){let f=e.breakpoints[d],h;try{h=new Dr(this,t[d],e.source,f,this.conditionFactory.getConditionFor(f))}catch(I){if(!(I instanceof O))throw I;this._dap.output({category:"stderr",output:I.message}),h=new _f(this,t[d],e.source,f)}let m=p.unbound.findIndex(I=>I.equivalentTo(h)),b=p.unbound[m];b?.equivalentTo?.(h)?(p.list.push(b),p.unbound.splice(m,1)):(p.new.push(h),p.list.push(h),this._byDapId.set(h.dapId,h))}return p},a=()=>e.source.sourceReference?this._byRef.get(e.source.sourceReference):e.source.path?this._byPath.get(e.source.path):void 0,c=s(a()??[]);if(e.source.sourceReference)this._byRef.set(e.source.sourceReference,c.list);else if(e.source.path)this._byPath.set(e.source.path,c.list);else return{breakpoints:[]};if(c.unbound.length===0&&c.new.length===0)return{breakpoints:[]};if(this._totalBreakpointsCount-=c.unbound.length,await Promise.all(c.unbound.map(l=>(this._byDapId.delete(l.dapId),l.disable()))),this._totalBreakpointsCount+=c.new.length,this._thread&&(this._totalBreakpointsCount===0&&this._sourceMapHandlerInstalled?this._uninstallSourceMapHandler(this._thread):this._totalBreakpointsCount>0&&!this._sourceMapHandlerInstalled&&this._installSourceMapHandler(this._thread)),o&&c.new.length){this.ensureModuleEntryBreakpoint(o,e.source);let l=a(),p=Promise.all(c.new.filter(this._enabledFilter).filter(d=>l?.includes(d)).map(d=>d.enable(o)));this.addLaunchBlocker(Promise.race([ue(pR),p])),await p}let u=await Promise.all(c.list.map(l=>l.toDap()));return this._breakpointsStatisticsCalculator.registerBreakpoints(u),ue(0).then(()=>c.new.forEach(l=>l.markSetCompleted())),{breakpoints:u}}async notifyBreakpointChange(e,t){if(!this._byDapId.has(e.dapId))return;let n=await e.toDap();n.verified&&(this._breakpointsStatisticsCalculator.registerResolvedBreakpoint(e.dapId),this.suggester.notifyVerifiedBreakpoint()),t&&this._dap.breakpoint({reason:"changed",breakpoint:n})}isEntrypointBreak(e,t){return[...this.moduleEntryBreakpoints.values()].some(i=>i.enabled&&i.cdpScriptIds.has(t))?!0:e.some(i=>{let o=this._resolvedBreakpoints.get(i);return o&&(o instanceof qn||lR(o))})}async disableEntrypointBreaks(e){await Promise.all([...this.moduleEntryBreakpoints.values()].map(t=>{if(t.enabled&&t.cdpScriptIds.has(e))return t.disable()}))}isEntrypointCdpBreak(e){return this._resolvedBreakpoints.get(e)instanceof qn}async shouldPauseAt(e,t,n,i=!1){if(!t.length)return e.reason!=="instrumentation";let o=0,s=i?1:0;return await Promise.all(t.map(async a=>{if(n?.cdpId===a){o++;return}let c=this._resolvedBreakpoints.get(a);if(c instanceof qn){this.entryBreakpointMode===0&&!(c instanceof rl)&&c.disable(),s++;return}c instanceof Dr&&(await c.testHitCondition(e)?o++:s++)})),o>0||s===0}registerBreakpointsHit(e){for(let t of e){let n=this._resolvedBreakpoints.get(t);n instanceof Dr&&this._breakpointsStatisticsCalculator.registerBreakpointHit(n.dapId)}}statisticsForTelemetry(){return this._breakpointsStatisticsCalculator.statistics()}ensureModuleEntryBreakpoint(e,t){if(!t.path||(this._byPath.get(t.path)??[]).some(lR))return;let i=qn.getModeKeyForSource(this.entryBreakpointMode,t.path);if(!t.path||this.moduleEntryBreakpoints.has(i))return;let o=new qn(this,t,this.entryBreakpointMode);this.moduleEntryBreakpoints.set(t.path,o),this._setBreakpoint(o,e)}executionContextWasCleared(){for(let e of this._byDapId.values())e.executionContextWasCleared()}async reapply(){let e=[...this._byDapId.values()];if(await Promise.all(e.map(t=>t.disable())),this._thread){let t=this._thread;await Promise.all(e.map(n=>n.enable(t)))}}};Nr=P([(0,Gn.injectable)(),y(0,(0,Gn.inject)(er)),y(1,(0,Gn.inject)(mt)),y(2,(0,Gn.inject)(W)),y(3,(0,Gn.inject)(le)),y(4,(0,Gn.inject)(gf)),y(5,(0,Gn.inject)(je)),y(6,(0,Gn.inject)(os))],Nr);var IA=g("crypto"),rc=S(G());var Ae=class r{static{this.Undefined=new r(void 0)}constructor(e){this.element=e,this.next=r.Undefined,this.prev=r.Undefined}},ol=class{constructor(){this._first=Ae.Undefined;this._last=Ae.Undefined;this._size=0}get size(){return this._size}isEmpty(){return this._first===Ae.Undefined}clear(){let e=this._first;for(;e!==Ae.Undefined;){let t=e.next;e.prev=Ae.Undefined,e.next=Ae.Undefined,e=t}this._first=Ae.Undefined,this._last=Ae.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let n=new Ae(e);if(this._first===Ae.Undefined)this._first=n,this._last=n;else if(t){let o=this._last;this._last=n,n.prev=o,o.next=n}else{let o=this._first;this._first=n,n.next=o,o.prev=n}this._size+=1;let i=!1;return()=>{i||(i=!0,this._remove(n))}}shift(){if(this._first!==Ae.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Ae.Undefined){let e=this._last.element;return this._remove(this._last),e}}applyFilter(e){let t=this._first;for(;t!==Ae.Undefined;){let n=t.next;e(t.element)||this._remove(t),t=n}}_remove(e){if(e.prev!==Ae.Undefined&&e.next!==Ae.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Ae.Undefined&&e.next===Ae.Undefined?(this._first=Ae.Undefined,this._last=Ae.Undefined):e.next===Ae.Undefined?(this._last=this._last.prev,this._last.next=Ae.Undefined):e.prev===Ae.Undefined&&(this._first=this._first.next,this._first.prev=Ae.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Ae.Undefined;)yield e.element,e=e.next}};var Yf=S(G());var zn=class extends O{constructor(e){super({id:9243,format:e,showUser:!0}),this._cause={id:9243,format:e,showUser:!0}}};function Kn(r,e,t){if(e.isCancellationRequested)return Promise.reject(new zn(t||"Task cancelled"));let n=be(),i=e.onCancellationRequested(n.resolve);return Promise.race([n.promise.then(()=>{throw new zn(t||"Task cancelled")}),r.then(o=>(i.dispose(),o)).catch(o=>{throw i.dispose(),o})])}function fR(r,e){let t=new ut(e),n=r.map(async i=>{try{return await i(t.token)}finally{t.cancel()}});return Promise.race(n)}var hR=Object.freeze(function(r,e){let t=setTimeout(r.bind(e),0);return{dispose(){clearTimeout(t)}}}),Ht=Object.freeze({isCancellationRequested:!1,onCancellationRequested:()=>({dispose:()=>{}})}),LG=Object.freeze({isCancellationRequested:!0,onCancellationRequested:hR}),ut=class r{constructor(e){this._token=void 0;this._parentListener=void 0;this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}static withTimeout(e,t){let n=new r(t),i=n._token=new Ja,o=setTimeout(()=>i.cancel(),e);return i.onCancellationRequested(()=>clearTimeout(o)),n}get token(){return this._token||(this._token=new Ja),this._token}cancel(){this._token?this._token instanceof Ja&&this._token.cancel():this._token=LG}dispose(e=!1){e&&this.cancel(),this._parentListener&&this._parentListener.dispose(),this._token?this._token instanceof Ja&&this._token.dispose():this._token=Ht}},Ja=class{constructor(){this._isCancelled=!1;this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?hR:(this._emitter||(this._emitter=new k),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}};var vA=S(g("net"));var G3=S(bR(),1),z3=S(gv(),1),K3=S(bv(),1),gA=S(Cv(),1),Tv=S(mA(),1);var yA=gA.default;var bA=(r,e)=>r+Math.floor(Math.random()*(e-r));async function Jf({min:r=53e3,max:e=54e3,attempts:t=1e3,tester:n=Y3}={},i=Ht){let o=bA(r,e);for(let s=Math.min(t,e-r);;s--)try{return await n(o,i)}catch(a){if(s===0||a instanceof zn)throw a;o=o===e-1?r:o+1}}function Y3(r,e=Ht){let t;return new Promise((n,i)=>{let o=vA.createServer();o.listen(r,"127.0.0.1",()=>{let s=o.address();o.close(()=>n(s.port))}),o.on("error",i),t=e.onCancellationRequested(()=>{o.close(),i(new zn("Port open lookup cancelled"))})}).finally(()=>t?.dispose())}var _A=r=>(e,t)=>wA(new Tv.default({host:"127.0.0.1",...r,port:e}),t),wA=(r,e)=>{let t;return new Promise((n,i)=>{r.on("error",i),r.on("listening",()=>n(r)),t=e.onCancellationRequested(()=>{r.close(),i(new zn("Port open lookup cancelled"))})}).finally(()=>t?.dispose())};var Xf=async(r,e,t)=>{let n=await Jf({tester:_A(e)},t),i=r.register(n.address().port);return n.on("close",()=>i.dispose()),n.on("error",()=>i.dispose()),n},Fr=Symbol("IPortLeaseTracker"),ec=class{constructor(e){this.usedPorts=new Set;this.onRegistered=new k;this.isMandated=e==="remote"}register(e){return this.usedPorts.add(e),this.onRegistered.fire(e),{dispose:()=>this.usedPorts.delete(e)}}isRegistered(e,t=2e3){return this.usedPorts.has(e)?Promise.resolve(!0):e<53e3||e>=54e3?Promise.resolve(!1):fR([()=>ue(t).then(()=>!1),n=>new Promise(i=>{let o=this.onRegistered.event(s=>{s===e&&i(!0)});n.onCancellationRequested(()=>o.dispose())})])}};ec=P([(0,Yf.injectable)(),y(0,(0,Yf.inject)(yi))],ec);var SA="JsDebug",xA="*";var Ev=class{constructor(){this.replays=new Map}addReplay(e,t,n){let i=this.replays.get(e);return i||(i=new ol,this.replays.set(e,i)),i.push({event:`${e}.${t}`,params:n})}capture(e,t,n,i){let o=e[t];if(i===0)o.on(n,s=>this.addReplay(t,n,s));else if(i===2){let s;o.on(n,a=>{s?.(),s=this.addReplay(t,n,a)})}else{let s=new ol;o.on(n,a=>{s.size===i.cap&&s.shift()?.(),s.push(this.addReplay(t,n,a))})}}filter(e,t){let n=this.replays.get(e);n&&n.applyFilter(t)}clearEvent(e,t){let n=`${e}.${t}`;this.filter(e,i=>i.event!==n)}clearDomain(e){this.replays.delete(e)}read(e){return this.replays.get(e)??[]}},Qf=Symbol("ICdpProxyProvider"),tc=class{constructor(e,t,n){this.cdp=e;this.portTracker=t;this.logger=n;this.disposables=new De;this.replay=new Ev;this.jsDebugApi={subscribe:(e,{events:t})=>{for(let n of t)n.endsWith(xA)?e.pushDisposable(this.cdp.session.onPrefix(n.slice(0,-xA.length),i=>e.send({method:i.method,params:i.params}))):e.pushDisposable(this.cdp.session.on(n,i=>e.send({method:n,params:i})));return{}}};this.replay.capture(e,"CSS","styleSheetAdded",0),this.replay.capture(e,"Debugger","paused",2),this.replay.capture(e,"Runtime","executionContextCreated",{cap:50,type:1}),this.replay.capture(e,"Runtime","consoleAPICalled",{cap:50,type:1}),e.Debugger.on("resumed",()=>{this.replay.clearEvent("Debugger","paused")}),e.CSS.on("fontsUpdated",i=>{i.font&&this.replay.addReplay("CSS","fontsUpdated",i)}),e.CSS.on("styleSheetRemoved",i=>this.replay.filter("CSS",o=>o.params.styleSheetId!==i.styleSheetId))}async proxy(){this.server||(this.server=this.createServer());let{server:e,path:t}=await this.server,n=e.address();return{host:n.address,port:n.port,path:t}}async createServer(){let e=`/${(0,IA.randomBytes)(20).toString("hex")}`,t=await Xf(this.portTracker,{perMessageDeflate:!0,path:e});return this.logger.info("proxyActivity","activated cdp proxy"),t.on("connection",n=>{let i=new Rv(n,this.logger);this.logger.info("proxyActivity","accepted proxy connection",{id:i.id}),n.on("close",()=>{this.logger.verbose("proxyActivity","closed proxy connection",{id:i.id}),this.disposables.disposeObject(i)}),n.on("message",async o=>{let s;try{s=JSON.parse(o.toString())}catch(d){return i.send({id:0,error:{code:-32700,message:d.message}})}this.logger.verbose("proxyActivity","received proxy message",s);let{method:a,params:c,id:u=0}=s,[l,p]=a.split(".");try{let d=l===SA?await this.invokeJsDebugDomainMethod(i,p,c):await this.invokeCdpMethod(i,l,p,c);i.send({id:u,result:d})}catch(d){let f=d instanceof ss&&d.cause?d.cause:{code:0,message:d.message};i.send({id:u,error:f})}})}),{server:t,path:e}}dispose(){this.disposables.dispose(),this.server?.then(e=>e.server.close()),this.server=void 0}invokeCdpMethod(e,t,n,i){let o=this.cdp.session.sendOrDie(`${t}.${n}`,i);switch(n){case"enable":for(let s of this.replay.read(t))e.send({method:s.event,params:s.params});break;case"disable":this.replay.clearDomain(t);break;default:}return o}invokeJsDebugDomainMethod(e,t,n){if(!this.jsDebugApi.hasOwnProperty(t))throw new ss(t).setCause(-32601,`${SA}.${t} not found`);return this.jsDebugApi[t](e,n)}};tc=P([(0,rc.injectable)(),y(0,(0,rc.inject)(Ue)),y(1,(0,rc.inject)(Fr)),y(2,(0,rc.inject)(W))],tc);var X3=0,Rv=class{constructor(e,t){this.webSocket=e;this.logger=t;this.disposables=new De;this.id=X3++}pushDisposable(e){this.disposables.push(e)}dispose(){this.disposables.dispose(),this.webSocket.close()}send(e){this.logger.verbose("proxyActivity","send proxy message",e),this.webSocket.send(JSON.stringify(e))}};var CA=S(G());var gl=Symbol("IClientCapabilies"),io=class{};io=P([(0,CA.injectable)()],io);var TA=g("./vendor/acorn-loose.js"),yl=S(G());var Av=nt(function(r,e,t){let n=t?"variable":"property",i=(l,p,d)=>{if(p!=="function")return n;if(l==="constructor")return"class";let f=String(d);return f.startsWith("class ")||f.includes("[native code]")&&/^[A-Z]/.test(l)?"class":t?"function":"method"},o=l=>{switch(typeof l){case"number":case"boolean":return`${l}`;case"object":return l===null?"null":l.constructor.name||"object";case"function":return`fn(${new Array(l.length).fill("?").join(", ")})`;default:return typeof l}},s=[],a=new Set,c="~",u=r===void 0?this:r;for(;u!=null;u=u.__proto__){c+="~";let l=Object.getOwnPropertyNames(u).filter(p=>p.startsWith(e)&&!p.match(/^\d+$/));for(let p of l){if(a.has(p))continue;a.add(p);let d=Object.getOwnPropertyDescriptor(u,p),f=n,h;try{let m=u[p];f=i(p,typeof d?.value,m),h=o(m)}catch{}s.push({label:p,sortText:c+p.replace(/^_+/,m=>"{".repeat(m.length)),type:f,detail:h})}t=!1}return{result:s,isArray:this instanceof Array}}),PA=hi(Av.source);var Q3=r=>{switch(r.type){case"ClassDeclaration":case"ClassExpression":return{type:"class",id:r.id};case"MethodDefinition":return{type:r.key?.type==="Identifier"&&r.key.name==="constructor"?"constructor":"method",id:r.key};case"VariableDeclarator":return{type:r.init?.type==="FunctionExpression"||r.init?.type==="ArrowFunctionExpression"?"function":"variable",id:r.id}}};function Z3(r){let e=!1;return Vi(r,{enter(t){if(t.type==="CallExpression"||t.type==="NewExpression"||t.type==="UnaryExpression"&&t.operator==="delete"||t.type==="ClassBody")return e=!0,0}}),e}var Zf=Symbol("ICompletions"),nc=class{constructor(e,t){this.evaluator=e;this.cdp=t}async completions(e){let t=kn(e.expression),n=new Hi(e.expression).convert(e.position),i=()=>Promise.resolve([]);return Vi(t,{enter:(o,s)=>{let a=o;if(a.start<n&&n<=a.end){if(o.type==="MemberExpression"||o.type==="Identifier"&&s?.type==="MemberExpression"&&!s.computed&&s.object!==o){let c=o.type==="MemberExpression"?o:s;i=c.computed?()=>this.elementAccessCompleter(e,c,n):()=>this.propertyAccessCompleter(e,c,n)}else o.type==="Identifier"&&(i=()=>this.identifierCompleter(e,t,o,n));s=o}}}),i().then(o=>o.sort((s,a)=>s.sortText>a.sortText?1:-1))}async elementAccessCompleter(e,t,n){if(t.property.type!=="Literal"||typeof t.property.value!="string")return[];let i=e.expression.slice(Wi(t.property)+1,n);return(await this.defaultCompletions(e,i)).filter(s=>s.sortText!=="~~[").map(s=>({...s,text:JSON.stringify(s.text??s.label)+"]",start:Wi(t.property),length:fb(t.property)-Wi(t.property)}))}async identifierCompleter(e,t,n,i){let o=[],s=Wi(n);Vi(t,{enter(u){let l=Q3(u);l?.id?.type==="Identifier"&&o.push({label:l.id.name,type:l.type,sortText:l.id.name})}});let a=e.expression.slice(s,i),c=[...o,...await this.defaultCompletions(e,a)];this.evaluator.hasReturnValue&&e.executionContextId!==void 0&&vi.startsWith(a)&&c.push({sortText:`~${vi}`,label:vi,type:"variable"});for(let u of c)u.start=s,u.length=i-s;return c}async propertyAccessCompleter(e,t,n){let{result:i,isArray:o}=await this.completePropertyAccess({executionContextId:e.executionContextId,stackFrame:e.stackFrame,expression:ET(e.expression,t.object),prefix:(0,TA.isDummy)(t.property)?"":e.expression.slice(Wi(t.property),n),throwOnSideEffect:Z3(t)}),s=Wi(t.property)-1,a=/^[$a-z_][0-9a-z_$]*$/i;for(let c of i)a.test(c.label)||(c.text=`[${JSON.stringify(c.label)}]`,c.start=s,c.length=1);if(o){let c="index";i.unshift({label:`[${c}]`,text:`[${c}]`,type:"property",sortText:"~~[",start:s,selectionStart:1,selectionLength:c.length,length:1})}return i}async completePropertyAccess({executionContextId:e,stackFrame:t,expression:n,prefix:i,isInGlobalScope:o=!1,throwOnSideEffect:s=!1}){let a={expression:`(${n})`,objectGroup:"console",silent:!0,throwOnSideEffect:s},c=t&&t.callFrameId(),u=await this.evaluator.evaluate(c?{...a,callFrameId:c}:{...a,contextId:e},{stackFrame:t});if(!u||u.exceptionDetails)return{result:[],isArray:!1};if(!u.result.objectId){let l={...a,returnByValue:!0,throwOnSideEffect:!1,expression:PA.expr(`(${n})`,JSON.stringify(i),JSON.stringify(o))},p=await this.evaluator.evaluate(c?{...l,callFrameId:c}:{...l,contextId:e});return!p||p.exceptionDetails?{result:[],isArray:!1}:p.result.value}try{return(await Av({cdp:this.cdp,args:[void 0,i,o],objectId:u.result.objectId,returnByValue:!0})).value}catch{return{result:[],isArray:!1}}finally{this.cdp.Runtime.releaseObject({objectId:u.result.objectId})}}async defaultCompletions(e,t=""){for(let n of["self","global","this"]){let{result:i}=await this.completePropertyAccess({executionContextId:e.executionContextId,stackFrame:e.stackFrame,expression:n,prefix:t,isInGlobalScope:!0});if(e.stackFrame){let o=t.toLowerCase(),s=new Set(i.map(a=>a.label));for(let a of await e.stackFrame.completions())s.has(a.label)||!a.label.toLowerCase().includes(o)||(s.add(a.label),i.push(a))}return i.push(...this.syntheticCompletions(e,t)),i}return this.syntheticCompletions(e,t)}syntheticCompletions(e,t){return this.evaluator.hasReturnValue&&vi.startsWith(t)?[{sortText:`~${vi}`,label:vi,type:"variable"}]:[]}};nc=P([(0,yl.injectable)(),y(0,(0,yl.inject)(kr)),y(1,(0,yl.inject)(Ue))],nc);var EA=/^(\W*at .*\()(.*):(\d+):(\d+)(\))$/,RA=/^(\W*at )(.*):(\d+):(\d+)$/,oo=class{constructor(e){this.stack=e}static isStackLike(e){return EA.test(e)||RA.test(e)}*[Symbol.iterator](){for(let e of this.stack.split(`
`)){let t=EA.exec(e)||RA.exec(e);if(!t){yield e+`
`;continue}let[,n,i,o,s,a]=t;n&&(yield n),yield new kv(i,new Fe(Number(o),Number(s))),a&&(yield a),yield`
`}}},kv=class{constructor(e,t){this.path=e;this.position=t}toString(){return`${this.path}:${this.position.lineNumber}:${this.position.columnNumber}`}};var Yn=class{constructor(e,t){this._tokens=[];this._separator=t||"",this._budget=e-1-this._separator.length}append(e){if(e.length>this.budget()){this.appendEllipsis();return}this._append(e)}_append(e){this._tokens.length&&(this._budget-=this._separator.length),this._tokens.push(e),this._budget-=e.length}appendEllipsis(){this._tokens[this._tokens.length-1]!=="\u2026"&&this._append("\u2026")}checkBudget(){return this._budget<=0&&this.appendEllipsis(),this._budget>0}budget(){return this._budget-(this._tokens.length?this._separator.length:0)}build(){return this._tokens.join(this._separator)}isEmpty(){return!this._tokens.length}};var ZA=S(XA());var m4=1e4;function g4(r,e){if(!r.includes("%"))return[{type:"string",value:r}];let t=[];function n(c){if(!c)return;let u=t[t.length-1];u?.type==="string"?u.value+=c:t.push({type:"string",value:c})}function i(c,u,l){t.push({type:"specifier",specifier:c,precision:u,substitutionIndex:l})}let o=0,s=0,a=new RegExp(`%%|%(?:(\\d+)\\$)?(?:\\.(\\d*))?([${e.join("")}])`,"g");for(let c=a.exec(r);c;c=a.exec(r)){let u=c.index;if(u>o&&n(r.substring(o,u)),c[0]==="%%")n("%");else{let[,l,p,d]=c;l&&Number(l)>0&&(s=Number(l)-1);let f=p?Number(p):void 0;i(d,f,s),++s}o=u+c[0].length}return n(r.substring(o)),t}function Lv(r,e,t){let n=g4(r,Array.from(t.keys())),i=new Set,o=t.get("");if(!o)throw new Error("Expected to hav a default formatter");let s=new Yn(m4),a=!1;for(let c=0;s.checkBudget()&&c<n.length;++c){let u=n[c];if(u.type==="string"){s.append(u.value);continue}let l=u.substitutionIndex;if(l>=e.length){s.append("%"+(u.precision||"")+u.specifier);continue}i.add(l),u.specifier==="c"&&(a=!0);let p=t.get(u.specifier)||o;s.append(p(e[l],{budget:s.budget(),quoted:!1,ansi:!0}))}a&&s.append("\x1B[0m");for(let c=0;s.checkBudget()&&c<e.length;++c)i.has(c)||(i.add(c),(r||c)&&s.append(" "),s.append(o(e[c],{budget:s.budget(),quoted:!1,ansi:!0})));return{result:s.build(),usedAllSubs:i.size===e.length}}function QA(r){try{return new ZA.default(r).ansi256().object().ansi256}catch{}}function ek(r){let e=/\s*(.*?)\s*:\s*(.*?)\s*(?:;|$)/g,t="\x1B[0m",n=e.exec(r);for(;n!==null;){if(n.length===3)switch(n[1]){case"color":let i=QA(n[2]);i&&(t+=`\x1B[38;5;${i}m`);break;case"background":case"background-color":let o=QA(n[2]);o&&(t+=`\x1B[48;5;${o}m`);break;case"font-weight":n[2]==="bold"&&(t+="\x1B[1m");break;case"font-style":n[2]==="italic"&&(t+="\x1B[3m");break;case"text-decoration":n[2]==="underline"&&(t+="\x1B[4m");break;default:}n=e.exec(r)}return t}var rk=r=>r.replace(/\n/gm,"\\n").replace(/\r/gm,"\\r").replace(/\t/gm,"\\t"),b4={budget:1e5,quoted:!0},tk={budget:1e3,quoted:!0,postProcess:rk},v4={budget:1/0,quoted:!1},_4={budget:1e3,quoted:!0,postProcess:rk},w4={budget:1e5,quoted:!0},ih=r=>{switch(r){case"repl":return b4;case"hover":return tk;case"propertyValue":return tk;case"watch":return _4;case"copy":case"clipboard":return v4;default:return w4}};var S4=30,x4=100,Fv=20,I4=1e4,C4=3,nk=120,Bv=new Set(["null","regexp","date"]);function hs(r){return r.type==="function"||r.type==="object"&&!Bv.has(r.subtype)}function Uv(r){return r.subtype==="array"||r.subtype==="typedarray"}function ms(r,e,t){let n=ih(e),i=oh(r,n,t);return r.preview?.subtype==="regexp"?i:n.postProcess?.(i)??i}function oh(r,e,t){return r.type==="function"?r.description?uk(r.description,e.budget):"<function>":r.type==="object"&&r.subtype==="node"?r.description:"preview"in r&&r.preview?sh(r.preview,e.budget,t):ck(r,e,t)}function sh(r,e,t){return Uv(r)?P4(r,e):r.subtype==="internal#entry"?On(r.description||"",e):r.type==="function"?uk(r.description,e):hs(r)?T4(r,e,t):R4(r,e,t)}function P4(r,e){let t=new Yn(e),n=r.description,i=n.match(/[^(]*\(([\d]+)\)/);if(!i)return n;let o=parseInt(i[1],10);n.startsWith("Array(")&&(n=n.substring(5)),t.append(On(n,t.budget())),t.append(" ");let s=new Yn(t.budget()-2,", "),a=-1;for(let c of r.properties){if(!s.checkBudget())break;if(isNaN(c.name))continue;let u=parseInt(c.name,10);u>a+1&&s.appendEllipsis(),a=u,s.append(wl(c,s.budget()))}o>a+1&&s.appendEllipsis();for(let c of r.properties){if(!s.checkBudget())break;isNaN(c.name)&&s.append(wl(c,s.budget(),c.name))}return r.overflow&&s.appendEllipsis(),t.append("["+s.build()+"]"),t.build()}function T4(r,e,t){let n=new Yn(e," ");r.description!=="Object"&&n.append(On(r.description,n.budget()));let i=new Map,o=r.properties||[];for(let d of o)i.set(d.name,d);let s=i.get("[[PrimitiveValue]]");if(s)return n.append(`(${wl(s,n.budget()-2)})`),n.build();let a=i.get("[[PromiseStatus]]"),c=i.get("[[PromiseValue]]");if(a&&c)return a.value==="pending"?n.append(`{<${a.value}>}`):n.append(`{${wl(c,n.budget()-2,`<${a.value}>`)}}`),n.build();let u=i.get("[[GeneratorStatus]]");if(u)return n.append(`{<${u.value}>}`),n.build();let l=new Yn(n.budget()-2,", ");for(let d of o){if(!l.checkBudget())break;l.append(wl(d,l.budget(),d.name))}for(let d of r.entries||[]){if(!l.checkBudget())break;if(d.key){let f=sh(d.key,Math.min(Fv,l.budget()),t),h=sh(d.value,Math.min(Fv,l.budget()-f.length-4),t);l.append(sc(f," => ",h,l.budget()))}else l.append(sh(d.value,Math.min(Fv,l.budget()),t))}r.overflow&&l.appendEllipsis();let p=l.build();return p?n.append("{"+p+"}"):n.isEmpty()&&n.append("{}"),n.build()}function ik(r,e){return r.length<=e?r:"\u2026"}function E4(r,e){return r.length>=e?r.slice(0,e-1)+"\u2026":r}function R4(r,e,t){if(r.type==="object"&&r.subtype==="null")return ik("null",e);if(r.type==="undefined")return ik("undefined",e);if(r.type==="string"){let n=r.description??r.value;return t?.hex&&(n=Buffer.from(n,"utf8").toString("hex")),ya(n,e)}return r.type==="number"||r.type==="bigint"?Sl(r,!1,e,t):E4(r.description||"",e)}function sc(r,e,t,n){return r===void 0?ya(t,n):r.length+e.length>n?On(r,n):sk(`${r}${e}${ya(t,n-r.length-e.length)}`)}function wl(r,e,t){return e=Math.min(e,x4),r.type==="function"?sc(t,": ","\u0192",e):r.type==="object"&&r.value==="Object"?sc(t,": ","{\u2026}",e):typeof r.value>"u"?sc(t,": ",`<${r.type}>`,e):r.type==="string"?sc(t,": ",ak(r.value),e):sc(t,": ",r.value??"unknown",e)}function sk(r){return r.replaceAll("\x1B","\\x1b")}function ak(r){let e=r.includes("'")?r.includes('"')?r.includes("`")?"'":"`":'"':"'",t=new RegExp(`[${e}\\\\]`,"g");return`${e}${r.replace(t,"\\$&")}${e}`}function ck(r,{budget:e,quoted:t,ansi:n},i){if(r.type==="string"){let o=r.value||(r.description?r.description:"");i?.hex&&(o=Buffer.from(o,"utf8").toString("hex"),t=!1);let s=ya(o,t?e-2:e);return t&&(s=ak(s)),n?s:sk(s)}return r.type==="undefined"?"undefined":r.subtype==="null"?"null":r.type==="bigint"||r.type==="number"?Sl(r,!1,e,i):r.description?On(r.description,Math.max(e,1e5)):On(String("value"in r?r.value:r.description),e)}function uk(r,e){let t=new Yn(e),n=r.replace(/^function [gs]et /,"function ").replace(/^function [gs]et\(/,"function(").replace(/^[gs]et /,""),i=n.match(/^(async\s+function)/),o=n.startsWith("function*"),s=n.startsWith("*"),a=!o&&n.startsWith("function"),c=n.startsWith("class ")||n.startsWith("class{"),u=n.indexOf("=>"),l=!i&&!o&&!a&&!c&&u>0,p;if(c){p=n.substring(5);let h=/^[^{\s]+/.exec(p.trim()),m="";h&&(m=h[0].trim()||""),f("class",p,m)}else if(i)p=n.substring(i[1].length),f("async \u0192",p,d(p));else if(o)p=n.substring(9),f("\u0192*",p,d(p));else if(s)p=n.substring(1),f("\u0192*",p,d(p));else if(a)p=n.substring(8),f("\u0192",p,d(p));else if(l){let h=n;n.length>S4&&(h=n.substring(0,u+2)+" {\u2026}"),f("",n,h)}else f("\u0192",n,d(n));return t.build();function d(h){let m=h.indexOf("("),b=h.match(/\)\s*{/),I=b&&b.index||0;if(m!==-1&&b&&I>m){let D=h.substring(0,m).trim()||"",B=h.substring(m,I+1);return D+B}return"()"}function f(h,m,b){t.checkBudget()&&(h.length&&t.append(h+" "),m=m.trim(),m.endsWith(" { [native code] }")&&(m=m.substring(0,m.length-18)),t.budget()>=m.length?t.append(m):t.append(b.replace(/\n/g," ")))}}function gs(r){let e=r;if(e.type!=="object"||e.subtype==="null")return{title:ck(e,{budget:I4,quoted:!1},void 0)};let t=e.description??e.className??"Error",n=/^\s+at\s/m.exec(t);if(!n){let i=t.lastIndexOf(`
`);return i===-1?{title:t}:{title:t.substring(0,i)}}return{title:t.substring(0,n.index-1),stackTrace:t.substring(n.index+2)}}function Sl(r,e,t,n){if(r.type==="number"){if("unserializableValue"in r)return r.unserializableValue;let s=r.value!==void 0?r.value:+r.description;return n?.hex?s.toString(16):String(s)}if(r.type==="bigint"){let s=r.unserializableValue||r.description;return n?.hex?BigInt(s.slice(0,-1)).toString(16):s}let i=r,o=typeof i.value=="number"?i.value:+String(i.description);return On(String(e?Math.floor(o):o),t)}function A4(r,e){return ya(String(typeof r.value<"u"?r.value:r.description),e)}function lk(r){let e=[],t=new Set([void 0]),n=new Map;for(let l of r.properties.filter(p=>p.valuePreview)){let p=new Map;p.set(void 0,l.name),n.set(void 0,Math.max(n.get(void 0)||0,l.name.length)),e.push(p),l.valuePreview?.properties.map(d=>{d.value&&(t.add(d.name),p.set(d.name,d.value),n.set(d.name,Math.max(n.get(d.name)||0,d.value.length)))})}for(let l of t.values())l&&n.set(l,Math.max(n.get(l)||0,l.length));let i=Array.from(n.values()).reduce((l,p)=>l+p,0),o=nk-4-(t.size-1)*3;if(i>o){let l=o/i;for(let p of n.keys()){let d=Math.max(C4,n.get(p)*l|0);n.set(p,d)}}let s=[];for(let l of t.values())s.push("-".repeat(n.get(l)));let a="[-"+s.join("-|-")+"-]",c=[];c.push(a.replace("[","\u256D").replace(/\|/g,"\u252C").replace("]","\u256E").replace(/-/g,"\u2504"));let u=[];for(let l of t.values())u.push(ok(l||"",n.get(l)));c.push("\u250A "+u.join(" \u250A ")+" \u250A"),c.push(a.replace("[","\u251C").replace(/\|/g,"\u253C").replace("]","\u2524").replace(/-/g,"\u2504"));for(let l of e){let p=[];for(let d of t.values())p.push(ok(l.get(d)||"",n.get(d)));c.push("\u250A "+p.join(" \u250A ")+" \u250A")}return c.push(a.replace("[","\u2570").replace(/\|/g,"\u2534").replace("]","\u256F").replace(/-/g,"\u2504")),c.map(l=>On(l,nk)).join(`
`)}var jv=new Map([["",(r,e)=>oh(r,e)],["s",(r,e)=>A4(r,e.budget)],["i",(r,e)=>Sl(r,!0,e.budget,void 0)],["d",(r,e)=>Sl(r,!0,e.budget,void 0)],["f",(r,e)=>Sl(r,!1,e.budget,void 0)],["c",r=>ek(r.value)],["o",(r,e)=>oh(r,e)],["O",(r,e)=>oh(r,e)]]);function ok(r,e){return r.length===e?r:r.length<e?r+" ".repeat(e-r.length):On(r,e)}var rr=S(He());var xl=S(G());async function qv(r){let e=await r.uiLocation();return e?e.source.blackboxed()?2:Vt(e.source)&&!e.isMapped&&e.unmappedReason===3?1:0:0}var k4=new Set(["breakpoint","exception","entry"]),D4=256,ao=class{constructor(e,t){this.launchConfig=e;this.logger=t;this._smartStepCount=0}resetSmartStepCount(){this._smartStepCount>0&&(this.logger.verbose("internal",`smartStep: skipped ${this._smartStepCount} steps`),this._smartStepCount=0)}async getSmartStepDirection(e,t){if(!this.launchConfig.smartStep||k4.has(e.reason))return;let n=(await e.stackTrace.loadFrames(1)).find(Fo(Nt));if((n&&await qv(n))===0){this.resetSmartStepCount();return}return this._smartStepCount++>D4?2:t?.reason==="step"?t.direction:0}};ao=P([(0,xl.injectable)(),y(0,(0,xl.inject)(le)),y(1,(0,xl.inject)(W))],ao);var dk=nt(function(){return[Symbol.for("debug.description"),Symbol.for("nodejs.util.inspect.custom")]}),fk=hi(function(r,e){let t={},n="<<default preview>>";if(typeof this!="object"||!this)return t;for(let i of Object.keys(this)){let o;try{o=this[i]}catch{continue}if(e)try{let s=e.call(o,n);if(s!==n){t[i]=String(s);continue}}catch(s){t[i]=`<<indescribable>>${JSON.stringify([String(s),i])}`;continue}if(typeof o=="object"&&o){let s;for(let a of runtimeArgs[0])if(typeof o[a]=="function")try{s=o[a](2);break}catch{}!s&&!String(o.toString).includes("[native code]")&&(s=String(o)),s&&!s.startsWith("[object ")&&(t[i]=s.length>=r?s.slice(0,r)+"\u2026":s)}}return t}),ah=hi(function(r,e){if(e)try{let t="<<default preview>>",n=e.call(this,t);if(n!==t)return String(n)}catch(t){return`<<indescribable>>${JSON.stringify([String(t),"object"])}`}if(typeof this=="object"&&this){let t;for(let n of[Symbol.for("debug.description"),Symbol.for("nodejs.util.inspect.custom")])if(typeof this[n]=="function")try{t=this[n](2);break}catch{}if(!t&&!String(this.toString).includes("[native code]")&&(t=String(this)),t&&!t.startsWith("[object "))return t.length>=r?t.slice(0,r)+"\u2026":t}});var he=S(He()),Ak=g("crypto");var Br=class r{constructor(e=process.hrtime()){this.value=e}get ms(){return this.s*1e3}get s(){return this.value[0]+this.value[1]/1e9}elapsed(){return new r().subtract(this)}subtract(e){let t=this.value[1]-e.value[1],n=this.value[0]-e.value[0];return t<0&&(t+=1e9,n--),new r([n,t])}};var ac=class{constructor(e,t,n,i,o,s){this.launchConfig=e;this.targetInfo=t;this.parentTarget=n;this.targetOriginValue=i;this.cdp=o;this.logger=s;this.onNameChanged=new k().event;this.attached=!1;this.isWaitingForDebugger=!0;o.pause()}id(){return this.targetInfo.targetId}name(){return this.targetInfo.title}fileName(){return this.targetInfo.url}type(){return"node"}parent(){return this.parentTarget}children(){return[]}canStop(){return!1}stop(){}canRestart(){return!1}restart(){}canAttach(){return!this.attached}async attach(){return await this.cdp.Runtime.enable({}),this.launchConfig.noDebug||await this.cdp.Debugger.enable({}),this.attached=!0,this.cdp}canDetach(){return this.attached}async detach(){await this.cdp.Debugger.resume({}),await this.cdp.NodeWorker.detach({sessionId:this.targetInfo.targetId}),this.attached=!1}targetOrigin(){return this.targetOriginValue}afterBind(){return this.cdp.resume(),Promise.resolve()}async runIfWaitingForDebugger(){this.isWaitingForDebugger=!1,await this.cdp.Runtime.runIfWaitingForDebugger({})}initialize(){return Promise.resolve()}waitingForDebugger(){return this.isWaitingForDebugger}supportsCustomBreakpoints(){return!1}supportsXHRBreakpoints(){return!1}scriptUrlToUrl(e){return e[0]==="/"||process.platform==="win32"&&e[1]===":"&&e[2]==="\\"?ge(e):e}executionContextName(){return this.targetInfo.title}};var Ne=S(He()),ch=new Map;function uh(){if(ch.size)return ch;function r(o,s){for(let a of s)a.group=o,ch.set(a.id,a)}function e(o,s){let a=s||o;return{id:"instrumentation:"+o,title:a,group:"",details:c=>{if(o==="webglErrorFired"){let u=c.webglErrorName;return u=u.replace(/^.*(0x[0-9a-f]+).*$/i,"$1"),{short:u,long:Ne.t('Paused on WebGL Error instrumentation breakpoint, error "{0}"',u)}}return o==="scriptBlockedByCSP"&&c.directiveText?{short:Ne.t('CSP violation "{0}"',c.directiveText),long:Ne.t('Paused on Content Security Policy violation instrumentation breakpoint, directive "{0}"',c.directiveText)}:{short:a,long:Ne.t('Paused on instrumentation breakpoint "{0}"',a)}},apply:async(c,u)=>(u?await c.EventBreakpoints.setInstrumentationBreakpoint({eventName:o}):await c.EventBreakpoints.removeInstrumentationBreakpoint({eventName:o}))?!0:!!(u?await c.DOMDebugger.setInstrumentationBreakpoint({eventName:o}):await c.DOMDebugger.removeInstrumentationBreakpoint({eventName:o}))}}function t(o,s,a){let c=s===void 0?"*":typeof s=="string"?[s]:s;return{id:"listener:"+o,title:a||o,group:"",details:u=>{let l=(u.targetName||"*").toLowerCase();return{short:l+"."+o,long:Ne.t('Paused on event listener breakpoint "{0}", triggered on "{1}"',o,l)}},apply:async(u,l)=>{let p=!0;for(let d of c)l?p=p&&!!await u.DOMDebugger.setEventListenerBreakpoint({eventName:o,targetName:d}):p=p&&!!await u.DOMDebugger.removeEventListenerBreakpoint({eventName:o,targetName:d});return p}}}r("Ad Auction Worklet",[e("beforeBidderWorkletBiddingStart",Ne.t("Bidder Bidding Phase Start")),e("beforeBidderWorkletReportingStart",Ne.t("Bidder Reporting Phase Start")),e("beforeSellerWorkletScoringStart",Ne.t("Seller Scoring Phase Start")),e("beforeSellerWorkletReportingStart",Ne.t("Seller Reporting Phase Start"))]),r("Animation",[e("requestAnimationFrame",Ne.t("Request Animation Frame")),e("cancelAnimationFrame",Ne.t("Cancel Animation Frame")),e("requestAnimationFrame.callback",Ne.t("Animation Frame Fired"))]),r("Canvas",[e("canvasContextCreated",Ne.t("Create canvas context")),e("webglErrorFired",Ne.t("WebGL Error Fired")),e("webglWarningFired",Ne.t("WebGL Warning Fired"))]),r("Clipboard",[t("copy"),t("cut"),t("paste"),t("beforecopy"),t("beforecut"),t("beforepaste")]),r("Control",[t("resize"),t("scroll"),t("scrollend"),t("zoom"),t("focus"),t("blur"),t("select"),t("change"),t("submit"),t("reset")]),r("Device",[t("deviceorientation"),t("devicemotion")]),r("DOM Mutation",[t("DOMActivate"),t("DOMFocusIn"),t("DOMFocusOut"),t("DOMAttrModified"),t("DOMCharacterDataModified"),t("DOMNodeInserted"),t("DOMNodeInsertedIntoDocument"),t("DOMNodeRemoved"),t("DOMNodeRemovedFromDocument"),t("DOMSubtreeModified"),t("DOMContentLoaded")]),r("Drag / Drop",[t("drag"),t("dragstart"),t("dragend"),t("dragenter"),t("dragover"),t("dragleave"),t("drop")]),r("Geolocation",[e("Geolocation.getCurrentPosition","getCurrentPosition"),e("Geolocation.watchPosition","watchPosition")]),r("Keyboard",[t("keydown"),t("keyup"),t("keypress"),t("input")]),r("Load",[t("load"),t("beforeunload"),t("unload"),t("abort"),t("error"),t("hashchange"),t("popstate"),t("navigate"),t("navigatesuccess"),t("navigateerror"),t("currentchange"),t("nagivateto"),t("navigatefrom"),t("finish"),t("dispose")]);let n=["audio","video"];r("Media",[t("play",n),t("pause",n),t("playing",n),t("canplay",n),t("canplaythrough",n),t("seeking",n),t("seeked",n),t("timeupdate",n),t("ended",n),t("ratechange",n),t("durationchange",n),t("volumechange",n),t("loadstart",n),t("progress",n),t("suspend",n),t("abort",n),t("error",n),t("emptied",n),t("stalled",n),t("loadedmetadata",n),t("loadeddata",n),t("waiting",n)]),r("Mouse",[t("auxclick"),t("click"),t("dblclick"),t("mousedown"),t("mouseup"),t("mouseover"),t("mousemove"),t("mouseout"),t("mouseenter"),t("mouseleave"),t("mousewheel"),t("wheel"),t("contextmenu")]),r("Notification",[e("Notification.requestPermission","requestPermission")]),r("Parse",[e("Element.setInnerHTML",Ne.t("Set innerHTML")),e("Document.write","document.write")]),r("Picture-in-Picture",[t("enterpictureinpicture","video"),t("leavepictureinpicture","video"),t("resize","PictureInPictureWindow"),t("enter","documentPictureInPicture")]),r("Pointer",[t("pointerover"),t("pointerout"),t("pointerenter"),t("pointerleave"),t("pointerdown"),t("pointerup"),t("pointermove"),t("pointercancel"),t("gotpointercapture"),t("lostpointercapture"),t("pointerrawupdate")]),r("Script",[e("scriptFirstStatement",Ne.t("Script First Statement")),e("scriptBlockedByCSP",Ne.t("Script Blocked by Content Security Policy"))]),r("Timer",[e("setTimeout"),e("clearTimeout"),e("setInterval"),e("clearInterval"),e("setTimeout.callback",Ne.t("setTimeout fired")),e("setInterval.callback",Ne.t("setInterval fired"))]),r("Touch",[t("touchstart"),t("touchmove"),t("touchend"),t("touchcancel")]),r("WebAudio",[e("audioContextCreated",Ne.t("Create AudioContext")),e("audioContextClosed",Ne.t("Close AudioContext")),e("audioContextResumed",Ne.t("Resume AudioContext")),e("audioContextSuspended",Ne.t("Suspend AudioContext"))]),r("Window",[e("DOMWindow.close","window.close")]),r("Worker",[t("message"),t("messageerror")]);let i=["xmlhttprequest","xmlhttprequestupload"];return r("XHR",[t("readystatechange",i),t("load",i),t("loadstart",i),t("loadend",i),t("abort",i),t("error",i),t("progress",i),t("timeout",i)]),ch}var Wv=hb(),hk=hi(function(){let r=["instantiate","instantiateStreaming","compile","compileStreaming"];for(let e of r){let t=WebAssembly[e];WebAssembly[e]=function(...n){return t.apply(this,n).then(i=>{if(!(n[0]instanceof WebAssembly.Module))debugger;return i})}}},Wv);var lh=hi(function(r,e){let t=" ".repeat(e),n=`
`;function i(s){if(s instanceof Uint8Array)return Uint8Array;if(s instanceof Uint8ClampedArray)return Uint8ClampedArray;if(s instanceof Uint16Array)return Uint16Array;if(s instanceof Uint32Array)return Uint32Array;if(s instanceof BigUint64Array)return BigUint64Array;if(s instanceof Int8Array)return Int8Array;if(s instanceof Int32Array)return Int32Array;if(s instanceof BigInt64Array)return BigInt64Array;if(s instanceof Float32Array)return Float32Array;if(s instanceof Float64Array)return Float64Array}function o(s,a=0,c=[]){switch(typeof s){case"bigint":return`${s}n`;case"boolean":return s.toString();case"function":{let p=s.toString().replace(/^[^\s]+\(/,"function(").split(/\r?\n/g),d=/^$/;for(let f of p){let h=/^[ \t]+/.exec(f);if(h){d=new RegExp(`^[ \\t]{0,${h[0].length}}`);break}}return p.map((f,h)=>h===0?f:(f=f.replace(d,""),h===p.length-1?t.repeat(a)+f:t.repeat(a+1)+f)).join(n)}case"number":return`${s}`;case"object":if(s===null)return"null";if(c.includes(s))return"[Circular]";if(s instanceof Date)return`"${s.toISOString()}"`;if(typeof Node<"u"&&r instanceof Node)return r.outerHTML;let u=i(s);if(u)return`new ${u.name}([${s.join(", ")}])`;if(s instanceof ArrayBuffer)return`new Uint8Array([${new Uint8Array(s).join(", ")}]).buffer`;if(s instanceof Array)return["[",...s.map(p=>t.repeat(a+1)+o(p,a+1,[...c,s])+","),t.repeat(a)+"]"].join(n);let l=s;return["{",...Object.keys(l).map(p=>t.repeat(a+1)+(/^[$a-z_][0-9a-z_$]*$/i.test(p)?p:JSON.stringify(p))+": "+o(l[p],a+1,[...c,s])+","),t.repeat(a)+"}"].join(n);case"string":return s.includes(`
`)?"`"+s.replace(/[`\\\\]|\${/g,"\\$&")+"`":JSON.stringify(s);case"symbol":return s.toString();case"undefined":return"undefined";default:return String(s)}}try{return o(r)}catch{return""+r}}),mk=nt(`
  function(spaces2) {
    const result = ${lh.expr("this","spaces2")};
    return result;
  }
`);var Ur=S(He());var co=S(G());var gk=nt(function(){let r={__proto__:this.__proto__},e=Object.getOwnPropertyNames(this);for(let t=0;t<e.length;++t){let n=e[t],i=n>>>0;if(String(i>>>0)===n&&i>>>0!==4294967295)continue;let o=Object.getOwnPropertyDescriptor(this,n);o&&Object.defineProperty(r,n,o)}return r});var yk=nt(function(r,e){let t={},n=r===-1?0:r,i=e===-1?this.length:r+e;for(let o=n;o<i&&o<this.length;++o){let s=Object.getOwnPropertyDescriptor(this,o);s&&Object.defineProperty(t,o,s)}return t});var bk=nt(function(r,e){let t={},n=r===-1?0:r,i=e===-1?this.childNodes.length:r+e;for(let o=n;o<i&&o<this.childNodes.length;++o){let s=this.childNodes[o];s.nodeName==="#comment"?t[o]=`<!-- ${s.textContent} -->`:s.nodeName==="#text"?t[o]=s.textContent||"":t[o]=s}return t});var vk=nt(function(r){return r.call(this)});var Vv=nt(function(r,e){let{buffer:t,byteLength:n,byteOffset:i}=this instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&this instanceof SharedArrayBuffer?new DataView(this):this instanceof WebAssembly.Memory?new DataView(this.buffer):this,o=i+Math.min(r,n),s=Math.max(0,Math.min(e,n-r));return a(new Uint8Array(t,o,s));function a(c){let u="0123456789abcdef",l="";for(let p=0;p<c.length;p++){let d=c[p];l+=u[d>>>4]+u[d&15]}return l}});var $v=nt(function(r,e){let t=c(e),{buffer:n,byteLength:i,byteOffset:o}=this instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&this instanceof SharedArrayBuffer?new DataView(this):this instanceof WebAssembly.Memory?new DataView(this.buffer):this,s=o+Math.min(r,i),a=Math.max(0,Math.min(t.length,i-r));return new Uint8Array(n,s,a).set(t.subarray(0,a)),a;function c(u){let l=new Uint8Array(u.length>>>1);for(let p=0;p<u.length;p+=2)l[p>>>1]=parseInt(u.slice(p,p+2),16);return l}});var uc=(()=>{let r=0,e=2147483646;return()=>r++%e+1})(),i_=r=>{if(typeof r=="string")return{value:r};let e=r;return e.objectId?{objectId:e.objectId}:e.unserializableValue?{unserializableValue:e.unserializableValue}:{value:e.value}},M4=new Set(["typedarray","dataview","arraybuffer","webassemblymemory"]);var Ck=1024,N4=/^[$a-z_][0-9a-z_$]*$/i,L4=/^#[0-9a-z_$]+$/i,F4=r=>r.hasOwnProperty("configurable"),_k=(r,e,t)=>{let n=RT(r,Ou(e),t);return fi(n)},wk="<<indescribable>>",Pk=r=>{if(!r.startsWith(wk))return r;let e,t;try{[e,t]=JSON.parse(r.slice(wk.length))}catch{return r}return Ur.t("{0} (couldn't describe: {1})",e,t)},Hv=r=>!!r&&typeof r=="object"&&"readMemory"in r&&"writeMemory"in r,Sk={PARAMETER:{name:Ur.t("Parameters"),sortOrder:-10},LOCAL:{name:Ur.t("Locals"),sortOrder:-9},GLOBAL:{name:Ur.t("Globals"),sortOrder:-8}},Il=class r{constructor(e,t,n,i,o,s,a,c){this.cdp=e;this.parent=t;this.vars=i;this.locationProvider=o;this.currentRef=s;this.settings=a;this.clientCapabilities=c;this.name=n.name,this.presentationHint=n.presentationHint,this.sortOrder=n.sortOrder||0}get customDescriptionGenerator(){return this.settings.customDescriptionGenerator}createVariable(e,t,...n){let i=new e(new r(this.cdp,this.currentRef?.(),t,this.vars,this.locationProvider,()=>i,this.settings,this.clientCapabilities),...n);return i.id>0&&this.vars.add(i),i}createVariableByType(e,t,n){if(Uv(t))return this.createVariable(hh,e,t);if(t.objectId){if(t.type==="function")return this.createVariable(Xv,e,t,n);if(t.subtype==="map"||t.subtype==="set")return this.createVariable(Qv,e,t,n);if(t.subtype==="node")return this.createVariable(Yv,e,t,n);if(!Bv.has(t.subtype))return this.createVariable(ys,e,t,n)}return this.createVariable(yr,e,t)}createWasmVariable(e,t,n){return this.createVariable(Pl,e,t,n)}async getDescriptionSymbols(e){return this.settings.descriptionSymbols??=dk({cdp:this.cdp,args:[],objectId:e}).then(t=>({objectId:t.objectId}),()=>({value:[]})),await this.settings.descriptionSymbols}async createObjectPropertyVars(e,t){let n=[];if(this.settings.customPropertiesGenerator){let{result:u,errorDescription:l}=await this.evaluateCodeForObject(e,this.settings.customPropertiesGenerator,[]);u&&u.type!=="undefined"?e=u:n.push([this.createVariable(Kv,{name:"",sortOrder:-1},u,u?.description||l||Ur.t("Unknown error"))])}if(!e.objectId)return[];t&&this.cdp.DotnetDebugger.setEvaluationOptions({options:t,type:"variable"});let[i,o,s]=await Promise.all([this.cdp.Runtime.getProperties({objectId:e.objectId,accessorPropertiesOnly:!0,ownProperties:!1,generatePreview:!0}),this.cdp.Runtime.getProperties({objectId:e.objectId,ownProperties:!0,generatePreview:!0}),this.cdp.Runtime.callFunctionOn({functionDeclaration:fk.decl(`${Ck}`,this.settings.customDescriptionGenerator||"null"),arguments:[await this.getDescriptionSymbols(e.objectId)],objectId:e.objectId,throwOnSideEffect:!0,returnByValue:!0}).then(u=>u?.result.value||{}).catch(()=>({}))]);if(!i||!o)return[];let a=new Map,c=[];for(let u of i.result){if(u.symbol){c.push(u);continue}u.name==="__proto__"&&o.internalProperties?.some(l=>l.name==="[[Prototype]]")||a.set(u.name,u)}for(let u of o.result)u.get||u.set||(u.symbol?c.push(u):a.set(u.name,u));for(let u of[a.values(),c.values()])for(let l of u)n.push(this.createPropertyVar(l,e,s?.hasOwnProperty(l.name)?Pk(s[l.name]):void 0));for(let u of o.privateProperties??[])n.push(this.createPropertyVar(u,e,void 0,{presentationHint:{visibility:"private"},sortOrder:1}));for(let u of o.internalProperties||[]){if(u.name==="[[StableObjectId]]")continue;let l;Ek(u)?l=this.createFunctionLocationVariable(u):u.value!==void 0&&(l=this.createVariableByType({name:u.name,presentationHint:{visibility:"internal"},sortOrder:2},u.value)),l&&n.push([l])}return Uo(await Promise.all(n))}createFunctionLocationVariable(e){return this.createVariable(dh,{name:e.name,presentationHint:{visibility:"internal",attributes:["readOnly"]},sortOrder:2},e.value)}async createPropertyVar(e,t,n,i){let o=[],s=e.get&&e.get.type!=="undefined",a=e.set&&e.set.type!=="undefined",c={name:e.name,presentationHint:{},sortOrder:0,...i};return i||(F4(e)?(e.enumerable===!1&&!s&&(c.presentationHint.visibility="internal",c.sortOrder=1),(e.writable===!1||s&&!a)&&(c.presentationHint.attributes=["readOnly"])):(c.presentationHint.visibility="private",c.sortOrder=1)),"value"in e&&e.value&&o.push(this.createVariableByType(c,e.value,n)),s?o.push(this.createVariable(t_,c,e.get,t)):a&&o.push(this.createVariable(e_,c,e.set)),o}async evaluateCodeForObject(e,t,n){try{let i=await this.cdp.Runtime.callFunctionOn({objectId:e.objectId,functionDeclaration:t,arguments:n.map(i_)});if(i){if(i.exceptionDetails===void 0)return{result:i.result};if(i&&i.result.description)return{errorDescription:i.result.description}}return{errorDescription:Ur.t("Unknown error")}}catch(i){return{errorDescription:i.stack||i.message||String(i)}}}},B4=r=>typeof r=="number"||/^[0-9]+$/.test(r),yr=class r{constructor(e,t){this.context=e;this.remoteObject=t;this.id=uc()}get name(){return this.context.name}get sortOrder(){return this.context.sortOrder}get accessor(){let{parent:e,name:t}=this.context;if(e instanceof Cl)return e.accessor;if(!(e instanceof r))return this.context.name;let n=e.context.parent;if(n instanceof r){if(this.remoteObject.subtype==="internal#entry")return`[...${n.accessor}.entries()][${+t}]`;if(e.remoteObject.subtype==="internal#entry")return`${e.accessor}[${this.name==="key"?0:1}]`}return B4(t)?`${e.accessor}[${t}]`:N4.test(t)?`${e.accessor}.${t}`:e.accessor==="this"&&L4.test(t)?`${e.accessor}.${t}`:`${e.accessor}[${JSON.stringify(t)}]`}async toDap(e,t){let n=this.context.name;return this.context.parent instanceof cc&&(n=await this.context.parent.getRename(n)),Promise.resolve({name:n,value:ms(this.remoteObject,e,t),evaluateName:this.accessor,type:this.remoteObject.type,variablesReference:0,presentationHint:this.context.presentationHint})}async setProperty(e,t){let n=await this.context.cdp.Runtime.callFunctionOn({objectId:this.remoteObject.objectId,functionDeclaration:`function(a) { return this[a] = ${t}; ${Ve()} }`,arguments:[i_(e)],silent:!0});if(!n)throw new O(ve(Ur.t("Unable to set variable value")));if(n.exceptionDetails)throw new O(Tk(n.exceptionDetails));return this.context.createVariableByType({name:e},n.result)}async getChildren(e){return Promise.resolve([])}},ph=class{constructor(e){this.child=e;this.id=uc()}getChildren(){return Promise.resolve([this.child])}},Gv=class extends yr{constructor(t,n,i,o){super(t,{type:i[0]?.type??"string"});this.value=n;this.args=i;this.stackTrace=o}toDap(){return Promise.resolve({name:this.context.name,value:this.value,variablesReference:this.stackTrace||this.args.some(hs)?this.id:0})}getChildren(t){let n=[],{args:i,stackTrace:o}=this;for(let s=0;s<i.length;++s)hs(i[s])&&n.push(this.context.createVariableByType({name:`arg${s}`,sortOrder:s},i[s]));return o&&n.push(this.context.createVariable(zv,{name:"",sortOrder:Number.MAX_SAFE_INTEGER},this.remoteObject,o)),Promise.resolve(n)}},zv=class extends yr{constructor(t,n,i){super(t,n);this.stacktrace=i}async toDap(){return{name:"",value:await this.stacktrace.format(),variablesReference:0}}},dh=class extends yr{constructor(e,t){super(e,t),this.location=t.value}async toDap(){return{name:this.context.name,value:await this.context.locationProvider.renderDebuggerLocation(this.location),variablesReference:0,presentationHint:{visibility:"internal"}}}},Kv=class extends yr{constructor(t,n,i){super(t,n);this.message=i}get accessor(){if(!(this.context.parent instanceof yr))throw new Error("ErrorVariable must have a parent Variable");return this.context.parent.accessor}toDap(){return Promise.resolve({name:this.context.name,value:this.message,variablesReference:0})}},fh=Symbol("NoStringRepr"),ys=class extends yr{constructor(t,n,i){super(t,n);this.customStringRepr=i}async toDap(t,n){let[i,o]=await Promise.all([await super.toDap(t,n),await this.getValueRepresentation(t)]);return{...i,type:this.remoteObject.className||this.remoteObject.subtype||this.remoteObject.type,variablesReference:this.id,memoryReference:M4.has(this.remoteObject.subtype)?String(this.id):void 0,value:o}}async getValueRepresentation(t){if(typeof this.customStringRepr=="string")return this.customStringRepr;if(!this.context.parent&&this.remoteObject.objectId&&this.customStringRepr!==fh)try{let n=await this.context.cdp.Runtime.callFunctionOn({functionDeclaration:ah.decl(`${Ck}`,this.context.customDescriptionGenerator||"null"),objectId:this.remoteObject.objectId,returnByValue:!0});if(n?.result.value)return this.customStringRepr=Pk(n.result.value)}catch{this.customStringRepr=fh}return this.context.name==="__proto__"&&this.remoteObject.description||ms(this.remoteObject,t)}async readMemory(t,n){let i=await Vv({cdp:this.context.cdp,args:[t,n],objectId:this.remoteObject.objectId,returnByValue:!0});return Buffer.from(i.value,"hex")}async writeMemory(t,n){return(await $v({cdp:this.context.cdp,args:[t,n.toString("hex")],objectId:this.remoteObject.objectId,returnByValue:!0})).value}getChildren(t){return this.context.createObjectPropertyVars(this.remoteObject,t.evaluationOptions)}},Jv=class extends ys{constructor(){super(...arguments);this.id=uc()}get accessor(){return this.context.parent.accessor}async toDap(t,n){return Promise.resolve({...await super.toDap(t,n),value:"..."})}},Yv=class extends yr{constructor(){super(...arguments);this.description=ne(()=>this.context.cdp.DOM.describeNode({objectId:this.remoteObject.objectId}))}async toDap(t,n){let o=(await this.description())?.node?.childNodeCount||0;return{...await super.toDap(t,n),value:await this.getValuePreview(t),variablesReference:this.id,indexedVariables:o>100?o:void 0,namedVariables:o>100?1:void 0}}async getChildren(t){switch(t?.filter){case"indexed":return this.getNodeChildren(t.start,t.count);case"named":return[this.getAttributesVar()];default:return[this.getAttributesVar(),...await this.getNodeChildren()]}}getAttributesVar(){return this.context.createVariable(Jv,{name:Ur.t("Node Attributes"),presentationHint:{visibility:"internal"},sortOrder:Number.MAX_SAFE_INTEGER},this.remoteObject,void 0)}async getNodeChildren(t=-1,n=-1){let i;try{i=await bk({cdp:this.context.cdp,generatePreview:!1,args:[t,n],objectId:this.remoteObject.objectId})}catch{return[]}let o=await this.context.createObjectPropertyVars(i);return i.objectId&&await this.context.cdp.Runtime.releaseObject({objectId:i.objectId}),o}async getValuePreview(t){let n=await this.description();if(!n?.node)return"";let{localName:i,attributes:o,childNodeCount:s}=n.node,a=this.context.clientCapabilities.value?.supportsANSIStyling?!0:"",c=(a&&"\x1B[34m")+`<${i}`;if(o)for(let u=0;u<o.length;u+=2){let l=o[u],p=o[u+1];c+=` ${a&&"\x1B[34;1m"}${l}${a&&"\x1B[2m"}=${a&&"\x1B[33m"}${JSON.stringify(p)}`}return c+=(a&&"\x1B[34m")+">",s&&(c+=`${a&&"\x1B[2m"}...${a&&"\x1B[34m"}`),c+=`</${i}>${a&&"\x1B[0m"}`,c}},Xv=class extends ys{async toDap(e){let[t,n]=await Promise.all([super.toDap(e),this.context.cdp.Runtime.getProperties({objectId:this.remoteObject.objectId,ownProperties:!0,nonIndexedPropertiesOnly:!0})]),i=n?.internalProperties?.find(Ek);return i&&(t.valueLocationReference=this.context.createFunctionLocationVariable(i).id),t}},xk="[[Entries]]",Qv=class extends ys{constructor(t,n){super(t,n,fh);this.baseChildren=ne(()=>super.getChildren({variablesReference:this.id}));this.isMap=n.subtype==="map";let i=n.preview;this.size=Number(i?.properties.find(o=>o.name==="size")?.value)??void 0}async toDap(t){let n=await super.toDap(t);return this.size&&this.size>100&&(n.indexedVariables=this.size),n}async getChildren(t){let n=await this.baseChildren();return[...(await n.find(o=>o.name===xk)?.getChildren(t)||[]).filter(o=>o.sortOrder===0),...n.filter(o=>o.name!==xk)]}},hh=class extends ys{constructor(t,n){super(t,n,fh);this.length=0;let i=String(n.description).match(/\(([0-9]+)\)/);this.length=i?+i[1]:0}async toDap(t){return{...await super.toDap(t),indexedVariables:this.length>100?this.length:void 0,namedVariables:this.length>100?1:void 0}}async getChildren(t){switch(t?.filter){case"indexed":return this.getArraySlots(t);case"named":return this.getArrayProperties();default:return Promise.all([this.getArrayProperties(),this.getArraySlots()]).then(Uo)}}async getArrayProperties(){try{let t=await gk({cdp:this.context.cdp,args:[],objectId:this.remoteObject.objectId,generatePreview:!0});return this.context.createObjectPropertyVars(t)}catch{return[]}}async getArraySlots(t){let n=t&&typeof t.start<"u"?t.start:-1,i=t&&typeof t.count<"u"?t.count:-1,o;try{o=await yk({cdp:this.context.cdp,generatePreview:!1,args:[n,i],objectId:this.remoteObject.objectId})}catch{return[]}let s=await this.context.createObjectPropertyVars(o);return o.objectId&&await this.context.cdp.Runtime.releaseObject({objectId:o.objectId}),s}},Zv=class extends hh{async toDap(e){return this.remoteObject.preview?{...await super.toDap(e),name:lk(this.remoteObject.preview)}:super.toDap(e)}},Cl=class extends yr{constructor(e,t){super(e,t)}getChildren(e){return this.context.createObjectPropertyVars(this.remoteObject)}},e_=class extends Cl{async toDap(e,t){return{...await super.toDap(e,t),value:"write-only",variablesReference:this.id}}},t_=class extends Cl{constructor(t,n,i){super(t,n);this.parentObject=i}async toDap(t,n){let i=await super.toDap(t,n);return i.variablesReference=this.id,i.presentationHint={...i.presentationHint,lazy:!0},i}async getChildren(t){try{let n=await vk({cdp:this.context.cdp,objectId:this.parentObject.objectId,args:[new Nu(this.remoteObject.objectId)]});return[this.context.createVariableByType({name:this.name,presentationHint:this.context.presentationHint},n)]}catch(n){if(!(n instanceof zo))throw n}return super.getChildren(t)}},Pl=class r{constructor(e,t,n){this.context=e;this.variable=t;this.scopeRef=n;this.id=uc();this.sortOrder=0}static{this.presentationHint={attributes:["readOnly"]}}toDap(){return Promise.resolve({name:this.context.name,value:this.variable.description||"",variablesReference:this.variable.getChildren?this.id:0,memoryReference:this.variable.linearMemoryAddress?String(this.id):void 0,presentationHint:this.context.presentationHint})}async getChildren(){return(await this.variable.getChildren?.()||[]).map(t=>this.context.createVariable(r,{name:t.name,presentationHint:r.presentationHint},t.value,this.scopeRef))}async readMemory(e,t){let n=this.variable.linearMemoryAddress;if(n===void 0)return;let i=await this.context.cdp.Debugger.evaluateOnCallFrame({callFrameId:this.scopeRef.callFrameId,expression:`(${Vv.source}).call(memories[0].buffer, ${+n+e}, ${+t}) ${Ve()}`,returnByValue:!0});if(!i)throw new zo({exceptionId:0,text:"No response from CDP",lineNumber:0,columnNumber:0});return Buffer.from(i.result.value,"hex")}async writeMemory(e,t){let n=this.variable.linearMemoryAddress;return n===void 0?0:(await this.context.cdp.Debugger.evaluateOnCallFrame({callFrameId:this.scopeRef.callFrameId,expression:`(${$v.source}).call(memories[0].buffer, ${+n+e}, ${JSON.stringify(t.toString("hex"))}) ${Ve()}`,returnByValue:!0}))?.result.value||0}},r_=class{constructor(e,t,n,i){this.context=e;this.kind=t;this.variables=n;this.scopeRef=i;this.id=uc();this.sortOrder=Sk[this.kind]?.sortOrder||0}toDap(){return Promise.resolve({name:Sk[this.kind]?.name||this.kind,value:"",variablesReference:this.id})}getChildren(){return Promise.all(this.variables.map(async e=>{let t=await e.evaluate();return this.context.createVariable(Pl,{name:e.name,presentationHint:Pl.presentationHint},t,this.scopeRef)}))}},cc=class{constructor(e,t,n,i,o){this.remoteObject=e;this.context=t;this.ref=n;this.extraProperties=i;this.renameProvider=o;this.id=uc()}async getChildren(e){let t=await this.context.createObjectPropertyVars(this.remoteObject),n=new Set(t.map(i=>i.name));for(let i of this.extraProperties)n.has(i.name)||t.push(this.context.createVariableByType({name:i.name},i.value));return t}async getRename(e){return(await this.renameProvider.provideOnStackframe(this.ref.stackFrame)).getOriginalName(e,this.ref.stackFrame.rawPosition)||e}async setProperty(e,t){let n=await this.context.cdp.Debugger.evaluateOnCallFrame({expression:`${t} ${Ve()}`,callFrameId:this.ref.callFrameId});if(!n)throw new O(_e(Ur.t("Invalid expression")));if(n.exceptionDetails)throw new O(Tk(n.exceptionDetails));return await this.context.cdp.Debugger.setVariableValue({callFrameId:this.ref.callFrameId,scopeNumber:this.ref.scopeNumber,variableName:e,newValue:i_(n.result)}),this.context.createVariableByType({name:e},n.result)}},n_=class{constructor(){this.value=new Map}get(e){return this.value.get(e)}add(e){this.value.set(e.id,e)}clear(){this.value.clear()}},uo=class{constructor(e,t,n,i,o,s){this.renameProvider=e;this.cdp=t;this.dap=n;this.launchConfig=i;this.clientCapabilities=o;this.locationProvider=s;this.vars=new n_;this.contextSettings={customDescriptionGenerator:i.customDescriptionGenerator&&_k(["defaultValue"],i.customDescriptionGenerator,!1),customPropertiesGenerator:i.customPropertiesGenerator&&_k([],i.customPropertiesGenerator,!1)}}createDetached(){return new uo(this.renameProvider,this.cdp,this.dap,this.launchConfig,this.clientCapabilities,this.locationProvider)}clear(){this.vars.clear()}createFloatingVariable(e,t){return this.createFloatingContext().createVariableByType({name:e},t)}createFloatingWasmVariable(e,t,n,i){let o=this.createFloatingContext(),s={stackFrame:n,callFrameId:i,scopeNumber:0};return o.createWasmVariable({name:e},t,s)}createVariableForOutput(e,t,n,i){let o=this.createFloatingContext(),s=t.length===1&&i==="table"?o.createVariable(Zv,{name:""},t[0]):t.length===1&&hs(t[0])&&!n?o.createVariableByType({name:""},t[0]):o.createVariable(Gv,{name:""},e,t,n),a=new ph(s);return this.vars.add(a),a}createScope(e,t,n){let i=new cc(e,new Il(this.cdp,void 0,{name:""},this.vars,this.locationProvider,()=>i,this.contextSettings,this.clientCapabilities),t,n,this.renameProvider);return this.vars.add(i),i}createWasmScope(e,t,n){let i=new r_(new Il(this.cdp,void 0,{name:""},this.vars,this.locationProvider,()=>i,this.contextSettings,this.clientCapabilities),e,t,n);return this.vars.add(i),i}hasVariable(e){return!!this.vars.get(e)}hasMemory(e){return Hv(this.vars.get(Number(e)))}async readMemory(e,t,n){let i=this.vars.get(Number(e));return Hv(i)?i.readMemory(t,n):void 0}async writeMemory(e,t,n){let i=this.vars.get(Number(e)),o=Hv(i)?await i.writeMemory(t,n):0;return o>0&&this.dap.invalidated({areas:["variables"]}),o}async getVariableNames(e){let t=this.vars.get(e.variablesReference);return t?(await t.getChildren(e)).filter(Fo(yr)):[]}async getVariables(e){let t=this.vars.get(e.variablesReference);if(!t)return[];let n=await t.getChildren(e);return(await Promise.all(n.map(o=>o.toDap(t instanceof cc||t instanceof ph?"repl":"propertyValue",e.format).then(s=>({v:o,dap:s}))))).sort((o,s)=>o.v.sortOrder-s.v.sortOrder||+o.dap.name-+s.dap.name||o.dap.name.localeCompare(s.dap.name)).map(o=>o.dap)}async getLocations(e){let t=this.vars.get(e);if(!t||!(t instanceof dh))throw Gu();return t.location}async setVariable(e){let t=this.vars.get(e.variablesReference);if(!e.value)throw new O(_e(Ur.t("Cannot set an empty value")));if(t instanceof cc||t instanceof yr)return await(await t.setProperty(e.name,e.value)).toDap("propertyValue",e.format);throw new O(ve(Ur.t("Variable not found")))}createFloatingContext(){return new Il(this.cdp,void 0,{name:"<unnamed>"},this.vars,this.locationProvider,void 0,this.contextSettings,this.clientCapabilities)}};uo=P([(0,co.injectable)(),y(0,(0,co.inject)(Xi)),y(1,(0,co.inject)(Ue)),y(2,(0,co.inject)(er)),y(3,(0,co.inject)(le)),y(4,(0,co.inject)(io))],uo);function Tk(r){let e=r.exception&&gs(r.exception).title||r.text;return _e(e)}function Ek(r){return r.name==="[[FunctionLocation]]"&&!!r.value&&r.value.subtype==="internal#location"}var o_=class{constructor(e){this.description=e;this.sourceMapLoads=new Map;this.scripts=[]}get isDefault(){return this.description.auxData&&this.description.auxData.isDefault}async remove(e){await Promise.all(this.scripts.map(async t=>{let n=await t.source;n.filterScripts(i=>i.executionContextId!==this.description.id),n.scripts.length||e.removeSource(n)}))}},s_=class{constructor(e){this._obj=e;this._dapDeferred=be()}resolve(){this._dapDeferred.resolve(this._obj)}with(e){return this._dapDeferred.hasSettled()?e(this._obj):this._dapDeferred.promise.then(t=>e(t))}},j4=50,Rk=(r,e)=>r.sourceReference===e.sourceReference&&Hd(r.path||"",e.path||""),q4=()=>`
//# sourceURL=eval-${(0,Ak.randomBytes)(4).toString("hex")}.repl
`,a_=class{async enqueue(e,t){if(this.queue?.operation===e&&await new Promise(n=>setTimeout(n)),!this.queue||this.queue.operation!==e){let n=this.queue?.result.then(t,t)??t(),i=this.queue={operation:e,result:n.finally(()=>{this.queue===i&&(this.queue=void 0)})}}return this.queue.result}};var lc=class r{constructor(e,t,n,i,o,s,a,c,u,l,p,d,f,h,m){this.target=i;this.logger=s;this.evaluator=a;this.completer=c;this.launchConfig=u;this._breakpointManager=l;this.console=p;this.exceptionPause=d;this._smartStepper=f;this.shutdown=h;this._executionContexts=new Map;this._excludedCallers=[];this.stateQueue=new a_;this._onPausedEmitter=new k;this.disposed=!1;this.debuggerReady=be();this.onPaused=this._onPausedEmitter.event;this._dap=new s_(n),this._sourceContainer=e,this._cdp=t,this.id=r._lastThreadId++,this.replVariables=new uo(o,this._cdp,n,u,m,this),e.onSourceMappedSteppingChange(()=>this.refreshStackTrace()),this._initialize()}static{this._lastThreadId=0}static{this._allThreadsByDebuggerId=new Map}setExcludedCallers(e){this._excludedCallers=e}cdp(){return this._cdp}name(){return this.target.name()}pausedDetails(){return this._pausedDetails}pausedVariables(){return this._pausedVariables}defaultExecutionContext(){for(let e of this._executionContexts.values())if(e.isDefault)return e}resume(){return this.stateQueue.enqueue("resume",async()=>(this._sourceContainer.clearDisabledSourceMaps(),!await this._cdp.Debugger.resume({})&&this._pausedDetails!==void 0?ve(he.t("Unable to resume")):{allThreadsContinued:!1}))}pause(){return this.stateQueue.enqueue("pause",async()=>(this._expectedPauseReason={reason:"pause"},await this._cdp.Debugger.pause({})?{}:ve(he.t("Unable to pause"))))}stepOver(){return this.stateQueue.enqueue("stepOver",async()=>{this._expectedPauseReason={reason:"step",direction:1};let e=await this.getCurrentSkipList(1);return await this._cdp.Debugger.stepOver({skipList:e})?{}:ve(he.t("Unable to step next"))})}stepInto(e){return this.stateQueue.enqueue("stepInto",async()=>{this._waitingForStepIn={lastDetails:this._pausedDetails},this._expectedPauseReason={reason:"step",direction:0};let t=this._pausedDetails?.stepInTargets?.[e];if(t){let n=await this._cdp.Debugger.setBreakpoint({location:t.breakLocation});if(this._waitingForStepIn.intoTargetBreakpoint=n?.breakpointId,await this._cdp.Debugger.resume({}))return{}}else{let n=await this.getCurrentSkipList(0);if(await this._cdp.Debugger.stepInto({breakOnAsyncCall:!0,skipList:n}))return{}}return ve(he.t("Unable to step in"))})}stepOut(){return this.stateQueue.enqueue("stepOut",async()=>(this._expectedPauseReason={reason:"step",direction:2},await this._cdp.Debugger.stepOut({})?{}:ve(he.t("Unable to step out"))))}async getCurrentSkipList(e){if(!this._pausedDetails)return;let[t]=await this._pausedDetails.stackTrace.loadFrames(1);if(!t||!kk(t))return;let n=await t.getStepSkipList(e);if(n)return Pt.simplify(n).map(i=>({start:i.begin.base0,end:i.end.base0,scriptId:t.root.scriptId}))}_stackFrameNotFoundError(){return ve(he.t("Stack frame not found"))}_evaluateOnAsyncFrameError(){return ve(he.t("Unable to evaluate on async stack frame"))}async restartFrame(e){let t=this._pausedDetails?.stackTrace.frame(e.frameId)?.root;if(!t)return this._stackFrameNotFoundError();let n=t.callFrameId();return n?await this._cdp.Debugger.restartFrame({callFrameId:n,mode:"StepInto"})?(this._expectedPauseReason={reason:"frame_entry",description:he.t("Paused on frame entry")},t.canExplicitlyBeRestarted||await this._cdp.Debugger.stepInto({}),{}):_e(he.t("Frame could not be restarted")):_e(he.t("Cannot restart asynchronous frame"))}async stackTrace(e){return this._pausedDetails?this._pausedDetails.stackTrace.toDap(e):ve(he.t("Thread is not paused"))}async scopes(e){let t=this._pausedDetails?this._pausedDetails.stackTrace.frame(e.frameId):void 0;return t?t.scopes():this._stackFrameNotFoundError()}async exceptionInfo(){let e=this._pausedDetails&&this._pausedDetails.exception;if(!e)return ve(he.t("Thread is not paused on exception"));let t=gs(e);return{exceptionId:t.title,breakMode:"all",details:{stackTrace:t.stackTrace,evaluateName:void 0}}}async revealPage(){return this._cdp.Page.bringToFront({}),{}}async completions(e){let t;if(e.frameId!==void 0){if(t=this._pausedDetails?this._pausedDetails.stackTrace.frame(e.frameId)?.root:void 0,!t)return this._stackFrameNotFoundError();if(!t.callFrameId())return this._evaluateOnAsyncFrameError()}if(e.line===1&&e.text.startsWith("cd "))return{targets:this.getExecutionContextCompletions(e)};let n=await this.completer.completions({executionContextId:this._selectedContext?this._selectedContext.description.id:void 0,stackFrame:t,expression:e.text,position:new Fe(e.line||1,e.column)});return{targets:[...this.getExecutionContextCompletions(e),...n]}}getExecutionContextCompletions(e){if(e.line&&e.line>1)return[];let t=e.text.slice(0,e.column).trim();return[...this._executionContexts.values()].map(n=>`cd ${this.target.executionContextName(n.description)}`).filter(n=>n.startsWith(t)).map(n=>({label:n,start:0,length:e.text.length}))}async _evaluteWasm(e,t,n){if(!e)return;let i=e.root,o=i.callFrameId(),s=await i.scriptSource?.source;if(!Xo(s)||!o)return;let a=await s.sourceMap.value.promise;if(!a.evaluate)return;let c=new Oe(e instanceof El?e.inlineFrameIndex:0,i.rawPosition.base0.columnNumber),u=await a.evaluate(o,c,t.expression);return await n.createFloatingWasmVariable(t.expression,u,i,o).toDap(t.context,t.format)}async _evaluteJs(e,t,n){let i,o;if(t.context==="clipboard"?(o=lh.exprArgRanges(t.expression,"2"),i={expression:lh.expr(t.expression,"2"),includeCommandLineAPI:!0,returnByValue:!0,objectGroup:"console"}):i={expression:t.expression,includeCommandLineAPI:!0,objectGroup:"console",generatePreview:!0,timeout:t.context==="hover"?this.getHoverEvalTimeout():void 0},t.context==="repl"){if(i.expression=ju(i.expression),i.expression.indexOf("await")!==-1){let l=JT(i.expression);l&&(i.expression=l,i.awaitPromise=!0)}i.expression+=q4()}t.evaluationOptions&&this.cdp().DotnetDebugger.setEvaluationOptions({options:t.evaluationOptions,type:"evaluation"});let s;if(t.source&&t.line&&t.column){let l=this._pausedVariables,p=this._sourceContainer.source(t.source);p&&l&&(s={source:p,position:new Fe(t.line,t.column),variables:l})}let a=e?.root.callFrameId(),c=this.evaluator.evaluate(a?{...i,callFrameId:a}:{...i,contextId:this._selectedContext?this._selectedContext.description.id:void 0},{isInternalScript:!1,stackFrame:e?.root,location:s,transformRanges:o});if(t.context==="repl")return await this._evaluateRepl(t,c,t.format);let u=await c;if(!u)throw new O(ve(he.t("Unable to evaluate")));if(u.exceptionDetails){let l=u.exceptionDetails.exception?gs(u.exceptionDetails.exception).title:u.exceptionDetails.text;throw l.startsWith("Uncaught")||(l="Uncaught "+l),new O(ve(l))}return n.createFloatingVariable(i.expression,u.result).toDap(t.context,t.format)}async evaluate(e){let t,n;if(e.frameId!==void 0){if(n=this._pausedDetails?this._pausedDetails.stackTrace.frame(e.frameId):void 0,!n)throw new O(this._stackFrameNotFoundError());if(t=n.root.callFrameId(),!t)throw new O(this._evaluateOnAsyncFrameError())}if(e.context==="repl"&&e.expression.startsWith("cd ")){let s=e.expression.substring(3).trim();for(let a of this._executionContexts.values())if(this.target.executionContextName(a.description)===s)return this._selectedContext=a,{result:`[${s}]`,variablesReference:0}}let i=t?this._pausedVariables:this.replVariables;if(!i)throw new O(ve(he.t("Unable to evaluate")));let o=await this._evaluteWasm(n,e,i)??await this._evaluteJs(n,e,i);return{type:o.type,result:o.value,variablesReference:o.variablesReference,namedVariables:o.namedVariables,indexedVariables:o.indexedVariables,memoryReference:o.memoryReference,valueLocationReference:o.valueLocationReference}}getHoverEvalTimeout(){let e=this.launchConfig.timeouts?.hoverEvaluation;if(e===void 0)return 500;if(!(e<=0))return e}async _evaluateRepl(e,t,n){let i=await t;if(!i)return{name:e.expression,value:"",variablesReference:0};if(i.exceptionDetails){let c=await new Tl(i.exceptionDetails).toDap(this);throw new O(w0(c.output))}let o=this._selectedContext&&this.defaultExecutionContext()!==this._selectedContext?`\x1B[33m[${this.target.executionContextName(this._selectedContext.description)}] `:"",s=await this.replVariables.createFloatingVariable(e.expression,i.result).toDap("repl",n),a=ih("repl").budget;return s.variablesReference===0&&s.value.length===a&&setImmediate(()=>this.console.enqueue(this,{toDap:()=>({output:he.t("Output has been truncated to the first {0} characters. Run `{1}` to copy the full output.",a,`copy(${e.expression.trim()})`),category:"stdout"})})),{...s,value:`${o}${s.value}`}}_initialize(){this._cdp.Runtime.on("executionContextCreated",e=>{this._executionContextCreated(e.context)}),this._cdp.Runtime.on("executionContextDestroyed",e=>{this._executionContextDestroyed(e.executionContextId)}),this._cdp.Runtime.on("executionContextsCleared",()=>{this._ensureDebuggerEnabledAndRefreshDebuggerId(),this.replVariables.clear(),this._executionContextsCleared()}),this._cdp.Inspector.on("targetReloadedAfterCrash",()=>{this._breakpointManager.reapply()}),this.launchConfig.outputCapture==="console"&&(this._cdp.Runtime.on("consoleAPICalled",e=>{this.console.dispatch(this,e)}),this._cdp.Runtime.on("exceptionThrown",e=>{this.console.enqueue(this,new Tl(e.exceptionDetails))})),this._cdp.Runtime.on("inspectRequested",e=>{e.hints.copyToClipboard?this._copyObjectToClipboard(e.object):e.hints.queryObjects?this.console.enqueue(this,new mh(e.object,this.cdp())):this._revealObject(e.object)}),this._cdp.Debugger.on("paused",async e=>this._onPaused(e)),this._cdp.Debugger.on("resumed",()=>this.onResumed()),this._cdp.Debugger.on("scriptParsed",e=>this._onScriptParsed(e)),this._cdp.Debugger.on("scriptFailedToParse",e=>this._onScriptParsed(e)),this._cdp.Runtime.enable({}),this._cdp.Profiler.enable({}),this._ensureDebuggerEnabledAndRefreshDebuggerId(),this.launchConfig.noDebug&&this.logger.info("runtime.launch","Running with noDebug, so debug domains are disabled"),this.target.initialize(),this._dap.with(e=>e.thread({reason:"started",threadId:this.id}))}dapInitialized(){this._dap.resolve()}async enableNetworking({mirrorEvents:e}){if(!await this._cdp.Network.enable({}))throw I0();return this._dap.with(n=>{for(let i of e)this._cdp.Network.on(i,o=>n.networkEvent({data:o,event:i}))}),{}}async getStepInTargets(e){let t=this._pausedDetails;if(!t)return[];let n=t.stackTrace.frames.find(l=>l.frameId===e);if(!(n instanceof Nt))return[];let i=await n.uiLocation();if(!i)return[];let o=t.event.callFrames[0].location,[s,a]=await Promise.all([this._breakpointManager.getBreakpointLocations(this,i.source,new Fe(i.lineNumber,1),new Fe(i.lineNumber+1,1)).then(l=>l.filter(p=>p.breakLocation.lineNumber!==o.lineNumber||p.breakLocation.columnNumber!==o.columnNumber)),i.source.content()]),c=t.stepInTargets?.length||0;t.stepInTargets=t.stepInTargets?.concat(s)||s;let u=a&&new Hi(a);return s.map((l,p)=>{let d=l.uiLocations.find(h=>h.source===i.source);if(!d)return;if(!u)return{id:c+p,label:`Column ${d}`,line:d.lineNumber,column:d.columnNumber};let f=YT(a.slice(u.getLineOffset(d.lineNumber-1),u.getLineOffset(d.lineNumber)),d.columnNumber-1);if(f)return{id:c+p,label:f.text,line:d.lineNumber,column:f.start+1,endLine:d.lineNumber,endColumn:f.end+1}}).filter(wt)}async refreshStackTrace(){this._pausedDetails&&(this._pausedDetails=await this._createPausedDetails(this._pausedDetails.event),this._onThreadResumed(),await this._onThreadPaused(this._pausedDetails))}_executionContextCreated(e){let t=new o_(e);return this._executionContexts.set(e.id,t),this._scriptWithSourceMapHandler&&this._installWasmPauseHandler(e.id),t}_installWasmPauseHandler(e){return this._cdp.Runtime.evaluate({expression:hk.expr(),silent:!0,contextId:e})}async _executionContextDestroyed(e){let t=this._executionContexts.get(e);t&&(this._executionContexts.delete(e),await this.shutdown.shutdownContext(),t.remove(this._sourceContainer))}async _executionContextsCleared(){let e=[...this._executionContexts.values()],t=this._pausedDetails;this._executionContexts.clear(),await this.shutdown.shutdownContext();for(let n of e)n.remove(this._sourceContainer);this._breakpointManager.executionContextWasCleared(),t&&t===this._pausedDetails&&!this.disposed&&this.onResumed()}_ensureDebuggerEnabledAndRefreshDebuggerId(){if(this.launchConfig.noDebug)return this.debuggerReady.resolve();this._cdp.Debugger.enable({}).then(e=>{this.debuggerReady.resolve(),e&&r._allThreadsByDebuggerId.set(e.debuggerId,this)}),this.exceptionPause.apply(this._cdp)}async _onPaused(e){let t=e.hitBreakpoints??[],n=e.reason==="Break on start"||e.reason==="debugCommand",i=e.callFrames[0]?.location,o=e.data?.scriptId||i?.scriptId,s=o&&this._sourceContainer.getSourceScriptById(o)?.url===Wv,a=o&&(e.reason==="instrumentation"||this._breakpointManager.isEntrypointBreak(t,o)||t.some(p=>this._pauseOnSourceMapBreakpointIds?.includes(p))||s);if(this.evaluator.setReturnedValue(e.callFrames[0]?.returnValue),a){this.launchConfig.perScriptSourcemaps==="auto"&&this._shouldEnablePerScriptSms(e)&&await this._enablePerScriptSourcemaps(),e.data&&!n&&(e.data.__rewriteAs="breakpoint");let p=this._expectedPauseReason;if(s){let d=this._lastParsedWasmScriptIds;return this._lastParsedWasmScriptIds=void 0,d&&await Promise.all(d.map(f=>this._handleSourceMapPause(f,i))),this.resume()}else if(!(o&&await this._handleSourceMapPause(o,i))){if(!n){if(await this.isCrossThreadStep(e))e.data={...e.data,__rewriteAs:"step"};else if(!await this._breakpointManager.shouldPauseAt(e,t,this.target.entryBreakpoint,!0))if(p?.reason==="step"){if(p.direction!==0)return this._cdp.Debugger.resume({})}else return this.resume()}}}else if(!(e.reason==="exception"||e.reason==="promiseRejection"?await this.exceptionPause.shouldPauseAt(e):await this._breakpointManager.shouldPauseAt(e,t,this.target.entryBreakpoint,!1)))return this.resume();let c=this._waitingForStepIn?.intoTargetBreakpoint;if(c){e.hitBreakpoints?.includes(c)?(this._waitingForStepIn.intoTargetBreakpoint=void 0,await this._cdp.Debugger.removeBreakpoint({breakpointId:c}),await this._cdp.Debugger.stepInto({breakOnAsyncCall:!1})):this.resume();return}if(n&&("continueOnAttach"in this.launchConfig&&this.launchConfig.continueOnAttach||this.launchConfig.type==="pwa-extensionHost"||this.target instanceof ac)){this.resume();return}let u=this._pausedDetails=await this._createPausedDetails(e);if(this._excludedCallers.length&&await this._matchesExcludedCaller(this._pausedDetails.stackTrace)){this.logger.info("runtime","Skipping pause due to excluded caller"),this.resume();return}let l=await this._smartStepper.getSmartStepDirection(u,this._expectedPauseReason);if(this._pausedDetails===u){switch(l){case 0:return this.stepInto();case 2:return this.stepOut();case 1:return this.stepOver();default:}this._waitingForStepIn=void 0,this._pausedVariables=this.replVariables.createDetached(),await this._onThreadPaused(u)}}async _matchesExcludedCaller(e){if(!this._excludedCallers.length)return!1;let t=e.frames[0],n=t instanceof Nt&&await t.uiLocation();if(!n)return!1;let i,o,s=[];for(let{caller:a,target:c}of this._excludedCallers)if(!(c.line!==n.lineNumber||c.column!==n.columnNumber)&&(i??=await n.source.toDap(),!!Rk(i,c.source))){o||(o=await e.loadFrames(j4).then(l=>Promise.all(l.slice(1).filter(Fo(Nt)).map(p=>p.uiLocation()))));for(let u=0;u<o.length;u++){let l=o[u];if(!l||l.lineNumber!==a.line||l.columnNumber!==a.column)continue;let p=s[u]??=await l.source.toDap();if(Rk(p,a.source))return!0}}return!1}onResumed(){this._pausedDetails=void 0,this._pausedVariables=void 0,this.evaluator.setReturnedValue(void 0),this._onThreadResumed()}async dispose(){await this.shutdown.shutdownAll(),this.disposed=!0;for(let[e,t]of r._allThreadsByDebuggerId)t===this&&r._allThreadsByDebuggerId.delete(e);this._removeAllScripts(!0),this._executionContextsCleared(),await this._dap.with(e=>e.thread({reason:"exited",threadId:this.id}))}rawLocation(e){if("location"in e){let t=e;return{lineNumber:Math.max(0,t.location.lineNumber)+1,columnNumber:Math.max(0,t.location.columnNumber||0)+1,scriptId:t.location.scriptId}}return{lineNumber:Math.max(0,e.lineNumber)+1,columnNumber:Math.max(0,e.columnNumber||0)+1,scriptId:e.scriptId}}rawLocationToUiLocation(e){if(!e.scriptId||this.disposed||this.launchConfig.noDebug)return;let t=this._sourceContainer.getScriptById(e.scriptId);return t?t.resolvedSource?this._sourceContainer.preferredUiLocation({...t.resolvedSource.offsetScriptToSource(e),source:t.resolvedSource}):t.source.then(n=>this._sourceContainer.preferredUiLocation({...n.offsetSourceToScript(e),source:n})):this.rawLocationToUiLocationWithWaiting(e)}async rawLocationToUiLocationWithWaiting(e){let t=e.scriptId?await this.getScriptByIdOrWait(e.scriptId):void 0;if(!t)return;let n=await t.source;return this._sourceContainer.preferredUiLocation({...n.offsetScriptToSource(e),source:n})}getScriptById(e){return this._sourceContainer.getScriptById(e)}getScriptByIdOrWait(e,t=500){return this._sourceContainer.getScriptById(e)||this.waitForScriptId(e,t)}waitForScriptId(e,t){return new Promise(n=>{let i=this._sourceContainer.onScript(s=>{s.scriptId===e&&(n(s),i.dispose(),clearTimeout(o))}),o=setTimeout(()=>{n(void 0),i.dispose()},t)})}async renderDebuggerLocation(e){let t=this.rawLocation(e),n=await this.rawLocationToUiLocation(t);return n?`@ ${await n.source.prettyName()}:${n.lineNumber}`:`@ VM${t.scriptId||"XX"}:${t.lineNumber}`}async updateCustomBreakpoints(e,t){if(!this.target.supportsCustomBreakpoints())return;this._enabledCustomBreakpoints??=new Set;let n=new Set;for(let o of e)n.add("x"+o);for(let o of t)n.add("e"+o);let i=[];for(let o of n)if(!this._enabledCustomBreakpoints.has(o)){let s=o.slice(1);i.push(o.startsWith("x")?this._cdp.DOMDebugger.setXHRBreakpoint({url:s}):uh().get(s)?.apply(this._cdp,!0))}for(let o of this._enabledCustomBreakpoints)if(!n.has(o)){let s=o.slice(1);i.push(o.startsWith("x")?this._cdp.DOMDebugger.removeXHRBreakpoint({url:s}):uh().get(s)?.apply(this._cdp,!1))}this._enabledCustomBreakpoints=n,await Promise.all(i)}async _createPausedDetails(e){let t=e.reason==="assert"||e.reason==="exception"||e.reason==="promiseRejection"||e.reason==="other"||e.reason==="ambiguous",n=e.hitBreakpoints?.filter(o=>!this._breakpointManager.isEntrypointCdpBreak(o))||[];if((n.length||!t)&&this._sourceContainer.clearDisabledSourceMaps(),e.hitBreakpoints&&this._sourceMapDisabler)for(let o of this._sourceMapDisabler(e.hitBreakpoints))this._sourceContainer.disableSourceMapForSource(o);let i=Ii.fromDebugger(this,e.callFrames,e.asyncStackTrace,e.asyncStackTraceId);if(e.data?.__rewriteAs==="breakpoint")return{thread:this,event:e,stackTrace:i,reason:"breakpoint",description:he.t("Paused on breakpoint")};if(e.data?.__rewriteAs==="step")return{thread:this,event:e,stackTrace:i,reason:"step",description:he.t("Paused")};switch(e.reason){case"assert":return{thread:this,event:e,stackTrace:i,reason:"exception",description:he.t("Paused on assert")};case"debugCommand":return{thread:this,event:e,stackTrace:i,reason:"pause",description:he.t("Paused on debug() call")};case"DOM":return{thread:this,event:e,stackTrace:i,reason:"data breakpoint",description:he.t("Paused on DOM breakpoint")};case"EventListener":return this._resolveEventListenerBreakpointDetails(i,e);case"exception":return{thread:this,event:e,stackTrace:i,reason:"exception",description:he.t("Paused on exception"),exception:e.data};case"promiseRejection":return{thread:this,event:e,stackTrace:i,reason:"exception",description:he.t("Paused on {0}","promise rejection"),exception:e.data};case"instrumentation":return e.data&&e.data.scriptId?{thread:this,event:e,stackTrace:i,reason:"step",description:he.t("Paused")}:{thread:this,event:e,stackTrace:i,reason:"function breakpoint",description:he.t("Paused on instrumentation breakpoint")};case"XHR":return{thread:this,event:e,stackTrace:i,reason:"data breakpoint",description:he.t("Paused on XMLHttpRequest or fetch")};case"OOM":return{thread:this,event:e,stackTrace:i,reason:"exception",description:he.t("Paused before Out Of Memory exception")};default:if(n.length){let o=!1,s=this.target.entryBreakpoint;if(s&&n.includes(s.cdpId)){o=!0;let a=this._sourceContainer.source({path:$e(s.path)});a!==void 0&&(o=!(await this._sourceContainer.currentSiblingUiLocations({lineNumber:e.callFrames[0].location.lineNumber+1,columnNumber:(e.callFrames[0].location.columnNumber||0)+1,source:a}))?.some(u=>this._breakpointManager.hasAtLocation(u)))}return o||this._breakpointManager.registerBreakpointsHit(n),{thread:this,event:e,stackTrace:i,hitBreakpoints:e.hitBreakpoints,reason:o?"entry":"breakpoint",description:he.t("Paused on breakpoint")}}return this._expectedPauseReason?{thread:this,event:e,stackTrace:i,description:he.t("Paused"),...this._expectedPauseReason}:{thread:this,event:e,stackTrace:i,reason:"pause",description:he.t("Paused on debugger statement")}}}_resolveEventListenerBreakpointDetails(e,t){let n=t.data,i=n&&n.eventName||"",o=uh().get(i);if(o){let s=o.details(n);return{thread:this,event:t,stackTrace:e,reason:"function breakpoint",description:s.short,text:s.long}}return{thread:this,event:t,stackTrace:e,reason:"function breakpoint",description:he.t("Paused on event listener")}}_clearDebuggerConsole(){return{category:"console",output:"\x1B[2J"}}_removeAllScripts(e=!1){this._sourceContainer.clear(e)}_onScriptParsed(e){let t={url:e.url,hasSourceURL:!!e.hasSourceURL,embedderName:e.embedderName,scriptId:e.scriptId,executionContextId:e.executionContextId};kt(e.url)&&(e.url=ge(e.url));let n=this._sourceContainer.getScriptById(e.scriptId);if(n&&this._executionContexts.has(n.executionContextId))return;if(e.url.endsWith(".cdp")){this._sourceContainer.addScriptById(t);return}e.url&&(e.url=this.target.scriptUrlToUrl(e.url));let i=this._executionContexts.get(e.executionContextId);i||(this.logger.info("internal","Creating missing execution context id",e),i=this._executionContextCreated({id:e.executionContextId,name:"<autofilled>",origin:"",uniqueId:String(e.executionContextId)}));let s={...t,source:(async()=>{let a=this._sourceContainer.getSourceByOriginalUrl(e.url);if(e.hash&&a?.contentHash===e.hash)return a.addScript({scriptId:e.scriptId,url:e.url,embedderName:e.embedderName,hasSourceURL:!!e.hasSourceURL,executionContextId:e.executionContextId}),a;let c=async()=>{let f=await this._cdp.Debugger.getScriptSource({scriptId:e.scriptId});return f?f.scriptSource:void 0},u=e.startLine||e.startColumn?{lineOffset:e.startLine,columnOffset:e.startColumn}:void 0,l=e.url.endsWith("#vscode-extension")?{lineOffset:2,columnOffset:0}:void 0,p;e.sourceMapURL&&(p=xt(e.sourceMapURL)?e.sourceMapURL:e.url&&$i(e.url,e.sourceMapURL)||e.url,p||this._dap.with(f=>f0(f,`Could not load source map from ${e.sourceMapURL}`))),e.scriptLanguage==="WebAssembly"&&(this._lastParsedWasmScriptIds??=[],this._lastParsedWasmScriptIds.push(e.scriptId));let d=await this._sourceContainer.addSource(e,c,p,u,l,!e.hasSourceURL&&this.launchConfig.enableContentValidation?e.hash:void 0);return d.addScript({scriptId:e.scriptId,url:e.url,embedderName:e.embedderName,hasSourceURL:!!e.hasSourceURL,executionContextId:e.executionContextId}),d})()};s.source.then(a=>s.resolvedSource=a),i.scripts.push(s),this._sourceContainer.addScriptById(s),(e.sourceMapURL||e.scriptLanguage==="WebAssembly")&&this._getOrStartLoadingSourceMaps(s)}async _handleSourceMapPause(e,t){this._pausedForSourceMapScriptId=e;let n=this._sourceContainer.sourceMapTimeouts().sourceMapMinPause,i=n+this._sourceContainer.sourceMapTimeouts().sourceMapCumulativePause,o=this._sourceContainer.getScriptById(e);if(!o)return this._pausedForSourceMapScriptId=void 0,!1;let s=new Br,a=this._breakpointManager.disableEntrypointBreaks(e),c=await Promise.race([this._getOrStartLoadingSourceMaps(o),ue(i)]),u=s.elapsed().ms,l=this._sourceContainer.sourceMapTimeouts().sourceMapCumulativePause-Math.max(u-n,0);this._sourceContainer.setSourceMapTimeouts({...this._sourceContainer.sourceMapTimeouts(),sourceMapCumulativePause:l}),this.logger.verbose("internal","Blocked execution waiting for source-map",{timeSpentWallClockInMs:u,sourceMapCumulativePause:l}),c||this._dap.with(f=>f.output({category:"stderr",output:he.t("WARNING: Processing source-maps of {0} took longer than {1} ms so we continued execution without waiting for all the breakpoints for the script to be set.",o.url||o.scriptId,i)})),console.assert(this._pausedForSourceMapScriptId===e),this._pausedForSourceMapScriptId=void 0,await a;let p=t?.lineNumber||0,d=t?.columnNumber;return!!c?.map(gi).some(f=>f.lineNumber===p&&(d===void 0||d===f.columnNumber))}_getOrStartLoadingSourceMaps(e){let t=this._executionContexts.get(e.executionContextId);if(!t)return Promise.resolve([]);let n=t.sourceMapLoads.get(e.scriptId);if(n)return n;let i=e.source.then(o=>this._sourceContainer.waitForSourceMapSources(o)).then(o=>o.length&&this._scriptWithSourceMapHandler?this._scriptWithSourceMapHandler(e,o):[]);return t.sourceMapLoads.set(e.scriptId,i),i}async _revealObject(e){if(e.type!=="function"||e.objectId===void 0)return;let t=await this._cdp.Runtime.getProperties({objectId:e.objectId,ownProperties:!0});if(t)for(let n of t.internalProperties||[]){if(n.name!=="[[FunctionLocation]]"||!n.value||n.value.subtype!=="internal#location")continue;let i=await this.rawLocationToUiLocation(this.rawLocation(n.value.value));i&&this._sourceContainer.revealUiLocation(i);break}}async _copyObjectToClipboard(e){if(!e.objectId){this._dap.with(t=>t.copyRequested({text:ms(e,"copy")}));return}try{let t=await mk({cdp:this.cdp(),objectId:e.objectId,args:[2],silent:!0,returnByValue:!0});this._dap.with(n=>n.copyRequested({text:t.value}))}catch{}finally{this.cdp().Runtime.releaseObject({objectId:e.objectId}).catch(()=>{})}}async _onThreadPaused(e){this._expectedPauseReason=void 0,this._onPausedEmitter.fire(e);let t;e.hitBreakpoints&&(t=await Promise.race([ue(1e3).then(()=>{}),Promise.all(e.hitBreakpoints.map(n=>this._breakpointManager._resolvedBreakpoints.get(n)).filter(Fo(Dr)).map(n=>n.untilSetCompleted().then(()=>n.dapId)))])),await ue(0),this._dap.with(n=>n.stopped({reason:e.reason,description:e.description,threadId:this.id,text:e.text,hitBreakpointIds:t,allThreadsStopped:!1}))}_onThreadResumed(){this._dap.with(e=>e.continued({threadId:this.id,allThreadsContinued:!1}))}isCrossThreadStep(e){if(!e.asyncStackTraceId||!e.asyncStackTraceId.debuggerId)return!1;let t=r.threadForDebuggerId(e.asyncStackTraceId.debuggerId);if(!t||!t._waitingForStepIn?.lastDetails)return!1;let n=t._waitingForStepIn.lastDetails.stackTrace;return t._cdp.Debugger.getStackTrace({stackTraceId:e.asyncStackTraceId}).then(i=>!i||!i.stackTrace.callFrames.length||!Nt.fromRuntime(t,i.stackTrace.callFrames[0],!1).equivalentTo(n.frames[0])?!1:(t._waitingForStepIn=void 0,!0))}async setScriptSourceMapHandler(e,t){this._scriptWithSourceMapHandler=t;let n=e&&this._sourceContainer.sourceMapTimeouts().sourceMapMinPause&&t;if(n&&!this._pauseOnSourceMapBreakpointIds?.length){await this.debuggerReady.promise;let i=await Promise.all([this._cdp.Debugger.setInstrumentationBreakpoint({instrumentation:"beforeScriptWithSourceMapExecution"})]);this._pauseOnSourceMapBreakpointIds=i.map(o=>o?.breakpointId).filter(wt)}else if(!n&&this._pauseOnSourceMapBreakpointIds?.length){let i=this._pauseOnSourceMapBreakpointIds;this._pauseOnSourceMapBreakpointIds=void 0,await Promise.all(i.map(o=>this._cdp.Debugger.removeBreakpoint({breakpointId:o})))}if(t){let i=Promise.all([...this._executionContexts.keys()].map(o=>this._installWasmPauseHandler(o)));await Promise.race([i,ue(100)])}return!!this._pauseOnSourceMapBreakpointIds?.length}async _enablePerScriptSourcemaps(){await this._breakpointManager.updateEntryBreakpointMode(this,1),await this.setScriptSourceMapHandler(!1,this._scriptWithSourceMapHandler)}_shouldEnablePerScriptSms(e){let t=this._sourceContainer.getScriptById(e.callFrames[0]?.location.scriptId);return t?t.url.includes("@vite/client")?!0:e.reason!=="instrumentation"||!xt(e.data?.sourceMapURL)?!1:t.url.startsWith("webpack")||t.url.startsWith("ng:"):!1}setSourceMapDisabler(e){this._sourceMapDisabler=e}static threadForDebuggerId(e){return r._allThreadsByDebuggerId.get(e)}async replacePathsInStackTrace(e){let t=[];for(let i of new oo(e)){if(typeof i=="string"){t.push(i);continue}let o=this._sourceContainer.getSourceByOriginalUrl(ge(i.path))||this._sourceContainer.getSourceByOriginalUrl(i.path);if(!o){t.push(i.toString());continue}t.push(this._sourceContainer.preferredUiLocation({columnNumber:i.position.base1.columnNumber,lineNumber:i.position.base1.lineNumber,source:o}).then(({source:s,lineNumber:a,columnNumber:c})=>`${s.absolutePath}:${a}:${c}`))}return(await Promise.all(t)).join("")}};var kk=r=>typeof r.uiLocation=="function",Ii=class r{constructor(e){this.thread=e;this.frames=[];this._frameById=new Map;this._lastInlineWasmExpanded=Promise.resolve(0);this._lastFrameThread=e}static fromRuntime(e,t){let n=new r(e);for(let i of t.callFrames)i.url.endsWith(".cdp")||n.frames.push(Nt.fromRuntime(e,i,!1));return t.parentId?(n._asyncStackTraceId=t.parentId,console.assert(!t.parent)):n._appendStackTrace(e,t.parent),n}static fromDebugger(e,t,n,i){let o=new r(e);for(let s of t)o._appendFrame(Nt.fromDebugger(e,s));return i?(o._asyncStackTraceId=i,console.assert(!n)):o._appendStackTrace(e,n),o}async loadFrames(e,t){return await this.expandAsyncStack(e,t),await this.expandWasmFrames(),this.frames}async expandAsyncStack(e,t){for(;this.frames.length<e&&this._asyncStackTraceId;){if(this._asyncStackTraceId.debuggerId&&(this._lastFrameThread=lc.threadForDebuggerId(this._asyncStackTraceId.debuggerId)),!this._lastFrameThread){this._asyncStackTraceId=void 0;break}t&&this._lastFrameThread.cdp().DotnetDebugger.setEvaluationOptions({options:{noFuncEval:t},type:"stackFrame"});let n=await this._lastFrameThread.cdp().Debugger.getStackTrace({stackTraceId:this._asyncStackTraceId});this._asyncStackTraceId=void 0,n&&this._appendStackTrace(this._lastFrameThread,n.stackTrace)}}expandWasmFrames(){return this._lastInlineWasmExpanded=this._lastInlineWasmExpanded.then(async e=>{for(;e<this.frames.length;e++){let t=this.frames[e];if(!(t instanceof Nt))continue;let n=t.scriptSource?.resolvedSource;if(!Xo(n))continue;let i=await n.sourceMap.value.promise;if(!i.getFunctionStack)continue;let o=await i.getFunctionStack(t.rawPosition);if(o.length===0)continue;let s=[];for(let a=0;a<o.length;a++){let c=new El({source:n,thread:this.thread,inlineFrameIndex:a,name:o[a].name,root:t});this._frameById.set(c.frameId,c),s.push(c)}this._spliceFrames(e,1,...s),e+=o.length-1}return e})}frame(e){return this._frameById.get(e)}_appendStackTrace(e,t){for(console.assert(!t||!this._asyncStackTraceId);t;){if(t.description==="async function"&&t.callFrames.length&&t.callFrames.shift(),t.callFrames.length){this._appendFrame(new gh(t.description||"async"));for(let n of t.callFrames)this._appendFrame(Nt.fromRuntime(e,n,!0))}t.parentId&&(this._asyncStackTraceId=t.parentId,console.assert(!t.parent)),t=t.parent}}_spliceFrames(e,t,...n){this.frames.splice(e,t,...n);for(let i of n)i instanceof gh||this._frameById.set(i.frameId,i)}_appendFrame(e){this._spliceFrames(this.frames.length,0,e)}async formatAsNative(){return await this.formatWithMapper(e=>e.formatAsNative())}async format(){return await this.formatWithMapper(e=>e.format())}async formatWithMapper(e){let t=await this.loadFrames(50);for(let i=t.length-1;i>=0;i--){let o=t[i];if(o instanceof Nt&&o.isReplEval){t=t.slice(0,i+1);break}}let n=t.map(e);return(await Promise.all(n)).join(`
`)+`
`}async toDap(e){let t=e.startFrame||0,n=(e.levels||50)+t,i=await this.loadFrames(n,e.noFuncEval);n=Math.min(i.length,e.levels?n:i.length);let o=[];for(let s=t;s<n;s++)o.push(i[s].toDap(e.format));return{stackFrames:await Promise.all(o),totalFrames:this._asyncStackTraceId?1e6:i.length}}},u_=_p(),gh=class{constructor(e="async"){this.label=e;this.frameId=u_()}async toDap(){return{name:this.label,id:this.frameId,line:0,column:0,presentationHint:"label"}}async formatAsNative(){return`    --- ${this.label} ---`}async format(){return`\u25C0 ${this.label} \u25B6`}},Dk="<anonymous>",W4=/^class\s+(.+) {($|\n)/;async function V4(r,e,t){if(!e.functionName)return Dk;if(e.functionName.includes("."))return e.functionName;let n;if(e.this.objectId&&t&&(n=(await r.cdp().Runtime.callFunctionOn({functionDeclaration:ah.decl("64","null"),objectId:e.this.objectId,returnByValue:!0}))?.result.value),!n&&e.this.description){n=e.this.description;let s=W4.exec(n);s&&(n=s[1])}if(!n)return e.functionName;let i=n.indexOf(`
`);i!==-1&&(n=n.slice(0,i).trim());let o=e.functionName;return n===o?`${n}.constructor`:n?`${n}.${o}`:o}function $4(r){return r.functionName||Dk}var Nt=class r{constructor(e,t,n,i=!1){this.callFrame=t;this.isAsync=i;this.frameId=u_();this.root=this;this.getLocationInfo=ne(async()=>{let e=this.uiLocation(),t=await qv(this),n=this.overrideName||("this"in this.callFrame?await V4(this._thread,this.callFrame,t===0):$4(this.callFrame));return{isSmartStepped:t,name:n,uiLocation:await e}});this.completions=ne(async()=>{if(!this._scope)return[];let e=this._thread.pausedVariables();if(!e)return[];let t=[];for(let i=0;i<this._scope.chain.length;i++){let o=this._scopeVariable(i,this._scope);o&&t.push(e.getVariableNames({variablesReference:o.id}).then(s=>s.map(({name:a})=>({label:a,type:"property"}))))}let n=await Promise.all(t);return[].concat(...n)});this._rawLocation=n,this.uiLocation=ne(()=>e.rawLocationToUiLocation(n)),this._thread=e;let o=n.scriptId?e.getScriptById(n.scriptId):void 0;this.isReplEval=o?o.url.endsWith(".repl"):!1}get rawPosition(){return new Fe(this._rawLocation.lineNumber,this._rawLocation.columnNumber)}get rawScopeChain(){return this._scope?.chain||[]}static fromRuntime(e,t,n){return new r(e,t,e.rawLocation(t),n)}static fromDebugger(e,t){let n=new r(e,t,e.rawLocation(t));return n._scope={chain:t.scopeChain,thisObject:t.this,returnValue:t.returnValue,variables:new Array(t.scopeChain.length).fill(void 0),callFrameId:t.callFrameId},n}get scriptId(){return"scriptId"in this.callFrame?this.callFrame.scriptId:this.callFrame.location.scriptId}get scriptSource(){return this._thread._sourceContainer.getScriptById(this.scriptId)}get canExplicitlyBeRestarted(){return!!this.callFrame.canBeRestarted}equivalentTo(e){return e instanceof r&&e._rawLocation.columnNumber===this._rawLocation.columnNumber&&e._rawLocation.lineNumber===this._rawLocation.lineNumber&&e._rawLocation.scriptId===this._rawLocation.scriptId}callFrameId(){return this._scope?this._scope.callFrameId:void 0}async scopes(){let e=this._scope;if(!e)throw new O(S0());return{scopes:(await Promise.all(e.chain.map(async(n,i)=>{let o="",s;switch(n.type){case"global":o=rr.t("Global");break;case"local":o=rr.t("Local"),s="locals";break;case"with":o=rr.t("With Block"),s="locals";break;case"closure":o=rr.t("Closure"),s="arguments";break;case"catch":o=rr.t("Catch Block"),s="locals";break;case"block":o=rr.t("Block"),s="locals";break;case"script":o=rr.t("Script");break;case"eval":o=rr.t("Eval");break;case"module":o=rr.t("Module");break;default:o=n.type.substr(0,1).toUpperCase()+n.type.substr(1);break}n.name&&n.type==="closure"?o=rr.t("Closure ({0})",n.name):n.name&&(o=`${o}: ${n.name}`);let a=this._scopeVariable(i,e);if(!a)return;let c={name:o,presentationHint:s,expensive:n.type==="global",variablesReference:a.id};if(n.startLocation){let u=this._thread.rawLocation(n.startLocation),l=await this._thread.rawLocationToUiLocation(u);if(c.line=(l||u).lineNumber,c.column=(l||u).columnNumber,l&&(c.source=await l.source.toDap()),n.endLocation){let p=this._thread.rawLocation(n.endLocation),d=await this._thread.rawLocationToUiLocation(p);c.endLine=(d||p).lineNumber,c.endColumn=(d||p).columnNumber}}return c}))).filter(wt)}}getStepSkipList(e){return Promise.resolve(void 0)}async toDap(e){let{isSmartStepped:t,name:n,uiLocation:i}=await this.getLocationInfo(),o=i?await i.source.toDap():void 0,s=t?"deemphasize":"normal";t&&o&&(o.origin=t===1?rr.t("Skipped by smartStep"):rr.t("Skipped by skipFiles"));let a=(i||this._rawLocation).lineNumber,c=(i||this._rawLocation).columnNumber,u=n;return o&&e&&(e.module&&(u+=` [${o.name}]`),e.line&&(u+=` Line ${a}`)),{id:this.frameId,name:u,line:a,column:c,source:o,presentationHint:s,canRestart:this.callFrame.canBeRestarted??!this.isAsync}}async formatAsNative(){let{name:e,uiLocation:t}=await this.getLocationInfo(),n=await t?.source.existingAbsolutePath()||await t?.source.prettyName()||this.callFrame.url,{lineNumber:i,columnNumber:o}=t||this._rawLocation;return`    at ${e} (${n}:${i}:${o})`}async format(){let{name:e,uiLocation:t}=await this.getLocationInfo(),n=await t?.source.prettyName()||"<unknown>",i=t||this._rawLocation,o=`${e} @ ${n}:${i.lineNumber}`;return i.columnNumber>1&&(o+=`:${i.columnNumber}`),o}_scopeVariable(e,t){let n=t.variables[e];if(n)return n;let i={stackFrame:this,callFrameId:t.callFrameId,scopeNumber:e},o=[];e===0&&(t.thisObject&&o.push({name:"this",value:t.thisObject}),t.returnValue&&o.push({name:rr.t("Return value"),value:t.returnValue}));let s=this._thread.pausedVariables();if(!s)return;let a=s.createScope(t.chain[e].object,i,o);return t.variables[e]=a}},c_={scopes:[]},El=class{constructor(e){this.frameId=u_();this.name=e.name,this.root=e.root,this.thread=e.thread,this.source=e.source,this.inlineFrameIndex=e.inlineFrameIndex,this.wasmPosition=new Oe(this.inlineFrameIndex,this.root.rawPosition.base0.columnNumber),this.uiLocation=ne(()=>e.thread._sourceContainer.preferredUiLocation({columnNumber:e.root.rawPosition.base1.columnNumber,lineNumber:e.inlineFrameIndex+1,source:e.source}))}async formatAsNative(){let{columnNumber:e,lineNumber:t,source:n}=await this.uiLocation();return`    at ${this.name} (${n.url}:${t}:${e})`}async format(){let{columnNumber:e,lineNumber:t,source:n}=await this.uiLocation(),i=await n.prettyName()||"<unknown>";return`${this.name} @ ${i}:${t}:${e}`}async toDap(){let{columnNumber:e,lineNumber:t,source:n}=await this.uiLocation();return Promise.resolve({id:this.frameId,name:this.name,column:e,line:t,source:await n.toDap()})}async getStepSkipList(e){let t=this.source.sourceMap.value.settledValue;if(!t?.getStepSkipList)return;let n=await this.uiLocation();return n?t.getStepSkipList(e,this.wasmPosition,n.source.compiledToSourceUrl.get(this.source),new Fe(n.lineNumber,n.columnNumber)):t.getStepSkipList(e,this.root.rawPosition)}async scopes(){let e=this.source.sourceMap.value.settledValue,t=this.root.callFrameId();if(!e||!t)return c_;let n=await e.getVariablesInScope?.(t,this.wasmPosition);if(!n)return c_;let i=this.thread.pausedVariables();if(!i)return c_;let o={stackFrame:this.root,callFrameId:t,scopeNumber:0};return{scopes:await Promise.all([...BT(n,s=>s.scope)].map(([s,a])=>i.createWasmScope(s,a,o).toDap("propertyValue").then(c=>({name:c.name,variablesReference:c.variablesReference,expensive:s!=="LOCAL"}))))}}};var Ok=S(He());var bs=class{constructor(e){this.event=e;this.stackTrace=ne(e=>this.event.stackTrace?Ii.fromRuntime(e,this.event.stackTrace):void 0);this.getUiLocation=ne(async e=>{let t=this.stackTrace(e);if(!t)return;let n;for(let i of t.frames){if(!(i instanceof Nt))continue;let o=await i.uiLocation();if(o&&(n||(n=o),!o.source.blackboxed()))return{source:await o.source.toDap(),line:o.lineNumber,column:o.columnNumber}}if(n)return{source:await n.source.toDap(),line:n.lineNumber,column:n.columnNumber}})}formatDefaultString(e,t,n=!1){let o=t.length>1&&t[0].type==="string"?Lv(t[0].value,t.slice(1),jv):Lv("",t,jv),s=o.result+`
`;return o.usedAllSubs&&!t.some(hs)?{output:s}:this.formatComplexStringOutput(e,s,t,n)}async formatComplexStringOutput(e,t,n,i){(n.some(s=>s.subtype==="error")||oo.isStackLike(t))&&(await this.getUiLocation(e),t=await e.replacePathsInStackTrace(t),i=!0);let o=e.replVariables.createVariableForOutput(t,n,i?this.stackTrace(e):void 0);return{output:t,variablesReference:o.id}}},yh=class extends bs{async toDap(e){return this.event.args[0]?.value==="console.assert"&&(this.event.args[0].value=Ok.t("Assertion failed")),{category:"stderr",...await this.formatDefaultString(e,this.event.args,!0),...await this.getUiLocation(e)}}},vs=class extends bs{constructor(t,n,i){super(t);this.includeStack=n;this.category=i}async toDap(t){return{category:this.category,...await this.formatDefaultString(t,this.event.args,this.includeStack),...await this.getUiLocation(t)}}},lo=class extends vs{constructor(e){super(e,!1,"stdout")}},bh=class extends vs{constructor(e){super(e,!0,"stdout")}},vh=class extends vs{constructor(e){super(e,!0,"stderr")}},_h=class extends vs{constructor(e){super(e,!0,"stderr")}},wh=class extends bs{async toDap(e){return{category:"stdout",group:this.event.type==="startGroupCollapsed"?"startCollapsed":"start",...await this.formatDefaultString(e,this.event.args),...await this.getUiLocation(e)}}},Sh=class extends vs{constructor(e){super(e,!1,"stdout")}async toDap(e){return this.event.args[0]?.preview?{category:"stdout",output:"",variablesReference:e.replVariables.createVariableForOutput("",this.event.args,void 0,this.event.type).id,...await this.getUiLocation(e)}:super.toDap(e)}};var Tl=class extends bs{constructor(){super(...arguments);this.stackTrace=ne(t=>{if(this.event.stackTrace)return Ii.fromRuntime(t,this.event.stackTrace);if(this.event.scriptId)return Ii.fromRuntime(t,{callFrames:[{functionName:"(program)",lineNumber:this.event.lineNumber,columnNumber:this.event.columnNumber,scriptId:this.event.scriptId,url:this.event.url||""}]})})}async toDap(t){let n=this.event.exception?gs(this.event.exception):{title:""},i=n.title;i.startsWith("Uncaught")||(i=`Uncaught ${this.event.exception?.className??"Error"} `+i);let o=this.stackTrace(t),s=this.event.exception&&!n.stackTrace?[this.event.exception]:[];return oo.isStackLike(i)?i=await t.replacePathsInStackTrace(i):o&&(i+=`
`+await o.formatAsNative()),{category:"stderr",output:i,variablesReference:o||s.length?t.replVariables.createVariableForOutput(i,s,o).id:void 0,...await this.getUiLocation(t)}}};var xh=S(He());var Mk=nt(function(){return this});var mh=class{constructor(e,t){this.protoObj=e;this.cdp=t}async toDap(e){if(!this.protoObj.objectId)return{category:"stderr",output:xh.t("Only objects can be queried")};let t=await this.cdp.Runtime.queryObjects({prototypeObjectId:this.protoObj.objectId,objectGroup:"console"});if(await this.cdp.Runtime.releaseObject({objectId:this.protoObj.objectId}),!t)return{category:"stderr",output:xh.t("Could not query the provided object")};let n;try{n=await Mk({cdp:this.cdp,args:[],objectId:t.objects.objectId,objectGroup:"console",generatePreview:!0})}catch(s){return{category:"stderr",output:xh.t(s.message)}}let i="\x1B[32mobjects: "+ms(n,"repl")+"\x1B[0m";return{category:"stdout",output:"",variablesReference:e.replVariables.createVariableForOutput(i,[n]).id}}};var Ih=Symbol("IConsole");var _s=S(G()),Fk=g("os"),Bk=g("path");var l_=g("path"),Nk=(0,l_.join)(__dirname,"diagnosticTool.js"),Lk=(0,l_.join)(__dirname,"diagnosticTool.css");var Xn=Symbol("ITarget"),Gt=Symbol("ILauncher");var po=class{constructor(e,t,n,i){this.fs=e;this.sources=t;this.breakpoints=n;this.target=i}async generateObject(){let[e]=await Promise.all([this.dumpSources()]);return{breakpoints:this.dumpBreakpoints(),sources:e,config:this.target.launchConfig}}async generateHtml(e=(0,Bk.join)((0,Fk.tmpdir)(),"js-debug-diagnostics.html")){return await this.fs.writeFile(e,`<!DOCTYPE html>
      <html lang="en">
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <style>${await this.fs.readFile(Lk,"utf-8")}<</style>
      </head>
      <body>
        <script>window.DUMP=${JSON.stringify(await this.generateObject())}</script>
        <script>${await this.fs.readFile(Nk,"utf-8")}</script>
      </body>
      </html>`),e}dumpBreakpoints(){let e=[];for(let t of[this.breakpoints.appliedByPath,this.breakpoints.appliedByRef])for(let n of t.values())for(let i of n){let o=i.diagnosticDump();e.push({source:o.source,params:o.params,cdp:o.cdp.map(s=>s.state===1?{...s,uiLocations:s.uiLocations.map(a=>this.dumpUiLocation(a))}:{...s,done:void 0})})}return e}dumpSources(){let e=[],t=0;for(let n of this.sources.sources)e.push((async()=>({uniqueId:t++,url:n.url,sourceReference:n.sourceReference,absolutePath:n.absolutePath,actualAbsolutePath:await n.existingAbsolutePath(),scriptIds:n.scripts.map(i=>i.scriptId),prettyName:await n.prettyName(),compiledSourceRefToUrl:n instanceof Xe?[...n.compiledToSourceUrl.entries()].map(([i,o])=>[i.sourceReference,o]):void 0,sourceMap:Yo(n)?{url:n.sourceMap.metadata.sourceMapUrl,metadata:n.sourceMap.metadata,sources:ai(Object.fromEntries(n.sourceMap.sourceByUrl),i=>i.sourceReference)}:void 0}))());return Promise.all(e)}dumpUiLocation(e){return{lineNumber:e.lineNumber,columnNumber:e.columnNumber,sourceReference:e.source.sourceReference}}};po=P([(0,_s.injectable)(),y(0,(0,_s.inject)(Re)),y(1,(0,_s.inject)(mt)),y(2,(0,_s.inject)(Nr)),y(3,(0,_s.inject)(Xn))],po);var fo=S(G());var dc=Symbol("IExceptionPauseService");var pc=class{constructor(e,t,n,i,o){this.evaluator=e;this.scriptSkipper=t;this.dap=n;this.sourceContainer=o;this.state={cdp:"none"};this.blocker=be();this.noDebug=!!i.noDebug,this.breakOnError=i.__breakOnConditionalError,this.blocker.resolve()}get launchBlocker(){return this.blocker.promise}async setBreakpoints(e){if(!this.noDebug){try{this.state=this.parseBreakpointRequest(e)}catch(t){if(!(t instanceof O))throw t;this.dap.output({category:"stderr",output:t.message});return}this.cdp?await this.sendToCdp(this.cdp):this.state.cdp!=="none"&&this.blocker.hasSettled()&&(this.blocker=be())}}async shouldPauseAt(e){if(e.reason!=="exception"&&e.reason!=="promiseRejection"||this.state.cdp==="none"||e.callFrames.some(n=>this.sourceContainer.getSourceScriptById(n.location.scriptId)?.url.endsWith(".cdp"))||this.shouldScriptSkip(e))return!1;let t=this.state.condition;if(e.data?.uncaught){if(t.uncaught&&!await this.evalCondition(e,t.uncaught))return!1}else if(t.caught&&!await this.evalCondition(e,t.caught))return!1;return!0}async apply(e){this.cdp=e,this.state.cdp!=="none"&&await this.sendToCdp(e)}async sendToCdp(e){await e.Debugger.setPauseOnExceptions({state:this.state.cdp}),this.blocker.resolve()}async evalCondition(e,t){return!!(await t({callFrameId:e.callFrames[0].callFrameId},i=>i==="error"?e.data:void 0))?.result.value}shouldScriptSkip(e){if(e.data?.uncaught||!e.callFrames.length)return!1;let t=this.sourceContainer.getScriptById(e.callFrames[0].location.scriptId);return!!t&&this.scriptSkipper.isScriptSkipped(t.url)}parseBreakpointRequest(e){let t=(e.filterOptions??[]).concat(e.filters.map(a=>({filterId:a}))),n="none",i=[],o=[];for(let{filterId:a,condition:c}of t)a==="all"?(n="all",c&&i.push(a)):a==="uncaught"&&(n==="none"&&(n="uncaught"),c&&o.push(a));let s=a=>{if(a.length===0)return;let c="!!("+t.map(p=>p.condition).filter(wt).join(") || !!(")+")",u=Ki(c);if(u)throw new O(Ji({line:0,condition:c},u.message));let l=Fb(c,this.breakOnError);return this.evaluator.prepare(l,{hoist:["error"]}).invoke};return n==="none"?{cdp:n}:{cdp:n,condition:{caught:s(i),uncaught:s(o)}}}};pc=P([(0,fo.injectable)(),y(0,(0,fo.inject)(kr)),y(1,(0,fo.inject)(eo)),y(2,(0,fo.inject)(er)),y(3,(0,fo.inject)(le)),y(4,(0,fo.inject)(mt))],pc);var Th=S(G());var Ch=class{constructor(){this.didEnable=new WeakSet}async retrieve(e){this.didEnable.has(e)||(this.didEnable.add(e),await e.Performance.enable({}));let t=await e.Performance.getMetrics({});if(!t)return{error:"Error in CDP"};let n={};for(let i of t.metrics)n[i.name]=i.value;return{metrics:n}}};var Ph=class{async retrieve(e){let t=await e.Runtime.evaluate({expression:`({
        memory: process.memoryUsage(),
        cpu: process.cpuUsage(),
        timestamp: Date.now(),
        resourceUsage: process.resourceUsage && process.resourceUsage(),
      })${Ve()}`,returnByValue:!0});return t?t.exceptionDetails?{error:t.exceptionDetails.text}:{metrics:t.result.value}:{error:"No response from CDP"}}};var Eh=Symbol("IPerformanceProvider"),ws=class{constructor(e){this.target=e}create(){return this.target.type()==="node"?new Ph:new Ch}};ws=P([(0,Th.injectable)(),y(0,(0,Th.inject)(Xn))],ws);var g_=S(He()),Wk=g("crypto"),ho=S(G()),Vk=g("os"),$k=g("path");var kh=S(G());var p_=S(He()),Ss=S(G()),Rh=g("path");var fc=class{constructor(e){this.sources=e;this.locationIdCounter=0;this.locationsByRef=new Map}getLocationIdFor(e){let t=[e.functionName,e.url,e.scriptId,e.lineNumber,e.columnNumber].join(":"),n=this.locationsByRef.get(t);if(n)return n.id;let i=this.locationIdCounter++;return this.locationsByRef.set(t,{id:i,callFrame:e,locations:(async()=>{let o=await this.sources.getScriptById(e.scriptId)?.source;if(!o)return[];let s=await this.sources.currentSiblingUiLocations({lineNumber:e.lineNumber+1,columnNumber:e.columnNumber+1,source:o});return Promise.all(s.map(async a=>({...a,source:await a.source.toDap()})))})()}),i}getLocations(){return Promise.all([...this.locationsByRef.values()].sort((e,t)=>e.id-t.id).map(async e=>({callFrame:e.callFrame,locations:await e.locations})))}};var yt=class{constructor(e,t,n,i){this.cdp=e;this.fs=t;this.sources=n;this.launchConfig=i}static canApplyTo(){return!0}async start(e,t){if(!await this.cdp.Profiler.start({}))throw new O(Pa());return new d_(this.cdp,this.fs,this.sources,this.launchConfig.__workspaceFolder,t)}async save(e,t){let n=await Uk(e,this.sources,this.launchConfig.__workspaceFolder);(0,Rh.isAbsolute)(t)||(t=(0,Rh.join)(this.launchConfig.__workspaceFolder,t)),await this.fs.writeFile(t,JSON.stringify(n))}};yt.type="cpu",yt.extension=".cpuprofile",yt.label=p_.t("CPU Profile"),yt.description=p_.t("Generates a .cpuprofile file you can open in VS Code or the Edge/Chrome devtools"),yt.editable=!0,yt=P([(0,Ss.injectable)(),y(0,(0,Ss.inject)(Ue)),y(1,(0,Ss.inject)(Re)),y(2,(0,Ss.inject)(mt)),y(3,(0,Ss.inject)(le))],yt);var d_=class{constructor(e,t,n,i,o){this.cdp=e;this.fs=t;this.sources=n;this.workspaceFolder=i;this.file=o;this.stopEmitter=new k;this.disposed=!1;this.onUpdate=new k().event;this.onStop=this.stopEmitter.event}async dispose(){this.disposed||(this.disposed=!0,this.stopEmitter.fire())}async stop(){let e=await this.cdp.Profiler.stop({});if(!e)throw new O(Pa());await this.dispose();let t=await Uk(e.profile,this.sources,this.workspaceFolder);await this.fs.writeFile(this.file,JSON.stringify(t))}};async function Uk(r,e,t){let n=new fc(e),i=r.nodes.map(o=>({...o,locationId:n.getLocationIdFor(o.callFrame),positionTicks:o.positionTicks?.map(s=>({...s,startLocationId:n.getLocationIdFor({...o.callFrame,lineNumber:s.line-1,columnNumber:0}),endLocationId:n.getLocationIdFor({...o.callFrame,lineNumber:s.line,columnNumber:0})}))}));return{...r,nodes:i,$vscode:{rootPath:t,locations:await n.getLocations()}}}var f_=S(He()),xs=S(G());var br=class{constructor(e,t,n,i){this.cdp=e;this.fs=t;this.sources=n;this.launchConfig=i}static canApplyTo(){return!0}async start(e,t){if(await this.cdp.HeapProfiler.enable({}),!await this.cdp.HeapProfiler.startSampling({}))throw new O(Pa());return new h_(this.cdp,this.fs,this.sources,this.launchConfig.__workspaceFolder,t)}};br.type="heap",br.extension=".heapprofile",br.label=f_.t("Heap Profile"),br.description=f_.t("Generates a .heapprofile file you can open in VS Code or the Edge/Chrome devtools"),br.editable=!0,br=P([(0,xs.injectable)(),y(0,(0,xs.inject)(Ue)),y(1,(0,xs.inject)(Re)),y(2,(0,xs.inject)(mt)),y(3,(0,xs.inject)(le))],br);var h_=class{constructor(e,t,n,i,o){this.cdp=e;this.fs=t;this.sources=n;this.workspaceFolder=i;this.file=o;this.stopEmitter=new k;this.disposed=!1;this.onUpdate=new k().event;this.onStop=this.stopEmitter.event}async dispose(){this.disposed||(this.disposed=!0,await this.cdp.HeapProfiler.disable({}),this.stopEmitter.fire())}async stop(){let e=await this.cdp.HeapProfiler.stopSampling({});if(!e)throw new O(Pa());await this.dispose();let t=await this.annotateSources(e.profile);await this.fs.writeFile(this.file,JSON.stringify(t))}async annotateSources(e){let t=new fc(this.sources),n=(o,s)=>{s.locationId=t.getLocationIdFor(o.callFrame);for(let a of o.children){let c={...a,children:[]};s.children.push(c),n(a,c)}},i={...e.head,children:[]};return n(e.head,i),{...e,head:i,$vscode:{rootPath:this.workspaceFolder,locations:await t.getLocations()}}}};var m_=S(He()),jk=g("fs"),Ah=S(G());var vr=class{constructor(e){this.cdp=e;this.cdp.HeapProfiler.on("addHeapSnapshotChunk",({chunk:t})=>this.currentWriter?.stream.write(t))}static canApplyTo(){return!0}async start(e,t){return{onStop:new k().event,onUpdate:new k().event,dispose:()=>{},stop:async()=>{await this.cdp.HeapProfiler.enable({}),await this.dumpToFile(t),await this.cdp.HeapProfiler.disable({})}}}async dumpToFile(e){let{stream:t,promise:n}=this.currentWriter={stream:(0,jk.createWriteStream)(e),promise:this.cdp.HeapProfiler.takeHeapSnapshot({})};await n,t.end(),this.currentWriter=void 0}};vr.type="memory",vr.extension=".heapsnapshot",vr.label=m_.t("Heap Snapshot"),vr.description=m_.t("Generates a .heapsnapshot file you can open in VS Code or the Edge/Chrome devtools"),vr.instant=!0,vr=P([(0,Ah.injectable)(),y(0,(0,Ah.inject)(Ue))],vr);var Dh=Symbol("IProfilerFactory"),qk=()=>{let r=new Date;return["vscode-profile",r.getFullYear(),r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()].map(e=>String(e).padStart(2,"0")).join("-")},Ci=class{constructor(e){this.container=e}get(e){let t=Ci.ctors.find(n=>n.type===e);if(!t)throw new Error(`Invalid profilter type ${e}`);return this.container.get(t)}};Ci.ctors=[yt,br,vr],Ci=P([(0,kh.injectable)(),y(0,(0,kh.inject)(Aa))],Ci);var Oh=Symbol("IProfileController"),hc=class{constructor(e,t,n,i,o){this.cdp=e;this.factory=t;this.basicCpuProfiler=n;this.breakpoints=i;this.shutdown=o;this.seenConsoleProfileNames=Object.create(null)}connect(e,t){e.on("startProfile",async n=>(await this.start(e,t,n),{})),e.on("stopProfile",()=>this.stopProfiling(e)),this.cdp.Profiler.on("consoleProfileStarted",()=>{e.output({output:g_.t("Console profile started")+`
`,category:"console"})}),this.cdp.Profiler.on("consoleProfileFinished",async n=>{let i=this.saveConsoleProfile(e,n),o=this.shutdown.register(0,()=>i);await i,o.dispose()}),t.onPaused(()=>this.stopProfiling(e))}async start(e,t,n){if(this.profile)throw new O(_0());this.profile=this.startProfileInner(e,t,n).catch(i=>{throw this.profile=void 0,i}),await this.profile}async saveConsoleProfile(e,t){let n;if(t.title){n=t.title.replace(/[\/\\]/g,"-");let i=this.seenConsoleProfileNames[t.title]||0;this.seenConsoleProfileNames[t.title]=i+1,i>0&&(n+=`-${i}`)}else n=qk();n+=yt.extension,await this.basicCpuProfiler.save(t.profile,n),e.output({output:g_.t('CPU profile saved as "{0}" in your workspace folder',n)+`
`,category:"console"})}async startProfileInner(e,t,n){let i=!1,o;if(n.stopAtBreakpoint?.length){let l=new Set(n.stopAtBreakpoint);i=!0,o=p=>!(p instanceof Dr)||l.has(p.dapId)}else o=()=>!1;await this.breakpoints.applyEnabledFilter(o);let s=(0,$k.join)((0,Vk.tmpdir)(),`vscode-js-profile-${(0,Wk.randomBytes)(4).toString("hex")}`),a=await this.factory.get(n.type).start(n,s),c={file:s,profile:a,enableFilter:o,keptDebuggerOn:i};a.onUpdate(l=>e.profilerStateUpdate({label:l,running:!0})),a.onStop(()=>this.disposeProfile(c));let u=!!t.pausedDetails();return i?await t.resume():u&&(await this.cdp.Debugger.disable({}),u&&t.onResumed()),e.profileStarted({file:c.file,type:n.type}),c}async stopProfiling(e){let t=await this.profile?.catch(()=>{});return!t||!this.profile?{}:(this.profile=void 0,await t?.profile.stop(),e.profilerStateUpdate({label:"",running:!1}),{})}async disposeProfile({profile:e,enableFilter:t,keptDebuggerOn:n}){n||await this.cdp.Debugger.enable({}),await this.breakpoints.applyEnabledFilter(void 0,t),e.dispose()}};hc=P([(0,ho.injectable)(),y(0,(0,ho.inject)(Ue)),y(1,(0,ho.inject)(Dh)),y(2,(0,ho.inject)(yt)),y(3,(0,ho.inject)(Nr)),y(4,(0,ho.inject)(Qi))],hc);var Is=class r{constructor(e,t,n,i){this.asyncStackPolicy=t;this.launchConfig=n;this._services=i;this._disposables=new De;this._customBreakpoints=[];this._xhrBreakpoints=[];this._threadDeferred=be();this.breakpointIdCounter=_p();this._cdpProxyProvider=this._services.get(Qf);this._configurationDoneDeferred=be(),this.sourceContainer=i.get(mt),this.breakpointManager=i.get(Nr);let o=i.get(Eh),s=i.get(Ot);s.onFlush(()=>{s.report("breakpointStats",this.breakpointManager.statisticsForTelemetry()),s.report("statistics",this.sourceContainer.statistics())}),this.dap=e,this.dap.on("initialize",a=>this.onInitialize(a)),this.dap.on("setBreakpoints",a=>this._onSetBreakpoints(a)),this.dap.on("setExceptionBreakpoints",a=>this.setExceptionBreakpoints(a)),this.dap.on("configurationDone",()=>this.configurationDone()),this.dap.on("loadedSources",()=>this._onLoadedSources()),this.dap.on("disableSourcemap",a=>this._onDisableSourcemap(a)),this.dap.on("source",a=>this._onSource(a)),this.dap.on("threads",()=>this._onThreads()),this.dap.on("stackTrace",a=>this._withThread(c=>c.stackTrace(a))),this.dap.on("variables",a=>this._onVariables(a)),this.dap.on("readMemory",a=>this._onReadMemory(a)),this.dap.on("writeMemory",a=>this._onWriteMemory(a)),this.dap.on("setVariable",a=>this._onSetVariable(a)),this.dap.on("setExpression",a=>this._onSetExpression(a)),this.dap.on("continue",()=>this._withThread(a=>a.resume())),this.dap.on("pause",()=>this._withThread(a=>a.pause())),this.dap.on("next",()=>this._withThread(a=>a.stepOver())),this.dap.on("stepIn",a=>this._withThread(c=>c.stepInto(a.targetId))),this.dap.on("stepOut",()=>this._withThread(a=>a.stepOut())),this.dap.on("restartFrame",a=>this._withThread(c=>c.restartFrame(a))),this.dap.on("scopes",a=>this._withThread(c=>c.scopes(a))),this.dap.on("evaluate",a=>this.onEvaluate(a)),this.dap.on("completions",a=>this._withThread(c=>c.completions(a))),this.dap.on("exceptionInfo",()=>this._withThread(a=>a.exceptionInfo())),this.dap.on("setCustomBreakpoints",a=>this.setCustomBreakpoints(a)),this.dap.on("toggleSkipFileStatus",a=>this._toggleSkipFileStatus(a)),this.dap.on("toggleSkipFileStatus",a=>this._toggleSkipFileStatus(a)),this.dap.on("prettyPrintSource",a=>this._prettyPrintSource(a)),this.dap.on("locations",a=>this._onLocations(a)),this.dap.on("revealPage",()=>this._withThread(a=>a.revealPage())),this.dap.on("getPerformance",()=>this._withThread(a=>o.retrieve(a.cdp()))),this.dap.on("breakpointLocations",a=>this._breakpointLocations(a)),this.dap.on("createDiagnostics",a=>this._dumpDiagnostics(a)),this.dap.on("requestCDPProxy",()=>this._requestCDPProxy()),this.dap.on("setExcludedCallers",a=>this._onSetExcludedCallers(a)),this.dap.on("saveDiagnosticLogs",({toFile:a})=>this._saveDiagnosticLogs(a)),this.dap.on("setSourceMapStepping",a=>this._setSourceMapStepping(a)),this.dap.on("stepInTargets",a=>this._stepInTargets(a)),this.dap.on("setDebuggerProperty",a=>this._setDebuggerProperty(a)),this.dap.on("setSymbolOptions",a=>this._setSymbolOptions(a)),this.dap.on("networkCall",a=>this._doNetworkCall(a)),this.dap.on("enableNetworking",a=>this._withThread(c=>c.enableNetworking(a))),this.dap.on("getPreferredUILocation",a=>this._getPreferredUILocation(a))}async _getPreferredUILocation(e){let t;if(e.originalUrl&&(t=this.sourceContainer.getSourceByOriginalUrl(e.originalUrl)),!t&&e.source&&(t=this.sourceContainer.source(e.source)),!t){if(e.source)return{column:e.column,line:e.line,source:e.source};throw new O(P0())}let n=await this.sourceContainer.preferredUiLocation({columnNumber:e.column+1,lineNumber:e.line+1,source:t});return{column:n.columnNumber-1,line:n.lineNumber-1,source:await n.source.toDap()}}async _doNetworkCall({method:e,params:t}){return this._thread?this._thread.cdp().Network[e](t):Promise.resolve({})}_setDebuggerProperty(e){return this._thread?.cdp().DotnetDebugger.setDebuggerProperty(e),Promise.resolve({})}_setSymbolOptions(e){return this._thread?.cdp().DotnetDebugger.setSymbolOptions(e),Promise.resolve({})}_breakpointLocations(e){return this._withThread(async t=>{let n=this.sourceContainer.source(e.source);return n?{breakpoints:(await this.breakpointManager.getBreakpointLocations(t,n,new Fe(e.line,e.column||1),new Fe(e.endLine||e.line+1,e.endColumn||e.column||1))).map(o=>o.uiLocations.find(s=>s.source===n)).filter(wt).map(o=>({line:o.lineNumber,column:o.columnNumber}))}:{breakpoints:[]}})}_stepInTargets(e){return this._withThread(async t=>({targets:await t.getStepInTargets(e.frameId)}))}_setSourceMapStepping({enabled:e}){return this.sourceContainer.doSourceMappedStepping=e,Promise.resolve({})}async _saveDiagnosticLogs(e){let t=this._services.get(W).getRecentLogs();return await this._services.get(Re).writeFile(e,t.map(n=>JSON.stringify(n)).join(`
`)),{}}async launchBlocker(){await this._configurationDoneDeferred.promise,await this._thread?.debuggerReady.promise,await this._services.get(dc).launchBlocker,await this.breakpointManager.launchBlocker()}async _onSetExcludedCallers({callers:e}){return(await this._threadDeferred.promise).setExcludedCallers(e),{}}async onInitialize(e){console.assert(e.linesStartAt1),console.assert(e.columnsStartAt1),this._services.get(gl).value=e;let t=r.capabilities(!0);return setTimeout(()=>this.dap.initialized({}),0),setTimeout(()=>this._thread?.dapInitialized(),0),t}static capabilities(e=!1){return{supportsConfigurationDoneRequest:!0,supportsFunctionBreakpoints:!1,supportsConditionalBreakpoints:!0,supportsHitConditionalBreakpoints:!0,supportsEvaluateForHovers:!0,supportsReadMemoryRequest:!0,supportsWriteMemoryRequest:!0,exceptionBreakpointFilters:[{filter:"all",label:jr.t("Caught Exceptions"),default:!1,supportsCondition:!0,description:jr.t("Breaks on all throw errors, even if they're caught later."),conditionDescription:'error.name == "MyError"'},{filter:"uncaught",label:jr.t("Uncaught Exceptions"),default:!1,supportsCondition:!0,description:jr.t("Breaks only on errors or promise rejections that are not handled."),conditionDescription:'error.name == "MyError"'}],supportsStepBack:!1,supportsSetVariable:!0,supportsRestartFrame:!0,supportsGotoTargetsRequest:!1,supportsStepInTargetsRequest:!0,supportsCompletionsRequest:!0,supportsModulesRequest:!1,additionalModuleColumns:[],supportedChecksumAlgorithms:[],supportsRestartRequest:!0,supportsExceptionOptions:!1,supportsValueFormattingOptions:!0,supportsExceptionInfoRequest:!0,supportTerminateDebuggee:!0,supportsDelayedStackTraceLoading:!0,supportsLoadedSourcesRequest:!0,supportsLogPoints:!0,supportsTerminateThreadsRequest:!1,supportsSetExpression:!0,supportsTerminateRequest:!1,completionTriggerCharacters:[".","[",'"',"'"],supportsBreakpointLocationsRequest:!0,supportsClipboardContext:!0,supportsExceptionFilterOptions:!0,supportsEvaluationOptions:!!e,supportsDebuggerProperties:!!e,supportsSetSymbolOptions:!!e,supportsANSIStyling:!0}}async _onSetBreakpoints(e){return this.breakpointManager.setBreakpoints(e,e.breakpoints?.map(()=>this.breakpointIdCounter())??[])}async setExceptionBreakpoints(e){return await this._services.get(dc).setBreakpoints(e),{}}async configurationDone(){return this._configurationDoneDeferred.resolve(),{}}async _onLoadedSources(){return{sources:await this.sourceContainer.loadedSources()}}async _onDisableSourcemap(e){let t=this.sourceContainer.source(e.source);if(!t)return ve(jr.t("Source not found"));if(!(t instanceof Xe))return ve(jr.t("Source not a source map"));for(let n of t.compiledToSourceUrl.keys())this.sourceContainer.disableSourceMapForSource(n,!0);return await this._thread?.refreshStackTrace(),{}}async _onSource(e){e.source||(e.source={sourceReference:e.sourceReference}),e.source.path=mi(e.source.path);let t=this.sourceContainer.source(e.source);if(!t)return ve(jr.t("Source not found"));let n=await t.content();return n===void 0?(t instanceof Xe&&this.dap.suggestDisableSourcemap({source:e.source}),ve(jr.t("Unable to retrieve source content"))):{content:n,mimeType:t.getSuggestedMimeType}}async _onThreads(){let e=[];return this._thread&&e.push({id:this._thread.id,name:this._thread.name()}),{threads:e}}findVariableStore(e){if(!this._thread)return;let t=this._thread.pausedVariables();if(t&&e(t))return t;if(e(this._thread.replVariables))return this._thread.replVariables}async _onLocations(e){let t=this.findVariableStore(o=>o.hasVariable(e.locationReference));if(!t||!this._thread)throw Gu();let n=await t.getLocations(e.locationReference),i=await this._thread.rawLocationToUiLocationWithWaiting(this._thread.rawLocation(n));if(!i)throw Gu();return{source:await i.source.toDap(),line:i.lineNumber,column:i.columnNumber}}async _onVariables(e){return{variables:await this.findVariableStore(n=>n.hasVariable(e.variablesReference))?.getVariables(e)??[]}}async _onReadMemory(e){let t=e.memoryReference,n=await this.findVariableStore(i=>i.hasMemory(t))?.readMemory(t,e.offset??0,e.count);return n?{address:"0",data:n.toString("base64"),unreadableBytes:e.count-n.length}:{address:"0",unreadableBytes:e.count}}async _onWriteMemory(e){let t=e.memoryReference;return{bytesWritten:await this.findVariableStore(i=>i.hasMemory(t))?.writeMemory(t,e.offset??0,Buffer.from(e.data,"base64"))}}async _onSetExpression(e){if(!this._thread)throw new O(Db());let t=await this._thread.evaluate({expression:`${e.expression} = ${ju(e.value)}`,context:"repl",frameId:e.frameId});return{value:t.result,variablesReference:t.variablesReference,indexedVariables:t.indexedVariables,namedVariables:t.namedVariables,presentationHint:t.presentationHint,type:t.type,memoryReference:t.memoryReference,valueLocationReference:t.valueLocationReference}}async _onSetVariable(e){let t=this.findVariableStore(n=>n.hasVariable(e.variablesReference));return t?(e.value=ju(e.value.trim()),t.setVariable(e)):ve(jr.t("Variable not found"))}_withThread(e){if(!this._thread)throw new O(Db());return e(this._thread)}async _refreshStackTrace(){if(!this._thread)return;this._thread.pausedDetails()&&await this._thread.refreshStackTrace()}createThread(e,t){this._thread=new lc(this.sourceContainer,e,this.dap,t,this._services.get(Xi),this._services.get(W),this._services.get(kr),this._services.get(Zf),this.launchConfig,this.breakpointManager,this._services.get(Ih),this._services.get(dc),this._services.get(ao),this._services.get(Qi),this._services.get(gl));let n=this._services.get(Oh);return n.connect(this.dap,this._thread),"profileStartup"in this.launchConfig&&this.launchConfig.profileStartup&&n.start(this.dap,this._thread,{type:yt.type}),this._thread.updateCustomBreakpoints(this._xhrBreakpoints,this._customBreakpoints),this.asyncStackPolicy.connect(e).then(i=>this._disposables.push(i)).catch(i=>this._services.get(W).error("internal","Error enabling async stacks",i)),this.breakpointManager.setThread(this._thread),this._services.get(je).attach(e),this._threadDeferred.resolve(this._thread),this._thread}async setCustomBreakpoints({ids:e,xhr:t}){return await this._thread?.updateCustomBreakpoints(t,e),this._customBreakpoints=e,this._xhrBreakpoints=t,{}}async _toggleSkipFileStatus(e){return await this._services.get(eo).toggleSkippingFile(e),await this._refreshStackTrace(),{}}async _prettyPrintSource(e){if(!e.source||!this._thread)return{};e.source.path=mi(e.source.path);let t=this.sourceContainer.source(e.source);if(!t)return ve(jr.t("Source not found"));let n=await t.prettyPrint();if(!n)return ve(jr.t("Unable to pretty print"));let{map:i,source:o}=n;await this.breakpointManager.moveBreakpoints(this._thread,t,i,o),this.sourceContainer.clearDisabledSourceMaps(t);let s=!!this._thread.pausedDetails();return await this._refreshStackTrace(),{source:await o.toDap(),didReveal:s}}onEvaluate(e){return e.expression===".scripts"?this._dumpDiagnostics({fromSuggestion:!1}).then(this.dap.openDiagnosticTool).then(()=>({result:"Opening diagnostic tool...",variablesReference:0})):this._withThread(t=>t.evaluate(e))}async _dumpDiagnostics(e){let t={file:await this._services.get(po).generateHtml()};return e.fromSuggestion&&this._services.get(Ot).report("diagnosticPrompt",{event:"opened"}),t}async _requestCDPProxy(){return await this._cdpProxyProvider.proxy()}dispose(){this._disposables.dispose(),af(this._services)}};var AF=S(He()),Mg=S(g("os"));var G4={connect:async()=>Qs},Gk=r=>({async connect(e){return await e.Debugger.setAsyncCallStackDepth({maxDepth:r}),Qs}}),z4=r=>{let e=new k,t=!1,n=()=>{t||(t=!0,e.fire())};return{async connect(i){if(t)return await i.Debugger.setAsyncCallStackDepth({maxDepth:r}),Qs;let o=new De;return o.push(e.event(()=>{o.dispose(),i.Debugger.setAsyncCallStackDepth({maxDepth:r})}),i.Debugger.on("breakpointResolved",n),i.Debugger.on("paused",s=>{s.reason!=="instrumentation"&&n()})),o}}},Hk=Gk(32),zk=r=>r===!1?G4:r===!0?Hk:"onAttach"in r?Gk(r.onAttach):"onceBreakpointResolved"in r?z4(r.onceBreakpointResolved):Hk;var Kk=g("fs"),Jk=g("inspector"),Mh=class{constructor(e){this.file=e;this.session=new Jk.Session;this.session.connect()}async start(){try{await this.post("Profiler.enable")}catch{}await this.post("Profiler.start")}async stop(){let{profile:e}=await this.post("Profiler.stop");await Kk.promises.writeFile(this.file,JSON.stringify(e))}dispose(){this.session.disconnect()}post(e,t){return new Promise((n,i)=>this.session.post(e,t,(o,s)=>{o?i(o):n(s)}))}};var Rl=Symbol("MutableLaunchConfig"),Yk=r=>{let e=new k;return new Proxy({},{ownKeys(){return Object.keys(r)},get(t,n){switch(n){case"update":return i=>{r=i,e.fire()};case"onChange":return e.event;default:return r[n]}}})};var Ag=S(R_()),wF=S(jy()),Rg=g("fs"),kg=S(G()),yxe=S(qg());var Dl=S(G());var kl=class{toDap(){return{category:"console",output:"\x1B[2J"}}},zh=class{toDap(){return{category:"stdout",output:"",group:"end"}}};var Kh=class{constructor(e){this.sink=e;this.q=[];this.disposed=!1;this.onDrainedEmitter=new k;this.onDrained=this.onDrainedEmitter.event}get length(){return this.q.length}enqueue(e){this.disposed||(this.q.push(new A_(e)),this.q.length===1&&this.process())}dispose(){this.disposed=!0,this.q=[]}async process(){let e=this.q.findIndex(t=>t.value===pD);e===0?await this.q[0].wait:e===-1?(this.sink(lD(this.q)),this.q=[]):(this.sink(lD(this.q.slice(0,e))),this.q=this.q.slice(e)),this.q.length?this.process():this.onDrainedEmitter.fire()}},lD=r=>r.map(e=>e.value).filter(e=>e!==dD),pD=Symbol("unsettled"),dD=Symbol("unsettled"),A_=class{constructor(e){this.value=pD;e instanceof Promise?this.wait=e.then(t=>{this.value=t},()=>{this.value=dD}):(this.value=e,this.wait=Promise.resolve())}};var kz=new Set(["group","assert","count"]),gc=class{constructor(e,t){this.dap=e;this.isDirty=!1;this.queue=new Kh(e=>{for(let t of e)this.dap.output(t)});this.onDrained=this.queue.onDrained;t.register(0,async n=>{this.length&&await new Promise(i=>this.onDrained(i)),n&&this.dispose()})}get length(){return this.queue.length}dispose(){this.queue.dispose()}dispatch(e,t){let n=this.parse(t);n&&this.enqueue(e,n)}enqueue(e,t){if(!(t instanceof kl))this.isDirty=!0;else if(this.isDirty)this.isDirty=!1;else return;this.queue.enqueue(t.toDap(e))}parse(e){if(e.type==="log"){let t=e.stackTrace?.callFrames[0];if(t&&t.url==="internal/console/constructor.js"&&kz.has(t.functionName))return}switch(e.type){case"clear":return new kl;case"endGroup":return new zh;case"assert":return new yh(e);case"table":return new Sh(e);case"startGroup":case"startGroupCollapsed":return new wh(e);case"debug":case"log":case"info":return new lo(e);case"trace":return new bh(e);case"error":return new _h(e);case"warning":return new vh(e);case"dir":case"dirxml":return new lo(e);case"count":return new lo(e);case"profile":case"profileEnd":return new lo(e);case"timeEnd":return new lo(e);default:try{bp(e.type,"unknown console message type")}catch{}}}};gc=P([(0,Dl.injectable)(),y(0,(0,Dl.inject)(er)),y(1,(0,Dl.inject)(Qi))],gc);var hD=S(He()),Jh=S(G());var fD="@vscode/dwarf-debugging",yc=class{constructor(e){this.dap=e;this.didPrompt=!1}async load(){try{return await import(fD)}catch{return}}prompt(){this.didPrompt||(this.didPrompt=!0,this.dap.output({output:hD.t("You may install the `{}` module via npm for enhanced WebAssembly debugging",fD),category:"console"}))}};yc=P([(0,Jh.injectable)(),y(0,(0,Jh.inject)(er))],yc);var $r=S(G());var jO=S(mD()),qO=g("dns"),Pm=S(UO()),Es=S(G());var Cm=Symbol("IRequestOptionsProvider");var vo=class{constructor(e,t){this.fs=e;this.options=t;this.autoLocalhostPortFallbacks={}}async fetch(e,t=Ht,n){try{let o=(0,jO.dataUriToBuffer)(e);return{ok:!0,url:e,body:new TextDecoder().decode(o.buffer),statusCode:200}}catch{}let i=kt(e)?e:$e(e);if(i)try{return{ok:!0,url:e,body:await this.fs.readFile(i,"utf-8"),statusCode:200}}catch(o){return{ok:!1,url:e,error:o,statusCode:200}}return this.fetchHttp(e,t,n)}async fetchJson(e,t,n){let i=await this.fetch(e,t,{Accept:"application/json",...n});if(!i.ok)return i;try{return{...i,body:JSON.parse(i.body)}}catch(o){return{...i,ok:!1,url:e,error:o}}}async fetchHttp(e,t,n){let i=new URL(e),o=i.protocol!=="http:",s=Number(i.port)??(o?443:80),a={headers:n,followRedirect:!0};o&&await ba(e)&&(a.rejectUnauthorized=!1),this.options?.provideOptions(a,e);let c=i.hostname==="localhost";if(c&&this.autoLocalhostPortFallbacks[s]){let p=await this.requestHttp(i.toString(),a,t);return p.statusCode!==503?p:(delete this.autoLocalhostPortFallbacks[s],this.requestHttp(e,a,t))}let l=await this.requestHttp(e,a,t);if(l.statusCode===503&&c){let p;try{p=await qO.promises.lookup(i.hostname)}catch{return l}i.hostname=p.family===6?"127.0.0.1":"[::1]",l=await this.requestHttp(i.toString(),a,t),l.statusCode!==503&&(this.autoLocalhostPortFallbacks[s]=i.hostname)}return l}async requestHttp(e,t,n){this.options?.provideOptions(t,e);let i=new De;try{let o=(0,Pm.default)(e,t);i.push(n.onCancellationRequested(()=>o.cancel()));let s=await o;return{ok:!0,url:e,body:s.body,statusCode:s.statusCode}}catch(o){if(!(o instanceof Pm.RequestError))throw o;let s=o.response?String(o.response?.body):o.message,a=o.response?.statusCode??503;return{ok:!1,body:s,statusCode:a,url:e,error:new ef(a,e,s)}}finally{i.dispose()}}};vo=P([(0,Es.injectable)(),y(0,(0,Es.inject)(Re)),y(1,(0,Es.optional)()),y(1,(0,Es.inject)(Cm))],vo);var Rs=class extends vo{constructor(t,n,i,o,s){super(t,s);this.logger=n;this.target=i;this.cdp=o;this.disposables=new De}dispose(){this.disposables.dispose()}async fetchHttp(t,n,i={}){let o=await super.fetchHttp(t,n,i);return o.ok?o:(this.logger.info("runtime","Network load failed, falling back to CDP",{url:t,res:o}),this.fetchOverBrowserNetwork(t,o))}async fetchOverBrowserNetwork(t,n){if(!this.cdp)return n;let i=await this.cdp.Network.loadNetworkResource({frameId:this.target?.targetInfo.targetId,url:t,options:{includeCredentials:!0,disableCache:!0}});if(!i||!i.resource.success||!i.resource.httpStatusCode||i.resource.httpStatusCode>=400||!i.resource.stream)return n;let o=Number(i.resource.headers?.["Content-Length"]);isNaN(o)&&(o=1/0);let s=[],a=0;for(;;){let c=await this.cdp.IO.read({handle:i.resource.stream,offset:a});if(!c)return this.logger.info("runtime","Stream error encountered in middle, falling back",{url:t}),n;let u=c.base64Encoded?Buffer.from(c.data,"base64").toString():c.data;if(a+=Buffer.byteLength(u,"utf-8"),s.push(u),a>=o){this.cdp.IO.close({handle:i.resource.stream});break}if(c.eof)break}return{ok:!0,body:s.join(""),statusCode:i.resource.httpStatusCode,url:t}}};Rs=P([(0,$r.injectable)(),y(0,(0,$r.inject)(Re)),y(1,(0,$r.inject)(W)),y(2,(0,$r.optional)()),y(2,(0,$r.inject)(Xn)),y(3,(0,$r.optional)()),y(3,(0,$r.inject)(Ue)),y(4,(0,$r.optional)()),y(4,(0,$r.inject)(Cm))],Rs);var _o=S(G()),$O=S(tl());function VO(r,e=Wt){let t=[];for(let n=0;n<r.length;n++){let i=r[n];if(i.startsWith("!")){let o=WO(i.slice(1),e);for(let s=0;s<t.length;s++)t[s]=`^(?!${o.slice(1)})${t[s].slice(1)}`}else t.push(WO(i,e))}return t.map(n=>new RegExp(n,"i"))}function WO(r,e=Wt){let t=r.split("/"),n=[];for(let i=0;i<t.length;i++){let o=t[i];if(o==="**")i===0?n.push("(.+/)?"):i===t.length-1||n.push(".*/");else{if(o.includes("*")){let s=o.split("*");n.push(s.map(a=>e(a)).join("[^\\/]*"))}else n.push(e(o));n.push(i<t.length-1?"\\/":"$")}}return`^${n.join("")}`}function FK(r){let e=/^<node_internals>[\/\\](.*)$/,t=r.map(n=>{n=n.trim();let i=e.exec(n);return i?i[1]:null}).filter(wt);return t.length>0?t:void 0}function BK(r,e){return e.filter(n=>!n.includes(di)).map(n=>kt(n)?va(r.rebaseLocalToRemote(n)):Be(n)).map($d)}var Qn=class{constructor({skipFiles:e},t,n,i,o){this.logger=n;this.cdp=i;this._regexForAuthored=YS(e=>VO(e,t=>Uu(t,0,t.length,!0,!0)));this._scriptsWithSkipping=new Set;this._targetId=o.id(),this._rootTargetId=HO(o).id(),this._isUrlFromSourceMapSkipped=new Dn(s=>this._normalizeUrl(s)),this._authoredGlobs=BK(t,e),this._nodeInternalsGlobs=FK(e),this._initNodeInternals(o),this._updateSkippedDebounce=QS(500,()=>this._updateGeneratedSkippedSources()),e.length&&this._updateGeneratedSkippedSources(),this._sharedSkipListener=Qn.sharedSkipsEmitter.event(s=>{s.rootTargetId===this._rootTargetId&&s.targetId!==this._targetId&&this._toggleSkippingFile(s.params)})}dispose(){this._sharedSkipListener.dispose()}setSourceContainer(e){this._sourceContainer=e}_testSkipNodeInternal(e){return this._nodeInternalsGlobs?(e.startsWith(Zr)&&(e=e.slice(Zr.length)),(0,$O.default)([e],this._nodeInternalsGlobs).length>0):!1}_testSkipAuthored(e){return this._regexForAuthored(this._authoredGlobs).some(t=>t.test(e))}_isNodeInternal(e,t){return e.startsWith(Zr)?!0:t?.has(e)||/^internal\/.+\.js$/.test(e)}async _updateGeneratedSkippedSources(){let e=this._regexForAuthored(this._authoredGlobs).map(n=>n.source),t=this._allNodeInternals?.settledValue;if(t){e.push(`^(${Zr})?internal\\/`);for(let n of t)this._testSkipNodeInternal(n)&&e.push(`^(${Zr})?${Wt(n)}$`)}await this.cdp.Debugger.setBlackboxPatterns({patterns:e})}_normalizeUrl(e){return Be(e.toLowerCase())}isScriptSkipped(e){return this._isNodeInternal(e,this._allNodeInternals?.settledValue)?this._testSkipNodeInternal(e):(e=this._normalizeUrl(e),this._isUrlFromSourceMapSkipped.get(e)===!0?!0:this._testSkipAuthored(e))}async _updateSourceWithSkippedSourceMappedSources(e,t){let n=this.isScriptSkipped(e.url),i=[],o=n;for(let a of e.sourceMap.sourceByUrl.values()){let c=this.isScriptSkipped(a.url);if(typeof c>"u"&&(c=n),c!==o){let[[u],[l]]=await Promise.all([this._sourceContainer.currentSiblingUiLocations({source:a,lineNumber:1,columnNumber:1},e),this._sourceContainer.currentSiblingUiLocations({source:a,lineNumber:1/0,columnNumber:1},e)]);u&&l?(i.push({lineNumber:u.lineNumber-1,columnNumber:u.columnNumber-1},{lineNumber:l.lineNumber-1,columnNumber:l.columnNumber-1}),o=!o):this.logger.error("internal","Could not map script beginning for "+a.sourceReference)}}let s=t;i.length||(s=s.filter(a=>this._scriptsWithSkipping.has(a.scriptId)),s.forEach(a=>this._scriptsWithSkipping.delete(a.scriptId))),s.map(({scriptId:a})=>this.cdp.Debugger.setBlackboxedRanges({scriptId:a,positions:i}))}initializeSkippingValueForSource(e){this._initializeSkippingValueForSource(e)}_initializeSkippingValueForSource(e,t=e.scripts){let n=e.url,i=this.isScriptSkipped(n);if(!i&&e.absolutePath&&this._testSkipAuthored(ge(e.absolutePath))&&(this.setIsUrlBlackboxSkipped(n,!0),i=!0,this._updateSkippedDebounce()),Vt(e)){if(i)for(let o of e.sourceMap.sourceByUrl.values())this._isUrlFromSourceMapSkipped.set(o.url,!0);for(let o of e.sourceMap.sourceByUrl.values())this._initializeSkippingValueForSource(o,t);this._updateSourceWithSkippedSourceMappedSources(e,t)}}async _initNodeInternals(e){if(e.type()!=="node"||!this._nodeInternalsGlobs||this._allNodeInternals)return;let t=this._allNodeInternals=be(),n=await this.cdp.Runtime.evaluate({expression:"require('module').builtinModules"+Ve(),returnByValue:!0,includeCommandLineAPI:!0});n&&!n.exceptionDetails?t.resolve(new Set(n.result.value.map(i=>i+".js"))):t.resolve(new Set),await this._updateGeneratedSkippedSources()}async _toggleSkippingFile(e){let t;e.resource&&kt(e.resource)&&(t=e.resource);let n={path:t,sourceReference:e.sourceReference},i=this._sourceContainer.source(n);if(!i)return{};let o=!this.isScriptSkipped(i.url);if(i instanceof Xe){this._isUrlFromSourceMapSkipped.set(i.url,o);let s=Array.from(i.compiledToSourceUrl.keys());await Promise.all(s.map(a=>this._updateSourceWithSkippedSourceMappedSources(a,a.scripts)))}else{if(Vt(i))for(let s of i.sourceMap.sourceByUrl.values())this._isUrlFromSourceMapSkipped.set(s.url,o);this.setIsUrlBlackboxSkipped(i.url,o),await this._updateGeneratedSkippedSources()}return{}}setIsUrlBlackboxSkipped(e,t){let n=e,i=`!${n}`,o=this._authoredGlobs.filter(s=>s!==n&&s!==i);this._regexForAuthored(o).some(s=>s.test(e))!==t&&(o.push(t?n:i),this._regexForAuthored.clear()),this._authoredGlobs=o}async toggleSkippingFile(e){let t=await this._toggleSkippingFile(e);return Qn.sharedSkipsEmitter.fire({params:e,rootTargetId:this._rootTargetId,targetId:this._targetId}),t}};Qn.sharedSkipsEmitter=new k,Qn=P([(0,_o.injectable)(),y(0,(0,_o.inject)(le)),y(1,(0,_o.inject)(Ce)),y(2,(0,_o.inject)(W)),y(3,(0,_o.inject)(Ue)),y(4,(0,_o.inject)(Xn))],Qn);function HO(r){let e=r.parent();return e?HO(e):r}var $l=S(G()),zO=g("path");var GO=/^webpack:\/{3}([^/]+?\.vue)(\?[0-9a-z]*)?$/i,UK=/^webpack:\/{3}\.\/.+\.vue\?[0-9a-z]+$/i,Rc=Symbol("IVueFileMapper");var Ec=class{constructor(e,t){this.files=e;this.search=t;this.getMapping=ne(async()=>{let e=new Map;return await this.search.streamAllChildren(this.files,t=>e.set((0,zO.basename)(t),t)),e})}async lookup(e){let t=GO.exec(e);return t?(await this.getMapping()).get(t[1]):void 0}getVueHandling(e){return this.files.empty?0:GO.test(e)?1:UK.test(e)?2:0}};Ec=P([(0,$l.injectable)(),y(0,(0,$l.inject)(bi)),y(1,(0,$l.inject)(Oa))],Ec);var Zn=class{constructor(){this.changeEmitter=new k;this.addEmitter=new k;this.removeEmitter=new k;this.targetMap=new Map;this.onChanged=this.changeEmitter.event;this.onAdd=this.addEmitter.event;this.onRemove=this.removeEmitter.event}get size(){return this.targetMap.size}add(e,t){this.targetMap.set(e,t),this.addEmitter.fire([e,t]),this.changeEmitter.fire()}get(e){return this.targetMap.get(e)}remove(e){let t=this.targetMap.get(e);return t===void 0?!1:(this.targetMap.delete(e),this.removeEmitter.fire([e,t]),this.changeEmitter.fire(),!0)}value(){return this.targetMap.values()}};var As=S(G());var pM=Symbol("IDefaultBrowserProvider"),Ac=class{constructor(e,t){this.location=e;this.vscode=t;this.lookup=ne(async()=>{let e;return this.location==="remote"&&this.vscode?e=await this.vscode.commands.executeCommand("js-debug-companion.defaultBrowser"):e=(await Promise.resolve().then(()=>(lM(),uM)).then(n=>n.default())).name,["chrome","edge"].find(n=>e.toLowerCase().includes(n))??"other"})}};Ac=P([(0,As.injectable)(),y(0,(0,As.inject)(yi)),y(1,(0,As.optional)()),y(1,(0,As.inject)(Bn))],Ac);var fM=S(G()),Am=S(g("os"));var Rm=class{async setup(){}dispose(){}write(e){if(e.level>2)throw new Error(e.message);console.log(JSON.stringify(e))}};var Vw=class{constructor(e=512){this.size=e;this.items=[];this.i=0}write(e){this.items[this.i]=e,this.i=(this.i+1)%this.size}read(){return this.items.slice(this.i).concat(this.items.slice(0,this.i))}},Hr=class{constructor(){this.logTarget={queue:[]};this.logBuffer=new Vw(1)}static async test(){let e=new Hr;return e.setup({sinks:[new Rm],showWelcome:!1}),e}info(e,t,n){this.log({tag:e,timestamp:Date.now(),message:t,metadata:n,level:1})}verbose(e,t,n){this.log({tag:e,timestamp:Date.now(),message:t,metadata:n,level:0})}warn(e,t,n){this.log({tag:e,timestamp:Date.now(),message:t,metadata:n,level:2})}error(e,t,n){this.log({tag:e,timestamp:Date.now(),message:t,metadata:n,level:3})}fatal(e,t,n){this.log({tag:e,timestamp:Date.now(),message:t,metadata:n,level:4})}assert(e,t){if(e===!1||e===void 0||e===null){if(this.error("runtime.assertion",t,{error:new Error("Assertion failed")}),process.env.JS_DEBUG_THROW_ASSERTIONS)throw new Error(t);debugger;return!1}return!0}log(e){if(this.logBuffer.write(e),"queue"in this.logTarget){this.logTarget.queue.push(e);return}for(let t of this.logTarget.sinks)t.write(e)}getRecentLogs(){return this.logBuffer.read()}dispose(){if("sinks"in this.logTarget){for(let e of this.logTarget.sinks)e.dispose();this.logTarget={queue:[]}}}forTarget(){return this}async setup(e){if(await Promise.all(e.sinks.map(n=>n.setup())),e.showWelcome!==!1){let n=GK();for(let i of e.sinks)i.write(n)}let t=this.logTarget;this.logTarget={sinks:e.sinks.slice()},"sinks"in t?t.sinks.forEach(n=>n.dispose()):t.queue.forEach(n=>this.log(n))}};Hr.null=(()=>{let e=new Hr;return e.setup({sinks:[]}),e})(),Hr=P([(0,fM.injectable)()],Hr);var GK=()=>({timestamp:Date.now(),tag:"runtime.welcome",level:1,message:`${Zd} v${$u} started`,metadata:{os:`${Am.platform()} ${Am.arch()}`,nodeVersion:process.version,adapterVersion:$u}});var NN=S(yN()),Wm=S(G());var Ls=Symbol("touched"),xo;(c=>{function r(){return{children:{},[Ls]:1}}c.root=r;function e(u,l){return u[Ls]=1,a(u,s(l),0)}c.getPath=e;function t(u){u[Ls]=1}c.touch=t;function n(u){u[Ls]=2}c.touchAll=n;function i(u,l){let p=u.children[l]??={children:{}};return p[Ls]=1,p}c.getOrMakeChild=i;function o(u){if(u[Ls]){for(let[l,p]of Object.entries(u.children))switch(p[Ls]){case 1:o(p);break;case 2:break;default:delete u.children[l]}return u}}c.prune=o;function s(u){let l=u.split(/\/|\\/);return l[0]===""&&l.unshift(),l}function a(u,l,p){let d=i(u,l[p]);return p===l.length-1?d:a(d,l,p+1)}})(xo||={});var fS=g("fs"),hS=S(tl()),Fs=g("path"),MN=S(ON());var R7=/\//g,qm=class{constructor(e){this.stat=Bo(e=>fS.promises.lstat(e));this.readdir=Bo(e=>fS.promises.readdir(e,{withFileTypes:!0}));this.alreadyProcessedFiles=new Set;this.fileEmitter=new k;this.onFile=this.fileEmitter.event;this.errorEmitter=new k;this.onError=this.errorEmitter.event;this.processor=e.fileProcessor,this.filter=e.filter,this.ignore=e.ignore.map(i=>hS.default.matcher((0,MN.default)(Be(i),{cwd:e.cwd})));let t=(0,Fs.isAbsolute)(e.pattern)?(0,Fs.relative)(e.cwd,e.pattern):e.pattern,n=hS.default.parse(Be(t),{ignore:e.ignore,cwd:e.cwd,expand:!0});this.done=Promise.all(n.map(i=>{let o=[];for(let u=1;u<i.tokens.length;){let l=u+1;for(;l<i.tokens.length&&i.tokens[l].type!=="slash";)l++;let p=i.tokens[u];p.type==="globstar"?o.push("**"):l===u+1&&p.type==="text"?o.push(p.value):o.push(new RegExp("^"+i.tokens.slice(u,l).map(d=>d.output||d.value).join("")+"$")),u=l+1}let s=o[0]==="**"?[0,1]:[0],a=xo.getPath(e.cache,e.cwd),c={elements:o,seen:new Set};return Promise.all(s.map(u=>this.readSomething(c,u,e.cwd,[],a)))})).then(()=>{})}async readSomething(e,t,n,i,o){if(this.alreadyProcessedFiles.has(o))return;let s=`${t}:${n}`;if(e.seen.has(s))return;e.seen.add(s);let a;try{a=await this.stat(n)}catch(u){this.errorEmitter.fire({path:n,error:u});return}if(this.alreadyProcessedFiles.has(o))return;let c=o.data;if(c&&a.mtimeMs===c.mtime){if(c.type===0){let u=[],p=Object.entries(o.children).filter(([,d])=>d.data?.type!==0).map(([d])=>d);for(let[d,f]of Object.entries(o.children))u.push(f.data!==void 0?this.handleDirectoryEntry(e,t,n,{name:d,type:f.data.type},p,o):this.stat(n).then(h=>this.handleDirectoryEntry(e,t,n,{name:d,type:h.isFile()?1:0},p,o),()=>{}));await Promise.all(u)}else c.type===1&&(this.alreadyProcessedFiles.add(o),this.fileEmitter.fire(c.extracted));return}a.isDirectory()?await this.handleDir(e,t,a.mtimeMs,n,o):(this.alreadyProcessedFiles.add(o),await this.handleFile(a.mtimeMs,n,i,o))}applyFilterToFile(e,t,n){let i=n.children[e];if(this.alreadyProcessedFiles.has(i))return!1;if(!this.filter)return!0;let o=i.data?.type===1?i.data.extracted:void 0;return xo.touch(i),this.filter(t,o)}handleDirectoryEntry(e,t,n,i,o,s){let a=n+"/"+i.name,c=this.getDirectoryReadDescends(e,t,n,i);if(c===void 0)return;let u=xo.getOrMakeChild(s,i.name);if(!(i.type===1&&!this.applyFilterToFile(i.name,a,s)))return typeof c=="number"?this.readSomething(e,t+c,a,o,u):Promise.all(c.map(l=>this.readSomething(e,t+l,a,o,u)))}getDirectoryReadDescends(e,t,n,i){let o=n+"/"+i.name;if(this.ignore.some(c=>c(o)))return;let s=t===e.elements.length-1,a=e.elements[t];if(a==="**")return i.type===1?s?0:this.getDirectoryReadDescends(e,t+1,n,i):s?0:[0,1];if((a instanceof RegExp&&a.test(i.name)||a===i.name)&&(i.type===0?!s:s))return 1}async handleFile(e,t,n,i){let o=Fs.sep==="/"?t:t.replace(R7,Fs.sep),s;try{s=await this.processor(o,{siblings:n,mtime:e})}catch(a){this.errorEmitter.fire({path:o,error:a});return}i.data={type:1,mtime:e,extracted:s},this.fileEmitter.fire(s)}async handleDir(e,t,n,i,o){let s;try{s=await this.readdir(i)}catch(u){this.errorEmitter.fire({path:i,error:u});return}let a=[],c=s.filter(u=>u.isFile()).map(u=>u.name);for(let u of s){if(u.name.startsWith("."))continue;let l;if(u.isDirectory())l=0;else if(u.isFile())l=1;else continue;a.push(this.handleDirectoryEntry(e,t,i,{name:u.name,type:l},c,o))}await Promise.all(a),o.data={type:0,mtime:n}}};var Lc=class{constructor(e){this.logger=e}async streamAllChildren(e,t){let n=[];return await this.globForFiles(e,o=>n.push(t(We(o.path)))),(await Promise.all(n)).filter(o=>o!==void 0)}async streamChildrenWithSourcemaps(e){let t=[],n=e.lastState||{},i={};return await Promise.all([...e.files.explode()].map(async s=>{let a=JSON.stringify(s),c=n[a]||xo.root();await this._streamChildrenWithSourcemaps(c,e,t,s);let u=xo.prune(c);u&&(i[a]=u)})),this.logger.info("sourcemap.parsing",`turboGlobStream search found ${t.length} files`),{values:(await Promise.all(t)).filter(wt),state:i}}async _streamChildrenWithSourcemaps(e,t,n,i){let o=new qm({pattern:i.pattern,ignore:i.negations,cwd:i.cwd,cache:e,filter:t.filter,fileProcessor:(s,a)=>N0(s,a).then(c=>c&&t.processMap(c))});o.onError(({path:s,error:a})=>{this.logger.warn("sourcemap.parsing","Error parsing source map",{error:a,path:s})}),o.onFile(s=>s&&n.push(t.onProcessedMap(s))),await o.done}async globForFiles(e,t){await Promise.all([...e.explode()].map(n=>new Promise((i,o)=>(0,NN.default)([n.pattern,"!**/*.asar/**"],{ignore:n.negations,cwd:n.cwd}).on("data",t).on("end",i).on("error",o))))}};Lc=P([(0,Wm.injectable)(),y(0,(0,Wm.inject)(W))],Lc);var Zm=S(He()),To=S(G());var LN=S(g("path")),FN=g("url");var Vm=class{constructor(){this._onFrameAddedEmitter=new k;this._onFrameRemovedEmitter=new k;this._onFrameNavigatedEmitter=new k;this.onFrameAdded=this._onFrameAddedEmitter.event;this.onFrameRemoved=this._onFrameRemovedEmitter.event;this.onFrameNavigated=this._onFrameNavigatedEmitter.event;this._frames=new Map}attached(e,t){e.Page.enable({}),e.Page.getResourceTree({}).then(n=>{this._processCachedResources(e,n?n.frameTree:void 0,t)})}mainFrame(){return this._mainFrame}_processCachedResources(e,t,n){t&&this._addFramesRecursively(e,t,t.frame.parentId,n),e.Page.on("frameAttached",i=>{this._frameAttached(e,n,i.frameId,i.parentFrameId)}),e.Page.on("frameNavigated",i=>{this._frameNavigated(e,n,i.frame)}),e.Page.on("frameDetached",i=>{this._frameDetached(e,n,i.frameId)})}_addFrame(e,t,n){let i=new gS(this,e,t,n);return this._frames.set(i.id,i),i.isMainFrame()&&(this._mainFrame=i),this._onFrameAddedEmitter.fire(i),i}_frameAttached(e,t,n,i){let o=this._frames.get(n);return o||(o=this._addFrame(e,n,i)),o._ref(t),o}_frameNavigated(e,t,n){let i=this._frames.get(n.id);i||(i=this._frameAttached(e,t,n.id,n.parentId)),i._navigate(n,t),this._onFrameNavigatedEmitter.fire(i)}_frameDetached(e,t,n){let i=this._frames.get(n);i&&i._unref(t)}frameForId(e){return this._frames.get(e)}frames(){return Array.from(this._frames.values())}_addFramesRecursively(e,t,n,i){let o=t.frame,s=this._frames.get(o.id);s?(s._navigate(o,i),this._onFrameNavigatedEmitter.fire(s)):(s=this._addFrame(e,o.id,n),s._navigate(o,i));for(let a=0;t.childFrames&&a<t.childFrames.length;++a)this._addFramesRecursively(e,t.childFrames[a],s.id,i)}},gS=class{constructor(e,t,n,i){this._targets=new Set;this.cdp=t,this.model=e,this._parentFrameId=i,this.id=n,this._url=""}_ref(e){this._targets.add(e)}_navigate(e,t){this._name=e.name,this._url=e.url,this._securityOrigin=e.securityOrigin,this._unreachableUrl=e.unreachableUrl||"",this._ref(t),this._unrefChildFrames(t)}name(){return this._name||""}url(){return this._url}securityOrigin(){return this._securityOrigin}unreachableUrl(){return this._unreachableUrl}isMainFrame(){return!this._parentFrameId}parentFrame(){return this._parentFrameId?this.model.frameForId(this._parentFrameId):void 0}childFrames(){return this.model.frames().filter(e=>e._parentFrameId===this.id)}_unrefChildFrames(e){for(let t of this.childFrames())t._unref(e)}_unref(e){this._targets.delete(e),!this._targets.size&&(this._unrefChildFrames(e),this.model._frames.delete(this.id),this.model._onFrameRemovedEmitter.fire(this))}displayName(){return this._name?this._name:A7(this._url)||`<iframe ${this.id}>`}};function mS(r,e){return r.length<=e?r:r.substr(0,e-1)+"\u2026"}function A7(r){let e;try{e=new FN.URL(r)}catch{return mS(r,20)}if(e.protocol==="data")return mS(r,20);if(e.protocol==="blob"||r==="about:blank")return r;let t=LN.basename(e.pathname);return t||(t=(e.host||"")+"/"),t==="/"&&(t=mS(r,20)),t}var BN=g("url");var yS=class{constructor(e){this.versions=new Map;this.id=e.registrationId,this.scopeURL=e.scopeURL}},bS=class{constructor(e,t){this.revisions=[];this.registration=e,this.id=t.versionId,this.scriptURL=t.scriptURL,this._targetId=t.targetId,this._status=t.status,this._runningStatus=t.runningStatus}addRevision(e){this._targetId&&e.targetId&&this._targetId!==e.targetId&&console.error(`${this._targetId} !== ${e.targetId}`),e.targetId&&(this._targetId=e.targetId),this._status=e.status,this._runningStatus=e.runningStatus,this.revisions.unshift(e)}status(){return this._status}runningStatus(){return this._runningStatus}targetId(){return this._targetId}label(){let e=new BN.URL(this.registration.scopeURL),t=e.pathname.substr(1);t.endsWith("/")&&(t=t.substring(0,t.length-1));let n=t||`${e.host}`,i=this._status==="activated"?"":` ${this._status}`,o=this._runningStatus==="running"?"":` ${this._runningStatus}`;return`${n} #${this.id}${i}${o}`}},$m=class r{constructor(e){this._registrations=new Map;this._versions=new Map;this._onDidChangeUpdater=new k;this.onDidChange=this._onDidChangeUpdater.event;this._targets=new Set;this._frameModel=e,r._instances.add(this)}static{this._instances=new Set}dispose(){r._instances.delete(this)}attached(e){this._targets.add(e),!this._cdp&&(this._cdp=e,e.ServiceWorker.enable({}),e.ServiceWorker.on("workerRegistrationUpdated",t=>this._workerRegistrationsUpdated(t.registrations)),e.ServiceWorker.on("workerVersionUpdated",t=>this._workerVersionsUpdated(t.versions)),r._mode!=="normal"&&this.setMode(r._mode))}async detached(e){this._targets.delete(e)}version(e){return this._versions.get(e)}registrations(){let e=[],t=this._frameModel.frames().map(n=>n.url());for(let n of this._registrations.values())for(let i of t)if(i.startsWith(n.scopeURL)){e.push(n);break}return e}registration(e){return this._registrations.get(e)}_workerVersionsUpdated(e){for(let t of e){let n=this._registrations.get(t.registrationId);if(!n)continue;let i=n.versions.get(t.versionId);i||(i=new bS(n,t),n.versions.set(t.versionId,i)),t.targetId&&this._versions.set(t.targetId,i),i.addRevision(t),i.status()==="redundant"&&i.runningStatus()==="stopped"&&(t.targetId&&this._versions.delete(t.targetId),n.versions.delete(i.id))}this._onDidChangeUpdater.fire()}_workerRegistrationsUpdated(e){for(let t of e)if(t.isDeleted){if(!this._registrations.has(t.registrationId))debugger;this._registrations.delete(t.registrationId)}else{if(this._registrations.has(t.registrationId))return;this._registrations.set(t.registrationId,new yS(t))}this._onDidChangeUpdater.fire()}static setModeForAll(e){r._mode=e;for(let t of r._instances)t.setMode(e)}setMode(e){if(this._cdp){this._cdp.ServiceWorker.setForceUpdateOnPageLoad({forceUpdateOnPageLoad:e==="force"});for(let t of this._targets.values())e==="bypass"?(t.Network.enable({}),t.Network.setBypassServiceWorker({bypass:!0})):t.Network.disable({})}}async stopWorker(e){if(!this._cdp)return;let t=this.version(e);t&&await this._cdp.ServiceWorker.stopWorker({versionId:t.id})}};var Io=class{constructor(e,t,n,i,o,s,a,c){this.process=t;this.logger=o;this.telemetry=s;this.launchParams=a;this._targets=new Map;this._detachedTargets=new Set;this.frameModel=new Vm;this.serviceWorkerModel=new $m(this.frameModel);this._lifecycleQueue=Promise.resolve();this._onTargetAddedEmitter=new k;this._onTargetRemovedEmitter=new k;this.onTargetAdded=this._onTargetAddedEmitter.event;this.onTargetRemoved=this._onTargetRemovedEmitter.event;this._connection=e,this._sourcePathResolver=i,this._browser=n,this._targetOrigin=c,this.serviceWorkerModel.onDidChange(()=>{for(let u of this._targets.values())u.type()==="service_worker"&&u._onNameChangedEmitter.fire()})}static async connect(e,t,n,i,o,s,a){let u=await e.rootSession().Target.attachToBrowserTarget({});if(!u)return;let l=e.createSession(u.sessionId);return new this(e,t,l,n,o,s,i,a)}dispose(){this.serviceWorkerModel.dispose()}targetList(){return Array.from(this._targets.values()).filter(e=>Lu.has(e.type()))}async getCandiateInfo(e){let t=await this._browser.Target.getTargets({});return t?e?t.targetInfos.filter(e):t.targetInfos:[]}async closeBrowser(){if(this.launchParams.request==="launch"){if(this.launchParams.cleanUp==="wholeBrowser")await this._browser.Browser.close({}),this.process?.kill();else for(let e of this._targets.values())await this._browser.Target.closeTarget({targetId:e.targetId}),this._connection.close();this.process=void 0}}waitForMainTarget(e){let t,n=new Promise(o=>t=o),i=async o=>{if([...this._targets.values()].some(c=>c.targetId===o.targetId)||this._detachedTargets.has(o.targetId)||e&&!e(o))return;let s=this._browser.Target.on("targetInfoChanged",c=>{c.targetInfo.targetId===o.targetId&&(o=c.targetInfo)}),a;try{a=await this._browser.Target.attachToTarget({targetId:o.targetId,flatten:!0})}finally{s.dispose()}if(!a){t(void 0);return}t(this.attachedToTarget(o,a.sessionId,!0))};return this._browser.Target.setDiscoverTargets({discover:!0}),this._browser.Target.on("targetCreated",this.enqueueLifecycleFn(o=>i(o.targetInfo))),this._browser.Target.on("targetInfoChanged",o=>this._targetInfoChanged(o.targetInfo,this.enqueueLifecycleFn(i))),this._browser.Target.on("detachedFromTarget",this.enqueueLifecycleFn(async o=>{o.targetId&&await this._detachedFromTarget(o.sessionId,!1)})),n}enqueueLifecycleFn(e){return t=>this._lifecycleQueue=this._lifecycleQueue.then(()=>e(t))}attachedToTarget(e,t,n,i,o=!0){let s=this._targets.get(t);if(s)return s;let a=this._connection.createSession(t),c=new jd(this,e,a,i,n,this.launchParams,t,this.logger,()=>{this._connection.disposeSession(t),this._detachedFromTarget(t)});this._targets.set(t,c),i&&i._children.set(e.targetId,c),a.Target.on("attachedToTarget",async l=>{this.attachedToTarget(l.targetInfo,l.sessionId,l.waitingForDebugger,c)}),a.Target.on("detachedFromTarget",async l=>{l.targetId&&this._detachedFromTarget(l.sessionId,!1)}),a.Target.setAutoAttach({autoAttach:!0,waitForDebuggerOnStart:o,flatten:!0}),a.Network.setCacheDisabled({cacheDisabled:this.launchParams.disableNetworkCache}).catch(l=>this.logger.info("runtime.target","Error setting network cache state",l)),i||this.retrieveBrowserTelemetry(a);let u=e.type;return Ud.has(u)&&this.frameModel.attached(a,e.targetId),this.serviceWorkerModel.attached(a),this._onTargetAddedEmitter.fire(c),!Lu.has(u)||u==="service_worker"?c.runIfWaitingForDebugger():u==="page"&&o&&!e.canAccessOpener&&a.Page.waitForDebugger({}),c}async retrieveBrowserTelemetry(e){try{let t=await e.Browser.getVersion({});if(!t)throw new Error("Undefined return from getVersion()");let n={targetCRDPVersion:t.protocolVersion,targetRevision:t.revision,targetUserAgent:t.userAgent,targetV8:t.jsVersion,targetVersion:"",targetProject:"",targetProduct:""};this.logger.verbose("runtime.target","Retrieved browser information",t);let i=(t.product||"").split("/");i.length===2?(n.targetProject=i[0],n.targetVersion=i[1]):n.targetProduct=t.product,this.telemetry.report("browserVersion",n)}catch(t){this.logger.warn("runtime.target","Error getting browser telemetry",t)}}async _detachedFromTarget(e,t=!0){let n=this._targets.get(e);if(n){this._targets.delete(e),n.parentTarget?._children.delete(e);try{await n._detached()}catch{}if(this._onTargetRemovedEmitter.fire(n),t&&(this._detachedTargets.add(n.targetId),await this._browser.Target.detachFromTarget({sessionId:e})),!this._targets.size&&this.launchParams.request==="launch")try{this.launchParams.cleanUp==="wholeBrowser"?await this._browser.Browser.close({}):(await this._browser.Target.closeTarget({targetId:n.id()}),this._connection.close())}catch{}}}async _targetInfoChanged(e,t){let n=[...this._targets.values()].filter(i=>i.targetId===e.targetId);if(!e.attached||!n.length)return n.length&&await Promise.all(n.map(i=>this._detachedFromTarget(i.sessionId,!1))),t(e);for(let i of n)i._updateFromInfo(e);for(let i of this._targets.values())i.targetId!==e.targetId&&i._onNameChangedEmitter.fire()}};var ZN=S(g("child_process")),eL=g("fs");var k7=50,Kt=class r{constructor(e){this.messageEmitter=new k;this.endEmitter=new k;this.onMessage=this.messageEmitter.event;this.onEnd=this.endEmitter.event;this._ws=e,this._ws.addEventListener("message",t=>{this.messageEmitter.fire([t.data.toString("utf-8"),new Br])}),this._ws.addEventListener("close",()=>{this.endEmitter.fire(),this._ws=void 0}),this._ws.addEventListener("error",()=>{})}static async create(e,t,n){let i=!e.startsWith("ws://"),o=await ba(e);for(;;){let s=Date.now()+k7;try{let a={headers:{host:n??"localhost"},perMessageDeflate:!1,maxPayload:268435456,rejectUnauthorized:!(i&&o),followRedirects:!0},c=new yA(e,[],a);return await Kn(new Promise((u,l)=>{c.addEventListener("open",()=>u(new r(c))),c.addEventListener("error",p=>{let d=e===c.url?e:c.url.replace(/^http(s?):/,"ws$1:");if(d===e){l(p.error);return}this.create(d,t,n).then(u,l)})}),ut.withTimeout(2e3,t).token,`Could not open ${e}`).catch(u=>{throw c.close(),u})}catch(a){if(t.isCancellationRequested)throw a;let c=s-Date.now();c>0&&await ue(c)}}}send(e){this._ws?.send(e)}dispose(){return new Promise(e=>{if(!this._ws)return e();this._ws.addEventListener("close",()=>e()),this._ws.close()})}};var Hm=S(g("path"));function D7(r){let e=[/^APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL$/i,/^ELECTRON_.+$/i,/^GOOGLE_API_KEY$/i,/^VSCODE_.+$/i,/^SNAP(|_.*)$/i,/^GDK_PIXBUF_.+$/i];return new bt(r).map((t,n)=>e.some(i=>i.test(t))?void 0:n)}var bt=class r{constructor(e){this.defined=ne(()=>Xs(this.value));this.value=e?GS(e):{}}static{this.platform=process.platform}static{this.empty=new r({})}static{this.processEnv=ne(()=>D7(process.env))}lookup(e){return r.platform==="win32"?JS(this.value,e):this.value[e]}addToPath(e,t="append",n=!1){let i=r.platform==="win32"?"Path":"PATH",o=r.platform==="win32"?Hm.win32.delimiter:Hm.posix.delimiter,s=this.lookup(i);return n&&!s&&(s=`\${env:${i}}`),s?t==="append"?s=s+o+e:s=e+o+s:s=e,this.update(i,s)}addNodeOption(e){let t=this.lookup("NODE_OPTIONS");return this.update("NODE_OPTIONS",t?`${t} ${e}`:e)}update(e,t){return r.merge(this,{[e]:t})}merge(...e){return r.merge(this,...e)}map(e){return new r(ai(this.value,(t,n)=>e(n,t)))}static merge(...e){let t=e.map(i=>i instanceof r?i.value:i),n=r.platform==="win32"?KS(...t):Object.assign({},...t);return new r(n)}};var UN=g("child_process");var rp=class r extends Error{constructor(t,n,i,o,s){super(`${t} exited with code ${o||-1}: ${n}`);this.command=t;this.stderr=n;this.stdout=i;this.code=o;this.innerError=s}static fromExeca(t){return new r(t.command,t.stderr.toString(),t.stdout.toString(),t.exitCode)}};function Gm(r,e,t){return new Promise((n,i)=>{let o=np(r,e,t?.cwd),s=(0,UN.spawn)(o.executable,o.args,{...t,cwd:o.cwd,shell:o.shell,stdio:"pipe"}),a=[],c=[];s.stderr.on("data",l=>a.push(l)),s.stdout.on("data",l=>c.push(l));let u=(l,p)=>i(new rp(r,Buffer.concat(a).toString(),Buffer.concat(c).toString(),l,p));s.on("error",l=>u(void 0,l)),s.on("close",l=>l?u(l):n({stdout:Buffer.concat(c).toString(),stderr:Buffer.concat(a).toString()}))})}var O7=/\.(bat|cmd)$/i,np=(r,e,t)=>(process.platform==="win32"&&(r=mi(r),t&&(t=mi(t.toString())),r.endsWith(".ps1")&&(e=["-File",r,...e],r="powershell.exe")),process.platform!=="win32"||!O7.test(r)?{executable:r,args:e,shell:!1,cwd:t}:{executable:`"${r}"`,args:e.map(n=>n.includes(" ")?`"${n}"`:n),shell:!0,cwd:t});var jN=r=>{let e={};for(let t of r){let n=t.indexOf("=");n===-1?e[t]=null:e[t.slice(0,n)]=t.slice(n+1)}return e},ip=r=>{let e=[];for(let t of Object.keys(r)){let n=r[t];n!==void 0&&e.push(n===null?t:`${t}=${n}`)}return e},zm=class r{constructor(e=[]){this.args=e;this.argMap=ne(()=>jN(this.args))}add(e,t=null){return this.newThis(ip({...this.argMap(),[e]:t}))}get(e){let t=this.argMap();return t.hasOwnProperty(e)?t[e]:void 0}remove(e){return this.newThis(ip({...this.argMap(),[e]:void 0}))}merge(e){return this.newThis(ip({...this.argMap(),...e instanceof r?e.argMap():jN(e)}))}filter(e){let t=this.argMap(),n=[];for(let i of Object.keys(t)){let o=t[i];e(i,o)&&n.push(o===null?i:`${i}=${o}`)}return this.newThis(n)}toArray(){return this.args.slice()}newThis(e){return new this.constructor(e)}};var qN="--remote-debugging-port",WN="--remote-debugging-pipe",Co=class r extends zm{static{this.default=new r(["--disable-background-networking","--disable-background-timer-throttling","--disable-backgrounding-occluded-windows","--disable-breakpad","--disable-client-side-phishing-detection","--disable-default-apps","--disable-dev-shm-usage","--disable-renderer-backgrounding","--disable-sync","--metrics-recording-only","--no-first-run","--no-default-browser-check"])}setConnection(e){return new r(ip({...this.argMap(),[WN]:e==="pipe"?null:void 0,[qN]:e!=="pipe"?String(e):void 0}))}getSuggestedConnection(){let e=this.argMap();if(e.hasOwnProperty(WN))return"pipe";let t=e[qN];if(t!==void 0)return t&&Number(t)||0}};var vS=g("url");function Km(r,e,t){let n=Bo(s=>{if(s)return new vS.URL(s);throw new Error(`A valid url wasn't supplied: <${s}>`)}),i={"url.hostname":()=>{let s=n(e).hostname;return s.endsWith(".localhost")?"localhost":s},"url.port":()=>n(e).port,browserInspectUri:()=>encodeURIComponent(t),browserInspectUriPath:()=>new vS.URL(t).pathname,wsProtocol:()=>n(e).protocol==="https:"?"wss":"ws"};return r.replace(/{([^\}]+)}/g,(s,a)=>i.hasOwnProperty(a)?i[a]():s)}var JN=S(g("readline"));var VN=g("stream"),Po=class extends VN.Transform{constructor(t){super();this.prefix=[];this.splitSuffix=Buffer.alloc(0);if(typeof t=="string"&&t.length===1)this.splitter=t.charCodeAt(0);else if(typeof t=="number")this.splitter=t;else throw new Error("not implemented here")}_transform(t,n,i){let o=0;for(;o<t.length;){let s=t.indexOf(this.splitter,o);if(s===-1)break;let a=t.subarray(o,s),c=this.prefix.length||this.splitSuffix.length?Buffer.concat([...this.prefix,a,this.splitSuffix]):a;this.push(c),this.prefix.length=0,o=s+1}o<t.length&&this.prefix.push(t.subarray(o)),i()}_flush(t){this.prefix.length&&this.push(Buffer.concat([...this.prefix,this.splitSuffix])),t()}};var ei=class{constructor(e,t,n){this.logger=e;this.pipeWrite=t;this.pipeRead=n;this.messageEmitter=new k;this.endEmitter=new k;this.onMessage=this.messageEmitter.event;this.onEnd=this.endEmitter.event;this.onceEnded=ne(()=>{this.streams&&(this.beforeClose(),this.streams.read.removeAllListeners(),this.pipeRead?.destroy(),this.streams.write.removeListener("end",this.onceEnded),this.streams.write.removeListener("error",this.onWriteError),this.streams.write.on("error",()=>{}),this.streams.write.end(),this.streams=void 0,this.endEmitter.fire())});this.onWriteError=e=>{this.logger.error("internal","pipeWrite error",{error:e})};let i=n||t;this.streams={read:i.on("error",o=>this.logger.error("internal","pipeRead error",{error:o})).pipe(new Po(0)).on("data",o=>this.messageEmitter.fire([o.toString(),new Br])).on("end",this.onceEnded),write:t.on("end",this.onceEnded).on("error",this.onWriteError)}}send(e){this.streams?.write.write(e+"\0")}dispose(){this.onceEnded()}beforeClose(){}};var Jm=g("child_process"),_S=g("path");function an(r,e,t="forceful"){if(t==="none")return!0;if(process.platform==="win32"){let n=process.env.WINDIR||"C:\\Windows",i=(0,_S.join)(n,"System32","taskkill.exe");try{return(0,Jm.execSync)(`${i} ${t==="forceful"?"/F":""} /T /PID ${r}`,{stdio:"pipe"}),!0}catch(o){return e.error("runtime.exception","Error running taskkill.exe",o),!1}}else try{let n=(0,_S.join)(__dirname,"./targets/node/terminateProcess.sh"),i=(0,Jm.spawnSync)("sh",[n,r.toString(),t==="forceful"?"9":"15"]);return i.stderr&&i.status?(e.error("runtime.exception","Error running terminateProcess",i),!1):!0}catch(n){return e.error("runtime.exception","Error running terminateProcess",n),!1}}var zN=g("fs");async function wS(r,e,t,n,i){let o=new vo(zN.promises),[s,a]=await Promise.all([HN(o,new URL("/json/version",r),e,i),n?HN(o,new URL("/json/list",r),e,i):Promise.resolve(void 0)]);if(!s.ok)t.verbose("runtime.launch","Error looking up /json/version",s);else if(s.body.webSocketDebuggerUrl){let c=GN(s.url,s.body.webSocketDebuggerUrl);return t.verbose("runtime.launch","Discovered target URL from /json/version",{url:s.body.webSocketDebuggerUrl,fixed:c}),c}if(a)if(!a.ok)t.verbose("runtime.launch","Error looking up /json/list",a);else{let c=GN(a.url,a.body[0].webSocketDebuggerUrl);return t.verbose("runtime.launch","Discovered target URL from /json/list",{url:a.body[0].webSocketDebuggerUrl,fixed:c}),c}throw new Error("Could not find any debuggable target")}async function HN(r,e,t,n){if(e.hostname!=="localhost")return r.fetchJson(e.toString(),t,{host:n??"localhost"});e.hostname="127.0.0.1";let i=e.toString();e.hostname="[::1]";let o=e.toString(),s=new ut(t);try{let a;return await Zs([i,o].map(async u=>(a=await r.fetchJson(u,s.token),a.ok&&a)))||a}finally{s.cancel()}}var KN=r=>async(e,t,n,i)=>{for(;;)try{return await wS(e,t,n,r,i)}catch(o){if(t.isCancellationRequested)throw new Error(`Could not connect to debug target at ${e}: ${o.message}`);await ue(200)}},Fc=KN(!0),Ym=KN(!1);function GN(r,e){let t=new URL(r),n=new URL(e);return n.host=t.host,n.toString()}var YN=async(r,e,t,n)=>{let i=t.connection===0?await M7(e,n):await Ym(`http://localhost:${t.connection}`,n,r),o=t.inspectUri?Km(t.inspectUri,t.url,i):i;for(;;)try{return await Kt.create(o,n)}catch(s){if(n.isCancellationRequested)throw s;await ue(200)}},Xm=class{constructor(e){this.logger=e;this.pid=void 0;this.onExit=new k().event;this.onError=new k().event}async transport(e,t){return YN(this.logger,this,e,t)}kill(){}},Qm=class{constructor(e,t,n){this.cp=e;this.logger=t;this.killBehavior=n;this.pid=void 0;this.exitEmitter=new k;this.onExit=this.exitEmitter.event;this.errorEmitter=new k;this.onError=this.errorEmitter.event;e.on("exit",i=>this.exitEmitter.fire(i||0)),e.on("error",i=>this.errorEmitter.fire(i))}get stderr(){return this.cp.stderr}get stdio(){return this.cp.stdio}async transport(e,t){return e.connection==="pipe"?new ei(this.logger,this.cp.stdio[3],this.cp.stdio[4]):YN(this.logger,this,e,t)}kill(){an(this.cp.pid,this.logger,this.killBehavior)}};function M7(r,e){if(!r.stderr)throw new Error("Cannot wait for a websocket for a target that lacks stderr");return new Promise((t,n)=>{let i=JN.createInterface({input:r.stderr}),o="",s=()=>u();i.on("line",l),i.on("close",s);let a=new De([r.onExit(()=>u()),r.onError(u)]),c=e.onCancellationRequested(()=>{p(),n(new zn(`Timed out after ${c} ms while trying to connect to the browser!`))});function u(d){p(),n(new Error(["Failed to launch browser!"+(d?" "+d.message:""),o,"","TROUBLESHOOTING: https://github.com/GoogleChrome/puppeteer/blob/master/docs/troubleshooting.md",""].join(`
`)))}function l(d){o+=d+`
`;let f=d.match(/^DevTools listening on (ws:\/\/.*)$/);f&&(p(),t(f[1]))}function p(){c.dispose(),i.removeListener("line",l),i.removeListener("close",s),a.dispose()}})}async function XN(r,e,t,n){let i=r.launchUnelevatedRequest({process:e,args:t});await Kn(i,n,"Could not launch browser unelevated")}var QN=()=>{};async function tL(r,e,t,n,i,o,s={}){let{onStderr:a=QN,onStdout:c=QN,args:u=[],dumpio:l=!1,cwd:p=process.cwd(),env:d=bt.empty,connection:f="pipe",cleanUp:h="wholeBrowser",url:m,killBehavior:b="forceful",inspectUri:I}=s,D=new Co(u),B=D.getSuggestedConnection();s.includeLaunchArgs!==!1?(D=SS(D,s),B===void 0&&(D=D.setConnection(f),B=f)):B===void 0&&(B="pipe");let Z=["pipe","pipe","pipe"];B==="pipe"&&(l?Z=["ignore","pipe","pipe","pipe","pipe"]:Z=["ignore","ignore","ignore","pipe","pipe"]);let F;if(!!(i.supportsLaunchUnelevatedProcessRequest&&s.launchUnelevated)&&typeof B=="number"&&B!==0)await XN(r,e,D.toArray(),o),F=new Xm(t);else{t.info("runtime.launch",`Launching Chrome from ${e}`);let j=np(e,D.toArray(),await sa(eL.promises,p)?p:process.cwd()),te=ZN.spawn(j.executable,j.args,{detached:!0,env:d.defined(),shell:j.shell,cwd:j.cwd,stdio:Z});if(te.pid===void 0)throw await Promise.race([ue(1e3).then(()=>new Error("Unable to launch the executable (undefined pid)")),new Promise(Se=>te.once("error",Se))]);F=new Qm(te,t,b)}l?(F.stderr?.on("data",j=>a(j.toString())),F.stdout?.on("data",j=>c(j.toString()))):(F.stderr?.resume(),F.stdout?.resume());let H=()=>{h==="wholeBrowser"&&F.kill()};process.on("exit",H),F.onExit(()=>process.removeListener("exit",H));try{if(s.promisedPort){let j;B=await Promise.race([s.promisedPort,new Promise((te,Se)=>{j=F.onExit(A=>{Se(new O(R0(A)))})})]).finally(()=>j.dispose())}return{process:F,canReconnect:typeof B=="number",createConnection:async j=>{let te=await F.transport({connection:B,inspectUri:I||void 0,url:m||void 0},j);return new it(te,t,n)}}}catch(j){throw F.kill(),j}}function SS(r,e={}){let{userDataDir:t=null,ignoreDefaultArgs:n=!1}=e,i=n===!0?new Co:Co.default;return n instanceof Array&&(i=i.filter(o=>!n.includes(o))),t&&(i=i.add("--user-data-dir",t)),i=i.merge(r),r.toArray().every(o=>o.startsWith("-"))&&e.hasUserNavigation&&(i=i.add("about:blank")),i}async function rL(r,e,t,n){let{browserWSEndpoint:i,browserURL:o}=r;if(i){let s=await Kt.create(i,e);return new it(s,t,n)}else if(o){let s=await Ym(o,e,t),a=r.inspectUri?Km(r.inspectUri,r.pageURL,s):s,c=await Kt.create(a,e);return new it(c,t,n)}throw new Error("Either browserURL or browserWSEndpoint needs to be specified")}var zr=class{constructor(e,t,n){this.logger=e;this.pathResolver=t;this.vscode=n;this._disposables=[];this._onTerminatedEmitter=new k;this.onTerminated=this._onTerminatedEmitter.event;this._onTargetListChangedEmitter=new k;this.onTargetListChanged=this._onTargetListChangedEmitter.event;this.closeWhenTargetsEmpty=!0}dispose(){for(let e of this._disposables)e.dispose();this._disposables=[],this._attemptTimer&&clearTimeout(this._attemptTimer),this._targetManager&&this._targetManager.dispose()}resolveParams(e){return e.request==="attach"&&(e.type==="pwa-chrome"||e.type==="pwa-msedge"&&typeof e.useWebView!="object")&&e.browserAttachLocation==="workspace"}async launch(e,t){return this.resolveParams(e)?(this._lastLaunchParams={...e,timeout:1/0},await this.attemptToAttach(this._lastLaunchParams,t),{blockSessionTermination:!0}):{blockSessionTermination:!1}}_scheduleAttach(e,t){this._attemptTimer=setTimeout(()=>{this._attemptTimer=void 0,this.attemptToAttach(e,{...t,cancellationToken:Ht})},1e3)}createTargetManager(e,t,n){return Io.connect(e,void 0,this.pathResolver,t,this.logger,n.telemetryReporter,n.targetOrigin)}async attemptToAttach(e,t){let n=await this.acquireConnectionForBrowser(t,e);this._connection=n,n.onDisconnected(()=>{this._connection=void 0,this._targetManager&&(this._targetManager.dispose(),this._targetManager=void 0,this._onTargetListChangedEmitter.fire()),this._lastLaunchParams===e&&e.restart?this._scheduleAttach(e,t):this._onTerminatedEmitter.fire({killed:!0,code:0})},void 0,this._disposables);let i=this._targetManager=await this.createTargetManager(n,e,t);if(!i)return;i.serviceWorkerModel.onDidChange(()=>this._onTargetListChangedEmitter.fire()),i.frameModel.onFrameNavigated(()=>this._onTargetListChangedEmitter.fire()),i.onTargetAdded(()=>{this._onTargetListChangedEmitter.fire()}),i.onTargetRemoved(()=>{this._onTargetListChangedEmitter.fire(),!i.targetList().length&&this.closeWhenTargetsEmpty&&(this._onTerminatedEmitter.fire({killed:!0,code:0}),this._connection?.close())});let o=await Promise.race([i.waitForMainTarget(await this.getTargetFilter(i,e)),ue(e.timeout).then(()=>{throw new O(rf())})]);return typeof o=="string"?o:void 0}async getTargetFilter(e,t){let n=zi(t),i=_a(n);if(t.targetSelection!=="pick")return i;let o=await e.getCandiateInfo(i);if(o.length===0)return i;if(o.length===1||!this.vscode)return c=>c.targetId===o[0].targetId;let s=Zm.t("Select a tab"),a=await this.vscode.window.showQuickPick(o.map(c=>({label:c.title,detail:c.url,targetId:c.targetId})),{matchOnDescription:!0,matchOnDetail:!0,placeHolder:s});return a?c=>c.targetId===a.targetId:i}async acquireConnectionForBrowser({telemetryReporter:e,cancellationToken:t},n){for(;this._lastLaunchParams===n;)try{return await this.acquireConnectionInner(e,n,t)}catch(i){if(t.isCancellationRequested)throw new O(Hu(Zm.t("Cannot connect to the target at {0}: {1}",`${n.address}:${n.port}`,i.message)));await ue(1e3)}throw new O(Hu(Zm.t("Cannot connect to the target at {0}: {1}",`${n.address}:${n.port}`,"Cancelled")))}async acquireConnectionInner(e,t,n){let i=`http://${t.address}:${t.port}`;return await rL({browserURL:i,inspectUri:t.inspectUri,pageURL:t.url},n,this.logger,e)}async terminate(){this._lastLaunchParams=void 0,this._connection?.close()}async restart(){if(this._targetManager)for(let e of this._targetManager.targetList())e.type()==="page"&&!e.name().startsWith("devtools://")&&e.restart()}targetList(){let e=this._targetManager;return e?e.targetList():[]}};zr=P([(0,To.injectable)(),y(0,(0,To.inject)(W)),y(1,(0,To.inject)(Ce)),y(2,(0,To.optional)()),y(2,(0,To.inject)(Bn))],zr);var cn=S(G());var iL=S(R_()),oL=S(He()),op=S(g("fs")),Eo=S(G()),Bc=S(g("path"));var ti=class{constructor(e,t,n,i,o){this.storagePath=e;this.logger=t;this.pathResolver=n;this.initializeParams=i;this.fs=o;this._disposables=new De;this._onTerminatedEmitter=new k;this.onTerminated=this._onTerminatedEmitter.event;this._onTargetListChangedEmitter=new k;this.onTargetListChanged=this._onTargetListChangedEmitter.event;this._terminatedCts=new ut}dispose(){this._disposables.dispose()}async launchBrowser({runtimeExecutable:e,trace:t,includeDefaultArgs:n,includeLaunchArgs:i,runtimeArgs:o,userDataDir:s,env:a,cwd:c,port:u,url:l,file:p,inspectUri:d,webRoot:f,cleanUp:h,launchUnelevated:m,killBehavior:b},I,D,B,Z){let F=await this.findBrowserPath(e||"stable"),X;return typeof s=="string"?X=Bc.resolve(s):s&&(X=Bc.resolve(Bc.join(this.storagePath,o?.includes("--headless")?".headless-profile":".profile"))),op.mkdirSync(this.storagePath,{recursive:!0}),X&&(op.mkdirSync(X,{recursive:!0}),X=op.realpathSync(X)),await tL(I,F,this.logger,B,this.initializeParams,D,{onStdout:H=>I.output({category:"stdout",output:H}),onStderr:H=>I.output({category:"stderr",output:H}),dumpio:typeof t=="boolean"?t:t.stdio,cleanUp:h,hasUserNavigation:!!(l||p),cwd:c||f||void 0,env:bt.merge(bt.processEnv(),a),args:o||[],userDataDir:X,connection:u||(d?0:"pipe"),launchUnelevated:m,ignoreDefaultArgs:!n,includeLaunchArgs:i,killBehavior:b,url:l,inspectUri:d,promisedPort:Z})}getFilterForTarget(e){return _a(zi(e,["about:blank"]))}async doLaunch(e,t){let n;try{n=await this.launchBrowser(e,t.dap,t.cancellationToken,t.telemetryReporter)}catch(u){throw new O(kb(u))}let i=new ut(this._terminatedCts.token);n.process.onExit(()=>this.fireTerminatedEvent());let o=()=>n.canReconnect&&!i.token.isCancellationRequested,s=async u=>{if(this._targetManager?.dispose(),this._targetManager=void 0,this._onTargetListChangedEmitter.fire(),o()&&(await ue(1e3),o())){t.dap.output({category:"stderr",output:oL.t("Browser connection failed, will retry: {0}",u?.message||"Connection closed")});try{return await ue(2e3),await a()}catch{}}n.process.kill(),this.fireTerminatedEvent()},a=async()=>{if(!i.token.isCancellationRequested)try{let u=await n.createConnection(i.token),l=await this.launchCdp(e,n,u,{...t,cancellationToken:i.token});await this.finishLaunch(l,e),u.onDisconnected(()=>s())}catch(u){if(o())return s(u);throw n.process.kill(),new O(kb(u))}},c=t.cancellationToken.onCancellationRequested(()=>i.cancel());try{await a()}finally{c.dispose()}}async launchCdp(e,t,n,i){if(this._connectionForTest=n,this._targetManager=await Io.connect(n,t.process,this.pathResolver,e,this.logger,i.telemetryReporter,i.targetOrigin),!this._targetManager)throw new O(Hu());this._targetManager.serviceWorkerModel.onDidChange(()=>this._onTargetListChangedEmitter.fire()),this._targetManager.frameModel.onFrameNavigated(()=>this._onTargetListChangedEmitter.fire()),this._disposables.push(this._targetManager),this._targetManager.onTargetAdded(()=>{this._onTargetListChangedEmitter.fire()}),this._targetManager.onTargetRemoved(()=>{this._onTargetListChangedEmitter.fire()});let o=this.getFilterForTarget(e),s=await Kn(this._targetManager.waitForMainTarget(o),i.cancellationToken,"Could not attach to main target");if(!s)throw new O(rf());return s}async finishLaunch(e,t){if("skipNavigateForTest"in t)return;let n;if(t.file){let i=Bc.resolve(t.webRoot||t.rootPath||"",t.file),o=Math.min(i.includes("#")?i.indexOf("#"):1/0,i.includes("?")?i.indexOf("?"):1/0);isFinite(o)&&!await Ui(this.fs,i)?n=ge(i.slice(0,o))+i.slice(o):n=ge(i)}else n=t.url;n&&await e.cdp().Page.navigate({url:n})}async launch(e,t){let n=this.resolveParams(e);return n?(await this.doLaunch(n,t),{blockSessionTermination:!0}):{blockSessionTermination:!1}}async terminate(){this._targetManager?await this._targetManager.closeBrowser():this.fireTerminatedEvent()}async restart(){for(let e of this.targetList())e.type()==="page"&&e.restart()}async findBrowserByExe(e,t){return t==="*"?(await e.findWhere(i=>i.quality==="stable")||(await e.findAll())[0])?.path:(0,iL.isQuality)(t)?(await e.findWhere(n=>n.quality===t))?.path:t}targetList(){let e=this._targetManager;return e?e.targetList():[]}connectionForTest(){return this._connectionForTest}fireTerminatedEvent(){this._terminatedCts.token.isCancellationRequested||(this._terminatedCts.cancel(),this._onTerminatedEmitter.fire({code:0,killed:!0}))}};ti=P([(0,Eo.injectable)(),y(0,(0,Eo.inject)(Fn)),y(1,(0,Eo.inject)(W)),y(2,(0,Eo.inject)(Ce)),y(3,(0,Eo.inject)(Dt)),y(4,(0,Eo.inject)(Re))],ti);var Bs=class extends ti{constructor(t,n,i,o,s,a){super(t,n,s,a,o);this.browserFinder=i}resolveParams(t){return t.type==="pwa-chrome"&&t.request==="launch"&&t.browserLaunchLocation==="workspace"?t:void 0}async findBrowserPath(t){let n=await this.findBrowserByExe(this.browserFinder,t);if(!n||!await sa(this.fs,n))throw new O(tf("Chrome",t,(await this.browserFinder.findAll()).map(i=>i.quality)));return n}};Bs=P([(0,cn.injectable)(),y(0,(0,cn.inject)(Fn)),y(1,(0,cn.inject)(W)),y(2,(0,cn.inject)(ts)),y(2,(0,cn.tagged)("browser","chrome")),y(3,(0,cn.inject)(Re)),y(4,(0,cn.inject)(Ce)),y(5,(0,cn.inject)(Dt))],Bs);var sL=g("crypto"),un=S(G()),aL=g("net"),cL=g("os"),uL=g("path");var N7=["--do-not-de-elevate"],Uc=class extends ti{constructor(t,n,i,o,s,a){super(t,n,s,a,o);this.browserFinder=i}resolveParams(t){return t.type==="pwa-msedge"&&t.request==="launch"&&t.browserLaunchLocation==="workspace"?t:void 0}launchBrowser(t,n,i,o){return super.launchBrowser({...t,runtimeArgs:t.runtimeArgs??N7},n,i,o,t.useWebView?this.getWebviewPort(t,o):void 0)}getFilterForTarget(t){return t.useWebView&&t.urlFilter?_a(zi(t)):super.getFilterForTarget(t)}async getWebviewPort(t,n){let i=be();if(!t.runtimeExecutable)return i.resolve(t.port),i.promise;let o=t.runtimeExecutable.split(/\\|\//).pop(),s=`VSCode_${(0,sL.randomBytes)(12).toString("base64")}`,a=`\\\\.\\pipe\\WebView2\\Debugger\\${o}\\${s}`,c=(0,aL.createServer)(u=>{u.on("data",async l=>{let p=JSON.parse(l.toString()),d=p.devtoolsActivePort||"",f=parseInt(d.split(`
`).shift()||""),h=t.port||f;i.resolve(h);let m=`ws://${t.address}:${h}/devtools/${p.type}/${p.id}`,b=await Kt.create(m,Ht),I=new it(b,this.logger,n);await I.rootSession().Runtime.runIfWaitingForDebugger({}),I.close()})});return c.on("error",i.reject),c.on("close",()=>i.resolve(t.port)),c.listen(a),t.userDataDir=t.userDataDir||(0,uL.join)((0,cL.tmpdir)(),`vscode-js-debug-userdatadir_${t.port}`),t.env=t.env||{},t.env.WEBVIEW2_USER_DATA_FOLDER=t.userDataDir.toString(),t.env.WEBVIEW2_ADDITIONAL_BROWSER_ARGUMENTS=`--remote-debugging-port=${t.port}`,t.env.WEBVIEW2_WAIT_FOR_SCRIPT_DEBUGGER="true",t.env.WEBVIEW2_PIPE_FOR_SCRIPT_DEBUGGER=s,i.promise}async findBrowserPath(t){let n=await this.findBrowserByExe(this.browserFinder,t);if(!n||!await sa(this.fs,n))throw new O(tf("Edge",t,(await this.browserFinder.findAll()).map(i=>i.quality)));return n}};Uc=P([(0,un.injectable)(),y(0,(0,un.inject)(Fn)),y(1,(0,un.inject)(W)),y(2,(0,un.inject)(ts)),y(2,(0,un.tagged)("browser","edge")),y(3,(0,un.inject)(Re)),y(4,(0,un.inject)(Ce)),y(5,(0,un.inject)(Dt))],Uc);var ki=S(G());var lL=g("crypto"),eg=S(G());var L7=0,ri=class{constructor(e){this.portLeaseTracker=e;this.teardown=new WeakMap}async launch(e,t,n){this.server&&this.server.close();let i=`/${(0,lL.randomBytes)(20).toString("hex")}`,o=this.server=await Xf(this.portLeaseTracker,{perMessageDeflate:!0,host:"127.0.0.1",path:i}),s=++L7;e.launchBrowserInCompanion({...n,serverPort:o.address().port,path:i,launchId:s});let a=await Kn(new Promise((u,l)=>{o.once("connection",u),o.once("error",l)}),t,"Timed out waiting for browser connection"),c=new Kt(a);return this.teardown.set(c,()=>e.killCompanionBrowser({launchId:s})),c}close(e){this.teardown.get(e)?.()}dispose(){this.server?.close(),this.server=void 0}};ri=P([(0,eg.injectable)(),y(0,(0,eg.inject)(Fr))],ri);var jc=class extends zr{constructor(t,n,i,o){super(n,i,o);this.helper=t}resolveParams(t){return t.request==="attach"&&(t.type==="pwa-chrome"||t.type==="pwa-msedge")&&t.browserAttachLocation==="ui"}async acquireConnectionForBrowser(t,n){let i=await this.helper.launch(t.dap,t.cancellationToken,{type:n.type==="pwa-chrome"?"chrome":"edge",params:n,attach:{host:n.address,port:n.port}});return new it(i,this.logger,t.telemetryReporter)}};jc=P([(0,ki.injectable)(),y(0,(0,ki.inject)(ri)),y(1,(0,ki.inject)(W)),y(2,(0,ki.inject)(Ce)),y(3,(0,ki.optional)()),y(3,(0,ki.inject)(Bn))],jc);var Di=S(G());var qc=class extends ti{constructor(t,n,i,o,s,a){super(t,n,i,o,s);this.helper=a}resolveParams(t){return(t.type==="pwa-chrome"||t.type==="pwa-msedge")&&t.request==="launch"&&t.browserLaunchLocation==="ui"?t:void 0}async launchBrowser(t,n,i,o){let s=await this.helper.launch(n,i,{type:t.type==="pwa-chrome"?"chrome":"edge",browserArgs:SS(new Co(t.runtimeArgs||[]),{hasUserNavigation:!!t.url,ignoreDefaultArgs:!t.includeDefaultArgs}).setConnection(t.port||"pipe").toArray(),params:t});return{canReconnect:!1,createConnection:()=>Promise.resolve(new it(s,this.logger,o)),process:{onExit:new k().event,onError:new k().event,transport:()=>Promise.resolve(s),kill:()=>this.helper.close(s)}}}async findBrowserPath(){throw new Error("not implemented")}};qc=P([(0,Di.injectable)(),y(0,(0,Di.inject)(Fn)),y(1,(0,Di.inject)(W)),y(2,(0,Di.inject)(Ce)),y(3,(0,Di.inject)(Dt)),y(4,(0,Di.inject)(Re)),y(5,(0,Di.inject)(ri))],qc);var Ro=S(G()),mL=g("net"),gL=g("path");var F7=ne(()=>{if(process.arch==="arm64")return Promise.resolve().then(()=>S(dL()));if(process.arch==="x64")return Promise.resolve().then(()=>S(hL()));throw new Error(`Unsupported architecture ${process.arch}`)});function tg(){if(process.platform!=="win32")throw new Error("Not running on Windows");return F7()}var Wc=class extends zr{constructor(e,t,n){super(e,t,n)}resolveParams(e){return e.request==="attach"&&e.type==="pwa-msedge"&&typeof e.useWebView=="object"}async acquireConnectionForBrowser(e,t){let{getAppContainerProcessTokens:n}=await tg(),i=n().map(c=>(0,gL.join)(c,t.useWebView.pipeName));if(!i)throw new O(x0());let o=i.map(c=>(0,mL.connect)(c)),s;try{s=await Kn(Zs(o.map(c=>new Promise(u=>c.on("error",()=>u(void 0)).on("connect",()=>u(c))))),e.cancellationToken)}finally{for(let c of o)c!==s&&c.destroy()}if(!s)throw new O(C0());let a=new ei(this.logger,s);return new it(a,this.logger,e.telemetryReporter)}};Wc=P([(0,Ro.injectable)(),y(0,(0,Ro.inject)(W)),y(1,(0,Ro.inject)(Ce)),y(2,(0,Ro.optional)()),y(2,(0,Ro.inject)(Bn))],Wc);var Gc=S(G());var Sr=S(G());var xS=Symbol("ILinkedBreakpointLocation");var xL=S(g("path"));var ap=S(G()),Do=S(g("path")),SL=g("url");var yL=g("fs"),Oi=S(g("path"));function rg(r,e){return r?(r.endsWith("/")||(r+="/"),r+e):e}async function ng(r,e,t,n,i){e=$e(e)||e;let o;if(r){if(Rr(r))o=$e(r);else if(kt(r))o=await n(r,t,i)||r;else if(Oi.isAbsolute(e))o=j7(e,r);else{let s=_b(e)||"/",a=await n(s,t,i),c=Oi.dirname(a);o=ji(c,r)}i.verbose("sourcemap.parsing","resolved sourceRoot",{sourceRoot:r,absSourceRoot:o})}else if(Oi.isAbsolute(e))o=Oi.dirname(e),i.verbose("sourcemap.parsing","no sourceRoot specified, using script dirname",{absSourceRoot:o});else{let s=_b(e)||"/placeholder.js",a=await n(s,t,i);o=a?Oi.dirname(a):"",i.verbose("sourcemap.parsing","no sourceRoot specified, using webRoot + script path dirname",{absSourceRoot:o})}return o=HT(o),o=We(o),o}var sp=async(r,e,t)=>{if(!r||!r.startsWith("/"))return"";let n=Object.keys(e).sort((i,o)=>o.length-i.length);for(let i of n){if(!i)continue;let o=e[i];if(i[0]!=="/"&&(t.verbose("sourcemap.parsing",`Keys should be absolute: ${i}`),i="/"+i),B7(i,r))return U7(i,o,r)}return""},bL=(r,e)=>async(t,n,i)=>{if(process.platform==="win32"&&/^[a-z]:/i.test(t))return t;let o=await Gd(r,Oi.dirname(e),"package.json");if(!o)return sp(t,n,i);let s=await sp(t,zS(n,a=>a.length>=o.length),i);return process.platform!=="win32"&&t!=="/"&&!s&&(await yL.promises.stat(t).catch(()=>{}))?.isDirectory()?t:s||o};function B7(r,e){return r===e?!0:(r.endsWith("/")||(r+="/"),e.startsWith(r))}function U7(r,e,t){let n=decodeURIComponent(t.substring(r.length));return n?ji(e,n):e}function j7(r,e){return cr(Oi.dirname(r),e)}var wL=S(tl()),Ao=S(g("path"));var sg="*",vL=new RegExp(Wt(sg),"g"),ig="?:"+sg,q7=new RegExp(Wt(ig),"g"),IS=(r,e)=>{let t=e.match(r);return r.lastIndex=0,t?t.length:0},_L=new RegExp(`${Wt(ig)}|${Wt(sg)}`,"g"),og=class{constructor(e,t){this.logger=t;this.replacers=[];let n=Object.keys(e).sort((i,o)=>o.replace(ig,"*").length-i.replace(ig,"*").length);for(let i of n){let o=e[i];if(!o.includes("*")&&/\$[0-9'`&]/.test(o)){this.replacers.push([new RegExp(`^${i}$`,"i"),o]);continue}let s=Be(i),a=`"${s}": "${o}"`,c=IS(vL,s)-IS(q7,s);if(c>1){t.warn("runtime.sourcemap",`Warning: only one asterisk allowed in a sourceMapPathOverrides entry - ${a}`);continue}if(IS(vL,o)>c){t.warn("runtime.sourcemap",`The right side of a sourceMapPathOverrides entry must have 0 or 1 asterisks - ${a}}`);continue}let u="^",l=0;for(_L.lastIndex=0;;){let p=_L.exec(s);if(u+=Wt(s.slice(l,p?.index),"/"),!p)break;p[0]===sg?u+="(.*?)":u+=".*?",l=p.index+p[0].length}c===0&&(u+="([\\/\\\\].*)?",o+="*"),this.replacers.push([new RegExp(u+"$","i"),o.replace(/\$/g,"$$$$").replace(/\*/,"$1")])}}apply(e){let t=Be(e);for(let[n,i]of this.replacers){let o=t.replace(n,i);if(o!==t)return this.logger.verbose("runtime.sourcemap",`SourceMap: mapping ${e} => ${o}, via sourceMapPathOverrides entry - ${n.toString()}`),ji(o)}return e}};var W7=/\x00/,Vc=class{constructor(e,t){this.options=e;this.logger=t;this.sourceMapOverrides=new og(this.options.sourceMapOverrides,this.logger);this.resolvePatterns=this.options.resolveSourceMapLocations?.map(e=>{let t=e.startsWith("!")?"!":"",n=e.slice(t.length).replace(/(?<!\.)\.[^./\\]+$/,".*");if(!kt(n))return Be(e);n=Be(cr(n));let i=Wy(this.options.workspaceFolder),o=Wy(n),s=0;for(let a=0;a<i.length&&a<o.length&&o[a].toLowerCase()===i[a].toLowerCase();a++)s+=i[a].length+1;return n=n.slice(0,s).replace(/[\[\]\(\)\{\}\!\*]/g,"\\$&")+n.slice(s),t+n})}shouldResolveSourceMap({sourceMapUrl:e,compiledPath:t}){if(t.startsWith(Zr))return!1;if(!this.resolvePatterns||this.resolvePatterns.length===0)return!0;let n=$e(e)||xt(e)&&t||e;if(n.startsWith("webpack-internal:///"))return!0;let i=md(e)?!1:yb(),o=this.rebaseRemoteToLocal(n);return(0,wL.default)((o!==n?[n,o]:[n]).map(Be),this.resolvePatterns,{dot:!0,nocase:!i}).length>0}rebaseRemoteToLocal(e){if(!this.options.remoteRoot||!this.options.localRoot||!this.canMapPath(e))return Ao.isAbsolute(e)?Ao.resolve(e):e;let t=Cu(this.options.remoteRoot,e);if(t.startsWith(".."))return"";let n=ji(this.options.localRoot,t);return n=Vy(n),this.logger.verbose("runtime.sourcemap",`Mapped remoteToLocal: ${e} -> ${n}`),cr(n)}rebaseLocalToRemote(e){if(!this.options.remoteRoot||!this.options.localRoot||!this.canMapPath(e))return e;let t=Cu(this.options.localRoot,e),n=ji(this.options.remoteRoot,t);return n=We(n,!0),this.logger.verbose("runtime.sourcemap",`Mapped localToRemote: ${e} -> ${n}`),n}normalizeSourceMapUrl(e){e=e.replace(W7,"");let t=e.lastIndexOf("?");return t!==-1&&e.slice(t-4,t)!==".vue"&&(e=e.slice(0,t)),e}canMapPath(e){return Ao.posix.isAbsolute(e)||Ao.win32.isAbsolute(e)||Rr(e)}};var CS="https?:\\/\\/[^\\/]+\\/",ko=class extends Vc{constructor(t,n,i,o){super(i,o);this.vueMapper=t;this.fsUtils=n}absolutePathToUrlPath(t){t=Do.normalize(t);let{baseUrl:n,pathMapping:i}=this.options,o=["/",i["/"]],s=Object.entries(i).sort(([u,l],[p,d])=>d.length-l.length||p.length-u.length).find(([,u])=>hd(u,t))||o;if(!s)return{url:ge(t),needsWildcard:!1};if(n&&Rr(n))return{url:va(t),needsWildcard:!1};let a=Gi(Do.relative(s[1],t)),c=s[0].replace(/\/$|^\//g,"");return c&&(a=c+"/"+a),!n&&!Kd(a)?{url:a,needsWildcard:!0}:{url:zd(n,a),needsWildcard:!1}}async urlToAbsolutePath({url:t,map:n}){let i=t.indexOf("?");return i!==-1&&t.slice(i-4,i)!==".vue"&&(t=t.slice(0,i)),n?this.sourceMapSourceToAbsolute(t,n):this.simpleUrlToAbsolute(t)}async simpleUrlToAbsolute(t){if(!t)return;if(t=this.sourceMapOverrides.apply(t),Rr(t)){let s=$e(t);if(await this.fsUtils.exists(s))return s;let a=GT(t);return await this.fsUtils.exists(a)?a:s}let n;try{let s=new SL.URL(t);if(!s.pathname||s.pathname==="/"?n="index.html":n=s.pathname,s.protocol==="webpack-internal:")return}catch{n=t}let i=Do.extname(n),o=n.replace(/^\//,"").split(/[\/\\]/);for(;o.length>0;){let s="/"+o.join("/"),a=await sp(s,this.options.pathMapping,this.logger);if(a){if(!i&&await this.fsUtils.exists(a+".html"))return a+".html";if(await this.fsUtils.exists(a))return a}o.shift()}}async sourceMapSourceToAbsolute(t,n){if(!this.shouldResolveSourceMap(n.metadata))return;switch(this.vueMapper.getVueHandling(t)){case 2:return;case 1:let a=await this.vueMapper.lookup(t);if(a)return We(a);break;default:}t=this.normalizeSourceMapUrl(t);let{pathMapping:i}=this.options,o=rg(n.sourceRoot,t),s=this.sourceMapOverrides.apply(o);if(s!==o){s=We(s);let a=cr(i["/"],"..","ClientApp",Cu(i["/"],s));return this.options.clientID==="visualstudio"&&o.startsWith("webpack:///")&&!await this.fsUtils.exists(s)&&await this.fsUtils.exists(a)?a:s}return Rr(t)?$e(t):Do.isAbsolute(t)?We(t):cr(await ng(n.sourceRoot,n.metadata.compiledPath,i,sp,this.logger),t)}absolutePathToUrlRegexp(t){let n=this.absolutePathToUrlPath(t),i=n.url,o=i.length;i.endsWith("index.html")?(o=i.length-10-1,i=i.slice(0,o)+"\\/?($|index(\\.html)?)"):i.endsWith(".html")&&(o=i.length-5,i=i.slice(0,o)+"(\\.html)?");let s=0;n.needsWildcard&&(i=CS+i,s=CS.length,o+=CS.length);let a=Er(i,[s,o]);return n.needsWildcard?`${Er(ge(t))}|${a}`:a}};ko=P([(0,ap.injectable)(),y(0,(0,ap.inject)(Rc)),y(1,(0,ap.inject)(Zt))],ko);var ag=class extends ko{constructor(t,n,i,o){super(t,n,i,o);this.blazorInCodespacesRegexpSubstitution="$1:\\$2";if(this.options.remoteFilePrefix){let s=`\\${xL.default.sep}`,a=this.options.remoteFilePrefix.replace(new RegExp(s,"g"),s);this.blazorInCodespacesRegexp=new RegExp(`^${a}${s}([A-z])\\$${s}(.*)$`)}else this.blazorInCodespacesRegexp=new RegExp("")}absolutePathToUrlRegexp(t){if(this.options.remoteFilePrefix){let n=t.replace(this.blazorInCodespacesRegexp,this.blazorInCodespacesRegexpSubstitution),o=Gi(n).replace(/^(\w):(.*)$/,"$1$2"),s=Er(o);if(s){let a=`dotnet://.*\\.dll/${s}`;return this.logger.verbose("runtime.breakpoints","absolutePathToUrlRegexp.blazor.remoteFs",{absolutePath:t,dotnetUrlRegexp:a}),a}}else{let n=ge(t),i=Er(n),o=super.absolutePathToUrlRegexp(t);return i.includes(o)?i:`${i}|${o}`}return super.absolutePathToUrlRegexp(t)}};var IL=g("url");function CL(r){if("file"in r&&r.file)return va(r.file);if(r.url)try{let e=new IL.URL(r.url);return e.pathname="/",e.search="",e.hash="",e.protocol==="data:"?void 0:e.href}catch{}}var Us=S(g("path")),TL=g("url");var PL="node:",Mi=class r extends Vc{constructor(t,n,i,o){super(i,o);this.fsUtils=t;this.linkedBp=n;this.options=i;this.logger=o}static shouldWarnAboutSymlinks(t){return"runtimeArgs"in t&&!t.runtimeArgs?.includes("--preserve-symlinks")}static getOptions(t){return{workspaceFolder:t.__workspaceFolder,resolveSourceMapLocations:t.resolveSourceMapLocations,basePath:t.cwd,sourceMapOverrides:t.sourceMapPathOverrides,remoteRoot:t.remoteRoot,localRoot:t.localRoot}}derive(t){return new r(this.fsUtils,this.linkedBp,{...this.options,...t},this.logger)}get resolutionOptions(){return this.options}async urlToAbsolutePath({url:t,map:n}){if(t=this.normalizeSourceMapUrl(t),t=this.sourceMapOverrides.apply(t),t.startsWith(PL)&&this.options.basePath)return t=Us.join(this.options.basePath,"lib",t.slice(PL.length)),t.endsWith(".js")||(t+=".js"),t;if(n)return this.sourceMapSourceToAbsolute(t,n);let i=$e(t);if(i)return this.rebaseRemoteToLocal(i);if(Kd(t)){let s=this.sourceMapOverrides.apply(t);t=s===t?new TL.URL(t).pathname.slice(1):s}else if(Us.isAbsolute(t))t=this.sourceMapOverrides.apply(t);else return`${di}/${t}`;let o=cr(this.options.basePath??"",t);return this.rebaseRemoteToLocal(o)}absolutePathToUrl(t){return ge(this.rebaseLocalToRemote(Us.normalize(t)))}async absolutePathToUrlRegexp(t){let n=t;try{n=await this.fsUtils.realPath(t)}catch{}return Hd(n,t)?Er(this.absolutePathToUrl(t)):(this.linkedBp?.warn(),Er(this.absolutePathToUrl(t))+"|"+Er(this.absolutePathToUrl(n)))}async sourceMapSourceToAbsolute(t,n){if(!this.shouldResolveSourceMap(n.metadata))return;let i=rg(n.sourceRoot,t),o=this.sourceMapOverrides.apply(i);return o!==i?We(o):Rr(t)?this.rebaseRemoteToLocal($e(t)):!Us.isAbsolute(t)&&this.options.basePath?cr(await ng(this.options.remoteRoot&&kt(n.sourceRoot)&&this.rebaseRemoteToLocal(n.sourceRoot)||n.sourceRoot,n.metadata.compiledPath,{"/":this.options.basePath},bL(this.fsUtils,n.metadata.compiledPath),this.logger),t):this.rebaseRemoteToLocal(t)||t}};var ln=Symbol("ISourcePathResolverFactory"),$c=class{constructor(e,t){this.fsUtils=e;this.linkedBp=t}create(e,t){if(e.type==="pwa-node"||e.type==="node-terminal"||e.type==="pwa-extensionHost")return new Mi(this.fsUtils,Mi.shouldWarnAboutSymlinks(e)?this.linkedBp:void 0,Mi.getOptions(e),t);throw new Error(`Not usable for type ${e.type}`)}};$c=P([(0,Sr.injectable)(),y(0,(0,Sr.inject)(Zt)),y(1,(0,Sr.optional)()),y(1,(0,Sr.inject)(xS))],$c);var Hc=class{constructor(e,t,n,i){this.initializeParams=e;this.vueMapper=t;this.fsUtils=n;this.linkedBp=i}create(e,t){if(e.type==="pwa-node"||e.type==="node-terminal"||e.type==="pwa-extensionHost")return new Mi(this.fsUtils,Mi.shouldWarnAboutSymlinks(e)?this.linkedBp:void 0,Mi.getOptions(e),t);{let n=!!e.inspectUri;return new(n?ag:ko)(this.vueMapper,this.fsUtils,{workspaceFolder:e.__workspaceFolder,resolveSourceMapLocations:e.resolveSourceMapLocations,baseUrl:CL(e),localRoot:null,remoteRoot:null,pathMapping:{"/":e.webRoot,...e.pathMapping},sourceMapOverrides:e.sourceMapPathOverrides,clientID:this.initializeParams.clientID,remoteFilePrefix:e.__remoteFilePrefix},t)}}};Hc=P([(0,Sr.injectable)(),y(0,(0,Sr.inject)(Dt)),y(1,(0,Sr.inject)(Rc)),y(2,(0,Sr.inject)(Zt)),y(3,(0,Sr.optional)()),y(3,(0,Sr.inject)(xS))],Hc);var EL=g("url");var cg=class extends Io{constructor(){super(...arguments);this.baseFilter=zi(this.launchParams);this.filter=t=>{let{debugWebWorkerExtHost:n,debugWebviews:i}=this.launchParams;return!!(n&&(t.type==="worker"&&t.title.startsWith("DebugExtensionHostWorker")||t.type==="page"&&t.title.includes("[Extension Development Host]"))||i&&t.type==="iframe"&&this.baseFilter(t))}}static async connectRenderer(t,n,i,o,s,a){let u=await t.rootSession().Target.attachToBrowserTarget({});if(!u)return;let l=t.createSession(u.sessionId);return new this(t,void 0,l,n,o,s,i,a)}waitForMainTarget(t){let n=this.launchParams;return n.debugWebWorkerExtHost&&this._browser.Target.on("targetCreated",this.enqueueLifecycleFn(async({targetInfo:i})=>{if(!i.url.includes(n.__sessionId))return;let o=await this._browser.Target.attachToTarget({targetId:i.targetId,flatten:!0});o&&this.attachedToTarget(i,o.sessionId,!1)})),super.waitForMainTarget(t)}attachedToTarget(t,n,i,o){let s=super.attachedToTarget(t,n,i||this.filter(t),o,!1);return t.type==="iframe"&&s.setComputeNameFn(V7),s}},V7=r=>{let e;try{e=new EL.URL(r.targetInfo.url)}catch{return}switch(e.searchParams.get("purpose")){case"customEditor":return`${e.searchParams.get("extensionId")} editor: ${e.host}`;case"notebookRenderer":return`Notebook Renderer: ${e.host}`;default:let t=e.searchParams.get("extensionId");return`Webview: ${t?t+" ":""} ${e.host}`}};var pn=class extends zr{constructor(t,n,i){super(t,n);this.pathResolverFactory=i;this.closeWhenTargetsEmpty=!1}async launch(t,n){if(t.type!=="pwa-extensionHost"||t.request!=="attach")return{blockSessionTermination:!1};let i=pn.debugIdTorendererDebugAddr.get(t.__sessionId);if(!i)return{blockSessionTermination:!1};let o=xa({name:"Webview",type:"pwa-chrome",request:"attach",address:i,__workspaceFolder:t.__workspaceFolder,timeout:0,urlFilter:"",resolveSourceMapLocations:t.resolveSourceMapLocations,...t.rendererDebugOptions});return o.__sessionId=t.__sessionId,o.debugWebWorkerExtHost=t.debugWebWorkerHost,o.debugWebviews=t.debugWebviews,super.launch(o,n).catch(s=>this.logger.error("runtime.exception","Error in webview attach",{err:s})),{blockSessionTermination:!1}}async acquireConnectionInner(t,n,i){return new it(await Kt.create(n.address,i),this.logger,t)}async getTargetFilter(t){return t.filter}async createTargetManager(t,n,i){return new cg(t,void 0,t.rootSession(),this.pathResolverFactory.create(n,this.logger),this.logger,i.telemetryReporter,n,i.targetOrigin)}};pn.debugIdTorendererDebugAddr=new Map,pn=P([(0,Gc.injectable)(),y(0,(0,Gc.inject)(W)),y(1,(0,Gc.inject)(Ce)),y(2,(0,Gc.inject)(ln))],pn);var AL=S(G());var zc=class r{constructor(){this.target={queue:[]}}connectTo(e){this.target={logger:e}}info(e,t,n){this.log({tag:e,timestamp:Date.now(),message:t,metadata:n,level:1})}verbose(e,t,n){this.log({tag:e,timestamp:Date.now(),message:t,metadata:n,level:0})}warn(e,t,n){this.log({tag:e,timestamp:Date.now(),message:t,metadata:n,level:2})}error(e,t,n){this.log({tag:e,timestamp:Date.now(),message:t,metadata:n,level:3})}fatal(e,t,n){this.log({tag:e,timestamp:Date.now(),message:t,metadata:n,level:4})}log(e){this.target&&("queue"in this.target?this.target.queue.push(e):this.target.logger.log(e))}getRecentLogs(){return this.target?"queue"in this.target?this.target.queue:this.target.logger.getRecentLogs():[]}assert(e,t){if(e===!1||e===void 0||e===null){if(this.error("runtime.assertion",t,{error:new Error("Assertion failed")}),process.env.JS_DEBUG_THROW_ASSERTIONS)throw new Error(t);debugger;return!1}return!0}setup(){throw new Error("A ProxyLogger cannot be setup()")}dispose(){this.target=void 0}forTarget(){return new r}};var RL=Symbol("ITargetOrigin"),ug=class{constructor(e){this.id=e}},lg=class{constructor(e){this.id=e}};var pg=class{constructor(e,t){this.parentList=e;this.logger=t;this.targets=new Zn;this.onTerminatedEmitter=new k;this.onTerminated=this.onTerminatedEmitter.event;this.onTargetListChanged=this.targets.onChanged;e.onAdd(([,n])=>{n.parent&&this.targets.get(n.parent.id)&&this.targets.add(n.id,n.target)}),e.onRemove(([n])=>{this.targets.remove(n)&&!this.targets.size&&this.onTerminatedEmitter.fire({killed:!0,code:0})})}async launch(e,t){if(e.type!=="node-terminal"||e.request!=="attach")return{blockSessionTermination:!1};let n=this.parentList.get(e.delegateId);if(n===void 0)return setTimeout(()=>this.onTerminatedEmitter.fire({killed:!0,code:0}),1),{blockSessionTermination:!0};let i=n.target.targetOrigin();if(!(i instanceof lg))throw new Error("Expected delegate session to have a mutable target origin");let o=n.target.logger;if(!(o instanceof zc))throw new Error("Expected delegate session to have a proxy logger");return i.id=t.targetOrigin.id,o.connectTo(this.logger),setTimeout(()=>{this.targets.add(e.delegateId,n.target),n.dap.connect(t.dap)},0),{blockSessionTermination:!0}}terminate(){for(let e of this.targets.value())e.stop();return Promise.resolve()}restart(){for(let e of this.targets.value())e.restart();return Promise.resolve()}targetList(){return[...this.targets.value()]}dispose(){this.terminate()}};var $7=0,js=class{constructor(){this.delegateSessions=new Zn;this.refsByTarget=new WeakMap}createLauncher(e){return new pg(this.delegateSessions,e)}addDelegate(e,t,n){let i={id:$7++,target:e,dap:t,parent:n&&this.refsByTarget.get(n)};return this.refsByTarget.set(e,i),this.delegateSessions.add(i.id,i),i.id}removeDelegate(e){let t=this.refsByTarget.get(e);t&&this.delegateSessions.remove(t.id)}};js=P([(0,AL.injectable)()],js);var JL=S(G());var ye=class r{constructor(e,t,n){this.major=e;this.minor=t;this.patch=n}static parse(e){let t=e.split(".").map(Number);if(t.length!==3||t.some(isNaN))throw new SyntaxError(`Input string '${e}' is not a semver`);return new r(t[0],t[1],t[2])}static min(e,t){return e.lt(t)?e:t}compare(e){return this.major-e.major||this.minor-e.minor||this.patch-e.patch}gt(e){return this.compare(e)>0}gte(e){return this.compare(e)>=0}lt(e){return this.compare(e)<0}lte(e){return this.compare(e)<=0}toString(){return`${this.major}.${this.minor}.${this.patch}`}};var HL=S(G());var VL=S(ML()),ii=S(g("fs")),Ws=S(G()),$L=S(g("net")),AS=S(g("os")),kS=S(g("path"));var hg=class{constructor(e,t){this.sessionId=e;this.sink=t;this.onMessageEmitter=new k;this.onEndEmitter=new k;this.disposables=new De;this.onMessage=this.onMessageEmitter.event;this.onEnd=this.onEndEmitter.event;this.disposables.push(t.NodeWorker.on("detachedFromWorker",n=>{n.sessionId===e&&(this.onEndEmitter.fire(),this.dispose())}),t.NodeWorker.on("receivedMessageFromWorker",n=>{n.sessionId===e&&this.onMessageEmitter.fire([n.message,new Br])}))}send(e){this.sink.NodeWorker.sendMessageToWorker({message:e,sessionId:this.sessionId})}dispose(){this.disposables.isDisposed||(this.disposables.dispose(),this.onEndEmitter.fire())}};var NL=":::";var ES=g("path"),Pve=(0,ES.join)(__dirname,"watchdog.js"),LL=(0,ES.join)(__dirname,"bootloader.js");var pp=S(He()),ir=S(G()),or=g("path");var cp=S(G()),FL=g("path");var qs=Symbol("IPackageJsonProvider");var Kc=class{constructor(e,t){this.fs=e;this.config=t;this.getPath=ne(async()=>{if(this.config.type!=="pwa-node"||this.config.request!=="launch")return;let e=await Gd(this.fs,this.config.cwd,"package.json");return e?(0,FL.join)(e,"package.json"):void 0});this.getContents=ne(async()=>{let e=await this.getPath();if(e)try{let t=await this.fs.readFile(e);return JSON.parse(t.toString())}catch{return}})}};Kc=P([(0,cp.injectable)(),y(0,(0,cp.inject)(Zt)),y(1,(0,cp.inject)(le))],Kc);var Oo=Symbol("INodeBinaryProvider");function BL(r,e){return r.has(1)?e.addNodeOption("--inspect-publish-uid=http"):e}var aJ=new Set(["npm","yarn","pnpm","tnpm","cnpm"]),UL=r=>aJ.has((0,or.basename)(r,(0,or.extname)(r))),jL=(r,e)=>{if(!(!r||!UL(r)))return e.find(t=>!t.startsWith("-")&&t!=="run"&&t!=="run-script")},RS=new ye(12,0,0),cJ=new ye(8,0,0),uJ=[{inclusiveMin:new ye(16,0,0),inclusiveMax:new ye(16,3,99),message:pp.t("Some breakpoints might not work in your version of Node.js. We recommend upgrading for the latest bug, performance, and security fixes. Details: https://aka.ms/AAcsvqm")},{inclusiveMin:new ye(7,0,0),inclusiveMax:new ye(8,99,99),message:pp.t("You're running an outdated version of Node.js. We recommend upgrading for the latest bug, performance, and security fixes.")}],nr=class{constructor(e,t){this.path=e;this.version=t;this.capabilities=new Set;t===void 0&&(t=RS),t.gte(new ye(12,0,0))&&this.capabilities.add(0),t.gte(new ye(12,6,0))&&this.capabilities.add(1),t.gte(new ye(22,14,0))&&t.lt(new ye(24,0,0))&&lJ.includes(bb(e))&&this.capabilities.add(2)}get isPreciselyKnown(){return this.version!==void 0}get warning(){if(this.version){for(let e of uJ)if(e.inclusiveMax.gte(this.version)&&e.inclusiveMin.lte(this.version))return e}}has(e,t){return!this.isPreciselyKnown&&t!==void 0?t:this.capabilities.has(e)}},lp=class extends O{constructor(t,n){super(v0(t.toString(),n));this.version=t;this.location=n}},qL=["node","node64","electron"],lJ=[...qL,"npx","npm"],pJ=new Map([[11,new ye(12,0,0)],[10,new ye(12,0,0)],[9,new ye(12,0,0)],[8,new ye(12,0,0)],[7,new ye(12,0,0)],[6,new ye(12,0,0)],[5,new ye(10,0,0)],[4,new ye(10,0,0)],[3,new ye(10,0,0)],[2,new ye(8,0,0)],[1,new ye(8,0,0)]]),up=class{constructor(e,t,n,i){this.logger=e;this.fs=t;this.packageJson=n;this.launchConfig=i;this.knownGoodMappings=new Map}async resolveAndValidate(e,t="node",n,i){try{return await this.resolveAndValidateInner(e,t,n,i)}catch(o){if(!(o instanceof lp))throw o;if(await this.shouldTryDebuggingAnyway(o))return new nr(o.location,o.version instanceof ye?o.version:void 0);throw o}}shouldTryDebuggingAnyway(e){return Promise.resolve(!1)}async resolveNodeModulesLocation(e,t,n){if(!n||(0,or.isAbsolute)(t)||!(0,or.isAbsolute)(n))return;let i=this.launchConfig.__workspaceFolder;if(i)return vb(n,o=>hd(i,o)?qy(this.fs,(0,or.join)(o,"node_modules",".bin",t),e):Promise.resolve(void 0))}async resolveAndValidateInner(e,t,n,i){let o=await this.resolveBinaryLocation(t,e);if(o||(o=await this.resolveNodeModulesLocation(e,t,i)),this.logger.info("runtime.launch","Using binary at",{location:o,executable:t}),!o)throw new O(Rb(t,pp.t("path does not exist")));if(n)return new nr(o,new ye(n,0,0));let s=bb(o);if(s==="deno")return new nr(o,new ye(20,0,0));if(!qL.includes(s)){if(UL(o)){let m=await this.packageJson.getPath();m&&(e=e.addToPath((0,or.resolve)((0,or.dirname)(m),"node_modules/.bin"),"prepend"))}try{let m=await this.resolveAndValidateInner(e,"node",void 0,i);return new nr(o,m.version)}catch(m){if(E0(m,9230))throw m;return new nr(o,void 0)}}if(o.startsWith("/snap/"))return new nr(o,void 0);let a=this.knownGoodMappings.get(o);if(a)return a;let c=await this.getVersionText(o,i);if(!c)return new nr(o,void 0);this.logger.info("runtime.launch","Discovered version",{version:c});let u=/v([0-9]+)\.([0-9]+)\.([0-9]+)/.exec(c);if(!u)throw new lp(c,o);let[,l,p,d]=u.map(Number),f=new ye(l,p,d);if(s==="electron"){let m=await this.resolveAndValidate(e);f=ye.min(pJ.get(f.major)??RS,m.version??RS)}if(f.lt(cJ))throw new lp(f,o);let h=new nr(o,f);return this.knownGoodMappings.set(o,h),h}async resolveBinaryLocation(e,t){return e&&(0,or.isAbsolute)(e)?await qy(this.fs,e,t):await fd(this.fs,e,t.value)}async getVersionText(e,t){try{let{stdout:n}=await Gm(e,["--version"],{env:bt.processEnv().defined(),cwd:t});return n.trim()}catch(n){throw t&&!(await Ui(this.fs,t))?.isDirectory()?new O(b0(t)):new O(Rb(e,n.message))}}};up=P([(0,ir.injectable)(),y(0,(0,ir.inject)(W)),y(1,(0,ir.inject)(Re)),y(2,(0,ir.inject)(qs)),y(3,(0,ir.inject)(le))],up);var Jc=class extends up{constructor(t,n,i,o,s){super(t,n,i,o);this.vscode=s}async shouldTryDebuggingAnyway({message:t}){if(!this.vscode)return!1;let n=pp.t("Yes");return await this.vscode.window.showErrorMessage(t,n)===n}};Jc=P([y(0,(0,ir.inject)(W)),y(1,(0,ir.inject)(Re)),y(2,(0,ir.inject)(qs)),y(3,(0,ir.inject)(le)),y(4,(0,ir.optional)()),y(4,(0,ir.inject)(Bn))],Jc);var WL=g("path");var mg=class{constructor(e,t,n,i,o,s,a={},c){this.launchConfig=e;this.targetOriginValue=t;this.connection=n;this.targetInfo=o;this.logger=s;this.lifecycle=a;this._parent=c;this._serialize=Promise.resolve(void 0);this._attached=!1;this._onNameChangedEmitter=new k;this._onDisconnectEmitter=new k;this.entryBreakpoint=void 0;this.onDisconnect=this._onDisconnectEmitter.event;this.onNameChanged=this._onNameChangedEmitter.event;this.connection=n,this._cdp=i,i.pause(),this._waitingForDebugger=o.type==="waitingForDebugger",o.title?this._targetName=`${(0,WL.basename)(o.title)} [${o.processId}]`:this._targetName=`[${o.processId}]`,i.Target.on("targetDestroyed",()=>this.connection.close()),n.onDisconnected(()=>this._disconnected())}id(){return this.targetInfo.targetId}processId(){return this.targetInfo.processId}name(){return this._targetName}fileName(){return this.targetInfo.title}type(){return"node"}targetOrigin(){return this.targetOriginValue}parent(){return this._parent}async initialize(){this.lifecycle.initialized&&(this.entryBreakpoint=await this.lifecycle.initialized(this)||void 0)}waitingForDebugger(){return this._waitingForDebugger}scriptUrlToUrl(e){return e[0]==="/"||process.platform==="win32"&&e[1]===":"&&e[2]==="\\"?ge(e):e}supportsCustomBreakpoints(){return!1}supportsXHRBreakpoints(){return!1}executionContextName(){return this._targetName}hasParent(){return!!this._parent}async runIfWaitingForDebugger(){await this._cdp.Runtime.runIfWaitingForDebugger({})}async _disconnected(){this._onDisconnectEmitter.fire()}canAttach(){return!this._attached}async attach(){return this._serialize=this._serialize.then(async()=>{if(!this._attached)return this._doAttach()}),this._serialize}async _doAttach(){this._waitingForDebugger=!1,this._attached=!0;let e=await this._cdp.Target.attachToTarget({targetId:this.targetInfo.targetId});if(!e){this.logger.info("runtime.launch","Failed to attach to target",{targetId:this.targetInfo.targetId});return}this._cdp.NodeWorker.enable({waitForDebuggerOnStart:!0}),e&&"__dynamicAttach"in e&&(await this._cdp.Runtime.enable({}),await this._cdp.Debugger.enable({}));let t;return this._cdp.Runtime.on("executionContextCreated",n=>{n.context.auxData&&n.context.auxData.isDefault&&(t=n.context.id)}),this._cdp.Runtime.on("executionContextDestroyed",n=>{n.executionContextId===t&&this.connection.close()}),this._cdp}async afterBind(){this._cdp.resume()}canDetach(){return this._attached}async detach(){this._serialize=this._serialize.then(async()=>{this._waitingForDebugger&&await(await this._doAttach())?.Runtime.runIfWaitingForDebugger({}),this._attached&&this._doDetach()})}async _doDetach(){await Promise.all([this._cdp.Target.detachFromTarget({targetId:this.targetInfo.targetId}),this._cdp.NodeWorker.disable({})]),this.connection.close(),this._attached=!1}canRestart(){return!1}restart(){}canStop(){return!0}stop(){try{this.lifecycle.close&&this.lifecycle.close(this)}finally{this.connection.close()}}};var ni=class{constructor(e,t,n,i){this.pathProvider=e;this.logger=t;this.portLeaseTracker=n;this.pathResolverFactory=i;this.serverConnections=new Set;this.targets=new Zn;this.onTerminatedEmitter=new k;this.onTerminated=this.onTerminatedEmitter.event;this.onTargetListChanged=this.targets.onChanged;this.bootloaderFile=ne(this.getBootloaderFile.bind(this));this.seenOpeners=new Map}async launch(e,t){let n=this.resolveParams(e);if(!n)return{blockSessionTermination:!1};this._stopServer();let{server:i,pipe:o}=await this._startServer(t.telemetryReporter),s=this.logger.forTarget(),a=this.run={server:i,serverAddress:o,params:n,context:t,logger:s,pathResolver:this.pathResolverFactory.create(n,this.logger)};return await this.launchProgram(a),{blockSessionTermination:!0}}async terminate(){this.program?await this.program.stop():this.onProgramTerminated({code:0,killed:!0})}async restart(e){if(!this.run)return;let t=this.program;t&&(this.program=void 0,await t.stop(),await Promise.race([ue(2e3).then(()=>!1),Promise.all([...this.serverConnections].map(i=>new Promise(o=>i.onDisconnected(o))))])||(this.logger.warn("runtime.launch","Timeout waiting for server connections to close"),this.closeAllConnections())),await this.launchProgram({...this.run,params:e?this.resolveParams(e)??this.run.params:this.run.params,context:{...this.run.context,cancellationToken:this.run.params.timeout>0?ut.withTimeout(this.run.params.timeout).token:Ht}})}targetList(){return[...this.targets.value()]}dispose(){this._stopServer()}onProgramTerminated(e){this.onTerminatedEmitter.fire(e),this._stopServer(),this.program=void 0}resolveNodePath(e,t="node"){return this.pathProvider.resolveAndValidate(bt.merge(bt.processEnv(),this.getConfiguredEnvironment(e)),t,e.nodeVersionHint,e.cwd)}getConfiguredEnvironment(e){let t=bt.empty;if(e.envFile)try{t=t.merge(fJ(e.envFile))}catch(n){throw new O(y0(n.message))}return t.merge(e.env)}async resolveEnvironment({params:e,serverAddress:t},n,i){let o=this.getConfiguredEnvironment(e),s=await this.bootloaderFile(e.cwd,n),a={inspectorIpc:t,deferredMode:!1,waitForDebugger:"",execPath:await fd(ii.promises,"node",process.env),onlyEntrypoint:!e.autoAttachChildProcesses,verbose:e.trace===!0||typeof e.trace=="object"&&e.trace.stdio?!0:void 0,autoAttachMode:"always",mandatePortTracking:this.portLeaseTracker.isMandated?!0:void 0,...i},c={NODE_OPTIONS:` --require ${s.interpolatedPath} `,VSCODE_INSPECTOR_OPTIONS:NL+JSON.stringify(a),ELECTRON_RUN_AS_NODE:null},u=o.lookup("NODE_OPTIONS");u&&(c.NODE_OPTIONS+=` ${u} `);let l=bt.processEnv().lookup("NODE_OPTIONS");return l&&(c.NODE_OPTIONS+=` ${l}`),o.merge({...c})}createLifecycle(e,t,n){return{}}async _startServer(e){let t=bP(),n=await new Promise((i,o)=>{let s=$L.createServer(a=>this._startSession(a,e)).on("error",o).listen(t,()=>i(s))});return{pipe:t,server:n}}_stopServer(){this.run?.server.close(),this.run=void 0,this.bootloaderFile.value?.then(e=>e.dispose()),this.bootloaderFile.forget(),this.closeAllConnections()}closeAllConnections(){this.serverConnections.forEach(e=>e.close()),this.serverConnections.clear()}async _startSession(e,t){if(!this.run)return;let{connection:n,cdp:i,targetInfo:o}=await this.acquireTarget(e,t,this.run.logger);if(!this.run){e.destroy();return}o.processId===void 0&&(o.processId=Number(o.targetId));let s=o.openerId;for(;s&&!this.targets.get(s)&&this.seenOpeners.has(s);)s=this.seenOpeners.get(s)?.openedBy;let a=new mg(this.run.params,this.run.context.targetOrigin,n,i,o,this.run.logger,this.createLifecycle(i,this.run,o),s?this.targets.get(s):void 0);this.seenOpeners.set(o.targetId,{openedBy:o.openerId}),this.listenToWorkerDomain(i,t,a),this.targets.add(o.targetId,a),a.onDisconnect(()=>this.targets.remove(o.targetId))}async listenToWorkerDomain(e,t,n){e.NodeWorker.on("attachedToWorker",i=>{let o=new hg(i.sessionId,e),s=new ac(n.launchConfig,{attached:!0,canAccessOpener:!1,type:"node-worker",targetId:`${n.id()}-${i.sessionId}`,title:i.workerInfo.title,url:i.workerInfo.url,openerId:n.id()},n,n.targetOrigin(),new it(o,n.logger,t).rootSession(),n.logger),a=new De;a.push(o),a.push(n.onDisconnect(()=>a.dispose())),a.push(o.onEnd(()=>a.dispose())),a.callback(()=>this.targets.remove(s.id())),this.targets.add(s.id(),s)})}async acquireTarget(e,t,n){let i=new it(new ei(n,e),n,t);this.serverConnections.add(i),i.onDisconnected(()=>this.serverConnections.delete(i));let o=i.rootSession(),{targetInfo:s}=await new Promise(u=>o.Target.on("targetCreated",u)),a=s,c=this.portLeaseTracker.register(a.processInspectorPort);return i.onDisconnected(()=>c.dispose()),{targetInfo:a,cdp:o,connection:i,logger:n}}async getBootloaderFile(e,t){let n=Be(LL);if(!n.includes(" "))return{interpolatedPath:n,dispose:()=>{}};if(t.has(0))return{interpolatedPath:`"${n}"`,dispose:()=>{}};let i=`require(${JSON.stringify(n)})`;if(!AS.tmpdir().includes(" ")||!e){let a=kS.join(AS.tmpdir(),"vscode-js-debug-bootloader.js");return await ii.promises.writeFile(a,i),{interpolatedPath:a,dispose:()=>{}}}let o=".vscode-js-debug-bootloader.js",s=kS.join(e,o);return await ii.promises.writeFile(s,i),{interpolatedPath:`./${o}`,dispose:()=>ii.unlinkSync(s)}}async gatherTelemetryFromCdp(e,t){for(let n=0;n<8;n++){let i=await e.Runtime.evaluate({contextId:1,returnByValue:!0,expression:"typeof process === 'undefined' || process.pid === undefined ? 'process not defined' : ({ processId: process.pid, nodeVersion: process.version, architecture: process.arch })"+Ve()});if(!this.program)return;if(!i||!i.result.value){this.logger.error("runtime.target","Undefined result getting telemetry");return}if(typeof i.result.value!="object"){this.logger.info("runtime.target","Process not yet defined, will retry"),await ue(50*2**n);continue}let o=i.result.value;return t.context.telemetryReporter.report("nodeRuntime",{version:o.nodeVersion,arch:o.architecture}),this.program.gotTelemetery(o),o}}};ni=P([(0,Ws.injectable)(),y(0,(0,Ws.inject)(Oo)),y(1,(0,Ws.inject)(W)),y(2,(0,Ws.inject)(Fr)),y(3,(0,Ws.inject)(ln))],ni);function fJ(r){if(!ii.existsSync(r))return{};let e=hJ(ii.readFileSync(r,"utf8"));return VL.parse(Buffer.from(e))}function hJ(r){return r&&r[0]==="\uFEFF"&&(r=r.substr(1)),r}var mJ=["NODE_OPTIONS","VSCODE_INSPECTOR_OPTIONS"],Mo=class extends ni{async appendEnvironmentVariables(e,t){let n="typeof Deno==='object'?'deno':typeof process==='undefined'||process.pid===undefined?'process not defined':(()=>{"+Object.entries(t.defined()).map(([i,o])=>{let s=JSON.stringify(i);return mJ.includes(i)?`process.env[${s}]=(process.env[${s}]||'')+${JSON.stringify(o)}`:`process.env[${s}]=${JSON.stringify(o)}`}).join(";")+"})()"+Ve();for(let i=0;i<200;i++){let o=await e.Runtime.evaluate({contextId:1,returnByValue:!0,expression:n});if(!o){this.logger.error("runtime.target","Undefined result setting child environment vars");return}if(!o.exceptionDetails&&o.result.value!=="process not defined")return;this.logger.error("runtime.target","Error setting child environment vars",o),await ue(50)}}};Mo=P([(0,HL.injectable)()],Mo);var gg=class{constructor(e,t){this.a=e;this.b=t;this.stopped=Promise.race([this.a.stopped.then(async e=>await this.b.stop()&&e),this.b.stopped.then(async e=>await this.a.stop()&&e)])}gotTelemetery(e){this.a.gotTelemetery(e),this.b.gotTelemetery(e)}async stop(){return(await Promise.all([this.a.stop(),this.b.stop()]))[0]}},yg=class{constructor(e,t,n){this.child=e;this.logger=t;this.killBehavior=n;this.killed=!1;this.stopped=new Promise((i,o)=>{e.once("exit",s=>i({killed:this.killed,code:s||0})),e.once("error",s=>o({killed:this.killed,code:1,error:s}))})}gotTelemetery(){}stop(){return this.killed=!0,an(this.child.pid,this.logger,this.killBehavior),this.stopped}},Vs=class{constructor(){this.stopped=new Promise(e=>this.stopDefer=e)}gotTelemetery(e){this.telemetry=e}stop(){return this.stopDefer({code:0,killed:!0}),this.stopped}},No=class extends Vs{constructor(t){super();this.wd=t;t.onEnd(n=>{this.stopDefer(n),this.wd.dispose()})}stop(){return this.wd.dispose(),this.stopped}},Yc=class r{constructor(e,t,n){this.terminalResult=e;this.logger=t;this.killBehavior=n;this.didStop=!1;this.stopped=new Promise(e=>this.onStopped=t=>{this.didStop=!0,e({code:0,killed:t})});e.processId&&this.startPollLoop(e.processId)}static{this.terminationPollInterval=1e3}static{this.killConfirmInterval=200}gotTelemetery({processId:e}){if(this.didStop){an(e,this.logger,this.killBehavior);return}this.loop||this.startPollLoop(e)}stop(){return this.didStop?this.stopped:(this.didStop=!0,this.loop?(an(this.loop.processId,this.logger,this.killBehavior),this.startPollLoop(this.loop.processId,r.killConfirmInterval)):this.terminalResult.shellProcessId?(an(this.terminalResult.shellProcessId,this.logger,this.killBehavior),this.startPollLoop(this.terminalResult.shellProcessId,r.killConfirmInterval)):this.onStopped(!0),this.stopped)}startPollLoop(e,t=r.terminationPollInterval){this.loop&&clearInterval(this.loop.timer);let n={processId:e,timer:setInterval(()=>{gJ(e)||(clearInterval(n.timer),this.onStopped(!0))},t)};this.loop=n}};function gJ(r){try{return process.kill(r,0),!0}catch{return!1}}var KL=S(g("net"));var GL=g("crypto"),zL=()=>(0,GL.randomBytes)(12).toString("hex");var oi=class r{constructor(e,t){this.info=e;this.server=t;this.onEndEmitter=new k;this.cts=new ut;this.gracefulExit=!1;this.targetAlive=!1;this.targetInfo={targetId:this.info.ownId??zL(),processId:Number(this.info.pid)||0,type:this.info.waitForDebugger?"waitingForDebugger":"",title:this.info.scriptName,url:"file://"+this.info.scriptName,openerId:this.info.openerId,attached:!0,canAccessOpener:!1,processInspectorPort:Number(new URL(this.info.inspectorURL).port)};this.onEnd=this.onEndEmitter.event;this.listenToServer()}get isTargetAlive(){return this.targetAlive}static async attach(e){let t=await new Promise((i,o)=>{let s=KL.createConnection(e.ipcAddress,()=>i(s));s.on("error",o)}),n=new ei(Hr.null,t);return new r(e,n)}listenToServer(){let{server:e,targetInfo:t}=this;e.send(JSON.stringify({method:"Target.targetCreated",params:{targetInfo:t}})),e.onMessage(async([n])=>{if(this.target&&!n.includes("Target.attachToTarget")&&!n.includes("Target.detachFromTarget")){this.target.send(n);return}let i=await this.execute(n);i&&e.send(JSON.stringify(i))}),e.onEnd(()=>{this.disposeTarget(),this.onEndEmitter.fire({killed:this.gracefulExit,code:this.gracefulExit?0:1})})}dispose(){this.gracefulExit=!0,this.cts.dispose(!0),this.disposeTarget(),this.server.dispose()}async execute(e){let t=JSON.parse(e);switch(t.method){case"Target.attachToTarget":return this.target&&this.disposeTarget(),this.target=await this.createTarget(),{id:t.id,result:{sessionId:this.targetInfo.targetId,__dynamicAttach:this.info.dynamicAttach?!0:void 0}};case"Target.detachFromTarget":return this.gracefulExit=!0,this.disposeTarget(),{id:t.id,result:{}};default:this.target?.send(t);return}}async createTarget(){this.gracefulExit=!1;let e=await Kt.create(this.info.inspectorURL,this.cts.token,this.info.remoteHostHeader);return e.onMessage(([t])=>this.server.send(t)),e.onEnd(()=>{e&&this.server.send(JSON.stringify({method:"Target.targetDestroyed",params:{targetId:this.targetInfo.targetId,sessionId:this.targetInfo.targetId}})),this.targetAlive=!1,this.server.dispose()}),e}disposeTarget(){this.target&&(this.target.dispose(),this.target=void 0)}};var DS=class extends No{constructor(t,n){super(t);this.logger=n;this.stopped.then(()=>{this.telemetry&&an(this.telemetry.processId,this.logger,"polite")})}},Xc=class extends Mo{constructor(){super(...arguments);this.restarting=!1}async restart(){this.restarting=!0,this.onProgramTerminated({code:0,killed:!0,restart:!0}),this.program?.stop()}resolveParams(t){return t.type==="pwa-extensionHost"&&t.request==="attach"?t:void 0}async launchProgram(t){let n=await Fc(`http://localhost:${t.params.port}`,t.context.cancellationToken,this.logger),i=await oi.attach({ipcAddress:t.serverAddress,scriptName:"Extension Host",inspectorURL:n,waitForDebugger:!0,dynamicAttach:!0}),o=this.program=new DS(i,this.logger);this.program.stopped.then(s=>{o===this.program&&this.onProgramTerminated(s)})}createLifecycle(t,n,i){return i.openerId?{}:{initialized:()=>this.onFirstInitialize(t,n,i)}}async onFirstInitialize(t,n,i){this.setEnvironmentVariables(t,n,i.targetId);let o=await this.gatherTelemetryFromCdp(t,n),s=this.program;if(o&&s){let a=new Yc({processId:o.processId},this.logger,"forceful");a.stopped.then(()=>s.stop()),s.stopped.then(()=>{this.restarting||a.stop()})}}async setEnvironmentVariables(t,n,i){if(!n.params.autoAttachChildProcesses)return;let o=await this.resolveEnvironment(n,new nr("node",ye.parse(process.versions.node)),{openerId:i});return this.appendEnvironmentVariables(t,o.update("ELECTRON_RUN_AS_NODE",null))}};Xc=P([(0,JL.injectable)()],Xc);var dp=g("fs"),YL=S(G());var Qc=class extends ni{resolveParams(e){return e.type==="pwa-extensionHost"&&e.request==="launch"?e:void 0}async launchProgram(e){let t=e.params.port||await Jf(),n=await e.context.dap.launchVSCodeRequest({args:yJ(e.params,t),env:this.getConfiguredEnvironment(e.params).defined(),debugRenderer:e.params.debugWebviews||e.params.debugWebWorkerHost});n.rendererDebugAddr&&pn.debugIdTorendererDebugAddr.set(e.params.__sessionId,n.rendererDebugAddr),this.program=new Vs,this.program.stop()}};Qc=P([(0,YL.injectable)()],Qc);var yJ=(r,e)=>{let t=r.args.map(n=>{if(n.startsWith("-")){let i=n.split("=",2);return i.length===2&&((0,dp.existsSync)(i[1])||(0,dp.existsSync)(i[1]+".js"))?{prefix:i[0]+"=",path:i[1]}:{prefix:n}}else{try{let i=(0,dp.lstatSync)(n);if(i.isDirectory())return{prefix:"--folder-uri=",path:n};if(i.isFile())return{prefix:"--file-uri=",path:n}}catch{}return{path:n}}});return r.noDebug||t.unshift({prefix:`--inspect-brk-extensions=${e}`}),t.unshift({prefix:`--debugId=${r.__sessionId}`}),t};var cF=S(He()),$s=S(G());var XL=g("crypto"),fp=g("fs"),QL=g("os"),ZL=S(g("path")),bg=class r{constructor(){this.disposed=!1;this.path=ZL.join((0,QL.tmpdir)(),`node-debug-callback-${(0,XL.randomBytes)(8).toString("hex")}`);this.file=fp.promises.open(this.path,"w")}static{this.updateInterval=1e3}static{this.recencyDeadline=2e3}static isValid(e){try{let t=(0,fp.readFileSync)(e);return t.length?t.readDoubleBE()>Date.now()-r.recencyDeadline:!1}catch{return!1}}async startTouchLoop(){await this.touch(),this.disposed||(this.updateInterval=setInterval(()=>this.touch(),r.updateInterval))}async touch(e=()=>Date.now()){let t=await this.file,n=Buffer.alloc(8);n.writeDoubleBE(e()),await t.write(n,0,n.length,0)}async dispose(){if(!this.disposed){this.disposed=!0,this.updateInterval&&clearInterval(this.updateInterval);try{await(await this.file).close(),await fp.promises.unlink(this.path)}catch{}}}};var nF=g("fs");var tF=g("path");var eF=g("child_process");var vg=class{constructor(e=eF.spawn){this.spawn=e}lookup(e,t){return new Promise((n,i)=>{let o=this.createProcess(),s=this.createParser();o.on("error",i),o.stderr.on("error",a=>i(`Error finding processes: ${a.toString()}`)),o.stdout.pipe(new Po(`
`)).on("data",a=>{let c=s(a.toString());c&&(t=e(c,t))}),o.on("close",(a,c)=>{a===0?n(t):c?i(new Error(`process terminated with signal: ${c}`)):a&&i(new Error(`process terminated with exit code: ${a}`))})})}};var Zc=class extends vg{constructor(t){super();this.fsUtils=t}async getWorkingDirectory(t){try{let{stdout:n}=await Gm("lsof",["-a","-dcwd","-Fn",`-p${t}`]),i=n.trim().split(`
`).pop().slice(1);return i&&(0,tF.isAbsolute)(i)&&await this.fsUtils.exists(i)?i:void 0}catch(n){if(n instanceof rp)return;throw n}}createProcess(){return this.spawn("ps",["-xo",`pid=PID,ppid=PPID,comm=${"a".repeat(256)},command=COMMAND`])}createParser(){let t;return n=>{if(!t){t=n.indexOf("COMMAND");return}let i=/^\W*([0-9]+)\W*([0-9]+)\W*/.exec(n);if(i)return{pid:Number(i[1]),ppid:Number(i[2]),command:n.slice(i[0].length,t).trim(),args:n.slice(t).trim()}}}};var _g=class extends Zc{createProcess(){return this.spawn("ps",["-axo","pid=PID,ppid=PPID,comm:30,command=COMMAND"])}createParser(){let e=super.createParser();return t=>{let n=e(t);if(!n)return;let i=n.args.indexOf(n.command);if(i===-1)return n;for(i=i+n.command.length;i<n.args.length&&n.args[i]!==" ";)i++;return n.command=n.args.substr(0,i),n.args=n.args.substr(i+1),n}}};var wg=class{async getWorkingDirectory(){}async lookup(e,t){let n=await tg();for(let i of n.getProcessInfo()){let o=i.commandLine.indexOf('" ');t=e({args:o!==-1?i.commandLine.slice(o+2):"",command:o!==-1?i.commandLine.slice(1,o+1):i.commandLine,date:i.creationDate*1e3,pid:i.processId,ppid:i.parentProcessId},t)}return t}};var rF=new Qr(nF.promises),iF=process.platform==="win32"?new wg:process.platform==="darwin"?new Zc(rF):new _g(rF),bJ=ne(()=>{let r=["--inspect(?:-brk)?","(?:=",["(?:",["(?:","(?<address>\\[[0-9a-f:]*\\]|[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+|(?:[a-z][a-z0-9\\.]*))","(?::(?<port1>\\d+))?",")"],"|",["(?:",":?","(?<port2>\\d+)?",")"],")"],")?"].flat(1/0).join("");return new RegExp(r,"i")});function oF(r){let e=/--inspect-port=(\d+)/,t,n,i=bJ().exec(r);if(i?.groups){let o=i.groups.port1||i.groups.port2;n=o?Number(o):9229,t=i.groups.address??"127.0.0.1"}return i=e.exec(r),i&&i.length===2&&(t||="127.0.0.1",n=parseInt(i[1])),{address:t,port:n}}async function sF(r,e,t,n=Ht){let i=await vJ(r.pid,t);if(!i)return[];let o=[],s=i.children.slice();for(;s.length;){let a=s.pop();s=s.concat(a.children);let{port:c}=oF(a.args);c&&o.push(wS(`http://${r.hostname}:${c}`,n,t,!0).then(u=>oi.attach({ipcAddress:r.ipcAddress,scriptName:"Child Process",inspectorURL:u,waitForDebugger:!0,dynamicAttach:!0,pid:String(a.pid),openerId:e})).catch(u=>t.info("internal","Could not spawn WD for child process",{err:u,port:c,child:a})))}return(await Promise.all(o)).filter(a=>!!a)}async function vJ(r,e){let t=new Map;t.set(0,{children:[],pid:0,ppid:0,command:"",args:""});try{await iF.lookup(({pid:i,ppid:o,command:s,args:a})=>(i!==o&&t.set(i,{pid:i,ppid:o,command:s,args:a,children:[]}),t),null)}catch(i){e.warn("internal","Error getting child process tree",i);return}let n=t.values();for(let i of n){let o=t.get(i.ppid);o&&o!==i&&o.children.push(i)}return!isNaN(r)&&r>0?t.get(r):t.get(0)}var aF=S(G());var si=class{create(e){return e===!1?new OS:e===!0?new Sg({maxAttempts:1/0,delay:1e3}):new Sg({maxAttempts:e.maxAttempts??1/0,delay:e.delay??1e3})}};si=P([(0,aF.injectable)()],si);var Sg=class r{constructor(e,t=0){this.options=e;this.attempt=t}get delay(){return this.options.delay}next(){return this.attempt===this.options.maxAttempts?void 0:new r(this.options,this.attempt+1)}reset(){return this.attempt?new r(this.options):this}},OS=class{constructor(){this.delay=-1}next(){}reset(){return this}};var eu=class extends Mo{constructor(t,n,i,o,s=new si){super(t,n,o,i);this.restarters=s}resolveParams(t){return t.type==="pwa-node"&&t.request==="attach"?t:void 0}async launchProgram(t){let n=async(o,s)=>{let a=this.program,c;try{t.params.websocketAddress?c=t.params.websocketAddress:c=await Fc(`http://${t.params.address}:${t.params.port}`,s&&t.params.timeout>0?ut.withTimeout(t.params.timeout).token:t.context.cancellationToken,this.logger,t.params.remoteHostHeader)}catch(p){if(a&&a===s)return i(o,a,{killed:!1,code:1});throw p}let u=await oi.attach({ipcAddress:t.serverAddress,scriptName:"Remote Process",inspectorURL:c,remoteHostHeader:t.params.remoteHostHeader,waitForDebugger:!0,dynamicAttach:!0}),l=this.program=new No(u);l.stopped.then(p=>i(o.reset(),l,p))},i=async(o,s,a)=>{if(this.program!==s)return;if(a.killed){this.onProgramTerminated(a);return}let c=o.next();if(!c){this.onProgramTerminated(a);return}t.context.dap.output({output:cF.t(`Lost connection to debugee, reconnecting in {0}ms\r
`,c.delay)});let u=new Vs;this.program=u;let l=await Promise.race([ue(c.delay),u.stopped]);this.program===u&&(l?this.onProgramTerminated(a):n(c,u))};return n(this.restarters.create(t.params.restart))}async terminate(t){await super.terminate(),t&&this.telemetry&&an(this.telemetry.processId,this.logger)}createLifecycle(t,n,i){if(i.openerId)return{};let o;return{initialized:async()=>{o=this.onFirstInitialize(t,n,i),await o},close:()=>{this.targetList().length&&this.program?.stop(),o?.then(s=>s.dispose())}}}async onFirstInitialize(t,n,i){let o=new bg;await o.startTouchLoop();let s=new nr("node",void 0);try{s=await this.resolveNodePath(n.params)}catch{}let[a]=await Promise.all([this.gatherTelemetryFromCdp(t,n),this.setEnvironmentVariables(t,n,o.path,i.targetId,s)]);return this.telemetry=a,a&&n.params.attachExistingChildren&&sF({pid:a.processId,nodePath:s.path,hostname:n.params.address,ipcAddress:n.serverAddress},i.targetId,this.logger).catch(c=>this.logger.warn("internal","Error watching child processes",{err:c})),o}async setEnvironmentVariables(t,n,i,o,s){if(!n.params.autoAttachChildProcesses)return;if(!await ba(n.params.address)){this.logger.warn("runtime.target","Cannot attach to children of remote process");return}let a=await this.resolveEnvironment(n,s,{requireLease:i,openerId:o});return this.appendEnvironmentVariables(t,a)}};eu=P([(0,$s.injectable)(),y(0,(0,$s.inject)(Oo)),y(1,(0,$s.inject)(W)),y(2,(0,$s.inject)(ln)),y(3,(0,$s.inject)(Fr))],eu);var xr=S(G()),nu=g("path");function uF(r){if(!r.runtimeArgs||r.attachSimplePort)return;let e=[];for(let t of r.runtimeArgs)/^--inspect-brk(=|$)/.test(t)?r.stopOnEntry=r.stopOnEntry||!0:e.push(t);r.runtimeArgs=e}var lF=g("crypto"),tu=g("fs"),pF=g("os"),dF=S(g("path")),xg=class r{constructor(){this.path=dF.join((0,pF.tmpdir)(),`node-debug-callback-${(0,lF.randomBytes)(8).toString("hex")}`);this.disposed=!1}static{this.pollInterval=200}read(e=r.pollInterval){return this.readPromise?this.readPromise:(this.readPromise=new Promise((t,n)=>{let i=setInterval(()=>{if(this.disposed){clearInterval(i),t(void 0);return}if((0,tu.existsSync)(this.path)){try{t(JSON.parse((0,tu.readFileSync)(this.path,"utf-8")))}catch(o){n(o)}finally{this.dispose()}clearInterval(i)}},e)}),this.readPromise)}dispose(){if(!this.disposed){this.disposed=!0;try{(0,tu.unlinkSync)(this.path)}catch{}}}};var Hs=S(g("path"));var hp=Symbol("IProgramLauncher"),Ig=r=>{let e=r.program;if(e&&Hs.isAbsolute(e)){let t=Hs.relative(r.cwd,e);e=Hs.isAbsolute(t)?t:`.${Hs.sep}${t}`}return e?[...r.runtimeArgs,e,...Fu(r.args)]:[...r.runtimeArgs,...Fu(r.args)]};var _J=async(r,e)=>{if(typeof e.stopOnEntry=="string")return(0,nu.resolve)(e.cwd,e.stopOnEntry);if(e.program)return(0,nu.resolve)(e.cwd,e.program);for(let t of Fu(e.args)){if(t.startsWith("-"))continue;let n=(0,nu.resolve)(e.cwd,t);if(await r.exists(n))return n}},ru=class extends ni{constructor(t,n,i,o,s,a,c,u,l){super(t,n,l,u);this.bpPredictor=i;this.launchers=o;this.restarters=s;this.fsUtils=a;this.packageJson=c}resolveParams(t){let n;if(t.type==="pwa-node"&&t.request==="launch"?n={...t}:"server"in t&&t.server&&"program"in t.server&&(n={...t.server}),!!n)return uF(n),n}async launchProgram(t){t.params.program&&(t.params.program=await this.tryGetCompiledFile(t.params.program)),this.attachSimplePort=await this.getSimpleAttachPortIfAny(t.params);let n=async i=>{this.program&&this.program.stop();let o=await this.resolveNodePath(t.params,t.params.runtimeExecutable||void 0),s=o.warning;s&&t.context.dap.output({category:"stderr",output:s.message});let a=new xg,c=await this.resolveEnvironment(t,o,{fileCallback:a.path});this.attachSimplePort?(t.params.attachSimplePort||t.context.dap.output({category:"stderr",output:"Using legacy attach mode for --inspect-brk in npm scripts. We recommend removing --inspect-brk, and using `stopOnEntry` in your launch.json if you need it."}),c=c.merge({NODE_OPTIONS:null})):c=BL(o,c);let u={...t.params,env:c.value},l="--experimental-network-inspection";t.params.experimentalNetworking==="off"||(o.has(2)||t.params.experimentalNetworking==="on")&&(u.runtimeArgs=[l,...u.runtimeArgs]);let p=this.launchers.find(f=>f.canLaunch(u));if(!p)throw new Error("Cannot find an appropriate launcher for the given set of options");let d=await p.launchProgram(o.path,u,t.context);if(this.attachSimplePort){let f=await oi.attach({ipcAddress:t.serverAddress,scriptName:"Remote Process",inspectorURL:await Fc(`http://127.0.0.1:${this.attachSimplePort}`,t.context.cancellationToken,this.logger),waitForDebugger:!0,dynamicAttach:!0});d=new gg(d,new No(f))}else a.read().then(f=>{f&&d.gotTelemetery(f)});this.program=d,d.stopped.then(async f=>{if(a.dispose(),this.program!==d)return;if(f.killed||f.code===0){this.onProgramTerminated(f);return}let h=i.next();if(!h){this.onProgramTerminated(f);return}await ue(h.delay),this.program===d&&n(h)})};return n(this.restarters.create(t.params.restart))}async getSimpleAttachPortIfAny(t){if(t.attachSimplePort)return t.attachSimplePort;let n=jL(t.runtimeExecutable,t.runtimeArgs);if(!(!n||!(await this.packageJson.getContents())?.scripts?.[n]?.includes("--inspect-brk")))return t.port??9229}createLifecycle(t,n,{targetId:i}){return{initialized:async()=>{if(this.attachSimplePort&&await this.gatherTelemetryFromCdp(t,n),!n.params.stopOnEntry)return;let o=await _J(this.fsUtils,n.params);if(!o){this.logger.warn("runtime","Could not resolve program entrypointfrom args");return}let s="(?:entryBreakpoint){0}",a=ge(o),c=Er(a)+s,u=await t.Debugger.setBreakpointByUrl({urlRegex:c,lineNumber:0,columnNumber:0});return u?.breakpointId?{cdpId:u?.breakpointId,path:a}:void 0},close:()=>{let o=Number(i);if(o>0)try{process.kill(o)}catch{}}}}async tryGetCompiledFile(t){t=We(t);let n=(0,nu.extname)(t);if(!n||n===".js")return t;let i=await this.bpPredictor.getPredictionForSource(t);if(!i||i.size===0)return t;let o=ga(i.values());return o?(this.logger.info("runtime.launch","Updating entrypoint to compiled file",{from:t,to:o.compiledPath,candidates:i.size}),o.compiledPath):t}};ru=P([(0,xr.injectable)(),y(0,(0,xr.inject)(Oo)),y(1,(0,xr.inject)(W)),y(2,(0,xr.inject)(os)),y(3,(0,xr.multiInject)(hp)),y(4,(0,xr.inject)(si)),y(5,(0,xr.inject)(Zt)),y(6,(0,xr.inject)(qs)),y(7,(0,xr.inject)(ln)),y(8,(0,xr.inject)(Fr))],ru);var ou=S(g("fs")),fF=g("fs"),Cg=S(G()),hF=S(g("os")),st=S(g("path"));var mF=Symbol("INvmResolver");var iu=class{constructor(e=new Qr(fF.promises),t=process.env,n=process.arch,i=process.platform,o=hF.homedir()){this.fsUtils=e;this.env=t;this.arch=n;this.platform=i;this.homedir=o}async resolveNvmVersionPath(e){let t,n=[],i=this.parseVersionString(e),o=this.env.NVS_HOME;if(!o){let s=this.platform==="win32"?st.join(this.env.LOCALAPPDATA||"","nvs"):st.join(this.env.HOME||"",".nvs");ou.existsSync(s)&&(o=s)}if(i.nvsFormat||o){if(t=await this.resolveNvs(o,i),!t&&i.nvsFormat)throw new O(Eb(e,"nvs"));n.push("nvs")}if(!t)if(this.platform==="win32")this.env.NVM_HOME&&(t=await this.resolveWindowsNvm(e),n.push("nvm-windows"));else{let s=this.env.NVM_DIR||st.join(this.homedir,".nvm");await this.fsUtils.exists(s)&&(t=await this.resolveUnixNvm(e),n.push("nvm"))}if(!t){let s=this.platform==="win32"?this.env.FNM_DIR||st.join(this.env.APPDATA||"","fnm"):this.env.FNM_DIR||st.join(this.homedir,".fnm");await this.fsUtils.exists(s)&&(t=await this.resolveFnm(e,s),n.push("fnm"))}if(!n.length)throw new O(Tb());if(!t||!await this.fsUtils.exists(t))throw new O(Eb(e,n.join("/")));return{directory:t,binary:await this.getBinaryInFolder(t)}}async getBinaryInFolder(e){return await Zs(["node64.exe","node64"].map(t=>this.fsUtils.exists(st.join(e,t))))?"node64":"node"}async resolveNvs(e,{remoteName:t,semanticVersion:n,arch:i}){if(!e)throw new O(h0());let o=this.findBinFolderForVersion(st.join(e,t),n,s=>ou.existsSync(st.join(s,i)));if(o)return this.platform!=="win32"?st.join(o,i,"bin"):st.join(o,i)}async resolveUnixNvm(e){let t=this.env.NVM_DIR;if(!t){let i=st.join(this.env.HOME||"",".nvm");await this.fsUtils.exists(i)&&(t=i)}if(!t)throw new O(Tb());let n=this.findBinFolderForVersion(st.join(t,"versions","node"),`v${e}`);return n?st.join(n,"bin"):void 0}async resolveWindowsNvm(e){let t=this.env.NVM_HOME;if(!t)throw new O(m0());return this.findBinFolderForVersion(t,`v${e}`)}async resolveFnm(e,t){let n=this.findBinFolderForVersion(st.join(t,"node-versions"),`v${e}`);if(n)return this.platform==="win32"?st.join(n,"installation"):st.join(n,"installation","bin")}findBinFolderForVersion(e,t,n){if(!ou.existsSync(e))return;let i=ou.readdirSync(e);if(i.includes(t))return st.join(e,t);let o=i.filter(s=>s.startsWith(`${t}.`)).sort(wJ).filter(s=>n?n(st.join(e,s)):!0).pop();return o?st.join(e,o):void 0}parseVersionString(e){let n=/^(([\w-]+)\/)?(v?(\d+(\.\d+(\.\d+)?)?))(\/((x86)|(32)|((x)?64)|(arm\w*)|(ppc\w*)))?$/i.exec(e);if(!n)throw new Error("Invalid version string: "+e);let i=!!(n[2]||n[8]),o=n[2]||"node",s=n[4]||"",a=SJ(n[8]||this.arch);return{nvsFormat:i,remoteName:o,semanticVersion:s,arch:a}}};iu=P([(0,Cg.injectable)(),y(0,(0,Cg.inject)(Zt))],iu);var wJ=(r,e)=>{let t=/([0-9]+)\.([0-9]+)\.([0-9]+)/.exec(r),n=/([0-9]+)\.([0-9]+)\.([0-9]+)/.exec(e);if(!t||!n)return(n?-1:0)+(t?1:0);let[,i,o,s]=t,[,a,c,u]=n;return Number(i)-Number(a)||Number(o)-Number(c)||Number(s)-Number(u)};function SJ(r){switch(r){case"32":case"x86":case"ia32":return"x86";case"64":case"x64":case"amd64":return"x64";case"arm":let e=process.config.variables.arm_version;return e?"armv"+e+"l":"arm";default:return r}}var gF=g("child_process"),Tg=S(G());var su=class{constructor(e){this.logger=e}canLaunch(e){return e.console==="internalConsole"}async launchProgram(e,t,n){let{executable:i,args:o,shell:s,cwd:a}=np(e,Ig(t),t.cwd);n.dap.output({category:"console",output:[i,...o].join(" ")+`
`});let c=(0,gF.spawn)(i,o,{shell:s,cwd:a,env:bt.merge(bt.processEnv(),t.env).defined()});return t.outputCapture==="console"?this.discardStdio(n.dap,c):this.captureStdio(n.dap,c),new yg(c,this.logger,t.killBehavior)}captureStdio(e,t){t.stdout.pipe(new Pg).on("data",n=>e.output({category:"stdout",output:n.toString()})).resume(),t.stderr.pipe(new Pg).on("data",n=>e.output({category:"stderr",output:n.toString()})).resume()}discardStdio(e,t){let n=[],i=()=>{n&&e.output({category:"stderr",output:Buffer.concat(n).toString()})},o=Buffer.from("Debugger attached."),s=a=>{a.includes(o)?(n=void 0,t.stderr.removeListener("data",s)):n&&n.push(a)};t.stderr.on("data",s),t.on("error",a=>{i(),e.output({category:"stderr",output:a.stack||a.message})}),t.on("exit",a=>{a!==null&&a>0&&(i(),e.output({category:"stderr",output:`Process exited with code ${a}\r
`}))}),t.stdout.resume(),t.stderr.resume()}};su=P([(0,Tg.injectable)(),y(0,(0,Tg.inject)(W))],su);var Pg=class extends Po{constructor(){super(3);this.etxSpotted=!1;this.splitSuffix=Buffer.from(`
`)}_transform(t,n,i){return!this.etxSpotted&&t.includes(3)&&(this.etxSpotted=!0),this.etxSpotted?super._transform(t,n,i):(this.push(t),i())}};var Eg=S(G());var au=class{constructor(e){this.logger=e}canLaunch(e){return e.internalConsoleOptions,e.console!=="internalConsole"}async launchProgram(e,t,n){let i={kind:t.console==="integratedTerminal"?"integrated":"external",title:t.name,cwd:t.cwd,args:[e,...Ig(t)],env:Xs(t.env),argsCanBeInterpretedByShell:!Array.isArray(t.args)},o;try{o=await this.sendLaunchRequest(i,n)}catch(s){throw new O(g0(s.message))}return new Yc(o,this.logger,t.killBehavior)}sendLaunchRequest(e,t){return t.dap.runInTerminalRequest(e)}};au=P([(0,Eg.injectable)(),y(0,(0,Eg.inject)(W))],au);var yF=S(G());var cu=class{getTreatment(e,t){return Promise.resolve(t)}};cu=P([(0,yF.injectable)()],cu);var bF=S(G());var Gs=class{constructor(){this.flushEmitter=new k;this.onFlush=this.flushEmitter.event}report(){}reportOperation(){}attachDap(){}flush(){this.flushEmitter.fire()}dispose(){}};Gs=P([(0,bF.injectable)()],Gs);var vF=r=>{},_F=r=>{};var SF=(r,e,t,n)=>{let i=new kg.Container;return i.parent=r,i.bind(le).toConstantValue(e.launchConfig),i.bind(Aa).toConstantValue(i),i.bind(er).toConstantValue(t),i.bind(Ue).toConstantValue(n),i.bind(Xn).toConstantValue(e),i.bind(RL).toConstantValue(e.targetOrigin()),i.bind(Qo).to(Rs).inSingletonScope(),i.bind(gl).to(io).inSingletonScope(),i.bind(Ln).to(Zo).inSingletonScope(),i.bind(gf).to(Ua).inSingletonScope(),i.bind(Zi).toSelf().inSingletonScope(),e.sourcePathResolver&&i.bind(Ce).toConstantValue(e.sourcePathResolver),i.bind(ws).toSelf(),i.bind(Eh).toDynamicValue(o=>o.container.get(ws).create()).inSingletonScope(),e.parent()&&(i.bind(os).to(is).inSingletonScope(),i.bind(jn).to(Na).inSingletonScope()),i.bind(Ot).to(process.env.DA_TEST_DISABLE_TELEMETRY?Gs:$n).inSingletonScope().onActivation(Ge),i.bind(Nr).toSelf().inSingletonScope(),i.bind(mt).toSelf().inSingletonScope(),i.bind(po).toSelf().inSingletonScope(),i.bind(eo).to(Qn).inSingletonScope().onActivation(Ge),i.bind(ao).toSelf().inSingletonScope(),i.bind(dc).to(pc).inSingletonScope(),i.bind(Zf).to(nc).inSingletonScope(),i.bind(kr).to(La).inSingletonScope(),i.bind(Ih).to(gc).inSingletonScope(),i.bind(Qi).to(ka).inSingletonScope(),i.bind(Mf).to(Ka).inSingletonScope().onActivation(Ge),i.bind(yt).toSelf(),i.bind(br).toSelf(),i.bind(vr).toSelf(),i.bind(Dh).to(Ci).inSingletonScope(),i.bind(Oh).to(hc).inSingletonScope(),i.bind(Qf).to(tc).inSingletonScope().onActivation(Ge),i},xF=r=>{let e=new kg.Container;e.parent=r,e.bind(Aa).toConstantValue(e),e.bind(W).to(Hr).inSingletonScope().onActivation(Ge),e.bind(Qo).to(Rs).inSingletonScope(),e.bind(Ot).to(process.env.DA_TEST_DISABLE_TELEMETRY?Gs:$n).inSingletonScope().onActivation(Ge),e.bind(Un).to(Un).inSingletonScope(),e.bind(bi).to(bi).inSingletonScope(),e.bind(Rc).to(Ec).inSingletonScope(),e.bind(Oa).to(Lc).inSingletonScope(),e.bind(Oo).to(Jc),e.bind(ri).toSelf().inSingletonScope().onActivation(Ge),e.bind(si).toSelf(),e.bind(Gt).to(pn).onActivation(Ge),e.bind(Gt).to(Xc).onActivation(Ge),e.bind(Gt).to(Qc).onActivation(Ge),e.bind(Gt).to(ru).onActivation(Ge),e.bind(hp).to(su),e.bind(hp).to(au),e.bind(qs).to(Kc).inSingletonScope(),_F(e),e.bind(Gt).to(eu).onActivation(Ge),e.bind(Bs).toSelf().inSingletonScope().onActivation(Ge),e.bind(Gt).toService(Bs),e.bind(Gt).to(Uc).inSingletonScope().onActivation(Ge),e.bind(Gt).to(qc).inSingletonScope().onActivation(Ge),e.bind(Gt).to(jc).inSingletonScope().onActivation(Ge),e.bind(Gt).to(Wc).inSingletonScope().onActivation(Ge),e.bind(Gt).to(zr).onActivation(Ge),e.bind(Gt).toDynamicValue(()=>r.get(js).createLauncher(e.get(W))).inSingletonScope(),e.isBound(il)||e.bind(il).to(yc).inSingletonScope(),e.bind(ov).to(za).inSingletonScope().onActivation(Ge);let t=n=>i=>new n(i.container.get(Mb),i.container.get(Re),i.container.get(Nb));return e.bind(ts).toDynamicValue(t(Ag.ChromeBrowserFinder)).inSingletonScope().whenTargetTagged("browser","chrome"),e.bind(ts).toDynamicValue(t(Ag.EdgeBrowserFinder)).inSingletonScope().whenTargetTagged("browser","edge"),e},IF=r=>{let e=new kg.Container;return e.bind(Aa).toConstantValue(e),e.bind(js).toSelf().inSingletonScope(),e.bind($c).toSelf().inSingletonScope(),e.bind(Ef).to(cu).inSingletonScope(),e.bind(D0).toConstantValue(new Zn),e.bind(pM).to(Ac).inSingletonScope(),e.bind(Fn).toConstantValue(r.storagePath),e.bind(es).toConstantValue(r.isVsCode),e.bind(mF).to(iu),e.bind(Fr).to(ec).inSingletonScope(),e.bind(Mb).toConstantValue(process.env),e.bind(Nb).toConstantValue(wF.default),e.bind(Re).toConstantValue(Rg.promises),e.bind(Zt).toConstantValue(new Qr(Rg.promises)),e.bind(yi).toConstantValue(r.isRemote?"remote":"local"),r.context&&e.bind(k0).toConstantValue(r.context),vF(e),e},CF=(r,e,t)=>{r.bind(Rl).toConstantValue(Yk(e)),r.bind(le).toService(Rl),r.bind(ln).to(Hc).inSingletonScope(),r.bind(Ta).toConstantValue(t),r.bind(Ce).toDynamicValue(n=>n.container.get(ln).create(e,n.container.get(W))).inSingletonScope(),r.bind(Zt).toConstantValue(td.create(e.__remoteFilePrefix,Rg.promises,t)),r.bind(Ob).to(Yi).inSingletonScope().onActivation(Ge),r.bind(Xi).to(Ea).inSingletonScope(),r.bind(je).toSelf().inSingletonScope().onActivation(Ge),r.bind(Ln).to(Zo).inSingletonScope(),r.bind(ns).toSelf().inSingletonScope(),r.bind(os).to(is).inSingletonScope(),r.bind(jn).to(Ma).inSingletonScope()};var Dg=S(g("path"));function TF(r,e,t){let n=PF(r,e,"uncaughtException",t),i=PF(r,e,"unhandledRejection",t);return process.addListener("uncaughtException",n),process.addListener("unhandledRejection",i),{dispose:()=>{process.removeListener("uncaughtException",n),process.removeListener("unhandledRejection",i)}}}var PF=(r,e,t,n=!0)=>i=>{CJ(i)&&(e.report("error",{"!error":i,error:n?void 0:i,exceptionType:t}),r.error("runtime.exception","Unhandled error in debug adapter",i))},xJ=r=>typeof r=="object"&&!!r&&"stack"in r,IJ=Dg.dirname(Dg.dirname(Dg.dirname(__dirname)));function CJ(r){return!EF||xJ(r)&&!!r.stack?.includes(IJ)}var EF=!1;function RF(){EF=!0}var Og=class{constructor(e,t,n,i){this._delegate=e;this._rootServices=n;this._disposables=new De;this._serviceTree=new WeakMap;this._root=new zs(void 0);this.getLaunchers=ne(()=>{let e=new Set(this._rootServices.getAll(Gt));for(let t of e)this._disposables.push(t.onTargetListChanged(()=>{let n=this.targetList();this._attachToNewTargets(n,t),this._terminateOrphanThreads(n)}));return e});this._dap=t.dap(),this._targetOrigin=i,this._disposables.callback(()=>af(n)),this._disposables.push(TF(n.get(W),n.get(Ot),n.get(es))),t.attachTelemetry(n.get(Ot));let o=this._dap,s=0,a;o.on("initialize",async c=>{this._rootServices.bind(Dt).toConstantValue(c);let u=Is.capabilities();return c.clientID==="vscode"&&RF(),setTimeout(()=>o.initialized({}),0),u}),o.on("setExceptionBreakpoints",async()=>({})),o.on("setBreakpoints",async c=>(c.breakpoints?.length&&n.get(je).notifyHadBreakpoint(),{breakpoints:c.breakpoints?.map(()=>({id:++s,verified:!1,message:AF.t("Unbound breakpoint")}))??[]})),o.on("configurationDone",async()=>({})),o.on("threads",async()=>({threads:[]})),o.on("loadedSources",async()=>({sources:[]})),o.on("breakpointLocations",()=>Promise.resolve({breakpoints:[]})),o.on("attach",async c=>(await this.boot(c,o),{})),o.on("launch",async c=>(await this.boot(c,o),{})),o.on("pause",async()=>({})),o.on("terminate",()=>this._terminateRoot(!0)),o.on("disconnect",c=>this._disconnectRoot(c)),o.on("restart",async({arguments:c})=>(await this._restart(c),{})),o.on("startSelfProfile",async({file:c})=>(a?.dispose(),a=new Mh(c),await a.start(),{})),o.on("stopSelfProfile",async()=>(a&&(await a.stop(),a.dispose(),a=void 0),{})),o.on("enableNetworking",()=>Promise.resolve({}))}async _terminateRoot(e){return this._root.state=1,await Promise.all([...this.getLaunchers()].map(t=>t.terminate(e))),await this._root.waitUntilChildrenAre(2),this._root.state=2,{}}async _disconnectRoot(e){return this._root.state<1&&await this._terminateRoot(e.terminateDebuggee),this._rootServices.get(Ot).flush(),await this._root.waitUntilChildrenAre(3),this._root.state=3,{}}async boot(e,t){return this._boot(xa(e,this._rootServices.get(yi)),t)}async _boot(e,t){PJ(t),this.reportBootTelemetry(e),CF(this._rootServices,e,t),this._rootServices.get(W).setup(ix(t,e.trace));let n=e.timeout>0?ut.withTimeout(e.timeout):new ut;e.rootPath&&(e.rootPath=mi(e.rootPath)),this._launchParams=e;let i=await Promise.all([...this.getLaunchers()].map(o=>this._launch(o,e,n.token)));return Promise.all(i.map(o=>o.terminated)).then(o=>{let s=o.find(wt);this._markTargetAsTerminated(this._root,{restart:!!s?.restart})}),{}}reportBootTelemetry(e){let t=xa({type:e.type,request:e.request,name:"<string>",__workspaceFolder:"<workspace>"}),n=(i,o)=>typeof i=="string"?o&&t[o]===i?i:"<string>":i instanceof Array?i.map(s=>n(s)):i&&typeof i=="object"?ai(i,s=>n(s)):i;this._rootServices.get(Ot).report("launch",{type:e.type,request:e.request,os:`${Mg.platform()} ${Mg.arch()}`,nodeVersion:process.version,adapterVersion:$u,parameters:ai(e,n)})}async _restart(e){let t;if(e){let n=this._rootServices.get(Rl);t=xa({__workspaceFolder:n.__workspaceFolder,...e},this._rootServices.get(yi)),n.update(t)}await Promise.all([...this.getLaunchers()].map(n=>n.restart(t)))}async _launch(e,t,n){return(await this.captureLaunch(e,t,n)).blockSessionTermination?{terminated:new Promise(o=>{let s=this._disposables.push(e.onTerminated(a=>{s.dispose(),o(a)}))})}:{terminated:Promise.resolve(void 0)}}async captureLaunch(e,t,n){let i=e.constructor.name,o;try{o=await e.launch(t,{telemetryReporter:this._rootServices.get(Ot),cancellationToken:n,targetOrigin:this._targetOrigin,dap:this._dap})}catch(s){throw this._rootServices.get(W).warn("runtime.launch","Launch returned error",{error:s,wasCancelled:n.isCancellationRequested,name:i}),s}return o.blockSessionTermination&&this._rootServices.get(W).info("runtime.launch","Launched successfully",{name:i}),o}dispose(){this._disposables.dispose(),this._terminateOrphanThreads([])}targetList(){let e=[];for(let t of this.getLaunchers())e.push(...t.targetList());return e}async attach(e,t){if(!this._launchParams)throw new Error("Cannot launch before params have been set");let n=e.value;if(!n.canAttach())return;let i=await n.attach();if(!i)return;let o=await this._delegate.acquireDap(n),s=o.dap(),a=this._launchParams;this._asyncStackPolicy||(this._asyncStackPolicy=zk(a.showAsyncStacks));let c=n.parent(),u=c&&this._serviceTree.get(c)||this._rootServices,l=SF(u,n,s,i);o.attachTelemetry(l.get(Ot)),this._serviceTree.set(n,u);let p=new Is(s,this._asyncStackPolicy,a,l),d=p.createThread(i,n);"inspectUri"in a&&!!a.inspectUri&&this.attachDotnetDebuggerEvent(i,this._rootServices.get(Ot),this._rootServices.get(es));let h=async()=>(await p.launchBlocker(),n.runIfWaitingForDebugger(),e.threadData.resolve({thread:d,debugAdapter:p}),{});s.on("disconnect",m=>this._disconnectTarget(e,m)),s.on("terminate",()=>this._terminateTarget(e)),s.on("restart",async()=>(n.canRestart()?n.restart():await this._restart(),Promise.resolve({}))),await this._delegate.initAdapter(p,n,t)?h():(s.on("attach",h),s.on("launch",h)),await n.afterBind()}attachDotnetDebuggerEvent(e,t,n){e.DotnetDebugger.on("reportBlazorDebugException",i=>{t.report("blazorDebugException",{exceptionType:i.exceptionType,"!error":i.exception,error:n?void 0:i.exception})})}_attachToNewTargets(e,t){for(let n of e.values()){if(!n.waitingForDebugger()||zs.targetNodes.has(n))continue;let i=n.parent(),o=i?zs.targetNodes.get(i):this._root;if(!o)throw new Error(`Got target with unknown parent: ${n.name()}`);let s=new zs(n);o.add(s),this.attach(s,t)}}async _terminateOrphanThreads(e,t){let n=[...this._root.all()].filter(i=>!e.includes(i.value));return Promise.all(n.map(i=>this._markTargetAsTerminated(i,t)))}async _markTargetAsTerminated(e,t={}){if(e.state>=1)return await e.waitUntil(2),{};if(e.state=1,kF(e)){let n=await e.threadData.promise;await n.thread.dispose(),n.debugAdapter.dap.terminated(t),n.debugAdapter.dispose()}else this._dap.terminated(t);return await e.waitUntilChildrenAre(2),e.state=2,{}}async _terminateTarget(e){return e.state>=3?{}:(e.value.canStop()?e.value.stop():this._terminateRoot(!0),await e.waitUntil(2),{})}async _disconnectTarget(e,t){if(e.state>=3)return{};e.state<1&&(t.terminateDebuggee!==!0&&e.value.canDetach()?await e.value.detach():e.value.canStop()?e.value.stop():this._terminateRoot(t.terminateDebuggee)),await e.waitUntil(2),await e.waitUntilChildrenAre(3),e.state=3,queueMicrotask(()=>this._delegate.releaseDap(e.value));let n=e.value.parent();return(n?zs.targetNodes.get(n):this._root)?.remove(e),{}}};function PJ(r){c0&&r.output({category:"console",output:`Note: Using the "preview" debug extension
`})}var kF=r=>!!r.value,zs=class r{constructor(e){this.value=e;this.threadData=be();this._state=0;this._children=new Set;this._stateChangeEmitter=new k;e&&r.targetNodes.set(e,this)}static{this.targetNodes=new WeakMap}get state(){return this._state}set state(e){e>this._state&&(this._state=e,this._stateChangeEmitter.fire(e))}add(e){this._children.add(e)}remove(e){this._children.delete(e)}async waitUntil(e){return this._state>=e?Promise.resolve():new Promise(t=>{let n=this._stateChangeEmitter.event(i=>{i>=e&&(n.dispose(),t())})})}async waitUntilChildrenAre(e){await Promise.all([...this._children].map(t=>t.waitUntil(e)))}*all(){kF(this)&&(yield this);for(let e of this._children)yield*e.all()}};var DF=`\r
\r
`,TJ=0,Ng=class{constructor(e,t,n){this.inputStream=e;this.outputStream=t;this._contentLength=-1;this._connectionId=TJ++;this.msgEmitter=new k;this.messageReceived=this.msgEmitter.event;this.endedEmitter=new k;this.closed=this.endedEmitter.event;this._handleData=e=>{let t=new Br;for(this._rawData=Buffer.concat([this._rawData,e]);;){if(this._contentLength>=0){if(this._rawData.length>=this._contentLength){let n=this._rawData.toString("utf8",0,this._contentLength);if(this._rawData=this._rawData.slice(this._contentLength),this._contentLength=-1,n.length>0)try{let i=JSON.parse(n);this.logger?.verbose("dap.receive",void 0,{connectionId:this._connectionId,message:i}),this.msgEmitter.fire({message:i,receivedTime:t})}catch(i){console.error("Error handling data: "+(i&&i.message))}continue}}else{let n=this._rawData.indexOf(DF);if(n!==-1){let o=this._rawData.toString("utf8",0,n).split(`\r
`);for(let s=0;s<o.length;s++){let a=o[s].split(/: +/);a[0]==="Content-Length"&&(this._contentLength=+a[1])}this._rawData=this._rawData.slice(n+DF.length);continue}}break}};this.logger=n,this._rawData=Buffer.alloc(0),e.on("end",()=>this.endedEmitter.fire()),e.on("data",this._handleData)}send(e,t=!0,n){let i=JSON.stringify(e);if(t){let s=e;e.type==="response"&&e.command==="source"&&(s={...e,body:{...e.body,content:"<script source>"}}),this.logger?.verbose("dap.send",void 0,{connectionId:this._connectionId,message:s})}let o=`Content-Length: ${Buffer.byteLength(i,"utf8")}\r
\r
${i}`;if(this.outputStream.destroyed){this.logger?.warn("dap.send","Message not sent. Connection was closed."),n?.();return}this.outputStream.write(o,"utf8",s=>{n?.(),s&&(console.log(e),this.logger?.error("dap.send","Error while writing to output stream",s),this.close())})}close(){this.inputStream.destroy(),this.outputStream.destroy()}setLogger(e){return this.logger=e,this}};process.env.L10N_FSPATH_TO_BUNDLE&&Lg.config({fsPath:process.env.L10N_FSPATH_TO_BUNDLE});var EJ=MF.mkdtempSync(Fg.join(LF.tmpdir(),"vscode-js-debug-"));function RJ(r){let e,t=[],n=[],i=[],o=be(),s=0,a;return r.on("setBreakpoints",async c=>{let u=c.breakpoints?.map(()=>++s)??[];return t.push({params:c,ids:u}),{breakpoints:u.map(p=>({id:p,verified:!1,message:Lg.t("breakpoint.provisionalBreakpoint","Unbound breakpoint")}))}}),r.on("setExceptionBreakpoints",async c=>(e=c,{})),r.on("setCustomBreakpoints",async c=>(n=c.ids,i=c.xhr,{})),r.on("configurationDone",async()=>(o.resolve(),{})),r.on("threads",async()=>({threads:[]})),r.on("loadedSources",async()=>({sources:[]})),r.on("initialize",async c=>(a=c,setTimeout(()=>r.initialized({}),0),Is.capabilities())),new Promise(c=>{let u=async l=>{await o.promise;let p=be();if(!a)throw new Error("cannot call launch/attach before initialize");return c({initializeParams:a,setExceptionBreakpointsParams:e,setBreakpointsParams:t,customBreakpoints:n,xhrBreakpoints:i,launchParams:l,deferred:p}),p.promise};r.on("launch",l=>u(l)),r.on("attach",u)})}var NS=class{constructor(e,t){this.dapRoot=e;this.services=t;this.sessions=new Map}async acquireDap(e){let t=this.sessions.get(e.id());if(t){let{connection:s}=await t.promise;return s}let n=e.parent(),i;if(n){let s=this.sessions.get(n.id())?.settledValue;if(!s)throw new Error("Expected parent session to have a settled value");i=s.connection.dap()}else i=this.dapRoot;let o=be();return this.sessions.set(e.id(),o),i.startDebuggingRequest({request:e.launchConfig.request,configuration:{type:e.launchConfig.type,name:e.name(),__pendingTargetId:e.id()}}).catch(s=>o.reject(s)),o.promise.then(s=>s.connection)}async initAdapter(e,t){let n=this.sessions.get(t.id())?.settledValue;if(!n)throw new Error(`Expected to find pending init for target ${t.id()}`);n.setExceptionBreakpointsParams&&await e.setExceptionBreakpoints(n.setExceptionBreakpointsParams);for(let{params:i,ids:o}of n.setBreakpointsParams)await e.breakpointManager.setBreakpoints(i,o);return await e.setCustomBreakpoints({xhr:n.xhrBreakpoints,ids:n.customBreakpoints}),await e.onInitialize(n.initializeParams),await e.configurationDone(),await e.launchBlocker(),n.deferred.resolve({}),!0}releaseDap(e){this.sessions.delete(e.id())}hasPendingTarget(e){return this.sessions.get(e)?.hasSettled()===!1}handleConnection(e){if(!("__pendingTargetId"in e.launchParams)||!e.launchParams.__pendingTargetId)throw new Error("Incoming session is missing __pendingTargetId");let t=e.launchParams.__pendingTargetId,n=this.sessions.get(t);if(!n)throw new Error(`__pendingTargetId ${t} not found`);n.resolve(e)}};function OF(r){let e=IF({storagePath:EJ,isVsCode:!1}),t=new Set,n=NF.createServer(async i=>{try{let o=new zc,s=new Ng(i,i,o),a=new zu(s,o),c=a.dap(),u=await RJ(c);if("__pendingTargetId"in u.launchParams){let l=u.launchParams.__pendingTargetId,p=l&&[...t].find(d=>d.hasPendingTarget(l));if(!p)throw new Error(`Cannot find pending target for ${l}`);o.connectTo(p.services.get(W)),p.handleConnection({...u,connection:a})}else{let l=xF(e),p=new NS(c,l);t.add(p),l.bind(Dt).toConstantValue(u.initializeParams),o.connectTo(l.get(W));let d=new Og(p,a,l,new ug("targetOrigin"));s.closed(()=>{d.dispose(),t.delete(p)}),u.deferred.resolve(await d.boot(u.launchParams,c))}}catch(o){return console.error(o),i.destroy()}}).on("error",i=>{console.error(i),process.exit(1)}).listen(r,()=>{let i=n.address();console.log(`Debug server listening at ${typeof i=="string"?i:`${i.address}:${i.port}`}`)})}var[,AJ,MS="8123",kJ="localhost"]=process.argv;process.argv.includes("--help")?console.log(`Usage: ${Fg.basename(AJ)} [port|socket path=8123] [host=localhost]`):isNaN(Number(MS))?OF({path:MS}):OF({port:Number(MS),host:kJ});})();
/*! Bundled license information:

reflect-metadata/Reflect.js:
  (*! *****************************************************************************
  Copyright (C) Microsoft. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0
  
  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.
  
  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** *)

is-number/index.js:
  (*!
   * is-number <https://github.com/jonschlinkert/is-number>
   *
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Released under the MIT License.
   *)

to-regex-range/index.js:
  (*!
   * to-regex-range <https://github.com/micromatch/to-regex-range>
   *
   * Copyright (c) 2015-present, Jon Schlinkert.
   * Released under the MIT License.
   *)

fill-range/index.js:
  (*!
   * fill-range <https://github.com/jonschlinkert/fill-range>
   *
   * Copyright (c) 2014-present, Jon Schlinkert.
   * Licensed under the MIT License.
   *)

normalize-path/index.js:
  (*!
   * normalize-path <https://github.com/jonschlinkert/normalize-path>
   *
   * Copyright (c) 2014-2018, Jon Schlinkert.
   * Released under the MIT License.
   *)

is-extglob/index.js:
  (*!
   * is-extglob <https://github.com/jonschlinkert/is-extglob>
   *
   * Copyright (c) 2014-2016, Jon Schlinkert.
   * Licensed under the MIT License.
   *)

is-glob/index.js:
  (*!
   * is-glob <https://github.com/jonschlinkert/is-glob>
   *
   * Copyright (c) 2014-2017, Jon Schlinkert.
   * Released under the MIT License.
   *)

is-windows/index.js:
  (*!
   * is-windows <https://github.com/jonschlinkert/is-windows>
   *
   * Copyright  2015-2018, Jon Schlinkert.
   * Released under the MIT License.
   *)
*/
